<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>typescript + ava + nyc + gitlab CI/CD å®ç°ä»£ç è¦†ç›–ç‡</title>
      <link href="/2019/02/06/test-cov/"/>
      <url>/2019/02/06/test-cov/</url>
      
        <content type="html"><![CDATA[<p><code>typescript</code> <code>ava</code> <code>nyc</code> <code>gitlab ci</code> å®ç°ä»£ç è¦†ç›–ç‡è‡ªåŠ¨åŒ–ä»¥åŠ badges æ˜¾ç¤º</p><a id="more"></a><h2 id="æœ€ç»ˆé…ç½®"><a href="#æœ€ç»ˆé…ç½®" class="headerlink" title="æœ€ç»ˆé…ç½®"></a>æœ€ç»ˆé…ç½®</h2><ul><li>åœ¨ <code>package.json</code> æ·»åŠ ä»¥ä¸‹</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"scripts"</span>: &#123;</span><br><span class="line">    <span class="attr">"coverage"</span>: <span class="string">"TS_NODE_FILES=true nyc ava --fail-fast -v"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"ava"</span>: &#123;</span><br><span class="line">    <span class="attr">"compileEnhancements"</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">"extensions"</span>: [<span class="string">"ts"</span>],</span><br><span class="line">    <span class="attr">"require"</span>: [<span class="string">"ts-node/register"</span>]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"nyc"</span>: &#123;</span><br><span class="line">    <span class="attr">"include"</span>: [<span class="string">"src/**/*.ts"</span>],</span><br><span class="line">    <span class="attr">"exclude"</span>: [<span class="string">"**/*.d.ts"</span>],</span><br><span class="line">    <span class="attr">"extension"</span>: [<span class="string">".ts"</span>],</span><br><span class="line">    <span class="attr">"require"</span>: [<span class="string">"ts-node/register"</span>],</span><br><span class="line">    <span class="attr">"reporter"</span>: [<span class="string">"html"</span>, <span class="string">"text-summary"</span>],</span><br><span class="line">    <span class="attr">"sourceMap"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"instrument"</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>éœ€è¦å®‰è£…<code>source-map-support</code>, åœ¨ <code>package.json</code> åŒç›®å½•ä¸‹è¿è¡Œ<code>yarn add -D source-map-support</code> æˆ–è€… <code>npm install --save-dev source-map-support</code></p></li><li><p>åœ¨ <code>gitlab-ci.yml</code> æ·»åŠ ä¸€ä¸‹å†…å®¹</p></li></ul><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">test-coverage:</span></span><br><span class="line"><span class="attr">  stage:</span> <span class="string">test-coverage</span></span><br><span class="line"><span class="attr">  coverage:</span> <span class="string">'/Lines\s*:\s*(\d+(?:\.\d+)?)%/'</span></span><br><span class="line"><span class="attr">  script:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">yarn</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">yarn</span> <span class="string">run</span> <span class="string">coverage</span></span><br></pre></td></tr></table></figure><h2 id="é…ç½®è¯¦è§£"><a href="#é…ç½®è¯¦è§£" class="headerlink" title="é…ç½®è¯¦è§£"></a>é…ç½®è¯¦è§£</h2><h3 id="ava-é…ç½®"><a href="#ava-é…ç½®" class="headerlink" title="ava é…ç½®"></a>ava é…ç½®</h3><p><code>ava</code> çš„é…ç½® ç›´æ¥ä»å®˜æ–¹æ–‡æ¡£ <a href="https://github.com/avajs/ava/blob/master/docs/recipes/typescript.md" target="_blank" rel="noopener">typescript.md</a>  çš„  åŠ¨æ€ç¼–è¯‘éƒ¨åˆ†è·å–  é…ç½®</p><p><strong>æ³¨æ„!!</strong></p><blockquote><p>å¦‚æœä½ å†™çš„ <code>typescript</code> ä»£ç ä¸­ å«æœ‰ <code>d.ts</code> æ–‡ä»¶<br>éœ€è¦åŠ ä¸Šç¯å¢ƒå˜é‡ <code>TS_NODE_FILES=true</code></p></blockquote><h3 id="nyc-é…ç½®"><a href="#nyc-é…ç½®" class="headerlink" title="nyc é…ç½®"></a>nyc é…ç½®</h3><p>ä»å®˜æ–¹æ–‡æ¡£ <a href="https://istanbul.js.org/docs/tutorials/typescript/" target="_blank" rel="noopener"><code>tutorials/typescript</code></a>éƒ¨åˆ†å¾—çŸ¥éœ€è¦é…ç½® <code>extension</code> ä¸º <code>.ts</code>, ä» <a href="https://azimi.me/2016/09/30/nyc-mocha-typescript.1.html" target="_blank" rel="noopener">nyc-mocha-typescript</a>è¿™ç¯‡æ–‡ç« å¾—çŸ¥, éœ€è¦ <code>source-map-support</code> æ¥æ˜ å°„ <code>ts</code> å’Œ <code>js</code>çš„ä»£ç å…³ç³»<br>è€Œ <code>reporter</code> é…ç½®, å¯ä»¥åœ¨ <a href="https://istanbul.js.org/docs/advanced/alternative-reporters/" target="_blank" rel="noopener">alternative-reporters</a> é€‰æ‹©è‡ªå·±éœ€è¦çš„ <code>reporter</code>, ç”±äºéœ€è¦é…åˆ <code>gitlab ci</code>, è¿™è¾¹éœ€è¦é€‰æ‹© <code>text-summary</code> æ–¹ä¾¿ <code>glitlab</code> åˆ†æ</p><h3 id="gitlab-é…ç½®"><a href="#gitlab-é…ç½®" class="headerlink" title="gitlab é…ç½®"></a>gitlab é…ç½®</h3><p>ä»å®˜æ–¹æ–‡æ¡£å¯çŸ¥, éœ€è¦ç”¨æ­£åˆ™è¡¨è¾¾å¼æ¥æˆªå–æœ€ç»ˆçš„è¦†ç›–ç‡, ç”±äºç”¨äº† <code>text-summary</code> çš„ <code>reporter</code>, æ‰€ä»¥æ­£åˆ™è¡¨è¾¾å¼ä¸º <code>/Lines\s*:\s*(\d+(?:\.\d+)?)%/</code></p><p>æœ€å, é€šè¿‡ URL <code>https://gitlab.com/&lt;namespace&gt;/&lt;project&gt;/badges/&lt;branch&gt;/coverage.svg</code> æ¥æ˜¾ç¤ºä¸€ä¸ªå°å›¾æ ‡, æ¯”å¦‚ <figure class="image-box">                <img src="https://gitlab.com/shang-music/music-api/badges/develop/coverage.svg" alt="" title="" class="">                <p></p>            </figure></p><h2 id="å®Œæ•´ä¾‹å­"><a href="#å®Œæ•´ä¾‹å­" class="headerlink" title="å®Œæ•´ä¾‹å­"></a>å®Œæ•´ä¾‹å­</h2><p><a href="https://gitlab.com/shang-music/music-api" target="_blank" rel="noopener">music-api</a><br>åŒ…å«äº† <code>ts</code> <code>ava</code> <code>nyc</code> <code>gitlab ci</code> <code>npm publish</code> å’Œ <code>badges</code>æ˜¾ç¤º</p><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><ul><li><a href="https://azimi.me/2016/09/30/nyc-mocha-typescript.1.html" target="_blank" rel="noopener">Setting up test coverage using Mocha, Istanbul, NYC with TypeScript</a></li><li><a href="https://istanbul.js.org/docs/tutorials/ava/" target="_blank" rel="noopener">Using Istanbul With AVA</a></li><li><a href="https://docs.gitlab.com/ee/user/project/pipelines/settings.html#test-coverage-parsing" target="_blank" rel="noopener">GitLab Docs test-coverage-parsing</a></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANG æ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> ava </tag>
            
            <tag> nyc </tag>
            
            <tag> typescript </tag>
            
            <tag> gitlab </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>headless Chrome å…¥é—¨</title>
      <link href="/2019/01/01/headless-chrome-start/"/>
      <url>/2019/01/01/headless-chrome-start/</url>
      
        <content type="html"><![CDATA[<p>ä½¿ç”¨ <code>puppeteer</code> <code>API</code> å…¥é—¨ <code>headless Chrome</code></p><a id="more"></a><h2 id="headless-ç®€ä»‹"><a href="#headless-ç®€ä»‹" class="headerlink" title="headless ç®€ä»‹"></a><code>headless</code> ç®€ä»‹</h2><ul><li><p><code>Headless browser</code><br><code>Headless browser</code> æ˜¯æ²¡æœ‰å›¾å½¢ç•Œé¢çš„æµè§ˆå™¨</p></li><li><p><a href="https://chromium.googlesource.com/chromium/src/+/lkgr/headless/README.md" target="_blank" rel="noopener"><code>Headless Chrome/Headless Chromium</code></a><br>å…è®¸ <code>Chrome/Chromium</code> åœ¨ <code>headless/server</code> çš„ç¯å¢ƒä¸­ä½¿ç”¨</p></li><li><p><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Firefox/Headless_mode" target="_blank" rel="noopener"><code>Headless Firefox</code></a><br>å…è®¸ <code>Firefox</code> åœ¨ <code>headless/server</code> çš„ç¯å¢ƒä¸­ä½¿ç”¨</p></li><li><p><a href="https://github.com/GoogleChrome/puppeteer" target="_blank" rel="noopener"><code>GoogleChrome/puppeteer</code></a><br><code>Google</code> å¼€æºçš„ <code>headless nodejs API</code></p></li></ul><h2 id="pptr-puppeteer-ä½¿ç”¨"><a href="#pptr-puppeteer-ä½¿ç”¨" class="headerlink" title="pptr(puppeteer) ä½¿ç”¨"></a><code>pptr(puppeteer)</code> ä½¿ç”¨</h2><ul><li>å®‰è£… &amp;&amp; å¯åŠ¨</li><li>pdf &amp;&amp; æˆªå›¾</li><li>éšè— headless chrome ç‰¹æœ‰çš„å±æ€§æ¥å±è”½æ£€æµ‹</li><li>è‡ªåŠ¨åŒ–æµ‹è¯• (é”®å…¥å­—ç¬¦ &amp;&amp; æ‹¦æˆªè¯·æ±‚)</li></ul><h3 id="å®‰è£…-amp-amp-å¯åŠ¨"><a href="#å®‰è£…-amp-amp-å¯åŠ¨" class="headerlink" title="å®‰è£… &amp;&amp; å¯åŠ¨"></a>å®‰è£… &amp;&amp; å¯åŠ¨</h3><p> éœ€è¦æ‰‹åŠ¨å®‰è£… chrome<br><code>npm i puppeteer-core</code><br>è‡ªåŠ¨ä¸‹è½½ chrome<br><code>npm i puppeteer</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> browser = <span class="keyword">await</span> puppeteer.launch(&#123;</span><br><span class="line">  <span class="comment">// Chromium å®‰è£…è·¯å¾„</span></span><br><span class="line">  executablePath: process.env.CHROME_BIN,</span><br><span class="line">  <span class="comment">// æ˜¯å¦ä»¥ headless æ¨¡å¼å¯åŠ¨</span></span><br><span class="line">  headless: <span class="literal">true</span>,</span><br><span class="line">  <span class="comment">// æ˜¯å¦å¼€å¯ devtools</span></span><br><span class="line">  devtools: <span class="literal">true</span>,</span><br><span class="line">  args: [<span class="string">'--no-sandbox'</span>, <span class="string">'--disable-gpu'</span>, <span class="string">'--disable-setuid-sandbox'</span>, <span class="string">'--disable-dev-shm-usage'</span>],</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// éšèº«æ¨¡å¼</span></span><br><span class="line"><span class="keyword">const</span> context = <span class="keyword">await</span> browser.createIncognitoBrowserContext();</span><br><span class="line"><span class="comment">// åˆ›å»ºä¸€ä¸ª æ ‡ç­¾é¡µ</span></span><br><span class="line"><span class="keyword">const</span> page = <span class="keyword">await</span> context.newPage();</span><br><span class="line"><span class="comment">// è½¬åˆ°å“ªä¸ªç½‘å€, å¹¶ä¸”ç­‰å¾…ç½‘é¡µload</span></span><br><span class="line"><span class="keyword">await</span> page.goto(<span class="string">'https://www.jd.com'</span>, &#123; <span class="attr">waitUntil</span>: <span class="string">'load'</span> &#125;);</span><br></pre></td></tr></table></figure><h3 id="pdf-amp-amp-æˆªå›¾"><a href="#pdf-amp-amp-æˆªå›¾" class="headerlink" title="pdf &amp;&amp; æˆªå›¾"></a>pdf &amp;&amp; æˆªå›¾</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">await</span> page.pdf(&#123;</span><br><span class="line">  path: pathResolve(__dirname, <span class="string">'../data/jd.pdf'</span>),</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">await</span> page.screenshot(&#123;</span><br><span class="line">  path: pathResolve(__dirname, <span class="string">'../data/jd.png'</span>),</span><br><span class="line">  fullPage: <span class="literal">true</span>,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="éšè—-headless-chrome-ç‰¹æœ‰çš„å±æ€§æ¥å±è”½æ£€æµ‹"><a href="#éšè—-headless-chrome-ç‰¹æœ‰çš„å±æ€§æ¥å±è”½æ£€æµ‹" class="headerlink" title="éšè— headless chrome ç‰¹æœ‰çš„å±æ€§æ¥å±è”½æ£€æµ‹"></a><a href="https://intoli.com/blog/not-possible-to-block-chrome-headless/" target="_blank" rel="noopener">éšè— headless chrome ç‰¹æœ‰çš„å±æ€§æ¥å±è”½æ£€æµ‹</a></h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">await</span> page.setUserAgent(</span><br><span class="line">  <span class="string">'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36'</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">await</span> page.evaluateOnNewDocument(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// overwrite the `languages` property to use a custom getter</span></span><br><span class="line">  <span class="built_in">Object</span>.defineProperty(navigator, <span class="string">'languages'</span>, &#123;</span><br><span class="line">    <span class="keyword">get</span>() &#123;</span><br><span class="line">      <span class="keyword">return</span> [<span class="string">'zh-CN'</span>, <span class="string">'zh'</span>, <span class="string">'zh-TW'</span>, <span class="string">'en-US'</span>, <span class="string">'en'</span>];</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Overwrite the `plugins` property to use a custom getter.</span></span><br><span class="line">  <span class="built_in">Object</span>.defineProperty(navigator, <span class="string">'plugins'</span>, &#123;</span><br><span class="line">    <span class="keyword">get</span>: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Pass the Webdriver test</span></span><br><span class="line">  <span class="built_in">Object</span>.defineProperty(navigator, <span class="string">'webdriver'</span>, &#123;</span><br><span class="line">    <span class="keyword">get</span>: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Pass the Chrome Test.</span></span><br><span class="line">  <span class="comment">// We can mock this in as much depth as we need for the test.</span></span><br><span class="line">  <span class="comment">// @ts-ignore</span></span><br><span class="line">  <span class="built_in">window</span>.navigator.chrome = &#123;</span><br><span class="line">    runtime: &#123;&#125;,</span><br><span class="line">    <span class="comment">// etc.</span></span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Pass the Permissions Test.</span></span><br><span class="line">  <span class="comment">// @ts-ignore</span></span><br><span class="line">  <span class="keyword">const</span> originalQuery = <span class="built_in">window</span>.navigator.permissions.query;</span><br><span class="line">  <span class="comment">// @ts-ignore</span></span><br><span class="line">  <span class="built_in">window</span>.navigator.permissions.query = <span class="function">(<span class="params">parameters</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> parameters.name === <span class="string">'notifications'</span></span><br><span class="line">      ? <span class="built_in">Promise</span>.resolve(&#123; state: Notification.permission &#125;)</span><br><span class="line">      : originalQuery(parameters);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="è‡ªåŠ¨åŒ–æµ‹è¯•-é”®å…¥å­—ç¬¦-amp-amp-æ‹¦æˆªè¯·æ±‚-ç­‰"><a href="#è‡ªåŠ¨åŒ–æµ‹è¯•-é”®å…¥å­—ç¬¦-amp-amp-æ‹¦æˆªè¯·æ±‚-ç­‰" class="headerlink" title="è‡ªåŠ¨åŒ–æµ‹è¯• (é”®å…¥å­—ç¬¦ &amp;&amp; æ‹¦æˆªè¯·æ±‚ ç­‰)"></a>è‡ªåŠ¨åŒ–æµ‹è¯• (é”®å…¥å­—ç¬¦ &amp;&amp; æ‹¦æˆªè¯·æ±‚ ç­‰)</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é”®å…¥å­—ç¬¦</span></span><br><span class="line"><span class="keyword">await</span> page.type(<span class="string">'input[name="username"]'</span>, <span class="string">'XXXXX'</span>, &#123; delay: <span class="number">10</span> &#125;);</span><br><span class="line"><span class="comment">// é¼ æ ‡ç‚¹å‡»</span></span><br><span class="line"><span class="keyword">await</span> page.mouse.click();</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‹¦æˆªè¯·æ±‚</span></span><br><span class="line"><span class="keyword">await</span> page.setRequestInterception(<span class="literal">true</span>);</span><br><span class="line">page.on(<span class="string">'request'</span>, <span class="function">(<span class="params">request</span>) =&gt;</span> &#123;&#125;);</span><br><span class="line">page.on(<span class="string">'response'</span>, <span class="function">(<span class="params">response</span>) =&gt;</span> &#123;&#125;);</span><br></pre></td></tr></table></figure><h2 id="dockerfile"><a href="#dockerfile" class="headerlink" title="dockerfile"></a>dockerfile</h2><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> node:<span class="number">10</span>-alpine as build</span><br><span class="line"></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="bash"> /app</span></span><br><span class="line"><span class="bash"></span></span><br><span class="line"><span class="bash">COPY package.json package.json</span></span><br><span class="line"><span class="bash">COPY yarn.lock yarn.lock</span></span><br><span class="line"><span class="bash">RUN yarnpkg</span></span><br><span class="line"><span class="bash"></span></span><br><span class="line"><span class="bash">COPY . .</span></span><br><span class="line"><span class="bash"></span></span><br><span class="line"><span class="bash">RUN npm run build</span></span><br><span class="line"><span class="bash"></span></span><br><span class="line"><span class="bash"></span></span><br><span class="line"><span class="bash">FROM keymetrics/pm2:10-alpine</span></span><br><span class="line"><span class="bash"></span></span><br><span class="line"><span class="bash">RUN <span class="built_in">set</span> -x \</span></span><br><span class="line"><span class="bash">      &amp;&amp; apk update \</span></span><br><span class="line"><span class="bash">      &amp;&amp; apk upgrade \</span></span><br><span class="line"><span class="bash">      &amp;&amp; apk add --no-cache \</span></span><br><span class="line"><span class="bash">      wget \</span></span><br><span class="line"><span class="bash">      dumb-init \</span></span><br><span class="line"><span class="bash">      udev \</span></span><br><span class="line"><span class="bash">      ttf-freefont \</span></span><br><span class="line"><span class="bash">      chromium \</span></span><br><span class="line"><span class="bash">      <span class="comment"># install chinese font</span></span></span><br><span class="line"><span class="bash">      &amp;&amp; wget -qO- https://raw.githubusercontent.com/yakumioto/YaHei-Consolas-Hybrid-1.12/master/install.sh | sh \</span></span><br><span class="line"><span class="bash">      <span class="comment"># Cleanup</span></span></span><br><span class="line"><span class="bash">      &amp;&amp; apk del --no-cache make gcc g++ python binutils-gold gnupg libstdc++ \</span></span><br><span class="line"><span class="bash">      &amp;&amp; rm -rf /usr/include \</span></span><br><span class="line"><span class="bash">      &amp;&amp; rm -rf /var/cache/apk/* /root/.node-gyp /usr/share/man /tmp/* \</span></span><br><span class="line"><span class="bash">      &amp;&amp; <span class="built_in">echo</span></span></span><br><span class="line"><span class="bash"></span></span><br><span class="line"><span class="bash">ENTRYPOINT [<span class="string">"/usr/bin/dumb-init"</span>]</span></span><br><span class="line"><span class="bash"></span></span><br><span class="line"><span class="bash"><span class="comment"># node project</span></span></span><br><span class="line"><span class="bash">WORKDIR /app</span></span><br><span class="line"><span class="bash"></span></span><br><span class="line"><span class="bash"><span class="comment"># cache package</span></span></span><br><span class="line"><span class="bash">COPY --from=build /app/dist/package.json package.json</span></span><br><span class="line"><span class="bash">RUN yarnpkg</span></span><br><span class="line"><span class="bash"></span></span><br><span class="line"><span class="bash"><span class="comment"># copy project dist files</span></span></span><br><span class="line"><span class="bash">COPY --from=build /app/dist/ .</span></span><br><span class="line"><span class="bash"></span></span><br><span class="line"><span class="bash">ENV CHROME_BIN <span class="string">"/usr/bin/chromium-browser"</span></span></span><br><span class="line"><span class="bash">ENV NODE_ENV <span class="string">"production"</span></span></span><br><span class="line"><span class="bash"></span></span><br><span class="line"><span class="bash">CMD [<span class="string">"node"</span>, <span class="string">"index.js"</span>]</span></span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><ul><li><a href="https://intoli.com/blog/not-possible-to-block-chrome-headless/" target="_blank" rel="noopener">IT IS <em>NOT</em> POSSIBLE TO DETECT AND BLOCK CHROME HEADLESS</a></li><li><a href="https://pptraas.com/" target="_blank" rel="noopener">Puppeteer as a service</a></li><li><a href="https://juejin.im/post/5bbc96785188255c72286403" target="_blank" rel="noopener">æˆªå›¾çš„è¯±æƒ‘</a></li><li><a href="https://github.com/GoogleChrome/puppeteer/blob/v1.11.0/docs/api.md" target="_blank" rel="noopener">puppeteer api</a></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANG æ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> headless </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨ fetch ä¸Šä¼  FormData è¸©å‘</title>
      <link href="/2018/12/01/fetch-form-data/"/>
      <url>/2018/12/01/fetch-form-data/</url>
      
        <content type="html"><![CDATA[<p>ä½¿ç”¨ fetch ä¸Šä¼ æ–‡ä»¶, ä½¿ç”¨ FormData æœåŠ¡å™¨æ— æ³•è¯†åˆ«<br><a id="more"></a></p><h1 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h1><p>å…ˆä¸Šç»“è®º, ä½¿ç”¨ <code>fetch</code> å’Œ <code>FormData</code>, ä¸èƒ½è®¾ç½® <code>Content-Type</code> header !!!!</p><h1 id="ç¼˜èµ·"><a href="#ç¼˜èµ·" class="headerlink" title="ç¼˜èµ·"></a>ç¼˜èµ·</h1><p>æƒ³è¦ é€šè¿‡ <code>blob</code> ä¸Šä¼ äºŒè¿›åˆ¶æ–‡ä»¶åˆ°æœåŠ¡å™¨, å¾ˆè‡ªç„¶ç”¨äº†å¦‚ä¸‹ä»£ç </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> formData = <span class="keyword">new</span> FormData();</span><br><span class="line">formData.append(<span class="string">'xxx'</span>, Blob, <span class="string">'filename'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">await</span> fetch(url, &#123;</span><br><span class="line">  method: <span class="string">'POST'</span>,</span><br><span class="line">  headers: &#123;</span><br><span class="line">    <span class="string">'Content-Type'</span>: <span class="string">'multipart/form-data'</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  body: formData,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯æœåŠ¡å™¨ä¸€ç›´æŠ¥é”™, è¿”å›æ— æ³•è¯†åˆ« <code>body</code></p><h1 id="æ’é”™"><a href="#æ’é”™" class="headerlink" title="æ’é”™"></a>æ’é”™</h1><ol><li>æ¢æˆ <code>xmlRequest</code> ä¸Šä¼ , ä¾ç„¶æŠ¥é”™</li><li>ä½¿ç”¨å…¶å®ƒå·¥å…·ä¸Šä¼ (<code>postman/insomnia</code>), æ­£å¸¸</li><li>ä½¿ç”¨ <code>fetch</code> ä¸Šä¼ , æŠ¥é”™</li><li>å¯¹æ¯” å‘é€çš„æ•°æ®, å‘ç°ä½¿ç”¨ <code>fetch</code> ä¸Šä¼ çš„ <code>Header</code>ä¸º:</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Content-Type multipart/form-data</span><br></pre></td></tr></table></figure><p>è€Œ ä½¿ç”¨å…¶å®ƒå·¥å…·ä¸Šä¼ æ—¶, <code>Header</code> ä¸º</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Content-Type: multipart/form-data; boundary=X-INSOMNIA-BOUNDARY</span><br></pre></td></tr></table></figure><p>å¤šäº†ä¸€ä¸ª <code>boundary</code> å±æ€§</p><h1 id="åŸå› "><a href="#åŸå› " class="headerlink" title="åŸå› "></a>åŸå› </h1><p>ä½¿ç”¨ <code>FormData</code> ä¼ è¾“äºŒè¿›åˆ¶æ•°æ®,æœåŠ¡å™¨éœ€è¦ä¸€ç§æ–¹æ³•æ¥çŸ¥é“ä¸€ä¸ªå­—æ®µçš„æ•°æ®ä½•å¤„ç»“æŸä»¥åŠä¸‹ä¸€ä¸ªæ•°æ®çš„èµ·å§‹ä½ç½®.è€Œ <code>boundary</code> å®šä¹‰äº†æˆ‘ä»¬åœ¨è¯·æ±‚ä¸­å‘é€çš„å­—æ®µä¹‹é—´çš„åˆ†éš”ç¬¦. å½“åˆ é™¤æˆ‘ä»¬æ‰‹åŠ¨å®šä¹‰çš„ <code>Content-Type</code> ä¹‹å, æµè§ˆå™¨ä¼šæ·»åŠ æ­£ç¡®çš„ <code>boundary</code></p><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><ul><li><a href="https://stanko.github.io/uploading-files-using-fetch-multipart-form-data/" target="_blank" rel="noopener">Uploading files using â€˜fetchâ€™ and â€˜FormDataâ€™</a><br><br></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong></p></blockquote><blockquote><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANG æ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> fetch </tag>
            
            <tag> FormData </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[è½¬] typescript 2.7 ç¼–è¯‘é€‰é¡¹è¯¦è§£</title>
      <link href="/2018/10/30/typescript-compiler-options/"/>
      <url>/2018/10/30/typescript-compiler-options/</url>
      
        <content type="html"><![CDATA[<p>typescriptçš„ç¼–è¯‘é€‰é¡¹ä¸€å †ï¼Œå¾®è½¯çˆ¸çˆ¸å†™æ–‡æ¡£åˆé©¬é©¬è™è™ ğŸ˜‚,  æ‰€ä»¥å®˜æ–¹æ–‡æ¡£æœ¬èº«å°±ä¸æ¸…ä¸æ¥šï¼Œä¼¼ä¹è¿˜æœ‰é”™è¯¯çš„åœ°æ–¹ã€‚æœ¬æ–‡å¯¹å„ä¸ªé€‰é¡¹è¿›è¡Œå®æµ‹ï¼Œä»¥æœŸç†è§£å…¶å«ä¹‰ä»¥åŠæ¯ä¸ªé€‰é¡¹ä¼šå¯¹ç¼–è¯‘æˆ–ç”Ÿæˆä»£ç çš„å½±å“ã€‚</p><p>typescriptç‰ˆæœ¬ 2.7.2, å‚è€ƒ<a href="https://www.typescriptlang.org/docs/handbook/compiler-options.html" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>ã€‚</p><p>test code: <a href="https://github.com/njleonzhang/typescript-options" target="_blank" rel="noopener">https://github.com/njleonzhang/typescript-options</a></p><h2 id="allowJs"><a href="#allowJs" class="headerlink" title="allowJs"></a>allowJs</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“allowJs</td><td>boolean</td><td>false</td><td>Allow JavaScript files to be compiled.</td></tr></tbody></table><p>æ˜¯å¦ä¼šå»ç¼–è¯‘<code>js</code>æ–‡ä»¶ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// leon.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">let</span> author = <span class="string">'leon'</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; author &#125; <span class="keyword">from</span> <span class="string">'./leon'</span></span><br><span class="line"><span class="built_in">console</span>.log(author);</span><br></pre></td></tr></table></figure><p>allowJsè®¾ç½®ä¸ºtrueçš„æ—¶å€™ï¼Œç”Ÿæˆçš„æ–‡ä»¶é‡Œä¼šåŒ…å«<code>leon.js</code>ç¼–è¯‘ä¹‹åçš„ç‰ˆæœ¬ï¼Œå¦åˆ™ä¸ä¼šã€‚</p><h2 id="allowSyntheticDefaultImports"><a href="#allowSyntheticDefaultImports" class="headerlink" title="allowSyntheticDefaultImports"></a>allowSyntheticDefaultImports</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“allowSyntheticDefaultImports</td><td>boolean</td><td>module === â€œsystemâ€ or â€“esModuleInterop</td><td>Allow default imports from modules with no default export. This does not affect code emit, just typechecking.</td></tr></tbody></table><p>ç›´æ¥ç¿»è¯‘è¿‡æ¥æ˜¯ï¼šæ˜¯å¦å…è®¸ä»æ²¡æœ‰defaultå¯¼å‡ºçš„æ¨¡å—ä¸­å¯¼å…¥defaultã€‚ä¸å½±å“ä»£ç çš„ç¼–è¯‘ç»“æœï¼Œåªå½±å“typecheckingã€‚</p><p>å®é™…æµ‹è¯•ï¼Œä¼¼ä¹æ²¡ä»€ä¹ˆä½œç”¨. å¯èƒ½æˆ‘ç†è§£ä¸å¯¹</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// leon.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">let</span> author = <span class="string">'leon'</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.ts</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> leon <span class="keyword">from</span> <span class="string">'./leon'</span> <span class="comment">// è¿™å¥é€‰é¡¹æ€ä¹ˆå˜éƒ½å¯¹</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(leon.author);</span><br></pre></td></tr></table></figure><h2 id="allowUnreachableCode"><a href="#allowUnreachableCode" class="headerlink" title="allowUnreachableCode"></a>allowUnreachableCode</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“allowUnreachableCode</td><td>boolean</td><td>false</td><td>Do not report errors on unreachable code.</td></tr></tbody></table><p>æ— æ³•åˆ°è¾¾çš„ä»£ç ï¼Œæ˜¯å¦æŠ¥é”™ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">  <span class="keyword">let</span> a = <span class="number">1000</span>  <span class="comment">// error TS7027: Unreachable code detected.</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="allowUnusedLabels"><a href="#allowUnusedLabels" class="headerlink" title="allowUnusedLabels"></a>allowUnusedLabels</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“allowUnusedLabels</td><td>boolean</td><td>false</td><td>Do not report errors on unused labels.</td></tr></tbody></table><p>æ— ç”¨çš„æ ‡ç­¾ï¼Œæ˜¯å¦æŠ¥é”™</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">loop1:</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">   loop2:         <span class="comment">// error TS7028: Unused label</span></span><br><span class="line">   <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; <span class="number">3</span>; j++) &#123;</span><br><span class="line">      <span class="keyword">if</span> (i == <span class="number">1</span> &amp;&amp; j == <span class="number">1</span>) &#123;</span><br><span class="line">         <span class="keyword">continue</span> loop1;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">"i = "</span> + i + <span class="string">", j = "</span> + j);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="alwaysStrict"><a href="#alwaysStrict" class="headerlink" title="alwaysStrict"></a>alwaysStrict</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“alwaysStrict</td><td>boolean</td><td>false</td><td>Parse in strict mode and emit â€œuse strictâ€ for each source file</td></tr></tbody></table><p>ç”¨ä¸¥æ ¼æ¨¡å¼æ¥è§£ætsä»£ç ï¼Œå¹¶ç”Ÿæˆä¸¥æ ¼æ¨¡å¼çš„jsä»£ç <br>å…³äºä¸¥æ ¼æ¨¡å¼å‚è€ƒ<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Strict_mode" target="_blank" rel="noopener">MDNçš„æ–‡æ¡£</a><br>å®˜æ–¹æ–‡æ¡£è¯´é»˜è®¤å€¼æ˜¯false, å®æµ‹é»˜è®¤å€¼æ˜¯<code>true</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// tsc index.ts</span></span><br><span class="line"><span class="keyword">var</span> sum = <span class="number">015</span>  <span class="comment">// error TS1121: Octal literals are not allowed in strict mode.</span></span><br><span class="line">+ <span class="number">197</span></span><br><span class="line">+ <span class="number">142</span>;</span><br></pre></td></tr></table></figure><h2 id="baseUrl"><a href="#baseUrl" class="headerlink" title="baseUrl"></a>baseUrl</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“baseUrl</td><td>string</td><td></td><td>Base directory to resolve non-relative module names. See Module Resolution documentation for more details.</td></tr></tbody></table><p>è§£æéç›¸å¯¹æ¨¡å—åçš„åŸºå‡†ç›®å½•ã€‚æŸ¥çœ‹æ¨¡å—è§£ææ–‡æ¡£äº†è§£è¯¦æƒ…ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.ts</span></span><br><span class="line"><span class="keyword">import</span> test <span class="keyword">from</span> <span class="string">'test'</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// test.ts</span></span><br><span class="line"><span class="keyword">let</span> test = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> test</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"compilerOptions"</span>: &#123;</span><br><span class="line">    <span class="attr">"baseUrl"</span>: <span class="string">"."</span> // æ²¡æœ‰è¿™å¥ï¼Œåˆ™ error TS2307: Cannot find module 'test'.</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="charset"><a href="#charset" class="headerlink" title="charset"></a>charset</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“charset</td><td>string</td><td>â€œutf8â€</td><td>The character set of the input files.</td></tr></tbody></table><p>æŒ‡å®šè¾“å…¥æ–‡ä»¶çš„ç¼–ç æ–¹å¼ã€‚ï¼ˆä¸€èˆ¬æŒ‡tsæ–‡ä»¶ï¼‰</p><h2 id="checkJs"><a href="#checkJs" class="headerlink" title="checkJs"></a>checkJs</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“checkJs</td><td>boolean</td><td>false</td><td>Report errors in .js files. Use in conjunction with â€“allowJs.</td></tr></tbody></table><p>å’Œallowjsä¸€èµ·ä½¿ç”¨ï¼Œjsæ–‡ä»¶é‡Œæœ‰é”™è¯¯çš„æ—¶å€™ï¼Œæ˜¯å¦æŠ¥é”™ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// -- checkJs true</span></span><br><span class="line"><span class="comment">// index.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; a &#125; <span class="keyword">from</span> <span class="string">'test'</span></span><br><span class="line"></span><br><span class="line">a(<span class="string">'1324'</span>) <span class="comment">// error TS2345: Argument of type '"1324"' is not assignable to parameter of type 'number'.</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// test.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params">i: number</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> i</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="declaration-å’Œ-declarationDir"><a href="#declaration-å’Œ-declarationDir" class="headerlink" title="declaration å’Œ declarationDir"></a>declaration å’Œ declarationDir</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“declaration <br> -d</td><td>boolean</td><td>false</td><td>Generates corresponding .d.ts file.</td></tr><tr><td>â€“declarationDir</td><td>string</td><td></td><td>Output directory for generated declaration files.</td></tr></tbody></table><p><code>declaration</code>æŒ‡æ˜¯å¦ç”Ÿæˆ<code>.d.ts</code>æ–‡ä»¶.<br><code>declarationDir</code>æŒ‡å®šç”Ÿæˆçš„<code>.d.ts</code>æ–‡ä»¶çš„ç›®å½•</p><h2 id="diagnostics"><a href="#diagnostics" class="headerlink" title="diagnostics"></a>diagnostics</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“diagnostics</td><td>boolean</td><td>false</td><td>Show diagnostic information.</td></tr></tbody></table><p>æ˜¾ç¤ºè¯Šæ–­ä¿¡æ¯</p><p>è®¾ç½®ä¸ºtrueçš„æ—¶å€™ï¼Œä¼šç”Ÿæˆç±»ä¼¼ä¸‹é¢çš„è¯Šæ–­æŠ¥å‘Šï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Files:            <span class="number">2</span></span><br><span class="line">Lines:        <span class="number">19890</span></span><br><span class="line">Nodes:        <span class="number">91623</span></span><br><span class="line">Identifiers:  <span class="number">31621</span></span><br><span class="line">Symbols:      <span class="number">24094</span></span><br><span class="line">Types:         <span class="number">6581</span></span><br><span class="line">Memory used: <span class="number">60631</span>K</span><br><span class="line">I/O read:     <span class="number">0.00</span>s</span><br><span class="line">I/O write:    <span class="number">0.00</span>s</span><br><span class="line">Parse time:   <span class="number">0.29</span>s</span><br><span class="line">Bind time:    <span class="number">0.12</span>s</span><br><span class="line">Check time:   <span class="number">0.80</span>s</span><br><span class="line">Emit time:    <span class="number">0.02</span>s</span><br><span class="line">Total time:   <span class="number">1.23</span>s</span><br></pre></td></tr></table></figure><h2 id="disableSizeLimit"><a href="#disableSizeLimit" class="headerlink" title="disableSizeLimit"></a>disableSizeLimit</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“disableSizeLimit</td><td>boolean</td><td>false</td><td>Disable size limitation on JavaScript project.</td></tr></tbody></table><p>ç¦ç”¨JavaScriptå·¥ç¨‹ä½“ç§¯å¤§å°çš„é™åˆ¶ã€‚</p><blockquote><p>ä¸æ‡‚å•¥æ„æ€ï¼Œä¹Ÿä¸çŸ¥é“æœ‰å•¥ç”¨ :-(</p></blockquote><h2 id="downlevelIteration"><a href="#downlevelIteration" class="headerlink" title="downlevelIteration"></a>downlevelIteration</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“downlevelIteration</td><td>boolean</td><td>false</td><td>Provide full support for iterables in for..of, spread and destructuring when targeting ES5 or ES3.</td></tr></tbody></table><p>åœ¨ç”Ÿæˆç›®æ ‡ä»£ç ä¸ºes5æˆ–è€…es3çš„æ—¶å€™ï¼Œæä¾›å¯¹ for..of, spread and destructuringè¯­æ³•çš„æ”¯æŒã€‚</p><blockquote><p>ç›¸å½“äºæä¾›polyfill</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> b = [<span class="number">4</span>, ...a]</span><br></pre></td></tr></table></figure><p>æ­¤é€‰é¡¹ä¸ºfalseæ—¶ï¼Œè½¬æ¢ä¸º<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">var</span> b = [<span class="number">4</span>].concat(a);</span><br></pre></td></tr></table></figure></p><p>æ­¤é€‰é¡¹ä¸ºtrueæ—¶ï¼Œè½¬æ¢æˆ:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> __read = (<span class="keyword">this</span> &amp;&amp; <span class="keyword">this</span>.__read) || <span class="function"><span class="keyword">function</span> (<span class="params">o, n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> m = <span class="keyword">typeof</span> <span class="built_in">Symbol</span> === <span class="string">"function"</span> &amp;&amp; o[<span class="built_in">Symbol</span>.iterator];</span><br><span class="line">    <span class="keyword">if</span> (!m) <span class="keyword">return</span> o;</span><br><span class="line">    <span class="keyword">var</span> i = m.call(o), r, ar = [], e;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">while</span> ((n === <span class="keyword">void</span> <span class="number">0</span> || n-- &gt; <span class="number">0</span>) &amp;&amp; !(r = i.next()).done) ar.push(r.value);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (error) &#123; e = &#123; <span class="attr">error</span>: error &#125;; &#125;</span><br><span class="line">    <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (r &amp;&amp; !r.done &amp;&amp; (m = i[<span class="string">"return"</span>])) m.call(i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">finally</span> &#123; <span class="keyword">if</span> (e) <span class="keyword">throw</span> e.error; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ar;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> __spread = (<span class="keyword">this</span> &amp;&amp; <span class="keyword">this</span>.__spread) || <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> ar = [], i = <span class="number">0</span>; i &lt; <span class="built_in">arguments</span>.length; i++) ar = ar.concat(__read(<span class="built_in">arguments</span>[i]));</span><br><span class="line">    <span class="keyword">return</span> ar;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">var</span> b = __spread([<span class="number">4</span>], a);</span><br></pre></td></tr></table></figure></p><h2 id="emitBOM"><a href="#emitBOM" class="headerlink" title="emitBOM"></a>emitBOM</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“emitBOM</td><td>boolean</td><td>false</td><td>Emit a UTF-8 Byte Order Mark (BOM) in the beginning of output files.</td></tr></tbody></table><p>ç”Ÿæˆçš„æ–‡ä»¶æ˜¯å¦è¦å¸¦BOMå¤´</p><h2 id="esModuleInterop"><a href="#esModuleInterop" class="headerlink" title="esModuleInterop"></a>esModuleInterop</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“esModuleInterop</td><td>boolean</td><td>false</td><td>Emit <strong>importStar and </strong>importDefault helpers for runtime babel ecosystem compatibility and enable â€“allowSyntheticDefaultImports for typesystem compatibility.</td></tr></tbody></table><p>ç”Ÿæˆçš„æ–‡ä»¶ä¼šä¸ºå…¼å®¹babelè€Œæ·»åŠ <code>__importStar</code>å’Œ<code>__importDefault</code>çš„helper.<br>è¿™ä¸ªé€‰é¡¹ä¼šæŠŠ<code>allowSyntheticDefaultImports</code>è®¾ç½®æˆtrue.</p><blockquote><p>ç±»ä¼¼<code>allowSyntheticDefaultImports</code>é€‰é¡¹ï¼Œå®æµ‹è¿™ä¸ªé€‰é¡¹ä¸ºtrueå’Œfalseå¹¶ä¸å½±å“ç”Ÿæˆçš„ä»£ç ã€‚å…·ä½“ä»€ä¹ˆæƒ…å†µä¼šå½±å“ä¸å¤ªæ¸…æ¥šã€‚</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">let</span> a = <span class="number">100</span></span><br><span class="line"><span class="keyword">let</span> b = <span class="number">200</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> a</span><br></pre></td></tr></table></figure><p>åŠ ä¸åŠ è¿™ä¸ªé€‰é¡¹ï¼Œéƒ½ç”Ÿæˆå¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">"use strict"</span>;</span><br><span class="line">exports.__esModule = <span class="literal">true</span>;</span><br><span class="line">exports.a = <span class="number">100</span>;</span><br><span class="line"><span class="keyword">var</span> b = <span class="number">200</span>;</span><br><span class="line">exports[<span class="string">"default"</span>] = exports.a;</span><br></pre></td></tr></table></figure><h2 id="forceConsistentCasingInFileNames"><a href="#forceConsistentCasingInFileNames" class="headerlink" title="forceConsistentCasingInFileNames"></a>forceConsistentCasingInFileNames</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“forceConsistentCasingInFileNames</td><td>boolean</td><td>false</td><td>Disallow inconsistently-cased references to the same file.</td></tr></tbody></table><p>æ˜¯å¦åœ¨å¯¼å…¥æ–‡ä»¶çš„æ—¶å€™éœ€è¦ä¿è¯å¤§å°å†™ä¸€è‡´ã€‚</p><blockquote><p>å’Œæ–‡ä»¶åæ˜¯å¦ä¸€è‡´ä¸é‡è¦ï¼Œä½†å¤šæ¬¡å¯¼å…¥çš„æ—¶å€™å¤§å°å†™ä¸€å®šè¦ä¸€è‡´ã€‚</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Test.ts</span></span><br><span class="line"><span class="keyword">let</span> a = <span class="number">1</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> a</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> a <span class="keyword">from</span> <span class="string">'./test'</span> <span class="comment">// å¯¼å…¥å°å†™ï¼Œæ²¡é—®é¢˜</span></span><br><span class="line"><span class="keyword">import</span> b <span class="keyword">from</span> <span class="string">'./Test'</span> <span class="comment">// å†å¯¼å…¥å¤§å†™ï¼ŒæŠ¥é”™ã€‚ error TS1149: File name '/Users/leon/Documents/git/typescript-options/forceConsistentCasingInFileNames/Test.ts' differs from already included file name '/Users/leon/Documents/git/typescript-options/forceConsistentCasingInFileNames/test.ts' only in casing.</span></span><br></pre></td></tr></table></figure><h2 id="experimentalDecorators"><a href="#experimentalDecorators" class="headerlink" title="experimentalDecorators"></a>experimentalDecorators</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“experimentalDecorators</td><td>boolean</td><td>false</td><td>Enables experimental support for ES decorators.</td></tr></tbody></table><p>å¯åŠ¨å®éªŒçš„è£…é¥°å™¨åŠŸèƒ½ã€‚</p><h2 id="importHelpers"><a href="#importHelpers" class="headerlink" title="importHelpers"></a>importHelpers</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“importHelpers</td><td>boolean</td><td>false</td><td>Import emit helpers (e.g. <strong>extends, </strong>rest, etc..) from tslib</td></tr></tbody></table><p>æ˜¯å¦ä»tslibé‡Œå¯¼å…¥<strong>extends, </strong>restç­‰helperå‡½æ•°</p><blockquote><p>è¿™ä¸ªé€‰é¡¹ä¼¼ä¹å·²ç»æ²¡æœ‰ä»€ä¹ˆç”¨äº†ã€‚</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> b = &#123;</span><br><span class="line">  name: <span class="string">'leon'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> a = &#123;</span><br><span class="line">  age: <span class="number">10</span>,</span><br><span class="line">  ...b</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ— è®ºæ­¤é¡¹å¦‚ä½•è®¾ç½®ï¼Œå§‹ç»ˆä¼šè½¬æ¢æˆï¼š<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> __assign = (<span class="keyword">this</span> &amp;&amp; <span class="keyword">this</span>.__assign) || <span class="built_in">Object</span>.assign || <span class="function"><span class="keyword">function</span>(<span class="params">t</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> s, i = <span class="number">1</span>, n = <span class="built_in">arguments</span>.length; i &lt; n; i++) &#123;</span><br><span class="line">        s = <span class="built_in">arguments</span>[i];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> p <span class="keyword">in</span> s) <span class="keyword">if</span> (<span class="built_in">Object</span>.prototype.hasOwnProperty.call(s, p))</span><br><span class="line">            t[p] = s[p];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> t;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> b = &#123;</span><br><span class="line">    name: <span class="string">'leon'</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> a = __assign(&#123; <span class="attr">age</span>: <span class="number">10</span> &#125;, b);</span><br></pre></td></tr></table></figure></p><h2 id="inlineSourceMap"><a href="#inlineSourceMap" class="headerlink" title="inlineSourceMap"></a>inlineSourceMap</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“inlineSourceMap</td><td>boolean</td><td>false</td><td>Emit a single file with source maps instead of having a separate file.</td></tr></tbody></table><p>æ˜¯å¦ç”Ÿæˆinlineçš„source map</p><p>ä¸Šæ —ä¸­çš„ä»£ç ï¼ŒåŠ æœ¬é€‰é¡¹ç¼–è¯‘ï¼Œæ–‡ä»¶æœ«å°¾ä¼šå¤šå‡ºsourcemap:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//# sourceMappingURL= xxxxxxx</span></span><br></pre></td></tr></table></figure><h2 id="inlineSources"><a href="#inlineSources" class="headerlink" title="inlineSources"></a>inlineSources</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“inlineSourceMap</td><td>boolean</td><td>false</td><td>Emit the source alongside the sourcemaps within a single file; requires â€“inlineSourceMap or â€“sourceMap to be set.</td></tr></tbody></table><p>å°†ä»£ç ä¸sourcemapsç”Ÿæˆåˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ã€‚</p><p>ä¸Šæ —ä¸­çš„ä»£ç ï¼Œåœ¨åŠ ä¸Šæ­¤é¡¹è¿›è¡Œç¼–è¯‘ï¼ŒåŒæ ·ä¼šåœ¨æ–‡ä»¶ç»“å°¾åŠ ä¸ŠsourceMappingURLï¼Œä½†ç”Ÿæˆçš„å†…å®¹ä¸åŒã€‚æš‚æ—¶ä¸å¤ªæ˜ç™½æœ‰ä»€ä¹ˆå®é™…ä¸Šçš„åŒºåˆ«ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sourceMappingURL = xxxxx</span><br></pre></td></tr></table></figure><h2 id="isolatedModules"><a href="#isolatedModules" class="headerlink" title="isolatedModules"></a>isolatedModules</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“isolatedModules</td><td>boolean</td><td>false</td><td>Transpile each file as a separate module (similar to â€œts.transpileModuleâ€).</td></tr></tbody></table><p>å°†æ¯ä¸ªæ–‡ä»¶å½“åšä¸€ä¸ªç‹¬ç«‹çš„æ¨¡å—æ¥è½¬ä¹‰<br>æ¯ä¸ªæ–‡ä»¶éƒ½éœ€è¦æ˜¯ä¸€ä¸ªæ¨¡å—</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.ts</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// error TS1208: Cannot compile namespaces when the '--isolatedModules' flag is provided.</span></span><br></pre></td></tr></table></figure><p>å¦å¤–æ¬¡é€‰é¡¹ä¸èƒ½å’Œ<code>declaration</code>ä¸€èµ·ä½¿ç”¨, ä¸å¤ªæƒ³çš„æ˜ç™½ä¸ºä»€ä¹ˆ ğŸ˜‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">error TS5053: Option <span class="string">'declaration'</span> cannot be specified <span class="keyword">with</span> option <span class="string">'isolatedModules'</span>.</span><br></pre></td></tr></table></figure><h2 id="jsx"><a href="#jsx" class="headerlink" title="jsx"></a>jsx</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“jsx</td><td>string</td><td>â€œPreserveâ€</td><td>Support JSX in .tsx files: â€œReactâ€ or â€œPreserveâ€. See JSX.</td></tr></tbody></table><p>æ˜¯å¦å¯¹jsxè¿›è¡Œè½¬æ¢ã€‚ä¸€èˆ¬ä¸è½¬è¯‘ï¼ŒæŠŠè¿™ä¸ªå·¥ä½œæ¨è¿Ÿç»™babel.</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;text&gt;a&lt;<span class="regexp">/text&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure><p>ç¼–è¯‘ï¼š<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// --jsx "React"</span></span><br><span class="line"><span class="meta">"use strict"</span>;</span><br><span class="line">exports.__esModule = <span class="literal">true</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (React.createElement(<span class="string">"text"</span>, <span class="literal">null</span>, <span class="string">"a"</span>));</span><br><span class="line">&#125;</span><br><span class="line">exports.a = a;</span><br></pre></td></tr></table></figure></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// --jsx "Preserve"</span></span><br><span class="line"><span class="meta">"use strict"</span>;</span><br><span class="line">exports.__esModule = <span class="literal">true</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">text</span>&gt;</span>a<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span>);</span><br><span class="line">&#125;</span><br><span class="line">exports.a = a;</span><br></pre></td></tr></table></figure><h2 id="jsxFactory"><a href="#jsxFactory" class="headerlink" title="jsxFactory"></a>jsxFactory</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“jsxFactory</td><td>string</td><td>â€œReact.createElementâ€</td><td>Specify the JSX factory function to use when targeting react JSX emit, e.g. React.createElement or h.</td></tr></tbody></table><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;text&gt;a&lt;<span class="regexp">/text&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure><p>ç¼–è¯‘ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// --jsx "React" --jsxFactory h</span></span><br><span class="line"><span class="comment">// è¯·ä¸ä¸Šä¸ªä¾‹å­å¯¹æ¯”ã€‚</span></span><br><span class="line"><span class="meta">"use strict"</span>;</span><br><span class="line">exports.__esModule = <span class="literal">true</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (h(<span class="string">"text"</span>, <span class="literal">null</span>, <span class="string">"a"</span>));</span><br><span class="line">&#125;</span><br><span class="line">exports.a = a;</span><br></pre></td></tr></table></figure><h2 id="lib"><a href="#lib" class="headerlink" title="lib"></a>lib</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“lib</td><td>string[]</td><td></td><td>List of library files to be included in the compilation.<br>Possible values are:  <br>â–º <code>ES5</code> <br>â–º <code>ES6</code> <br>â–º <code>ES2015</code> <br>â–º <code>ES7</code> <br>â–º <code>ES2016</code> <br>â–º <code>ES2017</code> <br>â–º <code>ESNext</code> <br>â–º <code>DOM</code> <br>â–º <code>DOM.Iterable</code> <br>â–º <code>WebWorker</code> <br>â–º <code>ScriptHost</code> <br>â–º <code>ES2015.Core</code> <br>â–º <code>ES2015.Collection</code> <br>â–º <code>ES2015.Generator</code> <br>â–º <code>ES2015.Iterable</code> <br>â–º <code>ES2015.Promise</code> <br>â–º <code>ES2015.Proxy</code> <br>â–º <code>ES2015.Reflect</code> <br>â–º <code>ES2015.Symbol</code> <br>â–º <code>ES2015.Symbol.WellKnown</code> <br>â–º <code>ES2016.Array.Include</code> <br>â–º <code>ES2017.object</code> <br>â–º <code>ES2017.SharedMemory</code> <br>â–º <code>ES2017.TypedArrays</code> <br>â–º <code>esnext.asynciterable</code> <br>â–º <code>esnext.array</code> <br>â–º <code>esnext.promise</code> <br><br> Note: If <code>â€“lib</code> is not specified a default list of librares are injected. The default libraries injected are:  <br> â–º For <code>â€“target ES5</code>: <code>DOM,ES5,ScriptHost</code><br>  â–º For <code>â€“target ES6</code>: <code>DOM,ES6,DOM.Iterable,ScriptHost</code></td></tr></tbody></table><p>ç¼–è¯‘æ—¶ï¼Œå¯ä»¥åŒ…æ‹¬çš„åº“æ–‡ä»¶çš„åˆ—è¡¨ã€‚é»˜è®¤ä¼šinjectä¸€äº›åº“çš„å®šä¹‰ã€‚<br>ä¼šä¸¥é‡å®é™…ä¸Šæ˜¯å½±å“ç¼–è¯‘æ˜¯å¦èƒ½æˆåŠŸã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> a = <span class="number">1</span></span><br><span class="line">  <span class="keyword">let</span> b = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">    resolve(<span class="number">1</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">return</span> a</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// tsc lib/index.ts --lib ES5</span></span><br><span class="line"><span class="comment">// error TS2693: 'Promise' only refers to a type, but is being used as a value here.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// tsc lib/index.ts --lib ES6</span></span><br><span class="line"><span class="comment">// build pass</span></span><br></pre></td></tr></table></figure><h2 id="listEmittedFiles"><a href="#listEmittedFiles" class="headerlink" title="listEmittedFiles"></a>listEmittedFiles</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“listEmittedFiles</td><td>boolean</td><td>false</td><td>Print names of generated files part of the compilation.</td></tr><tr><td>â€“listFiles</td><td>boolean</td><td>false</td><td>Print names of files part of the compilation.</td></tr></tbody></table><p>listEmittedFilesï¼šåˆ—å‡ºç¼–è¯‘ç”Ÿæˆæ–‡ä»¶<br>listFilesï¼šåˆ—å‡ºå‚ä¸ç¼–è¯‘çš„æºæ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">// tsc lib/index.ts --lib ES6 --listEmittedFiles --listFiles</span><br><span class="line"></span><br><span class="line">// ç”Ÿæˆçš„æ–‡ä»¶</span><br><span class="line">TSFILE: /Users/leon/Documents/git/typescript-options/lib/index.js</span><br><span class="line"></span><br><span class="line">// å‚ä¸ç¼–è¯‘çš„æ–‡ä»¶</span><br><span class="line">/Users/leon/.nvm/versions/node/v8.7.0/lib/node_modules/typescript/lib/lib.es2015.d.ts</span><br><span class="line">/Users/leon/.nvm/versions/node/v8.7.0/lib/node_modules/typescript/lib/lib.es5.d.ts</span><br><span class="line">/Users/leon/.nvm/versions/node/v8.7.0/lib/node_modules/typescript/lib/lib.es2015.symbol.wellknown.d.ts</span><br><span class="line">/Users/leon/.nvm/versions/node/v8.7.0/lib/node_modules/typescript/lib/lib.es2015.reflect.d.ts</span><br><span class="line">/Users/leon/.nvm/versions/node/v8.7.0/lib/node_modules/typescript/lib/lib.es2015.proxy.d.ts</span><br><span class="line">/Users/leon/.nvm/versions/node/v8.7.0/lib/node_modules/typescript/lib/lib.es2015.iterable.d.ts</span><br><span class="line">/Users/leon/.nvm/versions/node/v8.7.0/lib/node_modules/typescript/lib/lib.es2015.symbol.d.ts</span><br><span class="line">/Users/leon/.nvm/versions/node/v8.7.0/lib/node_modules/typescript/lib/lib.es2015.promise.d.ts</span><br><span class="line">/Users/leon/.nvm/versions/node/v8.7.0/lib/node_modules/typescript/lib/lib.es2015.generator.d.ts</span><br><span class="line">/Users/leon/.nvm/versions/node/v8.7.0/lib/node_modules/typescript/lib/lib.es2015.collection.d.ts</span><br><span class="line">/Users/leon/.nvm/versions/node/v8.7.0/lib/node_modules/typescript/lib/lib.es2015.core.d.ts</span><br><span class="line">lib/index.ts</span><br></pre></td></tr></table></figure><p>ä»ä¾‹å­æˆ‘ä»¬ä¹Ÿèƒ½çœ‹å‡º<code>--lib</code>çš„ä½œç”¨</p><h2 id="locale"><a href="#locale" class="headerlink" title="locale"></a>locale</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“locale</td><td>string</td><td></td><td>The locale to use to show error messages, e.g. en-us. <br>Possible values are:  <br>â–º English (US): <code>en</code> <br>â–º Czech: <code>cs</code> <br>â–º German: <code>de</code> <br>â–º Spanish: <code>es</code> <br>â–º French: <code>fr</code> <br>â–º Italian: <code>it</code> <br>â–º Japanese: <code>ja</code> <br>â–º Korean: <code>ko</code> <br>â–º Polish: <code>pl</code> <br>â–º Portuguese(Brazil): <code>pt-BR</code> <br>â–º Russian: <code>ru</code> <br>â–º Turkish: <code>tr</code> <br>â–º Simplified Chinese: <code>zh-CN</code>  <br>â–º Traditional Chinese: <code>zh-TW</code></td></tr></tbody></table><p>å®šä¹‰æŠ¥é”™çš„messageè¯­è¨€ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// --locale zh-CN</span><br><span class="line">error TS2693: â€œPromiseâ€ä»…è¡¨ç¤ºç±»å‹ï¼Œä½†åœ¨æ­¤å¤„å´ä½œä¸ºå€¼ä½¿ç”¨ã€‚</span><br></pre></td></tr></table></figure><h2 id="sourceMap-mapRoot-å’Œ-sourceRoot"><a href="#sourceMap-mapRoot-å’Œ-sourceRoot" class="headerlink" title="sourceMap, mapRoot å’Œ sourceRoot"></a>sourceMap, mapRoot å’Œ sourceRoot</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“sourceMap</td><td>boolean</td><td>false</td><td>Generates corresponding .map file.</td></tr><tr><td>â€“mapRoot</td><td>string</td><td></td><td>Specifies the location where debugger should locate map files instead of generated locations. Use this flag if the .map files will be located at run-time in a different location than the .js files. The location specified will be embedded in the sourceMap to direct the debugger where the map files will be located.</td></tr><tr><td>â€“sourceRoot</td><td>string</td><td></td><td>Specifies the location where debugger should locate TypeScript files instead of source locations. Use this flag if the sources will be located at run-time in a different location than that at design-time. The location specified will be embedded in the sourceMap to direct the debugger where the source files will be located.</td></tr></tbody></table><p><code>sourceMap</code>: ç”ŸæˆsourceMap</p><p><code>mapRoot</code>: æŒ‡å®šè°ƒè¯•å™¨å»ä»€ä¹ˆä½ç½®å¯»æ‰¾ <code>map</code> æ–‡ä»¶. å½“è¿è¡Œæ—¶<code>.map</code> æ–‡ä»¶å’Œå¯¹åº”çš„ <code>.js</code> æ–‡ä»¶ä¸åœ¨åŒä¸€ä½ç½®æ—¶ï¼Œéœ€è¦ä½¿ç”¨æœ¬å‚æ•°æŒ‡å®š <code>map</code> çš„ä½ç½®. æŒ‡å®šçš„ä½ç½®ä¼šè¢«å†…åµŒåˆ° <code>sourceMap</code> ä¸­å‘Šè¯‰è°ƒè¯•å™¨ <code>map</code> æ–‡ä»¶æ‰€åœ¨çš„ä½ç½®.<br><code>sourceRoot</code>: æŒ‡å®šè°ƒè¯•å™¨å»ä»€ä¹ˆä½ç½®å¯»æ‰¾ <code>ts</code> æ–‡ä»¶. å½“è¿è¡Œæ—¶ <code>.map</code> æ–‡ä»¶å’Œå¯¹åº”çš„ <code>.js</code> æ–‡ä»¶ä¸åœ¨åŒä¸€ä½ç½®æ—¶ï¼Œéœ€è¦ä½¿ç”¨æœ¬å‚æ•°æŒ‡å®š <code>map</code> çš„ä½ç½®. æŒ‡å®šçš„ä½ç½®ä¼šè¢«å†…åµŒåˆ° <code>sourceMap</code> ä¸­å‘Šè¯‰è°ƒè¯•å™¨ <code>ts</code> æ–‡ä»¶æ‰€åœ¨çš„ä½ç½®.</p><blockquote><p>ç”¨æ³•çŒœæµ‹ï¼šå¯¹äºå•†ä¸šä»£ç ï¼Œä¸€èˆ¬ä»¥ä¼šæŠŠmapæ–‡ä»¶ç›´æ¥æ”¾å‡ºå»ï¼Œè€Œä¼šæ”¾åˆ°å†…ç½‘çš„æŸä¸ªåœ°æ–¹ï¼Œé€šè¿‡è¿™ä¸ªé€‰é¡¹ï¼Œå¯ä»¥å¸®åŠ©å¼€å‘äººå‘˜åœ¨å†…ç½‘å»è°ƒè¯•ä»£ç ã€‚</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">tsc lib/index.ts --sourceMap --mapRoot <span class="string">'\\10.32.0.1\map\1'</span></span><br><span class="line"></span><br><span class="line">xxx code xxxx</span><br><span class="line">//<span class="comment"># sourceMappingURL=//10.32.0.1/map/1/index.js.map</span></span><br></pre></td></tr></table></figure><h2 id="maxNodeModuleJsDepth"><a href="#maxNodeModuleJsDepth" class="headerlink" title="maxNodeModuleJsDepth"></a>maxNodeModuleJsDepth</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“maxNodeModuleJsDepth</td><td>number</td><td>0</td><td>The maximum dependency depth to search under node_modules and load JavaScript files. Only applicable with â€“allowJs.</td></tr></tbody></table><p>å» <code>node_modules</code> é‡Œæœç´¢ä»£ç çš„å±‚çº§, é»˜è®¤æ˜¯0.</p><p>æŒ‰ç…§è¿™ä¸ªè¯´æ³•ï¼Œä¼¼ä¹é»˜è®¤æƒ…å†µä¸‹ä¸åº”è¯¥åº”è®¸å»åŠ è½½<code>node_modules</code>ç›®å½•ä¸‹çš„æ–‡ä»¶ã€‚ä½†æ˜¯äº‹å®ä¸Šï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>node_modules</code>ä¸‹çš„æ¨¡å—æ˜¯ä¼šè¢«åŠ è½½çš„ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">- maxNodeModuleJsDepth</span><br><span class="line">  - index.ts</span><br><span class="line">  - node_modules</span><br><span class="line">    - test1</span><br><span class="line">      - index.js</span><br><span class="line">      - node_modules</span><br><span class="line">        - test2</span><br><span class="line">          - index.js</span><br><span class="line"></span><br><span class="line"><span class="comment">// maxNodeModuleJsDepth/index.ts</span></span><br><span class="line"><span class="keyword">import</span> a <span class="keyword">from</span> <span class="string">'test1'</span> <span class="comment">// maxNodeModuleJsDepthè®¾ç½®æˆä»€ä¹ˆï¼Œè¿™å¥æ€»æ˜¯å¯¹çš„</span></span><br><span class="line"><span class="keyword">import</span> b <span class="keyword">from</span> <span class="string">'test2'</span> <span class="comment">// è¿™å¥æ€»æ˜¯é”™çš„ã€‚</span></span><br></pre></td></tr></table></figure><blockquote><p>å¯èƒ½æˆ‘çš„ç†è§£æœ‰è¯¯ã€‚</p></blockquote><h2 id="module"><a href="#module" class="headerlink" title="module"></a>module</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“module<br> -m</td><td>string</td><td>target === â€œES3â€ or â€œES5â€ ? â€œCommonJSâ€ : â€œES6â€</td><td>Specify module code generation: <code>â€œNoneâ€</code>, <code>â€œCommonJSâ€</code>, <code>â€œAMDâ€</code>, <code>â€œSystemâ€</code>, <code>â€œUMDâ€</code>, <code>â€œES6â€</code>, <code>â€œES2015â€</code> or <code>â€œESNextâ€</code>.<br>â–º Only <code>â€œAMDâ€</code> and <code>â€œSystemâ€</code> can be used in conjunction with <code>â€“outFile</code>.<br>â–º <code>â€œES6â€</code> and <code>â€œES2015â€</code> values may be used when targeting <code>â€œES5â€</code> or lower.</td></tr></tbody></table><p>æŒ‡å®šç”Ÿæˆä»£ç çš„æ¨¡å—æ ¼å¼</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'hello'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// --module CommonJs</span></span><br><span class="line"></span><br><span class="line">exports.__esModule = <span class="literal">true</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'hello'</span>;</span><br><span class="line">&#125;</span><br><span class="line">exports.test = test;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// --module AMD</span></span><br><span class="line"></span><br><span class="line">define([<span class="string">"require"</span>, <span class="string">"exports"</span>], <span class="function"><span class="keyword">function</span> (<span class="params">require, exports</span>) </span>&#123;</span><br><span class="line"><span class="meta">    "use strict"</span>;</span><br><span class="line">    exports.__esModule = <span class="literal">true</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'hello'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    exports.test = test;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// -module system</span></span><br><span class="line">System.register([], <span class="function"><span class="keyword">function</span> (<span class="params">exports_1, context_1</span>) </span>&#123;</span><br><span class="line"><span class="meta">    "use strict"</span>;</span><br><span class="line">    <span class="keyword">var</span> __moduleName = context_1 &amp;&amp; context_1.id;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'hello'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    exports_1(<span class="string">"test"</span>, test);</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        setters: [],</span><br><span class="line">        execute: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// -module UMD</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">factory</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="built_in">module</span> === <span class="string">"object"</span> &amp;&amp; <span class="keyword">typeof</span> <span class="built_in">module</span>.exports === <span class="string">"object"</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> v = factory(<span class="built_in">require</span>, exports);</span><br><span class="line">        <span class="keyword">if</span> (v !== <span class="literal">undefined</span>) <span class="built_in">module</span>.exports = v;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> define === <span class="string">"function"</span> &amp;&amp; define.amd) &#123;</span><br><span class="line">        define([<span class="string">"require"</span>, <span class="string">"exports"</span>], factory);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)(<span class="function"><span class="keyword">function</span> (<span class="params">require, exports</span>) </span>&#123;</span><br><span class="line"><span class="meta">    "use strict"</span>;</span><br><span class="line">    exports.__esModule = <span class="literal">true</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'hello'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    exports.test = test;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// -module es6 or es2015 or esnext</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'hello'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="target"><a href="#target" class="headerlink" title="target"></a>target</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“target <br> -t</td><td>string</td><td>â€œes3â€</td><td>Specify ECMAScript target version: â€œES3â€ (default), â€œES5â€, â€œES6â€/â€œES2015â€, â€œES2016â€, â€œES2017â€ or â€œESNextâ€. <br> Note: â€œESNextâ€ targets latest supported ES proposed features.</td></tr></tbody></table><p>æŒ‡å®šç›®æ ‡ä»£ç çš„ç‰ˆæœ¬ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">    resolve(<span class="number">1</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// --target es3</span></span><br><span class="line"><span class="meta">"use strict"</span>;</span><br><span class="line"><span class="keyword">var</span> __assign = (<span class="keyword">this</span> &amp;&amp; <span class="keyword">this</span>.__assign) || <span class="built_in">Object</span>.assign || <span class="function"><span class="keyword">function</span>(<span class="params">t</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> s, i = <span class="number">1</span>, n = <span class="built_in">arguments</span>.length; i &lt; n; i++) &#123;</span><br><span class="line">        s = <span class="built_in">arguments</span>[i];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> p <span class="keyword">in</span> s) <span class="keyword">if</span> (<span class="built_in">Object</span>.prototype.hasOwnProperty.call(s, p))</span><br><span class="line">            t[p] = s[p];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> t;</span><br><span class="line">&#125;;</span><br><span class="line">exports.__esModule = <span class="literal">true</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> a = &#123;</span><br><span class="line">            a: <span class="number">1</span>,</span><br><span class="line">            b: <span class="number">2</span></span><br><span class="line">        &#125;;</span><br><span class="line">        resolve(__assign(&#123; <span class="attr">c</span>: <span class="number">3</span> &#125;, a));</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line">exports.test = test;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// --target es5</span></span><br><span class="line"><span class="meta">"use strict"</span>;</span><br><span class="line"><span class="keyword">var</span> __assign = (<span class="keyword">this</span> &amp;&amp; <span class="keyword">this</span>.__assign) || <span class="built_in">Object</span>.assign || <span class="function"><span class="keyword">function</span>(<span class="params">t</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> s, i = <span class="number">1</span>, n = <span class="built_in">arguments</span>.length; i &lt; n; i++) &#123;</span><br><span class="line">        s = <span class="built_in">arguments</span>[i];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> p <span class="keyword">in</span> s) <span class="keyword">if</span> (<span class="built_in">Object</span>.prototype.hasOwnProperty.call(s, p))</span><br><span class="line">            t[p] = s[p];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> t;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">Object</span>.defineProperty(exports, <span class="string">"__esModule"</span>, &#123; <span class="attr">value</span>: <span class="literal">true</span> &#125;);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> a = &#123;</span><br><span class="line">            a: <span class="number">1</span>,</span><br><span class="line">            b: <span class="number">2</span></span><br><span class="line">        &#125;;</span><br><span class="line">        resolve(__assign(&#123; <span class="attr">c</span>: <span class="number">3</span> &#125;, a));</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line">exports.test = test;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// --target es6</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> a = &#123;</span><br><span class="line">            a: <span class="number">1</span>,</span><br><span class="line">            b: <span class="number">2</span></span><br><span class="line">        &#125;;</span><br><span class="line">        resolve(<span class="built_in">Object</span>.assign(&#123; <span class="attr">c</span>: <span class="number">3</span> &#125;, a));</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// --target esnext</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> a = &#123;</span><br><span class="line">            a: <span class="number">1</span>,</span><br><span class="line">            b: <span class="number">2</span></span><br><span class="line">        &#125;;</span><br><span class="line">        resolve(&#123;</span><br><span class="line">            c: <span class="number">3</span>,</span><br><span class="line">            ...a</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="moduleResolution"><a href="#moduleResolution" class="headerlink" title="moduleResolution"></a>moduleResolution</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“moduleResolution</td><td>string</td><td>module === â€œAMDâ€ or â€œSystemâ€ or â€œES6â€ ? â€œClassicâ€ : â€œNodeâ€</td><td>Determine how modules get resolved. Either â€œNodeâ€ for Node.js/io.js style resolution, or â€œClassicâ€. See Module Resolution documentation for more details.</td></tr></tbody></table><p>å®šä¹‰typescriptå¦‚ä½•å»æŸ¥æ‰¾moduleï¼Œè¯¦æƒ…æŸ¥çœ‹<a href="https://www.typescriptlang.org/docs/handbook/module-resolution.html" target="_blank" rel="noopener">å®˜æ–¹è¯´æ³•</a></p><blockquote><p>å¦‚æœé‡åˆ°node_modulesé‡Œçš„æ¨¡å—æ‰¾ä¸åˆ°çš„æƒ…å†µï¼Œå¯ä»¥å°è¯•æŠŠæ­¤é¡¹è®¾ç½®ä¸ºnode</p></blockquote><h2 id="newLine"><a href="#newLine" class="headerlink" title="newLine"></a>newLine</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“newLine</td><td>string</td><td></td><td>Use the specified end of line sequence to be used when emitting files: â€œcrlfâ€ (windows) or â€œlfâ€ (unix).â€</td></tr></tbody></table><p>ç”Ÿæˆçš„ä»£ç é‡Œä½¿ç”¨ä»€ä¹ˆæ ·çš„æ¢è¡Œç¬¦</p><h2 id="noEmit"><a href="#noEmit" class="headerlink" title="noEmit"></a>noEmit</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“noEmit</td><td>boolean</td><td>false</td><td>Do not emit outputs.</td></tr><tr><td>â€“noEmitHelpers</td><td>boolean</td><td>false</td><td>Do not generate custom helper functions like __extends in compiled output.</td></tr></tbody></table><p>noEmit: ä¸ç”Ÿæˆç¼–è¯‘ç»“æœã€‚</p><blockquote><p>ğŸ˜‚ é‚£è¿˜ç¼–è¯‘ä¸ªæ¯›ã€‚ã€‚ã€‚ã€‚</p></blockquote><p>noEmitHelpers: ä¸ç”Ÿæˆhelperå‡½æ•°. è®¾ç½®ä¸ºtrueï¼Œåˆ™<code>__assign</code>ï¼Œ<code>__extends</code>ç­‰helperå‡½æ•°çš„å®ç°ï¼Œä¸ä¼šå‡ºç°åœ¨ç”Ÿæˆçš„æ–‡ä»¶ä¸­ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> a = &#123;</span><br><span class="line">    a: <span class="number">1</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    b: <span class="number">2</span>,</span><br><span class="line">    ...a</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// --noEmitHelpers true</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a = &#123;</span><br><span class="line">        a: <span class="number">1</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> __assign(&#123; <span class="attr">b</span>: <span class="number">2</span> &#125;, a);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// --noEmitHelpers false</span></span><br><span class="line"><span class="keyword">var</span> __assign = (<span class="keyword">this</span> &amp;&amp; <span class="keyword">this</span>.__assign) || <span class="built_in">Object</span>.assign || <span class="function"><span class="keyword">function</span>(<span class="params">t</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> s, i = <span class="number">1</span>, n = <span class="built_in">arguments</span>.length; i &lt; n; i++) &#123;</span><br><span class="line">        s = <span class="built_in">arguments</span>[i];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> p <span class="keyword">in</span> s) <span class="keyword">if</span> (<span class="built_in">Object</span>.prototype.hasOwnProperty.call(s, p))</span><br><span class="line">            t[p] = s[p];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> t;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a = &#123;</span><br><span class="line">        a: <span class="number">1</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> __assign(&#123; <span class="attr">b</span>: <span class="number">2</span> &#125;, a);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="noEmitOnError"><a href="#noEmitOnError" class="headerlink" title="noEmitOnError"></a>noEmitOnError</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“noEmitOnError</td><td>boolean</td><td>false</td><td>Do not emit outputs if any errors were reported.</td></tr></tbody></table><p>ç¼–è¯‘æœ‰é”™è¯¯çš„æ—¶å€™ï¼Œæ˜¯å¦è¿˜ç”Ÿæˆæ–‡ä»¶ã€‚</p><h2 id="noErrorTruncation"><a href="#noErrorTruncation" class="headerlink" title="noErrorTruncation"></a>noErrorTruncation</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“noEmitOnError</td><td>boolean</td><td>false</td><td>Do not truncate error messages.</td></tr></tbody></table><p>ä¸æˆªæ–­é”™è¯¯æ¶ˆæ¯</p><h2 id="noFallthroughCasesInSwitch"><a href="#noFallthroughCasesInSwitch" class="headerlink" title="noFallthroughCasesInSwitch"></a>noFallthroughCasesInSwitch</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€”-noFallthroughCasesInSwitch</td><td>boolean</td><td>false</td><td>Report errors for fallthrough cases in switch statement.</td></tr></tbody></table><p>ä¸å…è®¸swithä¸­å­˜åœ¨æœ‰å†…å®¹çš„ä½†æ²¡æœ‰breakçš„case.</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">let</span> a = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span>(a) &#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">    <span class="built_in">console</span>.log(a)  <span class="comment">// error TS7029: Fallthrough case in switch.</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="noImplicitAny-noImplicitReturns-noImplicitThis-and-noImplicitUseStrict"><a href="#noImplicitAny-noImplicitReturns-noImplicitThis-and-noImplicitUseStrict" class="headerlink" title="noImplicitAny, noImplicitReturns, noImplicitThis and noImplicitUseStrict"></a>noImplicitAny, noImplicitReturns, noImplicitThis and noImplicitUseStrict</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“noImplicitAny</td><td>boolean</td><td>false</td><td>Raise error on expressions and declarations with an implied any type.</td></tr><tr><td>â€“noImplicitReturns</td><td>boolean</td><td>false</td><td>Report error when not all code paths in function return a value.</td></tr><tr><td>â€“noImplicitThis</td><td>boolean</td><td>false</td><td>Raise error on this expressions with an implied any type.</td></tr><tr><td>â€“noImplicitUseStrict</td><td>boolean</td><td>false</td><td>Do not emit â€œuse strictâ€ directives in module output.</td></tr></tbody></table><p>noImplicitAny ä¸å…è®¸ä½¿ç”¨éšå¼çš„ä½¿ç”¨<code>any</code><br>noImplicitReturns ä¸å…è®¸æœ‰éšå¼çš„return, å³æ‰€æœ‰åˆ†æ”¯éƒ½è¦æ˜¾ç¤ºçš„returnã€‚å®æµ‹ä¼¼ä¹æ— æ•ˆã€‚<br>noImplicitThis ä¸å…è®¸ä½¿ç”¨éšå¼çš„thisï¼Œéœ€è¦æ˜ç¡®thisçš„ç±»å‹<br>noImplicitUseStrict ç”Ÿæˆçš„æ–‡ä»¶ä¸­æ˜¯å¦ä½¿ç”¨â€use strictâ€ã€‚è¿™TMå’Œè¿™é€‰é¡¹çš„åå­—å®Œå…¨ä¸æ˜¯ä¸€ä¸ªæ„æ€å•Šã€‚ä¸ºtrueçš„æ—¶å€™ï¼Œç”Ÿæˆçš„ä»£ç ä¸ä¼šæ·»åŠ â€use strictâ€</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// --noImplicitAny true</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">a1</span>(<span class="params">b</span>) </span>&#123;  <span class="comment">// error TS7006: Parameter 'b' implicitly has an 'any' type.</span></span><br><span class="line">  <span class="keyword">return</span> b</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// --noImplicitReturns true</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">a2</span>(<span class="params">b</span>) </span>&#123;  <span class="comment">// ç¼–è¯‘é€šè¿‡ï¼Œä¸æ–‡æ¡£ä¼¼ä¹ä¸ç¬¦</span></span><br><span class="line">  <span class="keyword">if</span> (b) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(b)</span><br><span class="line">    <span class="keyword">return</span> b</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// --noImplicitThis true</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">a1</span>(<span class="params">b: any</span>) </span>&#123; <span class="comment">// error TS2683: 'this' implicitly has type 'any' because it does not have a type annotation.</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.b</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="noLib"><a href="#noLib" class="headerlink" title="noLib"></a>noLib</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“noLib</td><td>boolean</td><td>false</td><td>Do not include the default library file (lib.d.ts).</td></tr></tbody></table><p>ç¼–è¯‘çš„æ—¶å€™ä¸åŠ è½½<code>lib.d.ts</code>.</p><blockquote><p>é‚£ä½ è¿˜èƒ½ç¼–è¯‘ï¼ŸğŸ˜‚</p></blockquote><h2 id="noResolve"><a href="#noResolve" class="headerlink" title="noResolve"></a>noResolve</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“noResolve</td><td>boolean</td><td>false</td><td>Do not add triple-slash references or module import targets to the list of compiled files.</td></tr></tbody></table><p>ç¼–è¯‘æ—¶ï¼Œå¿½ç•¥<code>///&lt;reference path&gt;</code>å’Œ<code>import</code>å¼•å…¥çš„æ–‡ä»¶ã€‚</p><blockquote><p>ğŸ˜‚è¿™ç§é€‰é¡¹åˆ°åº•æœ‰å•¥ç”¨</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.ts</span></span><br><span class="line"><span class="comment">/// &lt;reference path="./my.d.ts" /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; a &#125; <span class="keyword">from</span> <span class="string">'./Test'</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// my.d.ts</span></span><br><span class="line">declare <span class="built_in">module</span> A &#123;</span><br><span class="line">  <span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params">number, string</span>): <span class="title">any</span></span></span><br><span class="line"><span class="function">&#125;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// test.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">let</span> a = <span class="number">1</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// tsc noResolve/index.ts  --listFiles</span></span><br><span class="line"></span><br><span class="line">/Users/leon/.nvm/versions/node/v8<span class="number">.7</span><span class="number">.0</span>/lib/node_modules/typescript/lib/lib.d.ts</span><br><span class="line">noResolve/my.d.ts</span><br><span class="line">/Users/leon/Documents/git/typescript-options/noResolve/Test.ts</span><br><span class="line">noResolve/index.ts</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// tsc noResolve/index.ts --noResolve --listFiles</span></span><br><span class="line">noResolve/index.ts(<span class="number">3</span>,<span class="number">19</span>): error TS2307: Cannot find <span class="built_in">module</span> <span class="string">'./Test'</span>.</span><br><span class="line">/Users/leon/.nvm/versions/node/v8<span class="number">.7</span><span class="number">.0</span>/lib/node_modules/typescript/lib/lib.d.ts</span><br><span class="line">noResolve/index.ts</span><br></pre></td></tr></table></figure><h2 id="noStrictGenericChecks"><a href="#noStrictGenericChecks" class="headerlink" title="noStrictGenericChecks"></a>noStrictGenericChecks</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“noStrictGenericChecks</td><td>boolean</td><td>false</td><td>Disable strict checking of generic signatures in function types.</td></tr></tbody></table><p>ç¦ç”¨ä¸¥æ ¼çš„å‡½æ•°æ³›å‹æ£€æŸ¥ã€‚</p><blockquote><p>ä¸æ¸…æ¥šå…·ä½“æŒ‡ä»€ä¹ˆã€‚æœ‰çŸ¥é“çš„æœ‹å‹è¯·æŒ‡æ•™</p></blockquote><h2 id="noUnusedLocals-noUnusedParameters"><a href="#noUnusedLocals-noUnusedParameters" class="headerlink" title="noUnusedLocals, noUnusedParameters"></a>noUnusedLocals, noUnusedParameters</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“noUnusedLocals</td><td>boolean</td><td>false</td><td>Report errors on unused locals.</td></tr><tr><td>â€“noUnusedParameters</td><td>boolean</td><td>false</td><td>Report errors on unused parameters.</td></tr></tbody></table><p>noUnusedLocals: ä¸å…è®¸æ— ç”¨çš„ä¸´æ—¶å˜é‡<br>noUnusedParameters: ä¸å…è®¸æœªä½¿ç”¨çš„å‚æ•°<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">A</span>(<span class="params"></span>) </span>&#123; <span class="comment">// error TS6133: 'b' is declared but its value is never read.</span></span><br><span class="line">  <span class="keyword">let</span> a = <span class="number">0</span>  <span class="comment">// error TS6133: 'a' is declared but its value is never read.</span></span><br><span class="line">  <span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="outDir-outFile"><a href="#outDir-outFile" class="headerlink" title="outDir, outFile"></a>outDir, outFile</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“outDir</td><td>string</td><td></td><td>Redirect output structure to the directory.</td></tr><tr><td>â€“outFile</td><td>string</td><td></td><td>Concatenate and emit output to single file. The order of concatenation is determined by the list of files passed to the compiler on the command line along with triple-slash references and imports. See output file order documentation for more details.</td></tr></tbody></table><p>outDir: æŠŠå¯¼å‡ºæ–‡ä»¶é‡å®šå‘åˆ°æŸä¸ªç›®å½•<br>outFile: æŠŠæ‰€æœ‰çš„æ–‡ä»¶æ‹¼æ¥å¹¶ç”Ÿæˆåˆ°å•ä¸ªæ–‡ä»¶ä¸­ã€‚</p><h2 id="paths"><a href="#paths" class="headerlink" title="paths"></a>paths</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>path</td><td>string</td><td></td><td>Redirect output structure to the directory.</td></tr></tbody></table><p>åªèƒ½ç”¨äºtsconfigä¸­ï¼Œè§£ææ¨¡å—çš„æ—¶å€™çš„è·¯å¾„ï¼Œåœ°å€æ˜¯ç›¸å¯¹äºbaseUrlçš„ã€‚è¯¦æƒ…æŸ¥çœ‹<a href="https://www.typescriptlang.org/docs/handbook/module-resolution.html" target="_blank" rel="noopener">å®˜æ–¹è¯´æ³•</a></p><h2 id="preserveConstEnums"><a href="#preserveConstEnums" class="headerlink" title="preserveConstEnums"></a>preserveConstEnums</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>preserveConstEnums</td><td>boolean</td><td>false</td><td>Do not erase const enum declarations in generated code. See const enums documentation for more details.</td></tr></tbody></table><p>ä»ç”Ÿæˆçš„ä»£ç ä¸­æ“¦é™¤é™æ€æšä¸¾çš„å£°æ˜ã€‚</p><blockquote><p>å®æµ‹æ€ä¹ˆè®¾ç½®ä¼¼ä¹éƒ½ä¸èµ·ä½œç”¨ã€‚ğŸ˜‚</p></blockquote><h2 id="preserveSymlinks"><a href="#preserveSymlinks" class="headerlink" title="preserveSymlinks"></a>preserveSymlinks</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>preserveSymlinks</td><td>boolean</td><td>false</td><td>Do not resolve symlinks to their real path; treat a symlinked file like a real one.</td></tr></tbody></table><p>ä¸æŠŠç¬¦å·é“¾æ¥è§£æä¸ºå…¶çœŸå®è·¯å¾„ï¼›å°†ç¬¦å·é“¾æ¥æ–‡ä»¶è§†ä¸ºçœŸæ­£çš„æ–‡ä»¶ã€‚</p><blockquote><p>ä¸å¤ªæ˜ç™½å•¥æ„æ€ã€‚æµ‹è¯•äº†<code>import</code>ä¸€ä¸ª<code>linux</code>è½¯è¿æ¥ï¼Œä½†æ˜¯è¿™ä¸ªé€‰é¡¹å¹¶æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// realIndex.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">let</span> a = <span class="number">1</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.ts --&gt; realIndex.ts</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ­¤é€‰é¡¹å¹¶ä¸å½±å“ tesc index.ts çš„ç¼–è¯‘</span></span><br></pre></td></tr></table></figure><h2 id="pretty"><a href="#pretty" class="headerlink" title="pretty"></a>pretty</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“pretty</td><td>boolean</td><td>false</td><td>Stylize errors and messages using color and context.</td></tr></tbody></table><p>å¯¹consoleä¸Šé”™è¯¯å’Œæ¶ˆæ¯åšé¢œè‰²å’Œæ ·å¼çš„ç¾åŒ–å¤„ç†ã€‚</p><h2 id="project"><a href="#project" class="headerlink" title="project"></a>project</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“project <br> -p</td><td>string</td><td></td><td>Compile a project given a valid configuration file. The argument can be a file path to a valid JSON configuration file, or a directory path to a directory containing a tsconfig.json file. See tsconfig.json documentation for more details.</td></tr></tbody></table><p>æŒ‡å®šä¸€ä¸ª<code>tsconfig.json</code>æ–‡ä»¶</p><h2 id="removeComments"><a href="#removeComments" class="headerlink" title="removeComments"></a>removeComments</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“removeComments</td><td>boolean</td><td>false</td><td>Remove all comments except copy-right header comments beginning with /*!</td></tr></tbody></table><p>åˆ é™¤æ³¨é‡Š</p><h2 id="rootDir"><a href="#rootDir" class="headerlink" title="rootDir"></a>rootDir</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“rootDir</td><td>string</td><td></td><td>Specifies the root directory of input files. Only use to control the output directory structure with â€“outDir.</td></tr></tbody></table><p>æŒ‡å®šè¾“å…¥æ–‡ä»¶çš„æ ¹ç›®å½•ï¼Œä»…å’ŒoutDirä¸€èµ·ç”¨äºç®¡ç†è¾“å‡ºç›®å½•çš„ç»“æ„ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ./test/index.ts</span></span><br><span class="line"><span class="keyword">let</span> a = <span class="number">1</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// tsc test/index.ts --outDir ./test/dist/ --rootDir .</span></span><br><span class="line">ç”Ÿæˆ ./test/dist/test/index.js</span><br><span class="line"></span><br><span class="line"><span class="comment">// tsc test/index.ts --outDir ./test/dist/</span></span><br><span class="line">ç”Ÿæˆ ./test/dist/index.js</span><br></pre></td></tr></table></figure><h2 id="rootDirs"><a href="#rootDirs" class="headerlink" title="rootDirs"></a>rootDirs</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>rootDirs</td><td>string[]</td><td></td><td>List of root folders whose combined content represent the structure of the project at runtime. See Module Resolution documentation for more details.</td></tr></tbody></table><p>æŒ‡å®šå¤šä¸ªæ ¹ç›®å½•ï¼Œå¹¶ä»¥æ­¤ç¡®å®šè¿è¡Œæ—¶çš„é¡¹ç›®ç»“æ„ã€‚<br><a href="https://www.typescriptlang.org/docs/handbook/module-resolution.html#virtual-directories-with-rootdirs" target="_blank" rel="noopener">è¯¦è§æ–‡æ¡£</a>.</p><blockquote><p>è¯´äººè¯ï¼šå…è®¸å°†ä¸åŒçš„ç›®å½•ï¼Œé€šè¿‡è¿™ä¸ªé€‰é¡¹éƒ½æŒ‡å®šä¸ºæ ¹ç›®å½•ï¼Œä»è€Œä½¿å¯¼å…¥æ–‡ä»¶çš„æ—¶å€™æ¯”è¾ƒæ–¹ä¾¿ã€‚</p></blockquote><h2 id="skipLibCheck"><a href="#skipLibCheck" class="headerlink" title="skipLibCheck"></a>skipLibCheck</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“skipLibCheck</td><td>boolean</td><td>false</td><td>Skip type checking of all declaration files (*.d.ts).</td></tr></tbody></table><p>å¿½ç•¥æ‰€æœ‰çš„å£°æ˜æ–‡ä»¶ï¼ˆ *.d.tsï¼‰çš„ç±»å‹æ£€æŸ¥ã€‚</p><blockquote><p>æš‚æ—¶ä¸çŸ¥é“æ€ä¹ˆç”¨ï¼Œå°è¯•äº†å‡ ç§æ–¹æ³•ä¼¼ä¹éƒ½ä¸èµ·ä½œç”¨ã€‚</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// test.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">let</span> a = [<span class="number">1</span>, ,<span class="number">2</span>, <span class="number">3</span>]</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// test.d.ts</span></span><br><span class="line"><span class="keyword">export</span> declare <span class="keyword">let</span> a: number[];</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; a &#125; <span class="keyword">from</span> <span class="string">'./test'</span></span><br><span class="line">a[<span class="number">0</span>] = <span class="string">'12'</span></span><br></pre></td></tr></table></figure><p>åŠ ä¸åŠ è¿™ä¸ªé€‰é¡¹éƒ½ä¼šæŠ¥é”™ï¼š<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">error TS2322: Type <span class="string">'"12"'</span> is not assignable to type <span class="string">'number'</span>.</span><br></pre></td></tr></table></figure></p><h2 id="strict"><a href="#strict" class="headerlink" title="strict"></a>strict</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“strict</td><td>boolean</td><td>false</td><td>Enable all strict type checking options. <br>Enabling <code>â€“strict</code> enables <code>â€“noImplicitAny</code>, <code>â€“noImplicitThis</code>, <code>â€“alwaysStrict</code>, <code>â€“strictNullChecks</code>, <code>â€“strictFunctionTypes</code> and <code>â€“strictPropertyInitialization</code>.</td></tr></tbody></table><p>å¼€å¯ä¸€ç³»åˆ—çš„å¼ºåˆ¶æ£€æµ‹ã€‚</p><h2 id="strictFunctionTypes-strictPropertyInitialization-strictNullChecks"><a href="#strictFunctionTypes-strictPropertyInitialization-strictNullChecks" class="headerlink" title="strictFunctionTypes, strictPropertyInitialization, strictNullChecks"></a>strictFunctionTypes, strictPropertyInitialization, strictNullChecks</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“strictFunctionTypes</td><td>boolean</td><td>false</td><td>Disable bivariant parameter checking for function types.</td></tr><tr><td>â€“strictPropertyInitialization</td><td>boolean</td><td>false</td><td>Enusre non-undefined class properties are initialized in the constructor.</td></tr><tr><td>â€“strictNullChecks</td><td>boolean</td><td>false</td><td>In strict null checking mode, the null and undefined values are not in the domain of every type and are only assignable to themselves and any (the one exception being that undefined is also assignable to void).</td></tr></tbody></table><p><code>strictFunctionTypes</code>: å¯ç”¨å‡½æ•°ç±»å‹çš„ä¸¥æ ¼æ£€æŸ¥ã€‚è¯¦è§ï¼š <a href="https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-6.html" target="_blank" rel="noopener">https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-6.html</a></p><p><code>strictPropertyInitialization</code>: è¦æ±‚æœªå®šä¹‰çš„classæˆå‘˜å˜é‡ï¼Œä¸€å®šè¦åœ¨æ„é€ å‡½æ•°é‡Œè¿›è¡Œåˆå§‹åŒ–ã€‚</p><p><code>strictNullChecks</code>: <code>null</code> å’Œ <code>undefined</code>, ä¸å±äºåŒ…å«åœ¨å…¶ä»–ä»»ä½•ç±»å‹ï¼Œæ‰€ä»¥ä»–ä»¬åªèƒ½ <code>null</code> åªèƒ½èµ‹å€¼ç»™ <code>null</code> ç±»å‹æˆ– <code>any</code> <code>ç±»å‹ï¼Œundefined</code> åªèƒ½èµ‹å€¼ç»™ <code>undefined</code> ç±»å‹æˆ–è€… <code>any</code> ç±»å‹ã€‚ä½†æœ‰ä¸€ä¸ªä¾‹å¤–: <code>undefined</code> å¯ä»¥è¢«èµ‹å€¼ç»™ <code>void</code> ç±»å‹</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">  name: string</span><br><span class="line">  age = <span class="number">10</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">constructor</span>(age: number) &#123; <span class="comment">// error TS2564: Property 'name' has no initializer and is not definitely assigned in the constructor.</span></span><br><span class="line">    <span class="keyword">this</span>.age = age</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> a1: number = <span class="literal">null</span>       <span class="comment">// error TS2322: Type 'null' is not assignable to type 'number'.</span></span><br><span class="line"><span class="keyword">let</span> a2: string = <span class="literal">undefined</span>  <span class="comment">// error TS2322: Type 'undefined' is not assignable to type 'string'.</span></span><br></pre></td></tr></table></figure><h2 id="stripInternal"><a href="#stripInternal" class="headerlink" title="stripInternal"></a>stripInternal</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“stripInternal</td><td>boolean</td><td>false</td><td>Do not emit declarations for code that has an /*<em> @internal </em>/ JSDoc annotation.</td></tr></tbody></table><p>å®éªŒå±æ€§ã€‚ä¸ä¸ºæœ‰<code>/** @internal */</code>æ ‡è®°çš„ä»£ç ç”Ÿæˆdeclaration</p><h2 id="suppressExcessPropertyErrors"><a href="#suppressExcessPropertyErrors" class="headerlink" title="suppressExcessPropertyErrors"></a>suppressExcessPropertyErrors</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“suppressExcessPropertyErrors</td><td>boolean</td><td>false</td><td>Suppress excess property checks for object literals.</td></tr></tbody></table><p>ä¸å¯¹å¯¹è±¡è‡ªå˜é‡çš„é¢å¤–å±æ€§è¿›è¡Œç±»å‹æ£€æµ‹</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">  name: string</span><br><span class="line">  age = <span class="number">10</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">constructor</span>(age: number) &#123;</span><br><span class="line">    <span class="keyword">this</span>.age = age</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> a: A = &#123;</span><br><span class="line">  name: <span class="string">'leon'</span>,</span><br><span class="line">  age: <span class="number">30</span>,</span><br><span class="line">  gender: <span class="string">'male'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// --suppressExcessPropertyErrors false</span></span><br><span class="line">error TS2322: Type <span class="string">'&#123; name: string; age: number; gender: string; &#125;'</span> is not assignable to type <span class="string">'A'</span>.</span><br><span class="line"><span class="built_in">Object</span> literal may only specify known properties, and <span class="string">'gender'</span> does not exist <span class="keyword">in</span> type <span class="string">'A'</span>.</span><br><span class="line"></span><br><span class="line"><span class="comment">//  --suppressExcessPropertyErrors true</span></span><br><span class="line">pass</span><br></pre></td></tr></table></figure><h2 id="suppressImplicitAnyIndexErrors"><a href="#suppressImplicitAnyIndexErrors" class="headerlink" title="suppressImplicitAnyIndexErrors"></a>suppressImplicitAnyIndexErrors</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“suppressImplicitAnyIndexErrors</td><td>boolean</td><td>false</td><td>Suppress â€“noImplicitAny errors for indexing objects lacking index signatures. See issue #1232 for more details.</td></tr></tbody></table><p>ä¿®å¤<a href="https://github.com/Microsoft/TypeScript/issues/1232#issuecomment-64510362" target="_blank" rel="noopener">#1232</a>çš„ä¸€ä¸ªé—®é¢˜ã€‚</p><h2 id="traceResolution"><a href="#traceResolution" class="headerlink" title="traceResolution"></a>traceResolution</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“traceResolution</td><td>boolean</td><td>false</td><td>Report module resolution log messages.</td></tr></tbody></table><p>æ‰“å°å‡ºmodule resolveè¿‡ç¨‹çš„logã€‚å½“moudleæ‰¾ä¸åˆ°çš„æ—¶å€™ï¼Œå¯ä»¥æ‰“å‡ºlogè¿›è¡Œæ’æŸ¥ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Module resolution kind is not specified, using <span class="string">'NodeJs'</span>.</span><br><span class="line">Loading <span class="built_in">module</span> <span class="keyword">as</span> file / folder, candidate <span class="built_in">module</span> location <span class="string">'/Users/leon/Documents/git/typescript-options/skipLibCheck/test'</span>, target file type<span class="string">'TypeScript'</span>.</span><br><span class="line">File <span class="string">'/Users/leon/Documents/git/typescript-options/skipLibCheck/test.ts'</span> does not exist.</span><br><span class="line">File <span class="string">'/Users/leon/Documents/git/typescript-options/skipLibCheck/test.tsx'</span> does not exist.</span><br><span class="line">File <span class="string">'/Users/leon/Documents/git/typescript-options/skipLibCheck/test.d.ts'</span> exist - use it <span class="keyword">as</span> a name resolution result.</span><br></pre></td></tr></table></figure><h2 id="types-typeRoots"><a href="#types-typeRoots" class="headerlink" title="types, typeRoots"></a>types, typeRoots</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“types</td><td>string[]</td><td></td><td>List of names of type definitions to include. See @types, â€“typeRoots and â€“types for more details.</td></tr><tr><td>â€“typeRoots</td><td>string[]</td><td></td><td>List of folders to include type definitions from. See @types, â€“typeRoots and â€“types for more details.</td></tr></tbody></table><p>æŒ‡å®štyesæ–‡ä»¶åˆ—è¡¨å’Œç›®å½•åˆ—è¡¨ã€‚</p><blockquote><p>å½“ä½ importä¸€ä¸ªç¬¬ä¸‰æ–¹åº“çš„æ—¶å€™ï¼Œtsä¼šæ ¹æ®è¿™ä¸ªåº“çš„package.jsoné‡Œçš„<code>types</code> æˆ–è€… <code>typings</code>å±æ€§æŒ‡å®šçš„ç›®å½•å»åŠ è½½type. å¯ä»¥å‚ç…§<a href="https://unpkg.com/vue/package.json" target="_blank" rel="noopener">vueçš„package.json</a>å’Œ<a href="https://unpkg.com/antd/package.json" target="_blank" rel="noopener">antdçš„package.json</a></p></blockquote><h2 id="emitDecoratorMetadata"><a href="#emitDecoratorMetadata" class="headerlink" title="emitDecoratorMetadata"></a>emitDecoratorMetadata</h2><table><thead><tr><th>Option</th><th>Type</th><th>Default</th><th>Desc</th></tr></thead><tbody><tr><td>â€“emitDecoratorMetadata</td><td>boolean</td><td>false</td><td>Emit design-type metadata for decorated declarations in source. See issue #2577 for details.</td></tr></tbody></table><blockquote><p>å…³äºtsçš„è£…é¥°å™¨ï¼Œæš‚æœªç ”ç©¶ï¼Œæœ‰ç©ºå†çœ‹ã€‚ ğŸ˜‚</p></blockquote><h2 id="è½¬è½½"><a href="#è½¬è½½" class="headerlink" title="è½¬è½½"></a>è½¬è½½</h2><ul><li><a href="https://www.njleonzhang.com/2018/03/24/typescript-compiler-options.html" target="_blank" rel="noopener">typescript 2.7 ç¼–è¯‘é€‰é¡¹è¯¦è§£</a><br><br></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong></p></blockquote><blockquote><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANG æ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> typescript </tag>
            
            <tag> è½¬ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>angularå­¦ä¹ ç¬”è®°</title>
      <link href="/2018/09/16/learn-angular/"/>
      <url>/2018/09/16/learn-angular/</url>
      
        <content type="html"><![CDATA[<p>ã€Œ Angular 4.0ä»å…¥é—¨åˆ°å®æˆ˜ æ‰“é€ è‚¡ç¥¨ç®¡ç†ç½‘ç«™ã€å­¦ä¹ ç¬”è®°<br><a id="more"></a></p><h1 id="init"><a href="#init" class="headerlink" title="init"></a>init</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨ yarnpkg åªéœ€è¦è®¾ç½®ä¸€æ¬¡</span></span><br><span class="line">ng config -g cli.packageManager yarn</span><br><span class="line"><span class="comment">#  æ–°å»ºé¡¹ç›®         æœ‰è·¯ç”±, æ— æµ‹è¯•, scss</span></span><br><span class="line">ng new <span class="variable">$project</span> --routing -S --style=scss</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ  material</span></span><br><span class="line">yarnpkg add @angular/material @angular/cdk @angular/animations</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆ component</span></span><br><span class="line">ng g c <span class="variable">$name</span></span><br></pre></td></tr></table></figure><h1 id="æ¨¡å—"><a href="#æ¨¡å—" class="headerlink" title="æ¨¡å—"></a>æ¨¡å—</h1><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@NgModule</span>(&#123;</span><br><span class="line">  declarations: [</span><br><span class="line">    ç»„ä»¶,</span><br><span class="line">    æŒ‡ä»¤,</span><br><span class="line">    ç®¡é“</span><br><span class="line">  ],</span><br><span class="line">  imports: [</span><br><span class="line">    ä¾èµ–æ¨¡å—</span><br><span class="line">  ],</span><br><span class="line">  providers: [</span><br><span class="line">    æœåŠ¡</span><br><span class="line">  ],</span><br><span class="line">  bootstrap: [</span><br><span class="line">    ä¸»ç»„ä»¶</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h1 id="ç»„ä»¶"><a href="#ç»„ä»¶" class="headerlink" title="ç»„ä»¶"></a>ç»„ä»¶</h1><figure class="image-box">                <img src="/img/learn-angular/001.png" alt="component" title="" class="">                <p>component</p>            </figure><h1 id="è·¯ç”±"><a href="#è·¯ç”±" class="headerlink" title="è·¯ç”±"></a>è·¯ç”±</h1><figure class="image-box">                <img src="/img/learn-angular/002.png" alt="route" title="" class="">                <p>route</p>            </figure><h2 id="app-routing-module-ts"><a href="#app-routing-module-ts" class="headerlink" title="app-routing.module.ts"></a><code>app-routing.module.ts</code></h2><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes: Routes = [</span><br><span class="line">  <span class="comment">// è·¯ç”±é‡å®šå‘</span></span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">''</span>,</span><br><span class="line">    redirectTo: <span class="string">'/home'</span>,</span><br><span class="line">    pathMath: <span class="string">'full'</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// åŸºæœ¬è·¯ç”±é…ç½®</span></span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">'home'</span>,</span><br><span class="line">    component: HomeComponent,</span><br><span class="line">    data: [</span><br><span class="line">      &#123;</span><br><span class="line">        isProd: <span class="literal">true</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">'children'</span>,</span><br><span class="line">    <span class="comment">// å­è·¯ç”±</span></span><br><span class="line">    children: [</span><br><span class="line">      &#123;</span><br><span class="line">        path: <span class="string">''</span>,</span><br><span class="line">        component: Children1Component,</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        path: <span class="string">'xxx/:id'</span>,</span><br><span class="line">        component: Children2Component,</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// é»˜è®¤è·¯ç”±</span></span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">'**'</span>,</span><br><span class="line">    redirectTo: <span class="string">''</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">];</span><br></pre></td></tr></table></figure><h2 id="html-ä¸­"><a href="#html-ä¸­" class="headerlink" title="html ä¸­"></a>html ä¸­</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- routerLinkæ•°ç»„,   queryParams å¯¹è±¡ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> [<span class="attr">routerLink</span>]=<span class="string">"['/product', id]"</span> [<span class="attr">queryParams</span>]=<span class="string">"&#123;debug: 1&#125;"</span>&gt;</span>XXXX<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- åœ¨æ ‡ç­¾ä¸‹é¢å±•ç¤ºè·¯ç”±å†…å®¹ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">router-outlet</span>&gt;</span><span class="tag">&lt;/<span class="name">router-outlet</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="component-ts"><a href="#component-ts" class="headerlink" title="component.ts"></a>component.ts</h2><h3 id="è·³è½¬"><a href="#è·³è½¬" class="headerlink" title="è·³è½¬"></a>è·³è½¬</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">constructor</span>(<span class="params"><span class="keyword">private</span> router: Router</span>)&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">this</span>.router.navigate([<span class="string">"/"</span>, id], &#123;</span><br><span class="line">  queryParams: &#123;</span><br><span class="line">    debug: <span class="number">1</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="è·å–"><a href="#è·å–" class="headerlink" title="è·å–"></a>è·å–</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">constructor</span>(<span class="params"><span class="keyword">private</span> routeInfo: ActivatedRoute</span>) &#123;</span><br><span class="line">  routeInfo.params.subscribe(<span class="function">(<span class="params">params: Params</span>) =&gt;</span> <span class="keyword">this</span>.productId = params[<span class="string">"id"</span>]);</span><br><span class="line">  routeInfo.queryParams.subscribe(<span class="function">(<span class="params">params: Params</span>) =&gt;</span> <span class="keyword">this</span>.test = params[<span class="string">"test"</span>]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">this</span>.id = routeInfo.snapshot.params[<span class="string">'id'</span>];</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è·¯ç”±ä¸­é…ç½® data: [&#123;isprod: true&#125;]</span></span><br><span class="line">  <span class="keyword">this</span>.isProd = routeInfo.snapshot.data[<span class="number">0</span>][<span class="string">'isProd'</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="è¾…åŠ©è·¯ç”±"><a href="#è¾…åŠ©è·¯ç”±" class="headerlink" title="è¾…åŠ©è·¯ç”±"></a>è¾…åŠ©è·¯ç”±</h2><figure class="image-box">                <img src="/img/learn-angular/003.png" alt="aux" title="" class="">                <p>aux</p>            </figure><h2 id="è·¯ç”±å®ˆå«"><a href="#è·¯ç”±å®ˆå«" class="headerlink" title="è·¯ç”±å®ˆå«"></a>è·¯ç”±å®ˆå«</h2><h3 id="routes"><a href="#routes" class="headerlink" title="routes"></a>routes</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  path: <span class="string">'product/:id'</span>,</span><br><span class="line">  component: ProductComponent,</span><br><span class="line">  <span class="comment">// åœ¨è·¯ç”±æ¿€æ´»ä¹‹å‰è·å–æ•°æ®</span></span><br><span class="line">  resolve: &#123;</span><br><span class="line">    product: ProductResolveGuard</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// å¤„ç†å¯¼èˆªåˆ°æŸä¸ªè·¯ç”±</span></span><br><span class="line">  canActivate: [LoginGuard],</span><br><span class="line">  <span class="comment">// å¤„ç†ä»å½“å‰è·¯ç”±ç¦»å¼€</span></span><br><span class="line">  canDeactivate: [UnsavedGuard],</span><br><span class="line">  data: [&#123;</span><br><span class="line">    isProd: <span class="literal">true</span></span><br><span class="line">  &#125;],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="canActivate"><a href="#canActivate" class="headerlink" title="canActivate"></a>canActivate</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> LoginGuard <span class="keyword">implements</span> CanActivate &#123;</span><br><span class="line">  canActivate(</span><br><span class="line">    route: ActivatedRouteSnapshot,</span><br><span class="line">    state: RouterStateSnapshot</span><br><span class="line">  ): Observable&lt;<span class="built_in">boolean</span>&gt; | <span class="built_in">Promise</span>&lt;<span class="built_in">boolean</span>&gt; | <span class="built_in">boolean</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> loggedIn: <span class="built_in">boolean</span> = <span class="built_in">Math</span>.random() &lt; <span class="number">0.5</span>;</span><br><span class="line">    <span class="keyword">if</span> (!loggedIn) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'LoginGuard:ç”¨æˆ·æœªç™»å½•'</span> + <span class="keyword">new</span> <span class="built_in">Date</span>());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> loggedIn;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="CanDeactivate"><a href="#CanDeactivate" class="headerlink" title="CanDeactivate"></a>CanDeactivate</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> UnsavedGuard <span class="keyword">implements</span> CanDeactivate&lt;ProductComponent&gt; &#123;</span><br><span class="line">  canDeactivate() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">window</span>.confirm(<span class="string">'ä½ è¿˜æ²¡æœ‰ä¿å­˜.ç¡®å®šè¦ç¦»å¼€ä¹ˆ?'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Resolve"><a href="#Resolve" class="headerlink" title="Resolve"></a>Resolve</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Injectable</span>()</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> ProductResolveGuard <span class="keyword">implements</span> Resolve&lt;ProductComponent&gt; &#123;</span><br><span class="line">  <span class="keyword">constructor</span>(<span class="params"><span class="keyword">private</span> router: Router</span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">  resolve(</span><br><span class="line">    route: ActivatedRouteSnapshot,</span><br><span class="line">    state: RouterStateSnapshot</span><br><span class="line">  ): Observable&lt;ProductComponent&gt; | <span class="built_in">Promise</span>&lt;ProductComponent&gt; | ProductComponent &#123;</span><br><span class="line">    <span class="keyword">let</span> productId: <span class="built_in">number</span> = route.params[<span class="string">'id'</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (productId == <span class="number">1</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">undefined</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">this</span>.router.navigate([<span class="string">'/home'</span>]);</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">undefined</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="ä¾èµ–æ³¨å…¥"><a href="#ä¾èµ–æ³¨å…¥" class="headerlink" title="ä¾èµ–æ³¨å…¥"></a>ä¾èµ–æ³¨å…¥</h1><figure class="image-box">                <img src="/img/learn-angular/004.png" alt="DI" title="" class="">                <p>DI</p>            </figure><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">providers: [</span><br><span class="line">  LoggerService,</span><br><span class="line">  &#123;</span><br><span class="line">    provide: ProductService,</span><br><span class="line">    <span class="comment">// å•ä¾‹, åªåœ¨ç¬¬ä¸€æ¬¡éœ€è¦çš„æ—¶å€™åˆå§‹åŒ–</span></span><br><span class="line">    useFactory: <span class="function">(<span class="params">logger: LoggerService, appConfig</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (appConfig.isDev) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ProductService(logger);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> AnotherProductService(logger);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// æä¾›å‚æ•°</span></span><br><span class="line">    deps: [LoggerService, <span class="string">'APP_CONFIG'</span>],</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// å˜é‡</span></span><br><span class="line">    provide: <span class="string">'APP_CONFIG'</span>,</span><br><span class="line">    useValue: &#123;</span><br><span class="line">      isDev: <span class="literal">false</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">];</span><br></pre></td></tr></table></figure><h1 id="æ•°æ®ç»‘å®š"><a href="#æ•°æ®ç»‘å®š" class="headerlink" title="æ•°æ®ç»‘å®š"></a>æ•°æ®ç»‘å®š</h1><h2 id="æ’å€¼è¡¨è¾¾å¼"><a href="#æ’å€¼è¡¨è¾¾å¼" class="headerlink" title="æ’å€¼è¡¨è¾¾å¼"></a>æ’å€¼è¡¨è¾¾å¼</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;&#123;title&#125;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="å±æ€§è¡¨è¾¾å¼"><a href="#å±æ€§è¡¨è¾¾å¼" class="headerlink" title="å±æ€§è¡¨è¾¾å¼"></a>å±æ€§è¡¨è¾¾å¼</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> [<span class="attr">src</span>]=<span class="string">"imgUrl"</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="äº‹ä»¶ç»‘å®š"><a href="#äº‹ä»¶ç»‘å®š" class="headerlink" title="äº‹ä»¶ç»‘å®š"></a>äº‹ä»¶ç»‘å®š</h2><figure class="image-box">                <img src="/img/learn-angular/005.png" alt="bind" title="" class="">                <p>bind</p>            </figure><h1 id="å“åº”å¼ç¼–ç¨‹"><a href="#å“åº”å¼ç¼–ç¨‹" class="headerlink" title="å“åº”å¼ç¼–ç¨‹"></a>å“åº”å¼ç¼–ç¨‹</h1><p><a href="/2018/08/30/lean-rxjs/">RxJS å­¦ä¹ ç¬”è®°</a></p><h1 id="ç®¡é“"><a href="#ç®¡é“" class="headerlink" title="ç®¡é“"></a>ç®¡é“</h1><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Pipe</span>(&#123;</span><br><span class="line">  name: <span class="string">'multiple'</span>,</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> MultiplePipe <span class="keyword">implements</span> PipeTransform &#123;</span><br><span class="line">  transform(value: <span class="built_in">number</span>, args?: <span class="built_in">number</span>): <span class="built_in">any</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!args) &#123;</span><br><span class="line">      args = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> value * args;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="ç»„ä»¶é—´é€šä¿¡"><a href="#ç»„ä»¶é—´é€šä¿¡" class="headerlink" title="ç»„ä»¶é—´é€šä¿¡"></a>ç»„ä»¶é—´é€šä¿¡</h1><h2 id="è·¯ç”±å±æ€§"><a href="#è·¯ç”±å±æ€§" class="headerlink" title="è·¯ç”±å±æ€§"></a>è·¯ç”±å±æ€§</h2><p><a href="#è·å–">è·å–è·¯ç”±å±æ€§</a></p><h2 id="è¾“å…¥å±æ€§"><a href="#è¾“å…¥å±æ€§" class="headerlink" title="è¾“å…¥å±æ€§"></a>è¾“å…¥å±æ€§</h2><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å­ç»„ä»¶ component ä¸­</span></span><br><span class="line"><span class="meta">@Input</span>()</span><br><span class="line">price: <span class="built_in">number</span>;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- çˆ¶ç»„ä»¶htmlä¸­ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">child-component</span> [<span class="attr">price</span>]=<span class="string">"some-value"</span>&gt;</span><span class="tag">&lt;/<span class="name">child-componen</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="è¾“å‡ºå±æ€§"><a href="#è¾“å‡ºå±æ€§" class="headerlink" title="è¾“å‡ºå±æ€§"></a>è¾“å‡ºå±æ€§</h2><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å­ç»„ä»¶</span></span><br><span class="line"><span class="meta">@Output</span>(<span class="string">'priceChange'</span>)</span><br><span class="line">lastPrice:EventEmitter&lt;<span class="built_in">number</span>&gt; = <span class="keyword">new</span> EventEmitter();</span><br><span class="line"></span><br><span class="line"><span class="comment">// some trigger</span></span><br><span class="line"><span class="keyword">this</span>.lastPrice.emit(<span class="number">10</span>);</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- çˆ¶ç»„ä»¶ä¸­ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">child-component</span> (<span class="attr">lastPrice</span>)=<span class="string">"priceHandle($event)"</span>&gt;</span><span class="tag">&lt;/<span class="name">child-component</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// çˆ¶ç»„ä»¶ä¸­</span></span><br><span class="line">priceHandle(event: <span class="built_in">number</span>) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'price: '</span>, event)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä¸­é—´äººæ¨¡å¼-æœ‰å…±åŒçš„çˆ¶ç»„ä»¶"><a href="#ä¸­é—´äººæ¨¡å¼-æœ‰å…±åŒçš„çˆ¶ç»„ä»¶" class="headerlink" title="ä¸­é—´äººæ¨¡å¼(æœ‰å…±åŒçš„çˆ¶ç»„ä»¶)"></a>ä¸­é—´äººæ¨¡å¼(æœ‰å…±åŒçš„çˆ¶ç»„ä»¶)</h2><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// child1 ç»„ä»¶</span></span><br><span class="line"><span class="meta">@Output</span>(<span class="string">'priceChange'</span>)</span><br><span class="line">lastPrice:EventEmitter&lt;<span class="built_in">number</span>&gt; = <span class="keyword">new</span> EventEmitter();</span><br><span class="line"></span><br><span class="line"><span class="keyword">this</span>.lastPrice.emit(<span class="number">10</span>);</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- çˆ¶ç»„ä»¶ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">child1-component</span> (<span class="attr">lastPrice</span>)=<span class="string">"priceHandle($event)"</span>&gt;</span><span class="tag">&lt;/<span class="name">child1-component</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">child2-component</span> [<span class="attr">lastPrice</span>]=<span class="string">"lastPrice"</span>&gt;</span><span class="tag">&lt;/<span class="name">child2-component</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ"><a href="#ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ"></a>ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ</h1><figure class="image-box">                <img src="/img/learn-angular/006.png" alt="life" title="" class="">                <p>life</p>            </figure><h1 id="è¡¨å•"><a href="#è¡¨å•" class="headerlink" title="è¡¨å•"></a>è¡¨å•</h1><h2 id="æ•°æ®æ¨¡å‹"><a href="#æ•°æ®æ¨¡å‹" class="headerlink" title="æ•°æ®æ¨¡å‹"></a>æ•°æ®æ¨¡å‹</h2><p>ç”± <code>angular/form</code>æ¨¡å—ä¸­ç‰¹å®šçš„ç±»(<code>FormControl</code>, <code>FormGroup</code>, <code>FormArray</code>)ç»„æˆ</p><h2 id="ä¸¤ç§è¡¨å•æ¯”è¾ƒ"><a href="#ä¸¤ç§è¡¨å•æ¯”è¾ƒ" class="headerlink" title="ä¸¤ç§è¡¨å•æ¯”è¾ƒ"></a>ä¸¤ç§è¡¨å•æ¯”è¾ƒ</h2><table><thead><tr><th></th><th>æ¨¡æ¿å¼è¡¨å•</th><th>å“åº”å¼è¡¨å•</th></tr></thead><tbody><tr><td>import</td><td><code>FormsModule</code></td><td><code>ReactiveFormsModule</code></td></tr><tr><td>å¦‚ä½•æ„é€ </td><td>é€šè¿‡ç»„ä»¶æ¨¡æ¿ä¸­ç›¸å…³æŒ‡ä»¤</td><td>é€šè¿‡ç¼–å†™ <code>typescript</code> ä»£ç </td></tr><tr><td>æ•°æ®æ¨¡å‹åˆ›å»º</td><td>ç”± <code>angular</code> åŸºäºæ¨¡æ¿ä¸­çš„æŒ‡ä»¤éšå¼åˆ›å»º</td><td>ç¼–ç æ˜ç¡®åˆ›å»ºæ•°æ®æ¨¡å‹</td></tr><tr><td>èƒ½å¦ç›´æ¥è®¿é—®æ•°æ®æ¨¡å‹</td><td>ä¸èƒ½</td><td>èƒ½</td></tr><tr><td>HTML</td><td>ç›´æ¥ç”Ÿæˆ</td><td>è‡ªå·±ç¼–å†™ç»‘å®šæ•°æ®</td></tr></tbody></table><h2 id="æ¨¡æ¿å¼è¡¨å•"><a href="#æ¨¡æ¿å¼è¡¨å•" class="headerlink" title="æ¨¡æ¿å¼è¡¨å•"></a>æ¨¡æ¿å¼è¡¨å•</h2><ul><li><code>NgFrom</code> ä¼šè‡ªåŠ¨æ·»åŠ åˆ° <code>&lt;form&gt;</code> è¡¨å•ä¸Š</li><li>æ‰‹åŠ¨æ·»åŠ  <code>NgFrom</code>: <code>&lt;form #myForm=&quot;ngForm&quot;&gt;</code></li><li><code>&lt;form&gt;</code>è¡¨å•çš„æäº¤ä¸ä¼šè¢«è§¦å‘</li><li>å®ç° <code>(ngSubmit)=&quot;onSubmit(myForm.value)&quot;</code></li><li>åœ¨ <code>NgForm</code> å…ƒç´ ä¸‹ å¯»æ‰¾æ ‡è®°ä¸º <code>NgModel</code> å±æ€§çš„å…ƒç´ (éœ€è¦æŒ‡å®š<code>name</code>å±æ€§æ‰èƒ½ç»‘å®š)</li></ul><h2 id="å“åº”å¼è¡¨å•"><a href="#å“åº”å¼è¡¨å•" class="headerlink" title="å“åº”å¼è¡¨å•"></a>å“åº”å¼è¡¨å•</h2><ul><li><code>formGroup</code> å’Œ <code>formControl</code> éœ€è¦å±æ€§ç»‘å®šè¯­æ³•</li><li><code>formGroupName</code>, <code>formControlName</code>, <code>formArrayName</code> <strong>ä¸éœ€è¦</strong>å±æ€§ç»‘å®šè¯­æ³•</li><li><code>formGroupName</code>, <code>formControlName</code>, <code>formArrayName</code> åªèƒ½ç”¨åœ¨ <code>formGroup</code> æŒ‡ä»¤è¦†ç›–çš„èŒƒå›´å†…</li></ul><h2 id="æŒ‡ä»¤å¯¹ç…§è¡¨"><a href="#æŒ‡ä»¤å¯¹ç…§è¡¨" class="headerlink" title="æŒ‡ä»¤å¯¹ç…§è¡¨"></a>æŒ‡ä»¤å¯¹ç…§è¡¨</h2><table><thead><tr><th>ç±»å</th><th>æ¨¡æ¿å¼è¡¨å•æŒ‡ä»¤</th><th>å“åº”å¼è¡¨å•æŒ‡ä»¤</th></tr></thead><tbody><tr><td>FormGroup</td><td>ngFrom <br> ngModelGroup</td><td>formGroup <br> formGroupName</td></tr><tr><td>FormControl</td><td>ngModel</td><td>formControl <br> formControlName</td></tr><tr><td>FormArray</td><td></td><td>formArrayName</td></tr></tbody></table><h2 id="æ ¡éªŒ"><a href="#æ ¡éªŒ" class="headerlink" title="æ ¡éªŒ"></a>æ ¡éªŒ</h2><ul><li><code>formControl</code> æ ¡éªŒå™¨</li></ul><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mobileValidator</span>(<span class="params">control: FormControl</span>): <span class="title">any</span> </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> value = (control.value || <span class="string">''</span>) + <span class="string">''</span>;</span><br><span class="line">  <span class="keyword">var</span> mobileReg = <span class="regexp">/^(((13[0-9]&#123;1&#125;)|(15[0-9]&#123;1&#125;)|(18[0-9]&#123;1&#125;))+\d&#123;8&#125;)$/</span>;</span><br><span class="line">  <span class="keyword">let</span> valid = mobileReg.test(value);</span><br><span class="line">  <span class="keyword">return</span> valid ? <span class="literal">null</span> : &#123; mobile: <span class="literal">true</span> &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>formGroup</code> æ ¡éªŒå™¨</li></ul><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">equalValidator</span>(<span class="params">group: FormGroup</span>): <span class="title">any</span> </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> password: FormControl = group.get(<span class="string">'password'</span>) <span class="keyword">as</span> FormControl;</span><br><span class="line">  <span class="keyword">let</span> pconfirm: FormControl = group.get(<span class="string">'pconfirm'</span>) <span class="keyword">as</span> FormControl;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> valid: <span class="built_in">boolean</span> = <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">if</span> (password &amp;&amp; pconfirm) &#123;</span><br><span class="line">    valid = password.value === pconfirm.value;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> valid ? <span class="literal">null</span> : &#123; equal: &#123; description: <span class="string">'å¯†ç å’Œç¡®è®¤å¯†ç ä¸åŒ¹é…!'</span> &#125; &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å¼‚æ­¥æ ¡éªŒå™¨ (è¿”å› <code>observable</code>)</li></ul><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mobileAsyncValidator</span>(<span class="params">control: FormControl</span>): <span class="title">any</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> Observable.of(valid ? <span class="literal">null</span> : &#123; mobile: <span class="literal">true</span> &#125;).delay(<span class="number">5000</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>åœ¨ å“åº”å¼è¡¨å•ä¸­ ä½¿ç”¨</li></ul><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">constructor</span>(<span class="params">fb: FormBuilder</span>) &#123;</span><br><span class="line">  <span class="keyword">this</span>.formModel = fb.group(&#123;</span><br><span class="line">    <span class="comment">//     åˆå§‹å€¼    åŒæ­¥æ ¡éªŒå™¨        å¼‚æ­¥æ ¡éªŒå™¨</span></span><br><span class="line">    mobile: [<span class="string">''</span>, mobileValidator, mobileAsyncValidator],</span><br><span class="line">    <span class="comment">//               å¤šä¸ªåŒæ­¥æ ¡éªŒå™¨</span></span><br><span class="line">    username: [<span class="string">''</span>, [Validators.required, Validators.minLength(<span class="number">5</span>)]],</span><br><span class="line">    passwordsGroup: fb.group(</span><br><span class="line">      &#123;</span><br><span class="line">        password: [<span class="string">''</span>, Validators.minLength(<span class="number">6</span>)],</span><br><span class="line">        pconfirm: [<span class="string">''</span>],</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="comment">// formGroup æ ¡éªŒå™¨</span></span><br><span class="line">      &#123; validator: equalValidator &#125;</span><br><span class="line">    ),</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">onSubmit() &#123;</span><br><span class="line">  <span class="keyword">let</span> isValid: <span class="built_in">boolean</span> = <span class="keyword">this</span>.formModel.get(<span class="string">'username'</span>).valid;</span><br><span class="line">  <span class="keyword">let</span> errors: <span class="built_in">any</span> = <span class="keyword">this</span>.formModel.get(<span class="string">'username'</span>).errors;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.formModel.valid) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.formModel.value);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> [<span class="attr">formGroup</span>]=<span class="string">"formModel"</span> (<span class="attr">submit</span>)=<span class="string">"onSubmit()"</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- åŒæ­¥æ ¡éªŒ --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> [<span class="attr">hidden</span>]=<span class="string">"formModel.get('username').valid || formModel.get('username').untouched"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- hasErrorçš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ æ ¡éªŒå™¨è¿”å›çš„å¯¹è±¡çš„key, ä¸æ˜¯æ ¡éªŒå™¨çš„åç§° --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> [<span class="attr">hidden</span>]=<span class="string">"!formModel.hasError('required', 'username')"</span>&gt;</span></span><br><span class="line">      ç”¨æˆ·åæ˜¯å¿…å¡«é¡¹</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> [<span class="attr">hidden</span>]=<span class="string">"!formModel.hasError('minlength', 'username')"</span>&gt;</span></span><br><span class="line">      ç”¨æˆ·åæœ€å°é•¿åº¦æ˜¯5</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- å¼‚æ­¥æ ¡éªŒ --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">      æ‰‹æœºå·:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"number"</span> <span class="attr">formControlName</span>=<span class="string">"mobile"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> [<span class="attr">hidden</span>]=<span class="string">"!formModel.get('mobile').pending"</span>&gt;</span></span><br><span class="line">    æ­£åœ¨æ ¡éªŒæ‰‹æœºå·åˆæ³•æ€§</span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> [<span class="attr">hidden</span>]=<span class="string">"formModel.get('mobile').valid || formModel.get('mobile').pristine"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> [<span class="attr">hidden</span>]=<span class="string">"!formModel.hasError('mobile', 'mobile')"</span>&gt;</span></span><br><span class="line">      è¯·è¾“å…¥æ­£ç¡®çš„æ‰‹æœºå·</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- formGroup æ ¡éªŒ --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">formGroupName</span>=<span class="string">"passwordsGroup"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>å¯†ç :<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">formControlName</span>=<span class="string">"password"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> [<span class="attr">hidden</span>]=<span class="string">"!formModel.hasError('minlength', ['passwordsGroup','password'])"</span>&gt;</span></span><br><span class="line">      å¯†ç æœ€å°é•¿åº¦æ˜¯6</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>ç¡®è®¤å¯†ç :<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">formControlName</span>=<span class="string">"pconfirm"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> [<span class="attr">hidden</span>]=<span class="string">"!formModel.hasError('equal', 'passwordsGroup')"</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- ä»æ ¡éªŒå™¨ä¸­è·å–é”™è¯¯ä¿¡æ¯ --&gt;</span></span><br><span class="line">      &#123;&#123;formModel.getError('equal', 'passwordsGroup')?.description&#125;&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>åœ¨ æ¨¡æ¿å¼è¡¨å• ä½¿ç”¨</li></ul><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å…ˆå°è£…æˆä¸€ä¸ª æŒ‡ä»¤</span></span><br><span class="line"><span class="meta">@Directive</span>(&#123;</span><br><span class="line">  <span class="comment">//       ä¸­æ‹¬å· æ‹¬èµ·æ¥</span></span><br><span class="line">  selector: <span class="string">'[mobile]'</span>,</span><br><span class="line">  <span class="comment">//            provide æ˜¯å›ºå®šçš„        useValue ä» validator å¼•å…¥    multi: true</span></span><br><span class="line">  providers: [&#123; provide: NG_VALIDATORS, useValue: mobileValidator, multi: <span class="literal">true</span> &#125;],</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> MobileValidatorDirective &#123;</span><br><span class="line">  <span class="keyword">constructor</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">constructor</span>(<span class="params"></span>) &#123; &#125;</span><br><span class="line">ngOnInit() &#123;&#125;</span><br><span class="line"></span><br><span class="line">onSubmit(value:<span class="built_in">any</span>, valid:<span class="built_in">boolean</span>)&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(valid);</span><br><span class="line">  <span class="built_in">console</span>.log(value);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">usernameValid:<span class="built_in">boolean</span> = <span class="literal">true</span>;</span><br><span class="line">usernameUntouched:<span class="built_in">boolean</span> = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¨¡æ¿å¼è¡¨å•è·å– çŠ¶æ€</span></span><br><span class="line">onUsernameInput(form:NgForm) &#123;</span><br><span class="line">  <span class="keyword">if</span>(form) &#123;</span><br><span class="line">    <span class="keyword">this</span>.usernameValid = form.form.get(<span class="string">"username"</span>).valid;</span><br><span class="line">    <span class="keyword">this</span>.usernameUntouched = form.form.get(<span class="string">"username"</span>).untouched;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">                                        <span class="comment">&lt;!-- ä¼ é€’è¡¨å•å€¼      ä¼ é€’è¡¨å•çŠ¶æ€  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> #<span class="attr">myForm</span>=<span class="string">"ngForm"</span> (<span class="attr">ngSubmit</span>)=<span class="string">"onSubmit(myForm.value, myForm.valid)"</span> <span class="attr">novalidate</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>ç”¨æˆ·å:<span class="tag">&lt;<span class="name">input</span> <span class="attr">ngModel</span> <span class="attr">required</span> <span class="attr">minlength</span>=<span class="string">"6"</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">type</span>=<span class="string">"text"</span></span></span><br><span class="line"><span class="tag">  (<span class="attr">input</span>)=<span class="string">"onUsernameInput(myForm)"</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- æ¨¡æ¿å¼è¡¨å•è·å– çŠ¶æ€ --&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> [<span class="attr">hidden</span>]=<span class="string">"usernameValid || usernameUntouched"</span>&gt;</span></span><br><span class="line">                    <span class="comment">&lt;!-- myForm.form --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> [<span class="attr">hidden</span>]=<span class="string">"!myForm.form.hasError('required','username')"</span>&gt;</span></span><br><span class="line">      ç”¨æˆ·åæ˜¯å¿…å¡«é¡¹</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> [<span class="attr">hidden</span>]=<span class="string">"!myForm.form.hasError('minlength','username')"</span>&gt;</span></span><br><span class="line">      ç”¨æˆ·åæœ€å°é•¿åº¦æ˜¯6</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="å’ŒæœåŠ¡å™¨é€šè®¯"><a href="#å’ŒæœåŠ¡å™¨é€šè®¯" class="headerlink" title="å’ŒæœåŠ¡å™¨é€šè®¯"></a>å’ŒæœåŠ¡å™¨é€šè®¯</h1><p><code>HttpClient</code></p><h1 id="build"><a href="#build" class="headerlink" title="build"></a>build</h1><ol><li><p>æ·»åŠ ç¯å¢ƒé…ç½®(å¦‚ <code>staging</code>)<br>ç¼–è¾‘ <code>angular.json</code>, ä»¿ç…§ <code>projects.architect.build.configurations.staging</code> ä¸‹æ·»åŠ ç¯å¢ƒå˜é‡</p></li><li><p><code>build</code> çš„æ—¶å€™åŠ å…¥ <code>--configuration</code></p></li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#                ä½¿ç”¨å“ªä¸ª config          è¾“å‡ºè·¯å¾„</span></span><br><span class="line">ng build --prod --configuration=<span class="variable">$&#123;env&#125;</span> --output-path dist</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> angular </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RxJS v6 dash æ–‡æ¡£</title>
      <link href="/2018/08/31/dash-rxjs-6/"/>
      <url>/2018/08/31/dash-rxjs-6/</url>
      
        <content type="html"><![CDATA[<p>Dash åªèƒ½æ‰¾åˆ°ç‰ˆæœ¬ä¸ºV5çš„ RxJS, æ‰€ä»¥èŠ±äº†ç‚¹æ—¶é—´è‡ªå·±æ„å»ºäº†ä¸€ä¸ªV6ç‰ˆæœ¬<br><a id="more"></a></p><h1 id="rxjs6-docsetæˆå“ä¸‹è½½åœ°å€"><a href="#rxjs6-docsetæˆå“ä¸‹è½½åœ°å€" class="headerlink" title="rxjs6.docsetæˆå“ä¸‹è½½åœ°å€"></a><code>rxjs6.docset</code>æˆå“ä¸‹è½½åœ°å€</h1><p><a href="https://github.com/xinshangshangxin/dash-rxjs-6/releases" target="_blank" rel="noopener">rxjs6.docset.zip</a></p><h1 id="ä»£ç ä»“åº“"><a href="#ä»£ç ä»“åº“" class="headerlink" title="ä»£ç ä»“åº“"></a>ä»£ç ä»“åº“</h1><p><a href="https://github.com/xinshangshangxin/dash-rxjs-6" target="_blank" rel="noopener">https://github.com/xinshangshangxin/dash-rxjs-6</a></p><h1 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h1><p>ä» <a href="https://kapeli.com/docsets#dashDocset" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£ Any HTML Documentation</a> å¯çŸ¥, åªè¦æœ‰ HTML, å°±å¯ä»¥è½»æ¾æ„å»º Dash æ–‡æ¡£</p><h1 id="æ­¥éª¤"><a href="#æ­¥éª¤" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h1><h2 id="åˆ›å»ºæ–‡ä»¶å¤¹-lt-docset-name-gt-docset-Contents-Resources-Documents"><a href="#åˆ›å»ºæ–‡ä»¶å¤¹-lt-docset-name-gt-docset-Contents-Resources-Documents" class="headerlink" title="åˆ›å»ºæ–‡ä»¶å¤¹ &lt;docset name&gt;.docset/Contents/Resources/Documents/"></a>åˆ›å»ºæ–‡ä»¶å¤¹ <code>&lt;docset name&gt;.docset/Contents/Resources/Documents/</code></h2><h2 id="åˆ›å»º-Info-plist-æ–‡ä»¶-å’Œ-icon-png"><a href="#åˆ›å»º-Info-plist-æ–‡ä»¶-å’Œ-icon-png" class="headerlink" title="åˆ›å»º Info.plist æ–‡ä»¶ å’Œ icon.png"></a>åˆ›å»º <code>Info.plist</code> æ–‡ä»¶ å’Œ <code>icon.png</code></h2><p><code>Info.plist</code> çš„æ¨¡æ¿ åœ¨ <a href="https://kapeli.com/resources/Info.plist" target="_blank" rel="noopener"><code>https://kapeli.com/resources/Info.plist</code></a></p><h2 id="ä»-https-rxjs-dev-firebaseapp-com-api-è§£ææœ‰å“ªäº›-API"><a href="#ä»-https-rxjs-dev-firebaseapp-com-api-è§£ææœ‰å“ªäº›-API" class="headerlink" title="ä» https://rxjs-dev.firebaseapp.com/api è§£ææœ‰å“ªäº› API"></a>ä» <a href="https://rxjs-dev.firebaseapp.com/api" target="_blank" rel="noopener"><code>https://rxjs-dev.firebaseapp.com/api</code></a> è§£ææœ‰å“ªäº› API</h2><p>ä» <code>Network</code> ä¸­å¯ä»¥ çœ‹åˆ° ä¸€ä¸ª <code>/generated/docs/api/api-list.json</code>çš„è¯·æ±‚, é‡Œé¢æœ‰æ¯ä¸ª <code>API</code> å†…å®¹, å¦‚ä¸‹å›¾</p><figure class="image-box">                <img src="/img/dash-rxjs-6/001.png" alt="api-json" title="" class="">                <p>api-json</p>            </figure><h2 id="åˆ›å»º-SQLite-Index"><a href="#åˆ›å»º-SQLite-Index" class="headerlink" title="åˆ›å»º SQLite Index"></a>åˆ›å»º <code>SQLite Index</code></h2><p>å°†ä¸Šé¢ <code>api-json</code> çš„å†…å®¹ åˆ›å»ºåˆ° <code>SQLite Index</code><br><code>CREATE TABLE searchIndex(id INTEGER PRIMARY KEY, name TEXT, type TEXT, path TEXT);</code></p><h2 id="åˆ›å»º-æ¯ä¸ª-API-çš„-html-ç•Œé¢"><a href="#åˆ›å»º-æ¯ä¸ª-API-çš„-html-ç•Œé¢" class="headerlink" title="åˆ›å»º æ¯ä¸ª API çš„ html ç•Œé¢"></a>åˆ›å»º æ¯ä¸ª API çš„ <code>html</code> ç•Œé¢</h2><ul><li>ä» <code>api-json</code> çš„å†…å®¹ä¸­ æœ‰ <code>path</code> å±æ€§, å¯ä»¥è¯·æ±‚æ¯ä¸ªç•Œé¢çš„è¯¦ç»†å†…å®¹(<code>content</code>å±æ€§)<br><img src="/img/dash-rxjs-6/002.png" alt="api-json"></li><li>ä» <a href="https://github.com/ReactiveX/rxjs/blob/73bfa92499b9e6f7b07346f052b3eee5c1acd06d/docs_app/src/app/custom-elements/code/pretty-printer.service.ts" target="_blank" rel="noopener"><code>ReactiveX/rxjs</code>çš„ä»“åº“ä¸­</a> å‘ç° ç”¨äº† <code>assets/js/prettify.js</code>æ¥æ ¼å¼åŒ–ä»£ç , æ‰€ä»¥ç›¸åŒçš„, åœ¨æˆ‘ä»¬åˆ›å»ºçš„ html ç•Œé¢ä¸­éœ€è¦ prettify æ¥æ ¼å¼åŒ–ä»£ç æ˜¾ç¤º, ä»£ç å¦‚ä¸‹</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> codeEleList = <span class="built_in">document</span>.querySelectorAll(<span class="string">'body code-example'</span>);</span><br><span class="line">[...codeEleList].forEach(<span class="function">(<span class="params">ele</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> html = <span class="built_in">window</span>.prettyPrintOne(ele.innerHTML, <span class="string">'javascript'</span>, <span class="literal">false</span>);</span><br><span class="line">  ele.innerHTML = <span class="string">`&lt;aio-code&gt;</span></span><br><span class="line"><span class="string">  &lt;pre class="prettyprint lang-javascript"&gt;</span></span><br><span class="line"><span class="string">    &lt;code class="animated fadeIn"&gt;<span class="subst">$&#123;html&#125;</span></span></span><br><span class="line"><span class="string">    &lt;/code&gt;</span></span><br><span class="line"><span class="string">  &lt;/pre&gt;</span></span><br><span class="line"><span class="string">&lt;/aio-code&gt;`</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><ul><li>ç”±äºæ˜¯ç¦»çº¿æ–‡æ¡£, æ‰€ä»¥åœ¨ html ä¸­æ‰€æœ‰çš„åœ°å€éƒ½è¦è½¬åŒ–æˆç›¸å¯¹è·¯å¾„, ä»£ç å¦‚ä¸‹</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> depth = location.href.replace(<span class="regexp">/.*\/api\//</span>, <span class="string">''</span>).split(<span class="string">'/'</span>).length;</span><br><span class="line"><span class="keyword">let</span> aEleList = <span class="built_in">document</span>.querySelectorAll(<span class="string">'a'</span>);</span><br><span class="line">[...aEleList].forEach(<span class="function">(<span class="params">ele</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> href = ele.href;</span><br><span class="line">  <span class="keyword">if</span> (<span class="regexp">/\/api\//</span>.test(href)) &#123;</span><br><span class="line">    <span class="keyword">let</span> depthStr = <span class="keyword">new</span> <span class="built_in">Array</span>(depth).fill(<span class="string">'..'</span>).join(<span class="string">'/'</span>);</span><br><span class="line">    <span class="keyword">let</span> [preUrl, anchor = <span class="string">''</span>] = href.split(<span class="string">'#'</span>);</span><br><span class="line">    ele.href = preUrl.replace(<span class="regexp">/.*\/api\//</span>, <span class="string">`<span class="subst">$&#123;depthStr&#125;</span>/api/`</span>) + <span class="string">'.html'</span> + <span class="string">'#'</span> + anchor;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="æ›´å¤šå…·ä½“å®ç°è¯·çœ‹ä»£ç "><a href="#æ›´å¤šå…·ä½“å®ç°è¯·çœ‹ä»£ç " class="headerlink" title="æ›´å¤šå…·ä½“å®ç°è¯·çœ‹ä»£ç "></a>æ›´å¤šå…·ä½“å®ç°è¯·çœ‹ä»£ç </h2><p><a href="https://github.com/xinshangshangxin/dash-rxjs-6" target="_blank" rel="noopener">https://github.com/xinshangshangxin/dash-rxjs-6</a></p><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><ul><li><a href="https://kapeli.com/docsets#dashDocset" target="_blank" rel="noopener">Any HTML Documentation</a></li><li><a href="https://github.com/ReactiveX/rxjs" target="_blank" rel="noopener">ReactiveX/rxjs</a></li><li><a href="https://rxjs-dev.firebaseapp.com/" target="_blank" rel="noopener">rxjs-dev æ–‡æ¡£</a><br><br></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong></p></blockquote><blockquote><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANG æ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
            <tag> rxjs </tag>
            
            <tag> RxJS </tag>
            
            <tag> dash </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RxJS å­¦ä¹ ç¬”è®°</title>
      <link href="/2018/08/30/lean-rxjs/"/>
      <url>/2018/08/30/lean-rxjs/</url>
      
        <content type="html"><![CDATA[<p><code>30 å¤©ç²¾é€š RxJS</code> çš„è¯»ä¹¦ç¬”è®°<br><a id="more"></a></p><h1 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„"></a>æ³¨æ„</h1><p>æœ¬æ–‡ç« ä¸ºå°æ¹¾åŒèƒå†™çš„ <a href="https://ithelp.ithome.com.tw/articles/10186103" target="_blank" rel="noopener">30 å¤©ç²¾é€š RxJS</a> çš„è¯»ä¹¦ç¬”è®°,  å»ºè®®é˜…è¯» <code>30 å¤©ç²¾é€š RxJS</code><a href="https://ithelp.ithome.com.tw/articles/10186103" target="_blank" rel="noopener">(å¢™å¤–åœ°å€)</a>/<a href="https://rxjs-cn.github.io/rxjs5-ultimate-cn/content/hot-n-cold-observables.html" target="_blank" rel="noopener">(gitbookåœ°å€)</a> æ¥å­¦ä¹  <code>RxJS</code></p><h1 id="RxJS-ä¸€ä¸ªæ ¸å¿ƒä¸‰ä¸ªé‡ç‚¹"><a href="#RxJS-ä¸€ä¸ªæ ¸å¿ƒä¸‰ä¸ªé‡ç‚¹" class="headerlink" title="RxJS ä¸€ä¸ªæ ¸å¿ƒä¸‰ä¸ªé‡ç‚¹"></a>RxJS ä¸€ä¸ªæ ¸å¿ƒä¸‰ä¸ªé‡ç‚¹</h1><ul><li>æ ¸å¿ƒ: <code>Observable</code> å†åŠ ä¸Šç›¸å…³çš„ <code>Operators</code> (<code>map</code>, <code>filter</code>, <code>...</code>)</li><li>ä¸‰ä¸ªé‡ç‚¹:<ul><li><code>Observer</code>(è§‚å¯Ÿè€…)</li><li><code>Subject</code></li><li><code>Schedulers</code></li></ul></li></ul><h1 id="åè¯è§£é‡Š"><a href="#åè¯è§£é‡Š" class="headerlink" title="åè¯è§£é‡Š"></a>åè¯è§£é‡Š</h1><table><thead><tr><th>åç§°</th><th>ä¸­æ–‡</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td><code>Observer Pattern</code></td><td>è§‚å¯Ÿè€…æ¨¡å¼</td><td>DOM çš„äº‹ä»¶ç›‘å¬(<code>addEventListener</code>)</td></tr><tr><td><code>Iterator Pattern</code></td><td>è¿­ä»£å™¨æ¨¡å¼</td><td>ES6 çš„åŸç”Ÿçš„ <code>Iterator</code></td></tr><tr><td><code>Observable</code></td><td>å¯è§‚å¯Ÿå¯¹è±¡</td><td><code>Observer Pattern</code> æ˜¯é ç”Ÿäº§è€…æ¨é€èµ„æ–™<br><code>Iterator Pattern</code> åˆ™æ˜¯æ¶ˆè´¹è€…å»è¦æ±‚èµ„æ–™<br>è€Œ <code>Observable</code> æ˜¯è¿™ä¸¤ä¸ªæ€æƒ³çš„ç»“åˆ</td></tr><tr><td><code>Observer</code></td><td>è§‚å¯Ÿè€…</td><td>æ³¨æ„å’Œ<code>Observer Pattern</code>åŒºåˆ†</td></tr></tbody></table><h1 id="Observer"><a href="#Observer" class="headerlink" title="Observer"></a><code>Observer</code></h1><p><strong> <code>Observer</code>(è§‚å¯Ÿè€…) è·Ÿå’Œ <code>Observer Pattern</code>(è§‚å¯Ÿè€…æ¨¡å¼) æ— å…³ï¼Œè§‚å¯Ÿè€…æ¨¡å¼æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œæ˜¯æ€è€ƒé—®é¢˜çš„è§£å†³è¿‡ç¨‹ï¼Œè€Œ <code>Observer</code>(è§‚å¯Ÿè€…) æ˜¯ä¸€ä¸ªè¢«å®šä¹‰çš„å¯¹è±¡</strong></p><h2 id="ä¸‰ä¸ªæ–¹æ³•"><a href="#ä¸‰ä¸ªæ–¹æ³•" class="headerlink" title="ä¸‰ä¸ªæ–¹æ³•"></a>ä¸‰ä¸ªæ–¹æ³•</h2><ul><li>next: æ¯å½“ Observable å‘é€å‡ºæ–°çš„å€¼,next æ–¹æ³•å°±ä¼šè¢«å‘¼å«</li><li>complete: åœ¨ Observable æ²¡æœ‰å…¶ä»–çš„èµ„æ–™å¯ä»¥å–å¾—æ—¶,complete æ–¹æ³•å°±ä¼šè¢«å‘¼å«,åœ¨ complete è¢«å‘¼å«ä¹‹å,next æ–¹æ³•å°±ä¸ä¼šå†èµ·ä½œç”¨</li><li>error: æ¯å½“ Observable å†…å‘ç”Ÿé”™è¯¯æ—¶,error æ–¹æ³•å°±ä¼šè¢«å‘¼å«</li></ul><h2 id="å¯Ÿè€…å¯ä»¥æ˜¯ä¸å®Œæ•´çš„ï¼Œå¯ä»¥åªå…·æœ‰ä¸€ä¸ª-next-æ–¹æ³•"><a href="#å¯Ÿè€…å¯ä»¥æ˜¯ä¸å®Œæ•´çš„ï¼Œå¯ä»¥åªå…·æœ‰ä¸€ä¸ª-next-æ–¹æ³•" class="headerlink" title="å¯Ÿè€…å¯ä»¥æ˜¯ä¸å®Œæ•´çš„ï¼Œå¯ä»¥åªå…·æœ‰ä¸€ä¸ª next æ–¹æ³•"></a>å¯Ÿè€…å¯ä»¥æ˜¯ä¸å®Œæ•´çš„ï¼Œå¯ä»¥åªå…·æœ‰ä¸€ä¸ª <code>next</code> æ–¹æ³•</h2><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Observable &#125; <span class="keyword">from</span> <span class="string">'rxjs'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> observable = Observable.create(<span class="function">(<span class="params">observer</span>) =&gt;</span> &#123;</span><br><span class="line">  observer.next(<span class="string">'Jerry'</span>);</span><br><span class="line">  observer.next(<span class="string">'Anna'</span>);</span><br><span class="line">  observer.complete();</span><br><span class="line">  observer.next(<span class="string">'not work'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºä¸€ä¸ªè§‚å¯Ÿè€…ï¼Œå…·æœ‰ next, error, complete ä¸Šä¸ªæ–¹æ³•</span></span><br><span class="line"><span class="keyword">let</span> observer = &#123;</span><br><span class="line">  next(value) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(value);</span><br><span class="line">  &#125;,</span><br><span class="line">  error(error) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(error);</span><br><span class="line">  &#125;,</span><br><span class="line">  complete() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'complete'</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">observable.subscribe(observer);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Jerry</span></span><br><span class="line"><span class="comment">Anna</span></span><br><span class="line"><span class="comment">complete</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h1 id="Observable-çš„è®¢é˜…è·Ÿ-addEventListener-çš„å·®å¼‚"><a href="#Observable-çš„è®¢é˜…è·Ÿ-addEventListener-çš„å·®å¼‚" class="headerlink" title="Observable çš„è®¢é˜…è·Ÿ addEventListener çš„å·®å¼‚"></a><code>Observable</code> çš„è®¢é˜…è·Ÿ <code>addEventListener</code> çš„å·®å¼‚</h1><ul><li><code>addEventListener</code> æœ¬è´¨ä¸Šå°±æ˜¯ <code>Observer Pattern</code> çš„å®ç°,åœ¨å†…éƒ¨ä¼šæœ‰ä¸€ä»½è®¢é˜…æ¸…å•</li><li><code>Observable</code> çš„è®¢é˜… æ¯”è¾ƒåƒæ˜¯æ‰§è¡Œä¸€ä¸ªç‰©ä»¶çš„æ–¹æ³•,å¹¶æŠŠèµ„æ–™ä¼ è¿›è¿™ä¸ªæ–¹æ³•ä¸­</li></ul><h1 id="Observable-å’Œ-Iterator-çš„å·®å¼‚"><a href="#Observable-å’Œ-Iterator-çš„å·®å¼‚" class="headerlink" title="Observable å’Œ Iterator çš„å·®å¼‚"></a><code>Observable</code> å’Œ <code>Iterator</code> çš„å·®å¼‚</h1><ul><li>å»¶è¿Ÿè¿ç®—</li><li>æ¸è¿›å¼å–å€¼</li></ul><h1 id="Observable-çš„-static-function"><a href="#Observable-çš„-static-function" class="headerlink" title="Observable çš„ static function"></a>Observable çš„ <code>static function</code></h1><ul><li><code>Observable.create</code> ä¼ å…¥ä¸€ä¸ª<code>callback function</code>, è¿™ä¸ª <code>callback function</code> ä¼šæ¥æ”¶ä¸€ä¸ª<code>observer</code> å‚æ•°</li><li><code>Observable.throw</code> åˆ›å»ºä¸€ä¸ªä¸å‘é€æ•°æ®ç»™è§‚å¯Ÿè€…å¹¶ä¸”ç«‹é©¬å‘å‡ºé”™è¯¯é€šçŸ¥çš„ <code>Observable</code></li><li><code>Observable.pipe</code> å°†ä¸€ç³»åˆ—çš„æ“ä½œå‡½æ•° å˜æˆ <code>chain</code> çš„æ–¹å¼</li></ul><h1 id="åˆ›å»ºå®ä¾‹"><a href="#åˆ›å»ºå®ä¾‹" class="headerlink" title="åˆ›å»ºå®ä¾‹"></a>åˆ›å»ºå®ä¾‹</h1><p><strong><code>import { of, from, fromEvent } from &#39;rxjs&#39;</code></strong></p><ul><li>of</li><li>from</li><li>fromEvent</li><li>fromEventPattern (<em>åŒæ—¶å…·æœ‰æ³¨å†Œç›‘å¬åŠç§»é™¤ç›‘å¬ä¸¤ç§è¡Œä¸º</em>)</li><li>fromPromise</li><li>never (<em>ä¸€ç›´å­˜åœ¨ä½†å´ä»€ä¹ˆéƒ½ä¸åšçš„ observable</em>)</li><li>empty (<em>ç«‹å³é€å‡º complete</em>)</li><li>throw (<em>ç«‹å³æŠ›å‡ºé”™è¯¯</em>)</li><li>interval (<em>æ¯éš” X æ¯«ç§’é€å‡ºä¸€ä¸ªä»é›¶å¼€å§‹é€’å¢çš„æ•´æ•°</em>)</li><li>timer (<em>ç¬¬ä¸€ä¸ªå‚æ•°è¦å‘å‡ºç¬¬ä¸€ä¸ªå€¼çš„ç­‰å¾…æ—¶é—´(ms)ï¼Œç¬¬äºŒä¸ªå‚æ•°ç¬¬ä¸€æ¬¡ä¹‹åå‘é€å€¼çš„é—´éš”æ—¶é—´</em>) | (<em>ç¬¬ä¸€ä¸ªå‚æ•°æ—¥æœŸ(Date)ç­‰åˆ°æŒ‡å®šçš„æ—¶é—´åœ¨å‘é€ç¬¬ä¸€ä¸ªå€¼ï¼Œç¬¬äºŒä¸ªå‚æ•°ç¬¬ä¸€æ¬¡ä¹‹åå‘é€å€¼çš„é—´éš”æ—¶é—´</em>) | (<em>åªæ¥æ”¶ä¸€ä¸ªå‚æ•°, ç­‰å¾…ç¬¬ä¸€ä¸ªå‚æ•°æ—¶å€™åé€šçŸ¥ç»“æŸ</em>)</li></ul><h1 id="è®¢é˜…"><a href="#è®¢é˜…" class="headerlink" title="è®¢é˜…"></a>è®¢é˜…</h1><ul><li>è®¢é˜… <code>observable</code> åï¼Œä¼šå›ä¼ ä¸€ä¸ª <code>subscription</code> ç‰©ä»¶ï¼Œè¿™ä¸ªç‰©ä»¶å…·æœ‰é‡Šæ”¾èµ„æºçš„<code>unsubscribe</code>æ–¹æ³•</li><li><code>Events observable</code> å°½é‡ä¸è¦ç”¨ <code>unsubscribe</code>ï¼Œé€šå¸¸æˆ‘ä»¬ä¼šä½¿ç”¨ <code>takeUntil</code>ï¼Œåœ¨æŸä¸ªäº‹ä»¶å‘ç”Ÿåæ¥å®Œæˆ <code>Event observable</code></li></ul><h1 id="operators"><a href="#operators" class="headerlink" title="operators"></a>operators</h1><p><strong><a href="http://rxmarbles.com/" target="_blank" rel="noopener">ç å®å›¾ http://rxmarbles.com/</a></strong></p><p><strong>!!! æ¯ä¸ª operator éƒ½ä¼šå›ä¼ ä¸€ä¸ªæ–°çš„ observable</strong></p><ul><li>map</li><li>mapTo</li><li>filter</li><li>take</li><li>first</li><li>takeUntil</li><li>skip</li><li>takeLast å¿…é¡»ç­‰åˆ°æ•´ä¸ª<code>observable</code>å®Œæˆ(complete)ï¼Œæ‰èƒ½çŸ¥é“æœ€åçš„å…ƒç´ æœ‰å“ªäº›ï¼Œå¹¶ä¸”<strong>åŒæ­¥é€å‡º</strong></li><li>last</li><li>concat æŠŠå¤šä¸ª <code>observable</code> å®ä¾‹åˆå¹¶æˆä¸€ä¸ª, ç­‰å‰ä¸€ä¸ª <code>observable</code>å®Œæˆ,æ‰ä¼šç»§ç»­ä¸‹ä¸€ä¸ª</li><li>startWith ä¸€å¼€å§‹å°±<strong>åŒæ­¥</strong>å‘å‡ºçš„ï¼Œè¿™ä¸ª<code>operator</code>å¸¸è¢«ç”¨æ¥ä¿å­˜ç¨‹å¼çš„èµ·å§‹çŠ¶æ€</li><li>merge æŠŠå¤šä¸ª <code>observable</code> å®ä¾‹åˆå¹¶æˆä¸€ä¸ª, å¤šä¸ª <code>observable</code> åŒæ—¶å¤„ç†</li><li>combineLatest å–å¾—å„ä¸ª <code>observable</code> æœ€åé€å‡ºçš„å€¼ï¼Œå†è¾“å‡ºæˆä¸€ä¸ªå€¼</li><li>zip&lt;T, R&gt;(â€¦observables: Array&lt;ObservableInput<any> | ((â€¦values: Array<any>) =&gt; R)&gt;): Observable<r><br>æ¯ä¸ª <code>observable</code> çš„ç¬¬ n ä¸ªå…ƒç´ ä¼šä¸€èµ·è¾“å‡º</r></any></any></li><li>withLatestFrom&lt;T, R&gt;(â€¦args: Array&lt;ObservableInput<any> | ((â€¦values: Array<any>) =&gt; R)&gt;): OperatorFunction&lt;T, R&gt;<br>å’Œ <code>combineLatest</code> åƒ, åªæœ‰åœ¨ä¸»<code>observable</code> é€å‡ºæ–°çš„å€¼æ—¶ï¼Œæ‰ä¼šæ‰§è¡Œ callback</any></any></li><li>reduce&lt;T, R&gt;(accumulator: (acc: R, value: T, index?: number) =&gt; R, seed?: R): OperatorFunction&lt;T, R&gt;<br>è¿”å›ä¸€ä¸ª<code>reduce</code>ä¹‹åçš„æœ€ç»ˆç»“æœ</li><li>scan&lt;T, R&gt;(accumulator: (acc: R, value: T, index: number) =&gt; R, seed?: T | R): OperatorFunction&lt;T, R&gt;<br> å’Œ<code>reduce</code> ç›¸ä¼¼,  ä½†æ˜¯  è¿”å›æ¯ä¸ªä¸­é—´ç»“æœ</li><li>buffer<t>(closingNotifier: Observable<any>): OperatorFunction&lt;T, T[]&gt;<br>ç¼“å†²æº Observable çš„å€¼ç›´åˆ° closingNotifier å‘å‡º</any></t></li><li>bufferTime<t>(bufferTimeSpan: number): OperatorFunction&lt;T, T[]&gt;<br>åœ¨ç‰¹å®šæ—¶é—´å‘¨æœŸå†…ç¼“å†²æº Observable çš„å€¼</t></li><li>bufferCount<t>(bufferSize: number, startBufferEvery: number = null): OperatorFunction&lt;T, T[]&gt;<br>ç¼“å†²æº Observable çš„å€¼ç›´åˆ°ç¼“å†²æ•°é‡åˆ°è¾¾è®¾å®šçš„ bufferSize.</t></li><li>delay</li><li>delayWhen</li><li>debounce æ¯æ¬¡æ”¶åˆ°å…ƒç´ ï¼Œä»–ä¼šå…ˆæŠŠå…ƒç´  cache ä½å¹¶ç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œå¦‚æœè¿™æ®µæ—¶é—´å†…å·²ç»æ²¡æœ‰æ”¶åˆ°ä»»ä½•å…ƒç´ ï¼Œåˆ™æŠŠå…ƒç´ é€å‡ºï¼›å¦‚æœè¿™æ®µæ—¶é—´å†…åˆæ”¶åˆ°æ–°çš„å…ƒç´ ï¼Œåˆ™ä¼šæŠŠåŸæœ¬ cache ä½çš„å…ƒç´ é‡Šæ”¾æ‰å¹¶é‡æ–°è®¡æ—¶ï¼Œä¸æ–­åè¦†</li><li>debounceTime</li><li>throttle æœ‰å…ƒç´ è¢«é€å‡ºå°±ä¼šæ²‰é»˜ä¸€æ®µæ—¶é—´ï¼Œç­‰åˆ°æ—¶é—´è¿‡äº†åˆä¼šå¼€æ”¾å‘é€å…ƒç´ </li><li>throttleTime</li><li>distinct&lt;T, K&gt;(keySelector?: (value: T) =&gt; K, flushes?: Observable<any>): MonoTypeOperatorFunction<t><br>ä¸è¦ç›´æ¥æŠŠ<code>distinct</code>ç”¨åœ¨ä¸€ä¸ªæ— é™çš„<code>observable</code>é‡Œï¼Œè¿™æ ·å¾ˆå¯èƒ½ä¼šè®© Set è¶Šæ¥è¶Šå¤§</t></any></li><li>distinctUntilChanged</li><li>catchError&lt;T, R&gt;(selector: (err: any, caught: Observable<t>) =&gt; ObservableInput<r>): OperatorFunction&lt;T, T | R&gt;</r></t></li><li>retry</li><li>retryWhen</li><li>repeat</li><li>concatAll <code>source</code> observable å†…éƒ¨æ¯æ¬¡å‘é€çš„å€¼ä¹Ÿæ˜¯<code>observable</code>ï¼Œç”¨ <code>concatAll</code> å°±å¯ä»¥æŠŠ <code>source</code> æ‘Šå¹³; ä¼šå¤„ç† <code>source</code> å…ˆå‘å‡ºæ¥çš„ <code>observable</code>ï¼Œå¿…é¡»ç­‰åˆ°è¿™ä¸ª <code>observable</code> ç»“æŸï¼Œæ‰ä¼šå†å¤„ç†ä¸‹ä¸€ä¸ª<code>source</code>å‘å‡ºæ¥çš„<code>observable</code></li><li>switchAll<t>(): OperatorFunction&lt;ObservableInput<t>, T&gt;<br>æ¯å½“æœ‰æ–°çš„ observable é€å‡ºå°±ä¼šç›´æ¥æŠŠæ—§çš„ observable é€€è®¢(unsubscribe)ï¼Œæ°¸è¿œåªå¤„ç†æœ€æ–°çš„ observable!</t></t></li><li>mergeAll<t>(concurrent: number = Number.POSITIVE_INFINITY): MonoTypeOperatorFunction<t></t></t></li><li>concatMap&lt;T, I, R&gt;(project: (value: T, index: number) =&gt; ObservableInput<i>, resultSelector?: (outerValue: T, innerValue: I, outerIndex: number, innerIndex: number) =&gt; R): OperatorFunction&lt;T, I | R&gt;<br><code>map + concatAll</code><br>ç¡®å®šå†…éƒ¨çš„ observable ç»“æŸæ—¶é—´æ¯”å¤–éƒ¨ observable å‘é€æ—¶é—´æ¥å¿«çš„æƒ…å¢ƒï¼Œå¹¶ä¸”ä¸å¸Œæœ›æœ‰ä»»ä½•å¹¶è¡Œå¤„ç†è¡Œä¸ºï¼Œé€‚åˆå°‘æ•°è¦ä¸€æ¬¡ä¸€æ¬¡å®Œæˆåˆ°åº•çš„çš„ UI åŠ¨ç”»æˆ–ç‰¹åˆ«çš„ HTTP request è¡Œä¸º</i></li><li>switchMap&lt;T, I, R&gt;(project: (value: T, index: number) =&gt; ObservableInput<i>, resultSelector?: (outerValue: T, innerValue: I, outerIndex: number, innerIndex: number) =&gt; R): OperatorFunction&lt;T, I | R&gt;<br><code>map + switchAll</code><br>åªè¦æœ€åä¸€æ¬¡è¡Œä¸ºçš„ç»“æœï¼Œé€‚åˆç»å¤§å¤šæ•°çš„ä½¿ç”¨æƒ…å¢ƒ</i></li><li>mergeMap&lt;T, I, R&gt;(project: (value: T, index: number) =&gt; ObservableInput<i>, resultSelector?: ((outerValue: T, innerValue: I, outerIndex: number, innerIndex: number) =&gt; R) | number, concurrent: number = Number.POSITIVE_INFINITY): OperatorFunction&lt;T, I | R&gt;<br><code>map + mergeAll</code><br>å¹¶è¡Œå¤„ç†å¤šä¸ª observableï¼Œé€‚åˆéœ€è¦å¹¶è¡Œå¤„ç†çš„è¡Œä¸ºï¼Œåƒæ˜¯å¤šä¸ª I/O çš„å¹¶è¡Œå¤„ç†</i></li><li>window<t>(windowBoundaries: Observable<any>): OperatorFunction&lt;T, Observable<t>&gt;<br>æ¯å½“ windowBoundaries å‘å‡ºé¡¹æ—¶ï¼Œå°†æº Observable çš„å€¼åˆ†æ”¯æˆåµŒå¥—çš„ Observable</t></any></t></li><li>windowToggle&lt;T, O&gt;(openings: Observable<o>, closingSelector: (openValue: O) =&gt; Observable<any>): OperatorFunction&lt;T, Observable<t>&gt;<br>å°†æº Observable çš„å€¼åˆ†æ”¯æˆåµŒå¥—çš„ Observableï¼Œåˆ†æ”¯ç­–ç•¥æ˜¯ä»¥ openings å‘å‡ºé¡¹ä¸ºèµ·å§‹ï¼Œä»¥ closingSelector å‘å‡ºä¸ºç»“æŸ</t></any></o></li><li>groupBy&lt;T, K, R&gt;(keySelector: (value: T) =&gt; K, elementSelector?: ((value: T) =&gt; R) | void, durationSelector?: (grouped: GroupedObservable&lt;K, R&gt;) =&gt; Observable<any>, subjectSelector?: () =&gt; Subject<r>): OperatorFunction&lt;T, GroupedObservable&lt;K, R&gt;&gt;<br>æ ¹æ®æŒ‡å®šæ¡ä»¶å°†æº Observable å‘å‡ºçš„å€¼è¿›è¡Œåˆ†ç»„ï¼Œå¹¶å°†è¿™äº›åˆ†ç»„ä½œä¸º GroupedObservables å‘å‡ºï¼Œæ¯ä¸€ä¸ªåˆ†ç»„éƒ½æ˜¯ä¸€ä¸ª GroupedObservable</r></any></li></ul><h1 id="Subject"><a href="#Subject" class="headerlink" title="Subject"></a>Subject</h1><ul><li><code>Subject</code> åŒæ—¶æ˜¯ <code>Observable</code> åˆæ˜¯ <code>Observer</code></li><li><code>Subject</code> ä¼šå¯¹å†…éƒ¨çš„ observers æ¸…å•è¿›è¡Œç»„æ’­(<code>multicast</code>)</li><li><code>Subject</code> å°±æ˜¯ <code>Observer Pattern</code> çš„å®ä½œå¹¶ä¸”ç»§æ‰¿è‡ª <code>Observable</code></li></ul><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Subject &#125; <span class="keyword">from</span> <span class="string">'rxjs'</span>;</span><br><span class="line"><span class="keyword">let</span> subject = <span class="keyword">new</span> Subject();</span><br><span class="line">subject.subscribe(observerA); <span class="comment">// ç›¸å½“äº æŠŠ observerA åŠ å…¥è®¢é˜…æ¸…å•</span></span><br><span class="line">source.subscribe(subject); <span class="comment">//  éå†è®¢é˜…æ¸…å•åå‘é€å½“å‰æ•°æ®</span></span><br></pre></td></tr></table></figure><h2 id="BehaviorSubject"><a href="#BehaviorSubject" class="headerlink" title="BehaviorSubject"></a>BehaviorSubject</h2><p>ä¸€ç§ <code>subject</code> èƒ½å¤Ÿè¡¨è¾¾å½“å‰çš„çŠ¶æ€,åœ¨ä¸€è®¢é˜…æ—¶å°±èƒ½æ”¶åˆ°æœ€æ–°çš„çŠ¶æ€æ˜¯ä»€ä¹ˆ,è€Œä¸æ˜¯è®¢é˜…åè¦ç­‰åˆ°æœ‰å˜åŠ¨æ‰èƒ½æ¥æ”¶åˆ°æ–°çš„çŠ¶æ€</p><h2 id="ReplaySubject"><a href="#ReplaySubject" class="headerlink" title="ReplaySubject"></a>ReplaySubject</h2><p>äº‹ä»¶çš„é‡æ”¾, åœ¨æ–°è®¢é˜…æ—¶é‡æ–°å‘é€æœ€åçš„å‡ ä¸ªå…ƒç´ </p><h2 id="AsyncSubject"><a href="#AsyncSubject" class="headerlink" title="AsyncSubject"></a>AsyncSubject</h2><p>ç­‰åˆ°äº‹æƒ…ç»“æŸåé€å‡ºä¸€ä¸ªå€¼</p><h2 id="å’Œ-Subject-ç›¸å…³çš„-Observable-operators"><a href="#å’Œ-Subject-ç›¸å…³çš„-Observable-operators" class="headerlink" title="å’Œ Subject ç›¸å…³çš„ Observable.operators"></a>å’Œ Subject ç›¸å…³çš„ Observable.operators</h2><ul><li>multicast&lt;T, R&gt;(subjectOrSubjectFactory: Subject<t> | (() =&gt; Subject<t>), selector?: (source: Observable<t>) =&gt; Observable<r>): OperatorFunction&lt;T, R&gt;<br>å¯ä»¥ç”¨æ¥æŒ‚è½½ <code>subject</code> å¹¶å›ä¼ ä¸€ä¸ªå¯è¿ç»“(<code>connectable</code>)çš„ <code>observable</code></r></t></t></t></li></ul><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> source = Observable.multicast(<span class="keyword">new</span> Subject());</span><br><span class="line">source.subscribe(observerA);</span><br><span class="line"><span class="keyword">let</span> realSubscription = source.connect();</span><br><span class="line">realSubscription.unsubscribe();</span><br></pre></td></tr></table></figure><ul><li>refCount<t>(): MonoTypeOperatorFunction<t><br>å»ºç«‹ä¸€ä¸ªåªè¦æœ‰è®¢é˜…å°±ä¼šè‡ªåŠ¨ <code>connect</code> çš„ <code>observable</code>, å¿…é¡»å’Œ <code>multicast</code> ä¸€èµ·ä½¿ç”¨</t></t></li></ul><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> source = Observable.multicast(<span class="keyword">new</span> Subject()).refCount();</span><br><span class="line"><span class="keyword">let</span> subscription = source.subscribe(observerA);</span><br><span class="line">subscription.unsubscribe();</span><br></pre></td></tr></table></figure><ul><li>publish&lt;T, R&gt;(selector?: OperatorFunction&lt;T, R&gt;): MonoTypeOperatorFunction<t> | OperatorFunction&lt;T, R&gt;<br>ç®€åŒ– <code>multicast(new Subject())</code></t></li></ul><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> source = Observable.publish().refCount();</span><br><span class="line"><span class="keyword">let</span> subscription = source.subscribe(observerA);</span><br><span class="line">subscription.unsubscribe();</span><br></pre></td></tr></table></figure><ul><li><p>publishReplay<br><code>multicast(new ReplaySubject(1))</code></p></li><li><p>publishBehavior(0)<br><code>multicast(new BehaviorSubject(0))</code></p></li><li><p>publishLast<br><code>multicast(new AsyncSubject())</code></p></li><li><p>share<br><code>.publish().refCount();</code></p></li></ul><h1 id="Scheduler"><a href="#Scheduler" class="headerlink" title="Scheduler"></a>Scheduler</h1><ul><li><code>Scheduler</code> æ˜¯ä¸€ä¸ªèµ„æ–™ç»“æ„.å®ƒçŸ¥é“å¦‚ä½•æ ¹æ®ä¼˜å…ˆçº§æˆ–å…¶ä»–æ ‡å‡†æ¥å‚¨å­˜å¹¶ä¼«åˆ—ä»»åŠ¡.</li><li><code>Scheduler</code> æ˜¯ä¸€ä¸ªæ‰§è¡Œç¯å¢ƒ.å®ƒæ„å‘³ç€ä»»åŠ¡ä½•æ—¶ä½•åœ°è¢«æ‰§è¡Œï¼Œæ¯”å¦‚åƒæ˜¯ç«‹å³æ‰§è¡Œã€åœ¨å›å‘¼(callback)ä¸­æ‰§è¡Œã€setTimeout ä¸­æ‰§è¡Œã€animation frame ä¸­æ‰§è¡Œ</li><li><code>Scheduler</code> æ˜¯ä¸€ä¸ªè™šæ‹Ÿæ—¶é’Ÿ.å®ƒé€è¿‡ now()è¿™ä¸ªæ–¹æ³•æä¾›äº†æ—¶é—´çš„æ¦‚å¿µï¼Œæˆ‘ä»¬å¯ä»¥è®©ä»»åŠ¡åœ¨ç‰¹å®šçš„æ—¶é—´ç‚¹è¢«æ‰§è¡Œ.</li></ul><h2 id="queue"><a href="#queue" class="headerlink" title="queue"></a>queue</h2><p>åœ¨ä¼šæœ‰é€’å›çš„ operator ä¸”å…·æœ‰å¤§é‡èµ„æ–™æ—¶ä½¿ç”¨ï¼Œåœ¨è¿™ä¸ªæƒ…å†µä¸‹ queue èƒ½é¿å…ä¸å¿…è¦çš„æ•ˆèƒ½æŸè€—</p><h2 id="asap"><a href="#asap" class="headerlink" title="asap"></a>asap</h2><p>asap å› ä¸ºéƒ½æ˜¯åœ¨ setTimeout ä¸­æ‰§è¡Œï¼Œæ‰€ä»¥ä¸ä¼šæœ‰ block event loop çš„é—®é¢˜ï¼Œå¾ˆé€‚åˆç”¨åœ¨æ°¸è¿œä¸ä¼šé€€è®¢çš„ observableï¼Œä¾‹å¦‚åœ¨èƒŒæ™¯ä¸‹æŒç»­ç›‘å¬ server é€æ¥çš„é€šçŸ¥</p><h2 id="async"><a href="#async" class="headerlink" title="async"></a>async</h2><p>asap å¾ˆåƒä½†æ˜¯ä½¿ç”¨ setInterval æ¥è¿ä½œï¼Œé€šå¸¸æ˜¯è·Ÿæ—¶é—´ç›¸å…³çš„ operator æ‰ä¼šç”¨åˆ°</p><h2 id="animationFrame"><a href="#animationFrame" class="headerlink" title="animationFrame"></a>animationFrame</h2><p>åœ¨åšå¤æ‚è¿ç®—ï¼Œä¸”é«˜é¢‘ç‡è§¦å‘çš„ UI åŠ¨ç”»æ—¶ï¼Œå°±å¾ˆé€‚åˆä½¿ç”¨ animationFrameï¼Œä»¥å¯ä»¥æ­é… throttle operator ä½¿ç”¨ã€‚</p><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><ul><li><a href="https://ithelp.ithome.com.tw/articles/10186103" target="_blank" rel="noopener">30 å¤©ç²¾é€š RxJS</a>  </li><li><a href="https://rxjs-cn.github.io/rxjs5-ultimate-cn/content/hot-n-cold-observables.html" target="_blank" rel="noopener">30-days-proficient-in-rxjs</a><br><br></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong></p></blockquote><blockquote><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANG æ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
            <tag> rxjs </tag>
            
            <tag> RxJS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GitLab CI ä¸­ cache å’Œ artifacts çš„åŒºåˆ«</title>
      <link href="/2018/07/21/gitlab-ci-artifacts-cache/"/>
      <url>/2018/07/21/gitlab-ci-artifacts-cache/</url>
      
        <content type="html"><![CDATA[<h2 id="ä½¿ç”¨å‡†åˆ™"><a href="#ä½¿ç”¨å‡†åˆ™" class="headerlink" title="ä½¿ç”¨å‡†åˆ™"></a>ä½¿ç”¨å‡†åˆ™</h2><ul><li>å¦‚æœç¬¬äºŒä¸ª <code>job</code> çš„ä¾èµ–ä¸å­˜åœ¨, <code>job</code> ä¹Ÿèƒ½ç»§ç»­è¿è¡Œ, åˆ™ä½¿ç”¨ <code>cache</code></li><li>å¦‚æœç¬¬äºŒä¸ª <code>job</code> çš„ä¾èµ–å¿…é¡»å­˜åœ¨, åˆ™ ä½¿ç”¨ <code>artifacts</code></li></ul><h2 id="ä¸»è¦åŒºåˆ«"><a href="#ä¸»è¦åŒºåˆ«" class="headerlink" title="ä¸»è¦åŒºåˆ«"></a>ä¸»è¦åŒºåˆ«</h2><ul><li><code>cache</code> ä¸ä¸€å®šå‘½ä¸­, <code>artifacts</code> è‚¯å®šå‘½ä¸­</li><li><code>artifacts</code> å¯ä»¥è®¾ç½®è‡ªåŠ¨è¿‡æœŸæ—¶é—´,è¿‡æœŸè‡ªåŠ¨åˆ é™¤,<code>cache</code> ä¸ä¼šè‡ªåŠ¨æ¸…ç†</li><li>é»˜è®¤ <code>artifacts</code> ä¼šè‡ªåŠ¨åœ¨ä¸åŒçš„ <code>stage</code> ä¸­ä¼ è¾“; <code>artifacts</code> ä¼šå…ˆä¼ åˆ° <code>GitLab</code> æœåŠ¡å™¨, ç„¶åéœ€è¦æ—¶å†é‡æ–°ä¸‹è½½, æ‰€ä»¥è¿™éƒ¨åˆ†ä¹Ÿå¯ä»¥åœ¨ <code>GitLab</code> ä¸‹è½½å’Œæµè§ˆ</li></ul><h2 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h2><ul><li>å¦‚æœ ç¬¬äºŒä¸ª <code>job</code> ä¾èµ– ç¬¬ä¸€ä¸ª <code>job</code> ç”Ÿæˆçš„å†…å®¹, ä½¿ç”¨ <code>cache</code> é€šå¸¸ä¼šå¤±è´¥(å› ä¸ºä¸ä¿è¯ <code>cache</code> å­˜åœ¨), è¿™æ—¶åº”å½“ä½¿ç”¨ <code>artifacts</code>, åœ¨ç¬¬äºŒä¸ª <code>job</code> ä½¿ç”¨ <code>dependencies</code> å±æ€§, è®©ç¬¬äºŒä¸ª <code>job</code> ä½¿ç”¨ç¬¬ä¸€ä¸ª <code>job</code> ä¸­çš„å†…å®¹</li><li>å¦‚æœå‡ ä¸ª <code>jobs</code> éƒ½éœ€è¦å®‰è£…ç›¸åŒçš„ä¾èµ–, å¯ä»¥ä½¿ç”¨ <code>cache</code>, å¯ä»¥åŠ å¿«ä¾èµ–çš„å®‰è£…è¿›åº¦, å³ä½¿ <code>cache</code> ä¸å­˜åœ¨ï¼Œ<code>job</code> ä¹Ÿä¸ä¼šå¤±è´¥</li></ul><h2 id="artifacts-ä½¿ç”¨-demo"><a href="#artifacts-ä½¿ç”¨-demo" class="headerlink" title="artifacts ä½¿ç”¨ demo"></a><code>artifacts</code> ä½¿ç”¨ <code>demo</code></h2><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">image:</span> <span class="attr">docker:latest</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line"><span class="attr">  - docker:</span><span class="string">dind</span></span><br><span class="line"></span><br><span class="line"><span class="attr">variables:</span></span><br><span class="line"><span class="attr">  CONTAINER_IMAGE:</span> <span class="string">registry.gitlab.com/$CI_PROJECT_PATH</span></span><br><span class="line"></span><br><span class="line"><span class="attr">stages:</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">build</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">test</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">deploy</span></span><br><span class="line">  <span class="comment"># personal jobs</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">build_code</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">use_artifacts</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">disable_artifacts</span></span><br><span class="line"></span><br><span class="line"><span class="attr">build_code:</span></span><br><span class="line"><span class="attr">  stage:</span> <span class="string">build_code</span></span><br><span class="line"><span class="attr">  artifacts:</span></span><br><span class="line">    <span class="comment"># ä¿å­˜å‹ç¼©åŒ…çš„åç§°</span></span><br><span class="line"><span class="attr">    name:</span> <span class="string">"$&#123;CI_COMMIT_SHA&#125;"</span></span><br><span class="line">    <span class="comment"># è¦ä¿å­˜çš„æ–‡ä»¶çš„è·¯å¾„</span></span><br><span class="line"><span class="attr">    paths:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">dist/</span></span><br><span class="line"><span class="attr">  script:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">npm</span> <span class="string">run</span> <span class="string">build</span></span><br><span class="line"></span><br><span class="line"><span class="attr">use_artifacts:</span></span><br><span class="line"><span class="attr">  stage:</span> <span class="string">use_artifacts</span></span><br><span class="line"><span class="attr">  script:</span></span><br><span class="line">    <span class="comment"># é»˜è®¤ä¼šè‡ªåŠ¨åœ¨ä¸åŒçš„ `stage` ä¸­ä¼ è¾“, æ‰€ä»¥è¿™é‡Œçš„ dist ç›®å½•æ˜¯å­˜åœ¨çš„</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">ls</span> <span class="string">./</span></span><br><span class="line"></span><br><span class="line"><span class="attr">disable_artifacts:</span></span><br><span class="line"><span class="attr">  stage:</span> <span class="string">disable_artifacts</span></span><br><span class="line">  <span class="comment"># å°† dependencies è®¾ç½®ä¸º [], ä»è€Œç¦ç”¨artifacts</span></span><br><span class="line"><span class="attr">  dependencies:</span> <span class="string">[]</span></span><br><span class="line"><span class="attr">  script:</span></span><br><span class="line">    <span class="comment"># æ— æ³• çœ‹åˆ° dist ç›®å½•</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">ls</span> <span class="string">./</span></span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><p><a href="https://gitlab.com/gitlab-com/support-forum/issues/2946#note_59414694" target="_blank" rel="noopener">Pipeline - Failed to extract cache</a><br><a href="https://zacksleo.github.io/2017/04/18/GitLab-CI%E4%B8%AD%E7%9A%84artifacts%E4%BD%BF%E7%94%A8%E7%A0%94%E7%A9%B6/" target="_blank" rel="noopener">GitLab-CIä¸­çš„artifactsä½¿ç”¨ç ”ç©¶</a><br><br></p><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong></p></blockquote><blockquote><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> GitLab </tag>
            
            <tag> CI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[è½¬] ç”¨ GitLab CI è¿›è¡ŒæŒç»­é›†æˆ</title>
      <link href="/2018/07/20/use-gitlab-ci-for-continuous-integration/"/>
      <url>/2018/07/20/use-gitlab-ci-for-continuous-integration/</url>
      
        <content type="html"><![CDATA[<h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h1><p>ä» GitLab 8.0 å¼€å§‹ï¼ŒGitLab CI å°±å·²ç»é›†æˆåœ¨ GitLab ä¸­ï¼Œæˆ‘ä»¬åªè¦åœ¨é¡¹ç›®ä¸­æ·»åŠ ä¸€ä¸ª <code>.gitlab-ci.yml</code> æ–‡ä»¶ï¼Œç„¶åæ·»åŠ ä¸€ä¸ª Runnerï¼Œå³å¯è¿›è¡ŒæŒç»­é›†æˆã€‚ è€Œä¸”éšç€ GitLab çš„å‡çº§ï¼ŒGitLab CI å˜å¾—è¶Šæ¥è¶Šå¼ºå¤§ï¼Œæœ¬æ–‡å°†ä»‹ç»å¦‚ä½•ä½¿ç”¨ GitLab CI è¿›è¡ŒæŒç»­é›†æˆã€‚</p><h1 id="ä¸€äº›æ¦‚å¿µ"><a href="#ä¸€äº›æ¦‚å¿µ" class="headerlink" title="ä¸€äº›æ¦‚å¿µ"></a>ä¸€äº›æ¦‚å¿µ</h1><p>åœ¨ä»‹ç» GitLab CI ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆçœ‹çœ‹ä¸€äº›æŒç»­é›†æˆç›¸å…³çš„æ¦‚å¿µã€‚</p><h2 id="Pipeline"><a href="#Pipeline" class="headerlink" title="Pipeline"></a>Pipeline</h2><p>ä¸€æ¬¡ Pipeline å…¶å®ç›¸å½“äºä¸€æ¬¡æ„å»ºä»»åŠ¡ï¼Œé‡Œé¢å¯ä»¥åŒ…å«å¤šä¸ªæµç¨‹ï¼Œå¦‚å®‰è£…ä¾èµ–ã€è¿è¡Œæµ‹è¯•ã€ç¼–è¯‘ã€éƒ¨ç½²æµ‹è¯•æœåŠ¡å™¨ã€éƒ¨ç½²ç”Ÿäº§æœåŠ¡å™¨ç­‰æµç¨‹ã€‚<br>ä»»ä½•æäº¤æˆ–è€… Merge Request çš„åˆå¹¶éƒ½å¯ä»¥è§¦å‘ Pipelineï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+------------------+           +----------------+</span><br><span class="line">|                  |  trigger  |                |</span><br><span class="line">|   Commit / MR    +----------&gt;+    Pipeline    |</span><br><span class="line">|                  |           |                |</span><br><span class="line">+------------------+           +----------------+</span><br></pre></td></tr></table></figure><h2 id="Stages"><a href="#Stages" class="headerlink" title="Stages"></a>Stages</h2><p>Stages è¡¨ç¤ºæ„å»ºé˜¶æ®µï¼Œè¯´ç™½äº†å°±æ˜¯ä¸Šé¢æåˆ°çš„æµç¨‹ã€‚<br>æˆ‘ä»¬å¯ä»¥åœ¨ä¸€æ¬¡ Pipeline ä¸­å®šä¹‰å¤šä¸ª Stagesï¼Œè¿™äº› Stages ä¼šæœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p><ul><li>æ‰€æœ‰ Stages ä¼šæŒ‰ç…§é¡ºåºè¿è¡Œï¼Œå³å½“ä¸€ä¸ª Stage å®Œæˆåï¼Œä¸‹ä¸€ä¸ª Stage æ‰ä¼šå¼€å§‹</li><li>åªæœ‰å½“æ‰€æœ‰ Stages å®Œæˆåï¼Œè¯¥æ„å»ºä»»åŠ¡ (Pipeline) æ‰ä¼šæˆåŠŸ</li><li>å¦‚æœä»»ä½•ä¸€ä¸ª Stage å¤±è´¥ï¼Œé‚£ä¹ˆåé¢çš„ Stages ä¸ä¼šæ‰§è¡Œï¼Œè¯¥æ„å»ºä»»åŠ¡ (Pipeline) å¤±è´¥</li></ul><p>å› æ­¤ï¼ŒStages å’Œ Pipeline çš„å…³ç³»å°±æ˜¯ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+--------------------------------------------------------+</span><br><span class="line">|                                                        |</span><br><span class="line">|  Pipeline                                              |</span><br><span class="line">|                                                        |</span><br><span class="line">|  +-----------+     +------------+      +------------+  |</span><br><span class="line">|  |  Stage <span class="number">1</span>  |----&gt;|   Stage <span class="number">2</span>  |-----&gt;|   Stage <span class="number">3</span>  |  |</span><br><span class="line">|  +-----------+     +------------+      +------------+  |</span><br><span class="line">|                                                        |</span><br><span class="line">+--------------------------------------------------------+</span><br></pre></td></tr></table></figure><h2 id="Jobs"><a href="#Jobs" class="headerlink" title="Jobs"></a>Jobs</h2><p>Jobs è¡¨ç¤ºæ„å»ºå·¥ä½œï¼Œè¡¨ç¤ºæŸä¸ª Stage é‡Œé¢æ‰§è¡Œçš„å·¥ä½œã€‚<br>æˆ‘ä»¬å¯ä»¥åœ¨ Stages é‡Œé¢å®šä¹‰å¤šä¸ª Jobsï¼Œè¿™äº› Jobs ä¼šæœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p><ul><li>ç›¸åŒ Stage ä¸­çš„ Jobs ä¼šå¹¶è¡Œæ‰§è¡Œ</li><li>ç›¸åŒ Stage ä¸­çš„ Jobs éƒ½æ‰§è¡ŒæˆåŠŸæ—¶ï¼Œè¯¥ Stage æ‰ä¼šæˆåŠŸ</li><li>å¦‚æœä»»ä½•ä¸€ä¸ª Job å¤±è´¥ï¼Œé‚£ä¹ˆè¯¥ Stage å¤±è´¥ï¼Œå³è¯¥æ„å»ºä»»åŠ¡ (Pipeline) å¤±è´¥</li></ul><p>æ‰€ä»¥ï¼ŒJobs å’Œ Stage çš„å…³ç³»å›¾å°±æ˜¯ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+------------------------------------------+</span><br><span class="line">|                                          |</span><br><span class="line">|  Stage <span class="number">1</span>                                 |</span><br><span class="line">|                                          |</span><br><span class="line">|  +---------+  +---------+  +---------+   |</span><br><span class="line">|  |  Job <span class="number">1</span>  |  |  Job <span class="number">2</span>  |  |  Job <span class="number">3</span>  |   |</span><br><span class="line">|  +---------+  +---------+  +---------+   |</span><br><span class="line">|                                          |</span><br><span class="line">+------------------------------------------+</span><br></pre></td></tr></table></figure><h1 id="GitLab-Runner"><a href="#GitLab-Runner" class="headerlink" title="GitLab Runner"></a>GitLab Runner</h1><h2 id="ç®€ä»‹-1"><a href="#ç®€ä»‹-1" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>ç†è§£äº†ä¸Šé¢çš„åŸºæœ¬æ¦‚å¿µä¹‹åï¼Œæœ‰æ²¡æœ‰è§‰å¾—å°‘äº†äº›ä»€ä¹ˆä¸œè¥¿ â€”â€” ç”±è°æ¥æ‰§è¡Œè¿™äº›æ„å»ºä»»åŠ¡å‘¢ï¼Ÿ<br>ç­”æ¡ˆå°±æ˜¯ GitLab Runner äº†ï¼</p><p>æƒ³é—®ä¸ºä»€ä¹ˆä¸æ˜¯ GitLab CI æ¥è¿è¡Œé‚£äº›æ„å»ºä»»åŠ¡ï¼Ÿ<br>ä¸€èˆ¬æ¥è¯´ï¼Œæ„å»ºä»»åŠ¡éƒ½ä¼šå ç”¨å¾ˆå¤šçš„ç³»ç»Ÿèµ„æº (è­¬å¦‚ç¼–è¯‘ä»£ç )ï¼Œè€Œ GitLab CI åˆæ˜¯ GitLab çš„ä¸€éƒ¨åˆ†ï¼Œå¦‚æœç”± GitLab CI æ¥è¿è¡Œæ„å»ºä»»åŠ¡çš„è¯ï¼Œåœ¨æ‰§è¡Œæ„å»ºä»»åŠ¡çš„æ—¶å€™ï¼ŒGitLab çš„æ€§èƒ½ä¼šå¤§å¹…ä¸‹é™ã€‚</p><p>GitLab CI æœ€å¤§çš„ä½œç”¨æ˜¯ç®¡ç†å„ä¸ªé¡¹ç›®çš„æ„å»ºçŠ¶æ€ï¼Œå› æ­¤ï¼Œè¿è¡Œæ„å»ºä»»åŠ¡è¿™ç§æµªè´¹èµ„æºçš„äº‹æƒ…å°±äº¤ç»™ GitLab Runner æ¥åšæ‹‰ï¼<br>å› ä¸º GitLab Runner å¯ä»¥å®‰è£…åˆ°ä¸åŒçš„æœºå™¨ä¸Šï¼Œæ‰€ä»¥åœ¨æ„å»ºä»»åŠ¡è¿è¡ŒæœŸé—´å¹¶ä¸ä¼šå½±å“åˆ° GitLab çš„æ€§èƒ½~</p><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>å®‰è£… GitLab Runner å¤ªç®€å•äº†ï¼ŒæŒ‰ç…§ç€ <a href="https://gitlab.com/gitlab-org/gitlab-ci-multi-runner" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a> çš„æ•™ç¨‹æ¥å°±å¥½æ‹‰ï¼<br>ä¸‹é¢æ˜¯ Debian/Ubuntu/CentOS çš„å®‰è£…æ–¹æ³•ï¼Œå…¶ä»–ç³»ç»Ÿå»å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># For Debian/Ubuntu</span></span><br><span class="line">$ curl -L https://packages.gitlab.com/install/repositories/runner/gitlab-ci-multi-runner/script.deb.sh | sudo bash</span><br><span class="line">$ sudo apt-get install gitlab-ci-multi-runner</span><br><span class="line"></span><br><span class="line"><span class="comment"># For CentOS</span></span><br><span class="line">$ curl -L https://packages.gitlab.com/install/repositories/runner/gitlab-ci-multi-runner/script.rpm.sh | sudo bash</span><br><span class="line">$ sudo yum install gitlab-ci-multi-runner</span><br></pre></td></tr></table></figure><h2 id="æ³¨å†Œ-Runner"><a href="#æ³¨å†Œ-Runner" class="headerlink" title="æ³¨å†Œ Runner"></a>æ³¨å†Œ Runner</h2><p>å®‰è£…å¥½ GitLab Runner ä¹‹åï¼Œæˆ‘ä»¬åªè¦å¯åŠ¨ Runner ç„¶åå’Œ CI ç»‘å®šå°±å¯ä»¥äº†ï¼š</p><ul><li>æ‰“å¼€ä½  GitLab ä¸­çš„é¡¹ç›®é¡µé¢ï¼Œåœ¨é¡¹ç›®è®¾ç½®ä¸­æ‰¾åˆ° runners</li><li>è¿è¡Œ <code>sudo gitlab-ci-multi-runner register</code></li><li>è¾“å…¥ CI URL</li><li>è¾“å…¥ Token</li><li>è¾“å…¥ Runner çš„åå­—</li><li>é€‰æ‹© Runner çš„ç±»å‹ï¼Œç®€å•èµ·è§è¿˜æ˜¯é€‰ Shell å§</li><li>å®Œæˆ</li></ul><p>å½“æ³¨å†Œå¥½ Runner ä¹‹åï¼Œå¯ä»¥ç”¨ <code>sudo gitlab-ci-multi-runner list</code> å‘½ä»¤æ¥æŸ¥çœ‹å„ä¸ª Runner çš„çŠ¶æ€ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ sudo gitlab-runner list</span><br><span class="line">Listing configured runners          ConfigFile=/etc/gitlab-runner/config.toml</span><br><span class="line">my-runner                           Executor=shell Token=cd1cd7cf243afb47094677855aacd3 URL=http://mygitlab.com/ci</span><br></pre></td></tr></table></figure><h1 id="gitlab-ci-yml"><a href="#gitlab-ci-yml" class="headerlink" title=".gitlab-ci.yml"></a>.gitlab-ci.yml</h1><h2 id="ç®€ä»‹-2"><a href="#ç®€ä»‹-2" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>é…ç½®å¥½ Runner ä¹‹åï¼Œæˆ‘ä»¬è¦åšçš„äº‹æƒ…å°±æ˜¯åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸­æ·»åŠ  <code>.gitlab-ci.yml</code> æ–‡ä»¶äº†ã€‚<br>å½“æˆ‘ä»¬æ·»åŠ äº† <code>.gitlab-ci.yml</code> æ–‡ä»¶åï¼Œæ¯æ¬¡æäº¤ä»£ç æˆ–è€…åˆå¹¶ MR éƒ½ä¼šè‡ªåŠ¨è¿è¡Œæ„å»ºä»»åŠ¡äº†ã€‚</p><p>è¿˜è®°å¾— Pipeline æ˜¯æ€ä¹ˆè§¦å‘çš„å—ï¼ŸPipeline ä¹Ÿæ˜¯é€šè¿‡æäº¤ä»£ç æˆ–è€…åˆå¹¶ MR æ¥è§¦å‘çš„ï¼<br>é‚£ä¹ˆ Pipeline å’Œ <code>.gitlab-ci.yml</code> æœ‰ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿ<br>å…¶å® <code>.gitlab-ci.yml</code> å°±æ˜¯åœ¨å®šä¹‰ Pipeline è€Œå·²æ‹‰ï¼</p><h2 id="åŸºæœ¬å†™æ³•"><a href="#åŸºæœ¬å†™æ³•" class="headerlink" title="åŸºæœ¬å†™æ³•"></a>åŸºæœ¬å†™æ³•</h2><p>æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ <code>.gitlab-ci.yml</code> æ˜¯æ€ä¹ˆå†™çš„ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®šä¹‰ stages</span></span><br><span class="line"><span class="attr">stages:</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">build</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">test</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰ job</span></span><br><span class="line"><span class="attr">job1:</span></span><br><span class="line"><span class="attr">  stage:</span> <span class="string">test</span></span><br><span class="line"><span class="attr">  script:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">echo</span> <span class="string">"I am job1"</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">echo</span> <span class="string">"I am in test stage"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰ job</span></span><br><span class="line"><span class="attr">job2:</span></span><br><span class="line"><span class="attr">  stage:</span> <span class="string">build</span></span><br><span class="line"><span class="attr">  script:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">echo</span> <span class="string">"I am job2"</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">echo</span> <span class="string">"I am in build stage"</span></span><br></pre></td></tr></table></figure><p>å†™èµ·æ¥å¾ˆç®€å•å§ï¼ç”¨ <code>stages</code> å…³é”®å­—æ¥å®šä¹‰ Pipeline ä¸­çš„å„ä¸ªæ„å»ºé˜¶æ®µï¼Œç„¶åç”¨ä¸€äº›éå…³é”®å­—æ¥å®šä¹‰ jobsã€‚<br>æ¯ä¸ª job ä¸­å¯ä»¥å¯ä»¥å†ç”¨ <code>stage</code> å…³é”®å­—æ¥æŒ‡å®šè¯¥ job å¯¹åº”å“ªä¸ª stageã€‚<br>job é‡Œé¢çš„ <code>script</code> å…³é”®å­—æ˜¯æœ€å…³é”®çš„åœ°æ–¹äº†ï¼Œä¹Ÿæ˜¯æ¯ä¸ª job ä¸­å¿…é¡»è¦åŒ…å«çš„ï¼Œå®ƒè¡¨ç¤ºæ¯ä¸ª job è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚</p><p>å›æƒ³ä¸€ä¸‹æˆ‘ä»¬ä¹‹å‰æåˆ°çš„ Stages å’Œ Jobs çš„å…³ç³»ï¼Œç„¶åçŒœçŒœä¸Šé¢ä¾‹å­çš„è¿è¡Œç»“æœï¼Ÿ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">I am job2</span><br><span class="line">I am in build stage</span><br><span class="line">I am job1</span><br><span class="line">I am in test stage</span><br></pre></td></tr></table></figure><p>æ ¹æ®æˆ‘ä»¬åœ¨ <code>stages</code> ä¸­çš„å®šä¹‰ï¼Œ<code>build</code> é˜¶æ®µè¦åœ¨ <code>test</code> é˜¶æ®µä¹‹å‰è¿è¡Œï¼Œæ‰€ä»¥ <code>stage:build</code> çš„ jobs ä¼šå…ˆè¿è¡Œï¼Œä¹‹åæ‰ä¼šè¿è¡Œ <code>stage:test</code> çš„ jobsã€‚</p><h2 id="å¸¸ç”¨çš„å…³é”®å­—"><a href="#å¸¸ç”¨çš„å…³é”®å­—" class="headerlink" title="å¸¸ç”¨çš„å…³é”®å­—"></a>å¸¸ç”¨çš„å…³é”®å­—</h2><p>ä¸‹é¢ä»‹ç»ä¸€äº›å¸¸ç”¨çš„å…³é”®å­—ï¼Œæƒ³è¦æ›´åŠ è¯¦å°½çš„å†…å®¹è¯·å‰å¾€ <a href="http://docs.gitlab.com/ce/ci/yaml/README.html" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a></p><h3 id="stages"><a href="#stages" class="headerlink" title="stages"></a>stages</h3><p>å®šä¹‰ Stagesï¼Œé»˜è®¤æœ‰ä¸‰ä¸ª Stagesï¼Œåˆ†åˆ«æ˜¯ <code>build</code>, <code>test</code>, <code>deploy</code>ã€‚</p><h3 id="types"><a href="#types" class="headerlink" title="types"></a>types</h3><p><code>stages</code> çš„åˆ«åã€‚</p><h3 id="before-script"><a href="#before-script" class="headerlink" title="before_script"></a>before_script</h3><p>å®šä¹‰ä»»ä½• Jobs è¿è¡Œå‰éƒ½ä¼šæ‰§è¡Œçš„å‘½ä»¤ã€‚</p><h3 id="after-script"><a href="#after-script" class="headerlink" title="after_script"></a>after_script</h3><blockquote><p>è¦æ±‚ GitLab 8.7+ å’Œ GitLab Runner 1.2+</p></blockquote><p>å®šä¹‰ä»»ä½• Jobs è¿è¡Œå®Œåéƒ½ä¼šæ‰§è¡Œçš„å‘½ä»¤ã€‚</p><h3 id="variables-amp-amp-Job-variables"><a href="#variables-amp-amp-Job-variables" class="headerlink" title="variables &amp;&amp; Job.variables"></a>variables &amp;&amp; Job.variables</h3><blockquote><p>è¦æ±‚ GitLab Runner 0.5.0+</p></blockquote><p>å®šä¹‰ç¯å¢ƒå˜é‡ã€‚<br>å¦‚æœå®šä¹‰äº† Job çº§åˆ«çš„ç¯å¢ƒå˜é‡çš„è¯ï¼Œè¯¥ Job ä¼šä¼˜å…ˆä½¿ç”¨ Job çº§åˆ«çš„ç¯å¢ƒå˜é‡ã€‚</p><h3 id="cache-amp-amp-Job-cache"><a href="#cache-amp-amp-Job-cache" class="headerlink" title="cache &amp;&amp; Job.cache"></a>cache &amp;&amp; Job.cache</h3><blockquote><p>è¦æ±‚ GitLab Runner 0.7.0+</p></blockquote><p>å®šä¹‰éœ€è¦ç¼“å­˜çš„æ–‡ä»¶ã€‚<br>æ¯ä¸ª Job å¼€å§‹çš„æ—¶å€™ï¼ŒRunner éƒ½ä¼šåˆ æ‰ <code>.gitignore</code> é‡Œé¢çš„æ–‡ä»¶ã€‚<br>å¦‚æœæœ‰äº›æ–‡ä»¶ (å¦‚ <code>node_modules/</code>) éœ€è¦å¤šä¸ª Jobs å…±ç”¨çš„è¯ï¼Œæˆ‘ä»¬åªèƒ½è®©æ¯ä¸ª Job éƒ½å…ˆæ‰§è¡Œä¸€é <code>npm install</code>ã€‚<br>è¿™æ ·å¾ˆä¸æ–¹ä¾¿ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å¯¹è¿™äº›æ–‡ä»¶è¿›è¡Œç¼“å­˜ã€‚ç¼“å­˜äº†çš„æ–‡ä»¶é™¤äº†å¯ä»¥è·¨ Jobs ä½¿ç”¨å¤–ï¼Œè¿˜å¯ä»¥è·¨ Pipeline ä½¿ç”¨ã€‚</p><p>å…·ä½“ç”¨æ³•è¯·æŸ¥çœ‹ <a href="http://docs.gitlab.com/ce/ci/yaml/README.html#cache" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>ã€‚</p><h3 id="Job-script"><a href="#Job-script" class="headerlink" title="Job.script"></a>Job.script</h3><p>å®šä¹‰ Job è¦è¿è¡Œçš„å‘½ä»¤ï¼Œå¿…å¡«é¡¹ã€‚</p><h3 id="Job-stage"><a href="#Job-stage" class="headerlink" title="Job.stage"></a>Job.stage</h3><p>å®šä¹‰ Job çš„ stageï¼Œé»˜è®¤ä¸º <code>test</code>ã€‚</p><h3 id="Job-artifacts"><a href="#Job-artifacts" class="headerlink" title="Job.artifacts"></a>Job.artifacts</h3><p>å®šä¹‰ Job ä¸­ç”Ÿæˆçš„é™„ä»¶ã€‚<br>å½“è¯¥ Job è¿è¡ŒæˆåŠŸåï¼Œç”Ÿæˆçš„æ–‡ä»¶å¯ä»¥ä½œä¸ºé™„ä»¶ (å¦‚ç”Ÿæˆçš„äºŒè¿›åˆ¶æ–‡ä»¶) ä¿ç•™ä¸‹æ¥ï¼Œæ‰“åŒ…å‘é€åˆ° GitLabï¼Œä¹‹åæˆ‘ä»¬å¯ä»¥åœ¨ GitLab çš„é¡¹ç›®é¡µé¢ä¸‹ä¸‹è½½è¯¥é™„ä»¶ã€‚<br>æ³¨æ„ï¼Œä¸è¦æŠŠ <code>artifacts</code> å’Œ <code>cache</code> æ··æ·†äº†ã€‚</p><h2 id="å®ç”¨ä¾‹å­"><a href="#å®ç”¨ä¾‹å­" class="headerlink" title="å®ç”¨ä¾‹å­"></a>å®ç”¨ä¾‹å­</h2><p>ä¸‹é¢ç»™å‡ºä¸€ä¸ªæˆ‘è‡ªå·±åœ¨ç”¨çš„ä¾‹å­ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">stages:</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">install_deps</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">test</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">build</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">deploy_test</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">deploy_production</span></span><br><span class="line"></span><br><span class="line"><span class="attr">cache:</span></span><br><span class="line"><span class="attr">  key:</span> <span class="string">$&#123;CI_BUILD_REF_NAME&#125;</span></span><br><span class="line"><span class="attr">  paths:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">node_modules/</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">dist/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># å®‰è£…ä¾èµ–</span></span><br><span class="line"><span class="attr">install_deps:</span></span><br><span class="line"><span class="attr">  stage:</span> <span class="string">install_deps</span></span><br><span class="line"><span class="attr">  only:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">develop</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">master</span></span><br><span class="line"><span class="attr">  script:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">npm</span> <span class="string">install</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿è¡Œæµ‹è¯•ç”¨ä¾‹</span></span><br><span class="line"><span class="attr">test:</span></span><br><span class="line"><span class="attr">  stage:</span> <span class="string">test</span></span><br><span class="line"><span class="attr">  only:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">develop</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">master</span></span><br><span class="line"><span class="attr">  script:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">npm</span> <span class="string">run</span> <span class="string">test</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¼–è¯‘</span></span><br><span class="line"><span class="attr">build:</span></span><br><span class="line"><span class="attr">  stage:</span> <span class="string">build</span></span><br><span class="line"><span class="attr">  only:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">develop</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">master</span></span><br><span class="line"><span class="attr">  script:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">npm</span> <span class="string">run</span> <span class="string">clean</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">npm</span> <span class="string">run</span> <span class="attr">build:client</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">npm</span> <span class="string">run</span> <span class="attr">build:server</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># éƒ¨ç½²æµ‹è¯•æœåŠ¡å™¨</span></span><br><span class="line"><span class="attr">deploy_test:</span></span><br><span class="line"><span class="attr">  stage:</span> <span class="string">deploy_test</span></span><br><span class="line"><span class="attr">  only:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">develop</span></span><br><span class="line"><span class="attr">  script:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">pm2</span> <span class="string">delete</span> <span class="string">app</span> <span class="string">||</span> <span class="literal">true</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">pm2</span> <span class="string">start</span> <span class="string">app.js</span> <span class="bullet">--name</span> <span class="string">app</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># éƒ¨ç½²ç”Ÿäº§æœåŠ¡å™¨</span></span><br><span class="line"><span class="attr">deploy_production:</span></span><br><span class="line"><span class="attr">  stage:</span> <span class="string">deploy_production</span></span><br><span class="line"><span class="attr">  only:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">master</span></span><br><span class="line"><span class="attr">  script:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">bash</span> <span class="string">scripts/deploy/deploy.sh</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„é…ç½®æŠŠä¸€æ¬¡ Pipeline åˆ†æˆäº”ä¸ªé˜¶æ®µï¼š</p><ul><li>å®‰è£…ä¾èµ–(<code>install_deps</code>)</li><li>è¿è¡Œæµ‹è¯•(<code>test</code>)</li><li>ç¼–è¯‘(<code>build</code>)</li><li>éƒ¨ç½²æµ‹è¯•æœåŠ¡å™¨(<code>deploy_test</code>)</li><li>éƒ¨ç½²ç”Ÿäº§æœåŠ¡å™¨(<code>deploy_production</code>)</li></ul><p>è®¾ç½® <code>Job.only</code> åï¼Œåªæœ‰å½“ develop åˆ†æ”¯å’Œ master åˆ†æ”¯æœ‰æäº¤çš„æ—¶å€™æ‰ä¼šè§¦å‘ç›¸å…³çš„ Jobsã€‚<br>æ³¨æ„ï¼Œæˆ‘è¿™é‡Œç”¨ GitLab Runner æ‰€åœ¨çš„æœåŠ¡å™¨ä½œä¸ºæµ‹è¯•æœåŠ¡å™¨ã€‚</p><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><p><a href="https://about.gitlab.com/gitlab-ci/" target="_blank" rel="noopener">https://about.gitlab.com/gitlab-ci/</a><br><a href="http://docs.gitlab.com/ce/ci/yaml/README.html" target="_blank" rel="noopener">http://docs.gitlab.com/ce/ci/yaml/README.html</a><br><a href="http://docs.gitlab.com/ce/ci/variables/README.html" target="_blank" rel="noopener">http://docs.gitlab.com/ce/ci/variables/README.html</a><br><a href="https://gitlab.com/gitlab-org/gitlab-ci-multi-runner" target="_blank" rel="noopener">https://gitlab.com/gitlab-org/gitlab-ci-multi-runner</a><br><a href="https://gitlab.com/gitlab-org/gitlab-ci-multi-runner/issues/1232" target="_blank" rel="noopener">https://gitlab.com/gitlab-org/gitlab-ci-multi-runner/issues/1232</a><br><a href="http://stackbox.cn/2016-02-gitlab-ci-conf/" target="_blank" rel="noopener">http://stackbox.cn/2016-02-gitlab-ci-conf/</a></p><h1 id="è½¬è½½è‡ª"><a href="#è½¬è½½è‡ª" class="headerlink" title="è½¬è½½è‡ª"></a>è½¬è½½è‡ª</h1><p><a href="https://scarletsky.github.io/2016/07/29/use-gitlab-ci-for-continuous-integration/" target="_blank" rel="noopener">ç”¨ GitLab CI è¿›è¡ŒæŒç»­é›†æˆ(scarletsky)</a><br><br></p><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong></p></blockquote><blockquote><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> GitLab </tag>
            
            <tag> CI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨ vscode ç¼–è¾‘è¿œç¨‹æ–‡ä»¶</title>
      <link href="/2018/07/11/remote-vscode/"/>
      <url>/2018/07/11/remote-vscode/</url>
      
        <content type="html"><![CDATA[<p>ä½¿ç”¨vimç¼–è¾‘æ–‡ä»¶ä¸æ˜¯å¾ˆé¡ºæ‰‹, åˆ©ç”¨ vscode æ’ä»¶å®ç°æœ¬åœ°ç¼–è¾‘è¿œç¨‹æ–‡ä»¶<br><a id="more"></a></p><h2 id="å®‰è£…-Remote-VSCode"><a href="#å®‰è£…-Remote-VSCode" class="headerlink" title="å®‰è£… Remote VSCode"></a>å®‰è£… <code>Remote VSCode</code></h2><ol><li>æ‰“å¼€ <a href="https://marketplace.visualstudio.com/items?itemName=rafaelmaiolla.remote-vscode" target="_blank" rel="noopener">marketplace</a>, ç‚¹å‡» <code>Install</code>, å®‰è£…åé‡å¯ <code>vsc</code></li><li>æŒ‰ç…§ <a href="https://github.com/aurora/rmate" target="_blank" rel="noopener">bash rmate</a> æ–‡æ¡£, åœ¨ <strong>è¿œç¨‹æœåŠ¡å™¨</strong> ä¸Š å®‰è£… rmate<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo wget -O /usr/<span class="built_in">local</span>/bin/rmate https://raw.github.com/aurora/rmate/master/rmate</span><br><span class="line">sudo chmod a+x /usr/<span class="built_in">local</span>/bin/rmate</span><br></pre></td></tr></table></figure></li></ol><h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><ol><li>åœ¨æœ¬æœº <code>vscode</code> çª—å£ä¸­, æŒ‰é”® <code>F1</code>, è¾“å…¥ <code>Remote: Start server</code>, å›è½¦åå¯åŠ¨ <code>Remote VSCode</code> æœåŠ¡</li><li>åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥ <code>ssh -R 52698:127.0.0.1:52698 user@example.com -p ssh_port</code></li><li>åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥ <code>rmate file</code></li></ol><h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><p>åœ¨ <code>vscode</code> ä¸­ æ‰“å¼€ <code>User Setttings</code>, æœç´¢ <code>remote vscode</code> ä¿®æ”¹ç›¸å…³é…ç½®<br><figure class="image-box">                <img src="/img/remote-vscode/001.png" alt="é…ç½®" title="" class="">                <p>é…ç½®</p>            </figure></p><h2 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h2><ul><li><a href="https://marketplace.visualstudio.com/items?itemName=rafaelmaiolla.remote-vscode" target="_blank" rel="noopener">marketplace remote-vscode</a></li><li><a href="https://spin.atomicobject.com/2017/12/18/remote-vscode-file-editing/" target="_blank" rel="noopener">Remote File Editing Over SSH with Visual Studio Code</a></li><li><a href="https://medium.com/@prtdomingo/editing-files-in-your-linux-virtual-machine-made-a-lot-easier-with-remote-vscode-6bb98d0639a4" target="_blank" rel="noopener">Editing files in your Linux Virtual Machine made a lot easier with Remote VSCode</a><br><br></li></ul><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢!</strong></p></blockquote><blockquote><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> vsc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[å†…ç½‘ç©¿é€] ubuntuä¸Šæ­å»ºfrp</title>
      <link href="/2018/06/18/frp/"/>
      <url>/2018/06/18/frp/</url>
      
        <content type="html"><![CDATA[<p>frpæœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯,unbutuå¼€æœºå¯åŠ¨ä»¥åŠä½œä¸ºsocket5ä»£ç†<br><a id="more"></a></p><h2 id="æœåŠ¡å™¨ç«¯"><a href="#æœåŠ¡å™¨ç«¯" class="headerlink" title="æœåŠ¡å™¨ç«¯"></a>æœåŠ¡å™¨ç«¯</h2><p><strong><a href="https://github.com/fatedier/frp/blob/master/README_zh.md" target="_blank" rel="noopener">å®˜æ–¹ä¸­æ–‡æ–‡æ¡£, å¾ˆæ¸…æ™°</a></strong></p><ol><li>è¿›å…¥ <a href="https://github.com/fatedier/frp/releases" target="_blank" rel="noopener"><code>frp release</code></a> ç•Œé¢, é€‰æ‹©å¯¹åº”æœåŠ¡å™¨ç‰ˆæœ¬çš„ç‰ˆæœ¬(æ¯”å¦‚ 64ä½çš„linuxé€‰æ‹© <code>frp_0.20.0_linux_amd64.tar.gz</code>)</li><li>è§£å‹ <code>tar zxvf frp_0.20.0_linux_amd64.tar.gz</code></li><li><p>è¿›å…¥ <code>frp_0.20.0_linux_amd64</code>, ç¼–è¾‘ <code>frps.ini</code></p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># frps.ini</span></span><br><span class="line"><span class="section">[common]</span></span><br><span class="line"><span class="attr">bind_port</span> = frpè¿è¡Œç«¯å£,éœ€è¦å¼€æ”¾é˜²ç«å¢™</span><br><span class="line"><span class="attr">vhost_http_port</span> = httpæœåŠ¡ç«¯å£,å¯ä»¥ å’Œ bind_port ç›¸åŒ</span><br></pre></td></tr></table></figure></li><li><p>å¯åŠ¨ <code>./frps -c ./frps.ini</code></p></li></ol><h2 id="å®¢æˆ·ç«¯"><a href="#å®¢æˆ·ç«¯" class="headerlink" title="å®¢æˆ·ç«¯"></a>å®¢æˆ·ç«¯</h2><ol><li>è¿›å…¥ <a href="https://github.com/fatedier/frp/releases" target="_blank" rel="noopener"><code>frp release</code></a> ç•Œé¢, é€‰æ‹©å¯¹åº”å®¢æˆ·ç«¯ç‰ˆæœ¬(æ¯”å¦‚ macOSé€‰æ‹© <code>frp_0.20.0_darwin_amd64.tar.gz</code>)</li><li>è§£å‹ <code>tar zxvf frp_0.20.0_darwin_amd64.tar.gz</code></li><li><p>è¿›å…¥ <code>frp_0.20.0_darwin_amd64</code>, ç¼–è¾‘ <code>frpc.ini</code></p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># frpc.ini</span></span><br><span class="line"><span class="section">[common]</span></span><br><span class="line"><span class="attr">server_addr</span> = ä¸Šä¸€æ­¥çš„æœåŠ¡å™¨åœ°å€</span><br><span class="line"><span class="attr">server_port</span> = ä¸Šä¸€æ­¥å¡«å†™çš„ç«¯å£</span><br><span class="line"></span><br><span class="line"><span class="section">[web]</span></span><br><span class="line"><span class="attr">type</span> = http</span><br><span class="line"><span class="attr">local_port</span> = æœ¬æœºhttpæœåŠ¡ç«¯å£</span><br><span class="line"><span class="attr">custom_domains</span> = www.yourdomain.com</span><br></pre></td></tr></table></figure></li><li><p>å¯åŠ¨<code>./frpc -c ./frpc.ini</code></p></li><li>å°† <code>www.yourdomain.com</code> çš„åŸŸå A è®°å½•è§£æåˆ°æœåŠ¡å™¨åœ°å€</li><li>è®¿é—® <code>www.yourdomain.com:${vhost_http_port}</code> å…¶ä¸­ <code>vhost_http_port</code>ä¸ºä¸Šä¸€æ­¥ç»‘å®šçš„ç«¯å£</li></ol><h2 id="è‡ªå®šä¹‰äºŒçº§åŸŸå-å¹¶ä¸”å»é™¤è®¿é—®æ—¶çš„ç«¯å£"><a href="#è‡ªå®šä¹‰äºŒçº§åŸŸå-å¹¶ä¸”å»é™¤è®¿é—®æ—¶çš„ç«¯å£" class="headerlink" title="è‡ªå®šä¹‰äºŒçº§åŸŸå, å¹¶ä¸”å»é™¤è®¿é—®æ—¶çš„ç«¯å£"></a>è‡ªå®šä¹‰äºŒçº§åŸŸå, å¹¶ä¸”å»é™¤è®¿é—®æ—¶çš„ç«¯å£</h2><p><strong>(æ›¿æ¢ <code>frp.yourdomain.com</code> ä¸ºä½ è‡ªå®šä¹‰çš„äºŒçº§åŸŸå )</strong></p><ol><li><p>æœåŠ¡å™¨ç«¯ <code>frps.ini</code></p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># frps.ini</span></span><br><span class="line"><span class="section">[common]</span></span><br><span class="line"><span class="attr">bind_port</span> = frpè¿è¡Œç«¯å£,éœ€è¦å¼€æ”¾é˜²ç«å¢™</span><br><span class="line"><span class="attr">vhost_http_port</span> = httpæœåŠ¡ç«¯å£,å¯ä»¥ å’Œ bind_port ç›¸åŒ</span><br><span class="line"><span class="attr">subdomain_host</span> = frp.yourdomain.com</span><br></pre></td></tr></table></figure></li><li><p>å»é™¤è®¿é—®æ—¶éœ€è¦è¾“å…¥ç«¯å£ (<code>nginx</code> åå‘ä»£ç†)</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">server_name</span> <span class="regexp">*.frp.yourdomain.com</span>;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">80</span>;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">443</span> ssl http2;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">ssl_certificate</span> /etc/nginx/ssl/<span class="regexp">*.frp.yourdomain.com.cer</span>;</span><br><span class="line">    <span class="attribute">ssl_certificate_key</span> /etc/nginx/ssl/<span class="regexp">*.frp.yourdomain.com.key</span>;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">location</span> / &#123;</span><br><span class="line">        <span class="comment"># vhost_http_port ä¸º ä¸Šé¢ç»‘å®šçš„ç«¯å£</span></span><br><span class="line">        <span class="attribute">proxy_pass</span> http://127.0.0.1:vhost_http_port;</span><br><span class="line">        <span class="comment"># è®¾ç½® host</span></span><br><span class="line">        <span class="attribute">proxy_set_header</span> Host <span class="variable">$http_host</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>å®¢æˆ·ç«¯ <code>frpc.ini</code></p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># frpc.ini</span></span><br><span class="line"><span class="section">[common]</span></span><br><span class="line"><span class="attr">server_addr</span> = ä¸Šä¸€æ­¥çš„æœåŠ¡å™¨åœ°å€</span><br><span class="line"><span class="attr">server_port</span> = ä¸Šä¸€æ­¥å¡«å†™çš„ç«¯å£</span><br><span class="line"></span><br><span class="line"><span class="section">[web]</span></span><br><span class="line"><span class="attr">type</span> = http</span><br><span class="line"><span class="attr">local_port</span> = æœ¬æœºhttpæœåŠ¡ç«¯å£</span><br><span class="line"><span class="attr">subdomain</span> = test</span><br></pre></td></tr></table></figure></li><li><p>è®¿é—® <code>test.yourdomain.com</code></p></li></ol><h2 id="æ­å»º-socket5-ä»£ç†"><a href="#æ­å»º-socket5-ä»£ç†" class="headerlink" title="æ­å»º socket5 ä»£ç†"></a>æ­å»º <code>socket5</code> ä»£ç†</h2><p><strong>æ³¨æ„, ä»¥ä¸‹é…ç½®å‡åœ¨ æœåŠ¡å™¨ç«¯!!</strong></p><ol><li><p>æœåŠ¡å™¨ç«¯é…ç½® <code>frpc.ini</code></p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># frpc.ini</span></span><br><span class="line"><span class="section">[common]</span></span><br><span class="line"><span class="attr">server_addr</span> = <span class="number">127.0</span>.<span class="number">0.1</span></span><br><span class="line"><span class="attr">server_port</span> = ç¬¬ä¸€æ­¥å¡«å†™çš„ç«¯å£</span><br><span class="line"></span><br><span class="line"><span class="section">[plugin_socks5]</span></span><br><span class="line"><span class="attr">type</span> = tcp</span><br><span class="line"><span class="attr">remote_port</span> = æœåŠ¡å™¨ç«¯å¼€æ”¾çš„ä¸€ä¸ª tcp ç«¯å£, ç”¨äºé€šä¿¡</span><br><span class="line"><span class="attr">plugin</span> = socks5</span><br><span class="line"><span class="attr">plugin_user</span> = è®¾ç½®ç”¨æˆ·å</span><br><span class="line"><span class="attr">plugin_passwd</span> = è®¾ç½®å¯†ç </span><br></pre></td></tr></table></figure></li><li><p>å¯åŠ¨,è®¾ç½®ä»£ç†è®¿é—®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">env ALL_PROXY=socks5h://<span class="variable">$&#123;plugin_user&#125;</span>:<span class="variable">$&#123;plugin_passwd&#125;</span>@æœåŠ¡å™¨åœ°å€:æœåŠ¡å™¨å¼€æ”¾çš„tcpç«¯å£ curl https://www.google.com --verbose</span><br></pre></td></tr></table></figure></li></ol><h2 id="ubuntu16-åŠ å…¥å¼€æœºå¯åŠ¨é¡¹"><a href="#ubuntu16-åŠ å…¥å¼€æœºå¯åŠ¨é¡¹" class="headerlink" title="ubuntu16 åŠ å…¥å¼€æœºå¯åŠ¨é¡¹"></a>ubuntu16 åŠ å…¥å¼€æœºå¯åŠ¨é¡¹</h2><ol><li><p>æ·»åŠ  <code>/lib/systemd/system/frps.service</code></p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[Unit]</span></span><br><span class="line"><span class="attr">Description</span>=frps</span><br><span class="line"><span class="attr">After</span>=network.target</span><br><span class="line"></span><br><span class="line"><span class="section">[Service]</span></span><br><span class="line"><span class="attr">TimeoutStartSec</span>=<span class="number">30</span></span><br><span class="line"><span class="attr">ExecStart</span>=<span class="variable">$&#123;frpsçš„ç»å¯¹è·¯å¾„&#125;</span> -c <span class="variable">$&#123;frps.iniçš„ç»å¯¹è·¯å¾„&#125;</span></span><br><span class="line"><span class="attr">ExecStop</span>=/bin/kill <span class="variable">$MAINPID</span></span><br><span class="line"></span><br><span class="line"><span class="section">[Install]</span></span><br><span class="line"><span class="attr">WantedBy</span>=multi-user.target</span><br></pre></td></tr></table></figure></li><li><p>å¯ç”¨ <code>frps.service</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl <span class="built_in">enable</span> frps</span><br><span class="line">systemctl start frps</span><br><span class="line">systemctl status frps</span><br></pre></td></tr></table></figure></li></ol><h2 id="æœåŠ¡å™¨-å®‰è£…è„šæœ¬"><a href="#æœåŠ¡å™¨-å®‰è£…è„šæœ¬" class="headerlink" title="æœåŠ¡å™¨ å®‰è£…è„šæœ¬"></a>æœåŠ¡å™¨ å®‰è£…è„šæœ¬</h2><ol><li><p><code>frps å®‰è£…</code> (tokenè®¤è¯,æ—¥å¿—,dashboard,å¼€æœºå¯åŠ¨)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é…ç½®</span></span><br><span class="line">frp_download_url=<span class="string">"https://github.com/fatedier/frp/releases/download/v0.20.0/frp_0.20.0_linux_amd64.tar.gz"</span></span><br><span class="line">dir=<span class="string">"è¦ä¸‹è½½ frp å­˜æ”¾çš„è·¯å¾„"</span></span><br><span class="line">bind_port=<span class="string">"frpè¿è¡Œç«¯å£"</span></span><br><span class="line">host=<span class="string">"è‡ªå®šä¹‰äºŒçº§åŸŸå"</span></span><br><span class="line">token=<span class="string">"tokenè®¤è¯è®¿é—®"</span></span><br><span class="line">log_name=<span class="string">"æ—¥å¿—åç§°"</span></span><br><span class="line">dashboard_port=<span class="string">"dashboard ç«¯å£"</span></span><br><span class="line">dashboard_user=admin</span><br><span class="line">dashboard_pwd=admin</span><br><span class="line"><span class="comment"># é…ç½®ç»“æŸ</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">dir=<span class="variable">$&#123;dir%/&#125;</span></span><br><span class="line">frp_tar_gz_name=<span class="variable">$&#123;frp_download_url##*/&#125;</span></span><br><span class="line">frp_type=<span class="variable">$&#123;frp_tar_gz_name%.tar.gz&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ -e <span class="variable">$&#123;dir&#125;</span>/<span class="variable">$&#123;frp_type&#125;</span>.tar.gz ]; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;dir&#125;</span>/<span class="variable">$&#123;frp_type&#125;</span>.tar.gz exists, skip download"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  wget <span class="variable">$&#123;frp_download_url&#125;</span> -P <span class="variable">$&#123;dir&#125;</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ -e <span class="variable">$&#123;dir&#125;</span>/<span class="variable">$&#123;frp_type&#125;</span> ]; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;dir&#125;</span>/<span class="variable">$&#123;frp_type&#125;</span> exists, skip tar zxvf"</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  <span class="built_in">cd</span> <span class="variable">$&#123;dir&#125;</span></span><br><span class="line">  tar zxvf <span class="variable">$&#123;frp_type&#125;</span>.tar.gz</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">get_base</span></span>()&#123;</span><br><span class="line">  <span class="built_in">local</span> conf_str=`cat &lt;&lt;EOF</span><br><span class="line">[common]</span><br><span class="line">bind_port = <span class="variable">$&#123;bind_port&#125;</span></span><br><span class="line">vhost_http_port = <span class="variable">$&#123;bind_port&#125;</span></span><br><span class="line">subdomain_host = <span class="variable">$&#123;host&#125;</span></span><br><span class="line">log_file = <span class="variable">$&#123;dir&#125;</span>/<span class="variable">$&#123;frp_type&#125;</span>/<span class="variable">$&#123;log_name&#125;</span></span><br><span class="line">token = <span class="variable">$&#123;token&#125;</span></span><br><span class="line">EOF</span><br><span class="line">`</span><br><span class="line">  <span class="built_in">echo</span> -e <span class="string">"<span class="variable">$&#123;conf_str&#125;</span>"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">get_dashboard</span></span>() &#123;</span><br><span class="line">  <span class="keyword">if</span> [ -z <span class="string">"dashboard_port"</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">return</span></span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">local</span> conf_str=`cat &lt;&lt;EOF</span><br><span class="line">dashboard_port = <span class="variable">$&#123;dashboard_port&#125;</span></span><br><span class="line">dashboard_user = <span class="variable">$&#123;dashboard_user&#125;</span></span><br><span class="line">dashboard_pwd = <span class="variable">$&#123;dashboard_pwd&#125;</span></span><br><span class="line">EOF</span><br><span class="line">`</span><br><span class="line">  <span class="built_in">echo</span> -e <span class="string">"<span class="variable">$&#123;conf_str&#125;</span>"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">set_frps_ini</span></span>() &#123;</span><br><span class="line">  conf_str=`cat &lt;&lt;EOF</span><br><span class="line">$(get_base)</span><br><span class="line">$(get_dashboard)</span><br><span class="line">EOF</span><br><span class="line">`</span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">"<span class="variable">$&#123;conf_str&#125;</span>"</span> &gt; <span class="variable">$&#123;dir&#125;</span>/<span class="variable">$&#123;frp_type&#125;</span>/frps.ini</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">generate_service</span></span>() &#123;</span><br><span class="line">  (</span><br><span class="line">cat &lt;&lt; EOF</span><br><span class="line">[Unit]</span><br><span class="line">Description=frps</span><br><span class="line">After=network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">TimeoutStartSec=30</span><br><span class="line">ExecStart=<span class="variable">$&#123;dir&#125;</span>/<span class="variable">$&#123;frp_type&#125;</span>/frps -c <span class="variable">$&#123;dir&#125;</span>/<span class="variable">$&#123;frp_type&#125;</span>/frps.ini</span><br><span class="line">ExecStop=/bin/<span class="built_in">kill</span> \<span class="variable">$MAINPID</span></span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line">EOF</span><br><span class="line">) &gt; /lib/systemd/system/frps.service</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">set_service</span></span>() &#123;</span><br><span class="line">  <span class="keyword">if</span> [ -e <span class="string">"/lib/systemd/system/frps.service"</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">read</span> -r -p <span class="string">"/lib/systemd/system/frps.serviceå·²å­˜åœ¨,è¦†ç›– [N/y] "</span> input</span><br><span class="line">    <span class="keyword">if</span> [ <span class="variable">$&#123;input&#125;</span> = <span class="string">"Y"</span> -o <span class="variable">$&#123;input&#125;</span> = <span class="string">'y'</span> ]; <span class="keyword">then</span></span><br><span class="line">      generate_service</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">start_service</span></span>() &#123;</span><br><span class="line">  systemctl <span class="built_in">enable</span> frps</span><br><span class="line">  systemctl restart frps</span><br><span class="line">  systemctl status frps </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">set_frps_ini </span><br><span class="line">set_service</span><br><span class="line">start_service</span><br></pre></td></tr></table></figure></li><li><p><code>socket5 frpc å®‰è£…</code> (token, ä»£ç†è®¤è¯, å¼€æœºè‡ªå¯)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é…ç½®</span></span><br><span class="line">frp_type=<span class="string">"frpæ–‡ä»¶å¤¹, æ¯”å¦‚ frp_0.20.0_linux_amd64"</span></span><br><span class="line">dir=<span class="string">"ä¸‹è½½ frp å­˜æ”¾çš„è·¯å¾„"</span></span><br><span class="line">server_addr=127.0.0.1</span><br><span class="line">server_port=<span class="string">"frpsè¿è¡Œç«¯å£"</span></span><br><span class="line">token=<span class="string">"frpsè®¾ç½®çš„token"</span></span><br><span class="line">log_name=<span class="string">"æ—¥å¿—"</span></span><br><span class="line">remote_port=<span class="string">"å¼€æ”¾çš„tcp, ç”¨äºsocket5ä»£ç†ç«¯å£"</span></span><br><span class="line">plugin_user=<span class="string">"ä»£ç†ç”¨æˆ·å"</span></span><br><span class="line">plugin_passwd=<span class="string">"ä»£ç†ç«¯å£"</span></span><br><span class="line"><span class="comment"># é…ç½®ç»“æŸ</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">dir=<span class="variable">$&#123;dir%/&#125;</span></span><br><span class="line">log_file=<span class="string">"<span class="variable">$&#123;dir&#125;</span>/<span class="variable">$&#123;frp_type&#125;</span>/<span class="variable">$&#123;log_name&#125;</span>"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ ! -e <span class="variable">$&#123;dir&#125;</span>/<span class="variable">$&#123;frp_type&#125;</span> ]; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;dir&#125;</span>/<span class="variable">$&#123;frp_type&#125;</span> not exists; please run frps.sh first"</span>;</span><br><span class="line">  <span class="built_in">exit</span> 1</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">(</span><br><span class="line">cat &lt;&lt;EOF</span><br><span class="line">[common]</span><br><span class="line">server_addr = <span class="variable">$&#123;server_addr&#125;</span></span><br><span class="line">server_port = <span class="variable">$&#123;server_port&#125;</span></span><br><span class="line">token = <span class="variable">$&#123;token&#125;</span></span><br><span class="line">log_file = <span class="variable">$&#123;log_file&#125;</span></span><br><span class="line"></span><br><span class="line">[plugin_socks5]</span><br><span class="line"><span class="built_in">type</span> = tcp</span><br><span class="line">remote_port = <span class="variable">$&#123;remote_port&#125;</span></span><br><span class="line">plugin = socks5</span><br><span class="line">plugin_user = <span class="variable">$&#123;plugin_user&#125;</span></span><br><span class="line">plugin_passwd = <span class="variable">$&#123;plugin_passwd&#125;</span></span><br><span class="line">use_encryption = <span class="literal">true</span></span><br><span class="line">use_compression = <span class="literal">true</span></span><br><span class="line">EOF</span><br><span class="line">) &gt;  <span class="variable">$&#123;dir&#125;</span>/<span class="variable">$&#123;frp_type&#125;</span>/frpc.ini</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">generate_service</span></span>() &#123;</span><br><span class="line">  (</span><br><span class="line">cat &lt;&lt; EOF</span><br><span class="line">[Unit]</span><br><span class="line">Description=frpc</span><br><span class="line">After=network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">TimeoutStartSec=30</span><br><span class="line">ExecStart=<span class="variable">$&#123;dir&#125;</span>/<span class="variable">$&#123;frp_type&#125;</span>/frpc -c <span class="variable">$&#123;dir&#125;</span>/<span class="variable">$&#123;frp_type&#125;</span>/frpc.ini</span><br><span class="line">ExecStop=/bin/<span class="built_in">kill</span> \<span class="variable">$MAINPID</span></span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line">EOF</span><br><span class="line">) &gt; /lib/systemd/system/frpc.service</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">set_service</span></span>() &#123;</span><br><span class="line">  <span class="keyword">if</span> [ -e <span class="string">"/lib/systemd/system/frpc.service"</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">read</span> -r -p <span class="string">"/lib/systemd/system/frpc.serviceå·²å­˜åœ¨,è¦†ç›– [N/y] "</span> input</span><br><span class="line">    <span class="keyword">if</span> [ <span class="variable">$&#123;input&#125;</span> = <span class="string">"Y"</span> -o <span class="variable">$&#123;input&#125;</span> = <span class="string">'y'</span> ]; <span class="keyword">then</span></span><br><span class="line">      generate_service</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">start_service</span></span>() &#123;</span><br><span class="line">  systemctl <span class="built_in">enable</span> frpc</span><br><span class="line">  systemctl restart frpc</span><br><span class="line">  systemctl status frpc </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">set_service</span><br><span class="line">start_service</span><br></pre></td></tr></table></figure></li></ol><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><p><a href="https://github.com/fatedier/frp/blob/master/README_zh.md" target="_blank" rel="noopener">frpå®˜æ–¹ä¸­æ–‡æ–‡æ¡£</a><br><br></p><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong></p></blockquote><blockquote><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> frp </tag>
            
            <tag> å†…ç½‘ç©¿é€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[å†…ç½‘ç©¿é€] ubuntuä¸Šæ­å»ºngrok 1.x</title>
      <link href="/2018/06/15/ngrok/"/>
      <url>/2018/06/15/ngrok/</url>
      
        <content type="html"><![CDATA[<p>ngrokçš„æ­å»ºå’Œä½¿ç”¨ åŒ…æ‹¬å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯<br><a id="more"></a></p><h2 id="æœåŠ¡å™¨ç«¯"><a href="#æœåŠ¡å™¨ç«¯" class="headerlink" title="æœåŠ¡å™¨ç«¯"></a>æœåŠ¡å™¨ç«¯</h2><h3 id="ä¸‹è½½å®‰è£…"><a href="#ä¸‹è½½å®‰è£…" class="headerlink" title="ä¸‹è½½å®‰è£…"></a>ä¸‹è½½å®‰è£…</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install ngrok-server</span><br></pre></td></tr></table></figure><h3 id="æ‰‹åŠ¨å¯åŠ¨"><a href="#æ‰‹åŠ¨å¯åŠ¨" class="headerlink" title="æ‰‹åŠ¨å¯åŠ¨"></a>æ‰‹åŠ¨å¯åŠ¨</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ngrokd -tlsKey=<span class="string">"tlsKey"</span> -tlsCrt=<span class="string">"tlsCrt"</span> -domain=<span class="string">"ngrok.xinshangshangxin.com"</span> -httpAddr=<span class="string">":8081"</span>  -httpsAddr=<span class="string">""</span></span><br></pre></td></tr></table></figure><h3 id="åå°å¯åŠ¨"><a href="#åå°å¯åŠ¨" class="headerlink" title="åå°å¯åŠ¨"></a>åå°å¯åŠ¨</h3><ol><li>å°†ä¸‹é¢çš„å†…å®¹ä¿å­˜ä¸º <code>ngrokd</code></li><li><code>chmod +x ngrokd</code></li><li><code>ngrokd (start|stop|status)</code></li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># These setting need you to set.</span></span><br><span class="line">TLSKEY=<span class="string">"set your TLSKEY"</span></span><br><span class="line">TLSCRT=<span class="string">"set your TLSCRT"</span></span><br><span class="line">DOMAIN=<span class="string">"set you ngrok domain"</span></span><br><span class="line">ADDR=8081</span><br><span class="line">LOGFILE=/data/logs/ngrokd.log</span><br><span class="line">PIDFILE=/var/run/ngrokd.pid</span><br><span class="line">DESC=ngrokd</span><br><span class="line"></span><br><span class="line"><span class="comment"># you should use /lib/init.d/functions </span></span><br><span class="line">. /lib/lsb/init-functions</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">do_start()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> [ -s <span class="variable">$PIDFILE</span> ]; <span class="keyword">then</span></span><br><span class="line">        RETVAL=1</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">"Already running!"</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">"Starting <span class="variable">$DESC</span>"</span></span><br><span class="line">        touch <span class="variable">$&#123;LOGFILE&#125;</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">"ngrokd -tlsKey=<span class="variable">$TLSKEY</span> -tlsCrt=<span class="variable">$TLSCRT</span> -domain=<span class="variable">$DOMAIN</span> -httpAddr=:<span class="variable">$&#123;ADDR-80&#125;</span> -httpsAddr=  -log=<span class="variable">$LOGFILE</span>"</span></span><br><span class="line">        <span class="comment"># you need to modify the command as you needing</span></span><br><span class="line">        nohup ngrokd -tlsKey=<span class="variable">$TLSKEY</span> -tlsCrt=<span class="variable">$TLSCRT</span> -domain=<span class="variable">$DOMAIN</span> -httpAddr=:<span class="variable">$&#123;ADDR-80&#125;</span> -httpsAddr=  -<span class="built_in">log</span>=<span class="variable">$LOGFILE</span> &gt;/dev/null 2&gt;&amp;1 &amp;</span><br><span class="line">        RETVAL=$?</span><br><span class="line">        PID=$!</span><br><span class="line">        [ <span class="variable">$RETVAL</span> -eq 0 ] &amp;&amp; <span class="built_in">echo</span> <span class="variable">$PID</span> &gt; <span class="variable">$PIDFILE</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">return</span> <span class="variable">$RETVAL</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">do_stop()</span><br><span class="line">&#123;</span><br><span class="line">    killproc -p <span class="variable">$PIDFILE</span> ngrokd</span><br><span class="line">    RETVAL=<span class="string">"$?"</span></span><br><span class="line">    <span class="built_in">echo</span></span><br><span class="line">    [ <span class="variable">$RETVAL</span> = 0 ] &amp;&amp; rm -rf <span class="variable">$PIDFILE</span></span><br><span class="line">    <span class="built_in">return</span> <span class="variable">$RETVAL</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="string">"<span class="variable">$1</span>"</span> <span class="keyword">in</span></span><br><span class="line">  start)</span><br><span class="line">    do_start</span><br><span class="line">    ;;</span><br><span class="line"></span><br><span class="line">  stop)</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"Stopping <span class="variable">$DESC</span>"</span></span><br><span class="line">    do_stop</span><br><span class="line">    ;;</span><br><span class="line"></span><br><span class="line">  logs)</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"tail -f log"</span></span><br><span class="line">    tail -f <span class="variable">$&#123;LOGFILE&#125;</span></span><br><span class="line">    ;;</span><br><span class="line"></span><br><span class="line">  status)</span><br><span class="line">    <span class="keyword">if</span> [ ! -s <span class="variable">$PIDFILE</span> ]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">"Not running"</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        PID=`cat <span class="variable">$PIDFILE</span>`</span><br><span class="line">        <span class="keyword">if</span> [[ -n <span class="variable">$PID</span> &amp;&amp; -n <span class="string">"`ps -p <span class="variable">$PID</span> | grep <span class="variable">$PID</span>`"</span> ]]; <span class="keyword">then</span></span><br><span class="line">            <span class="built_in">echo</span> <span class="string">"Running (<span class="variable">$&#123;PID&#125;</span>)"</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">echo</span> <span class="string">"Not running, yet <span class="variable">$&#123;PIDFILE&#125;</span> exists (stop ngrokd will fix this)"</span></span><br><span class="line">        <span class="keyword">fi</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">    ;;</span><br><span class="line"></span><br><span class="line">  *)</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"Usage: ngrokd (start|stop|status)"</span></span><br><span class="line">    <span class="built_in">exit</span> 3</span><br><span class="line">    ;;</span><br><span class="line"><span class="keyword">esac</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">exit</span> 0</span><br></pre></td></tr></table></figure><h3 id="åŸŸåæŒ‡å‘"><a href="#åŸŸåæŒ‡å‘" class="headerlink" title="åŸŸåæŒ‡å‘"></a>åŸŸåæŒ‡å‘</h3><p>å°† <code>ngrok.xinshangshangxin.com</code> å’Œ <code>*.ngrok.xinshangshangxin.com</code> æŒ‡å‘ è£…æœ‰ ngrok-serverçš„æœºå™¨</p><h3 id="å¼€æ”¾ç«¯å£"><a href="#å¼€æ”¾ç«¯å£" class="headerlink" title="å¼€æ”¾ç«¯å£"></a>å¼€æ”¾ç«¯å£</h3><p>éœ€è¦å¼€æ”¾ç«¯å£ 4443<br>å¦‚æœéœ€è¦<code>TCP</code> é“¾æ¥, è¿˜è¦å¼€æ”¾ <code>TCP</code>ç«¯å£, ç«¯å£è‡ªå®šä¹‰(æ¯”å¦‚<code>33333</code>)</p><h3 id="è®¿é—®æ—¶-å»é™¤ç«¯å£è®¿é—®"><a href="#è®¿é—®æ—¶-å»é™¤ç«¯å£è®¿é—®" class="headerlink" title="è®¿é—®æ—¶ å»é™¤ç«¯å£è®¿é—®"></a>è®¿é—®æ—¶ å»é™¤ç«¯å£è®¿é—®</h3><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">server_name</span> <span class="regexp">*.ngrok.xinshangshangxin.com</span>;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">80</span>;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">location</span> / &#123;</span><br><span class="line">        <span class="attribute">proxy_pass</span> http://localhost:8081;</span><br><span class="line">        <span class="comment"># æœ€ä¸»è¦çš„ä¸€å¥è¯</span></span><br><span class="line">        <span class="attribute">proxy_set_header</span> Host <span class="variable">$http_host</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å®¢æˆ·ç«¯"><a href="#å®¢æˆ·ç«¯" class="headerlink" title="å®¢æˆ·ç«¯"></a>å®¢æˆ·ç«¯</h2><h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># mac </span></span><br><span class="line">brew install ngrok-client</span><br><span class="line"><span class="comment"># ubuntu</span></span><br><span class="line">apt install ngrok-client</span><br></pre></td></tr></table></figure><h3 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h3><p><code>vim ~/ngrok.cfg</code></p><p>è¾“å…¥ä¸‹é¢çš„å†…å®¹<br>å…¶ä¸­ <code>remote_port</code> ä¸ºå›ºå®šè¿œç¨‹è¿æ¥<br><code>proto</code> ä¸ºæœ¬æœºåœ°å€<br><code>subdomain</code> ä¸ºäºŒçº§åŸŸåå‰ç¼€</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">server_addr: ngrok.xinshangshangxin.com:4443</span><br><span class="line">trust_host_root_certs: true</span><br><span class="line"></span><br><span class="line">tunnels:</span><br><span class="line">    ssh:</span><br><span class="line">        remote_port: 33333</span><br><span class="line">        proto:</span><br><span class="line">            tcp: 0.0.0.0:22</span><br><span class="line"></span><br><span class="line">    server:</span><br><span class="line">        remote_port: 8081</span><br><span class="line">        subdomain: test</span><br><span class="line">        proto:</span><br><span class="line">            http: 0.0.0.0:4000</span><br></pre></td></tr></table></figure><h3 id="å¯åŠ¨"><a href="#å¯åŠ¨" class="headerlink" title="å¯åŠ¨"></a>å¯åŠ¨</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ngrok -config=ngrok.cfg start ssh</span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">ngrok -config=ngrok.cfg start server</span><br></pre></td></tr></table></figure><h2 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h2><p><strong><code>ngrok 2.x</code> æºç æœªå…¬å¼€</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ngrok 2.x is the successor to 1.x and the focus of all current development effort. Its source code is not available.</span><br></pre></td></tr></table></figure></p><p>æ‰€ä»¥ç½‘ä¸Šæœ‰äº› å®¢æˆ·ç«¯é…ç½®æ˜¯é’ˆå¯¹2.xç‰ˆæœ¬çš„, å¹¶ä¸é€‚ç”¨!!</p><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><p><a href="https://www.jianshu.com/p/d35962b0dba4" target="_blank" rel="noopener">VPSè‡ªæ­å»ºNgrokå†…ç½‘ç©¿é€æœåŠ¡</a><br><br></p><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong></p></blockquote><blockquote><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> å†…ç½‘ç©¿é€ </tag>
            
            <tag> ngrok </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>docker ä½¿ç”¨ -v æˆ– --volume æ˜ å°„æ–‡ä»¶æŠ¥é”™</title>
      <link href="/2018/06/07/docker-volume-file/"/>
      <url>/2018/06/07/docker-volume-file/</url>
      
        <content type="html"><![CDATA[<p>-v å‡ºç° unknown: Are you trying to mount a directory onto a file (or vice-versa)<br><a id="more"></a></p><h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ:"></a>è§£å†³æ–¹æ¡ˆ:</h2><p>å‡è®¾ <code>docker run -v local_file_path:docker_file_path docker_image</code></p><ol><li><code>local_file_path</code> å¿…é¡»å­˜åœ¨, å¹¶ä¸”ç±»å‹ä¸ºæ–‡ä»¶</li><li><code>docker_file_path</code> å¿…é¡»å­˜åœ¨, ç»å¯¹è·¯å¾„, å¹¶ä¸”ç±»å‹ä¸ºæ–‡ä»¶</li></ol><h2 id="åŸå› "><a href="#åŸå› " class="headerlink" title="åŸå› :"></a>åŸå› :</h2><p>ä» <a href="https://docs.docker.com/storage/bind-mounts/#differences-between--v-and---mount-behavior" target="_blank" rel="noopener">docker æ–‡æ¡£ <code>Differences between -v and --mount behavior</code></a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">If you use -v or --volume to bind-mount a file or directory that does not yet exist on the Docker host, -v creates the endpoint for you. </span><br><span class="line">It is always created as a directory.</span><br></pre></td></tr></table></figure><p><strong>å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨, dockeræ€»ä¼šåˆ›å»ºä¸€ä¸ªç›®å½•</strong></p><h2 id="æ’æŸ¥æ–¹æ³•"><a href="#æ’æŸ¥æ–¹æ³•" class="headerlink" title="æ’æŸ¥æ–¹æ³•"></a>æ’æŸ¥æ–¹æ³•</h2><p>æ·»åŠ  <code>-it --entrypoint bash</code> è¿›å…¥å®¹å™¨æŸ¥çœ‹æ–‡ä»¶æ˜¯å¦å­˜åœ¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -v local_file_path:docker_file_path -it --entrypoint bash docker_image</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h2><ul><li><a href="https://stackoverflow.com/questions/42248198/how-to-mount-a-single-file-in-a-volume#47099098" target="_blank" rel="noopener">How to mount a single file in a volume</a><br><br></li></ul><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢!</strong></p></blockquote><blockquote><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>github project use travis npm publish</title>
      <link href="/2018/05/16/travis-npm/"/>
      <url>/2018/05/16/travis-npm/</url>
      
        <content type="html"><![CDATA[<p>githubçš„é¡¹ç›®ä½¿ç”¨traviså‘å¸ƒnpmåŒ…<br><a id="more"></a></p><h2 id="è·å–-npm-token"><a href="#è·å–-npm-token" class="headerlink" title="è·å– npm token"></a>è·å– npm token</h2><ol><li>åœ¨ <a href="https://www.npmjs.com/" target="_blank" rel="noopener">https://www.npmjs.com/</a> æ³¨å†Œ/ç™»å½•</li><li>å³ä¸Šè§’ç‚¹å‡»å¤´åƒ =&gt; <code>Tokens</code> è¿›å…¥ <code>Tokens</code> ç¼–è¾‘é¡µ<figure class="image-box">                <img src="/img/travis-npm/001.png" alt="" title="" class="">                <p></p>            </figure></li><li>æ–°å¢ä¸€ä¸ªtoken, è®°å¾—ä¿å­˜è¿™ä¸ªtoken, åé¢æ— æ³•å†æ¬¡æŸ¥çœ‹, åªèƒ½æ–°å¢</li></ol><h2 id="é…ç½®-travis"><a href="#é…ç½®-travis" class="headerlink" title="é…ç½® travis"></a>é…ç½® travis</h2><ol><li>è¿›å…¥ <a href="https://travis-ci.org/" target="_blank" rel="noopener">https://travis-ci.org/</a>, æ³¨å†Œ æˆ–è€… ä½¿ç”¨ GitHubç™»å½•(å³ä¸Šè§’<code>Sign in with GitHub</code>)</li><li>è¿›å…¥ <a href="https://travis-ci.org/profile/" target="_blank" rel="noopener">https://travis-ci.org/profile/</a> é¡µé¢, é€‰æ‹© ä½ è¦è‡ªåŠ¨æ„å»ºçš„é¡¹ç›®, å·¦ä¾§å¯ä»¥åˆ‡æ¢ç»„ç»‡é¡¹ç›®</li><li>å¦‚ä¸‹å›¾, å‹¾é€‰å¼€å¯æ„å»º<figure class="image-box">                <img src="/img/travis-npm/002.png" alt="" title="" class="">                <p></p>            </figure></li><li>ç‚¹å‡»è¦æ„å»ºçš„é¡¹ç›®, å³ä¸Šè§’ç‚¹å‡» <code>Settings</code><figure class="image-box">                <img src="/img/travis-npm/003.png" alt="" title="" class="">                <p></p>            </figure></li><li>åœ¨ <code>Environment Variables</code> ä¸­ æ·»åŠ  <code>NPM_EMAIL</code> (ä½ npmè´¦æˆ·çš„é‚®ç®±) å’Œ <code>NPM_TOKEN</code> (ä¸Šé¢è·å–çš„ token)<figure class="image-box">                <img src="/img/travis-npm/004.png" alt="" title="" class="">                <p></p>            </figure></li></ol><h2 id="é…ç½®é¡¹ç›®ä»£ç "><a href="#é…ç½®é¡¹ç›®ä»£ç " class="headerlink" title="é…ç½®é¡¹ç›®ä»£ç "></a>é…ç½®é¡¹ç›®ä»£ç </h2><p>åœ¨é¡¹ç›®ä¸­æ·»åŠ  <code>.travis.yml</code><br><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">language:</span> <span class="string">node_js</span>                <span class="comment"># ä½¿ç”¨ nodejs</span></span><br><span class="line"><span class="attr">node_js:</span>                         <span class="comment"># ç‰ˆæœ¬ä¸º 8</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">"8"</span></span><br><span class="line"></span><br><span class="line"><span class="attr">cache:</span> <span class="string">yarn</span>                      <span class="comment"># ä½¿ç”¨ yarn è€Œä¸æ˜¯ npm (æŒ‰ç…§å®é™…æƒ…å†µè°ƒæ•´)</span></span><br><span class="line"><span class="attr">install:</span> <span class="string">yarn</span></span><br><span class="line"></span><br><span class="line"><span class="attr">jobs:</span>                            <span class="comment"># æ·»åŠ  job</span></span><br><span class="line"><span class="attr">  include:</span></span><br><span class="line"><span class="attr">    - stage:</span> <span class="string">npm</span> <span class="string">release</span>   </span><br><span class="line"><span class="attr">      if:</span> <span class="string">tag</span> <span class="string">IS</span> <span class="string">present</span>         <span class="comment"># å¦‚æœ pushçš„ä»£ç  å­˜åœ¨ tag</span></span><br><span class="line"><span class="attr">      node_js:</span> <span class="string">"8"</span>               <span class="comment"># ä½¿ç”¨ 8.x çš„ node</span></span><br><span class="line"><span class="attr">      script:</span> <span class="string">yarn</span> <span class="string">compile</span>       <span class="comment"># æ‰§è¡Œ yarn compile å‘½ä»¤(æŒ‰ç…§å®é™…æƒ…å†µè°ƒæ•´)</span></span><br><span class="line"><span class="attr">      before_deploy:</span>             <span class="comment"># åœ¨ å‘å¸ƒä¹‹å‰, æ‰§è¡Œå‘½ä»¤(æŒ‰ç…§å®é™…æƒ…å†µè°ƒæ•´)</span></span><br><span class="line"><span class="bullet">        -</span> <span class="string">cd</span> <span class="string">dist</span></span><br><span class="line"><span class="attr">      deploy:</span></span><br><span class="line"><span class="attr">        provider:</span> <span class="string">npm</span></span><br><span class="line"><span class="attr">        email:</span> <span class="string">"$NPM_EMAIL"</span></span><br><span class="line"><span class="attr">        api_key:</span> <span class="string">"$NPM_TOKEN"</span></span><br><span class="line"><span class="attr">        skip_cleanup:</span> <span class="literal">true</span>       <span class="comment"># ä¸ºäº†é˜²æ­¢ Travis CI æ¸…ç†é¢å¤–çš„æ–‡ä»¶å¤¹å¹¶åˆ é™¤ä½ åšçš„æ”¹å˜</span></span><br><span class="line"><span class="attr">        on:</span></span><br><span class="line"><span class="attr">          tags:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure></p><h2 id="æäº¤ä½ çš„ä»£ç åˆ°-github"><a href="#æäº¤ä½ çš„ä»£ç åˆ°-github" class="headerlink" title="æäº¤ä½ çš„ä»£ç åˆ° github"></a>æäº¤ä½ çš„ä»£ç åˆ° github</h2><ol><li>å…ˆcommit ä½ çš„æ­£å¸¸ä¿®æ”¹</li><li><code>npm version patch/minor/major</code> æ›´æ–°ä½ çš„ç‰ˆæœ¬<br>æ¯”å¦‚ ä½¿ç”¨ <code>npm version patch</code>, ä¼šæ‰§è¡Œ<br>a) <code>package.json</code> ä¸­æ’å…¥ï¼ˆæ›´æ–°ï¼‰çš„ç‰ˆæœ¬å·<br>b) åˆ›å»ºä¸€ä¸ªæ–°çš„æäº¤<br>c) åˆ›å»ºä¸€ä¸ª git æ ‡ç­¾</li><li><code>git push origin master --tag</code>, pushä½ çš„ä»£ç åˆ°githubä¸Š, åŒæ—¶æŠŠtagä¹Ÿ</li></ol><h2 id="å»-travis-æŸ¥çœ‹æ˜¯å¦-å¼€å§‹æ„å»º-å¹¶æŸ¥çœ‹æ„å»ºæ˜¯å¦æˆåŠŸ"><a href="#å»-travis-æŸ¥çœ‹æ˜¯å¦-å¼€å§‹æ„å»º-å¹¶æŸ¥çœ‹æ„å»ºæ˜¯å¦æˆåŠŸ" class="headerlink" title="å» travis æŸ¥çœ‹æ˜¯å¦ å¼€å§‹æ„å»º, å¹¶æŸ¥çœ‹æ„å»ºæ˜¯å¦æˆåŠŸ"></a>å» <code>travis</code> æŸ¥çœ‹æ˜¯å¦ å¼€å§‹æ„å»º, å¹¶æŸ¥çœ‹æ„å»ºæ˜¯å¦æˆåŠŸ</h2><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><p><a href="https://github.com/xitu/gold-miner/blob/master/TODO/automated-npm-releases-with-travis-ci.md" target="_blank" rel="noopener">ä½¿ç”¨ Travis CI è‡ªåŠ¨å‘å¸ƒ npm</a><br><br></p><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong></p></blockquote><blockquote><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> travis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç”³è¯·letsencryptå®‰è£…æ³›åŸŸå</title>
      <link href="/2018/03/22/wildcard-domain/"/>
      <url>/2018/03/22/wildcard-domain/</url>
      
        <content type="html"><![CDATA[<p>åœ¨VPSä¸Šç”³è¯·letsencryptæ³›åŸŸå, åˆ©ç”¨é˜¿é‡Œäº‘dnsè‡ªåŠ¨ç”³è¯·è¯ä¹¦å¹¶ä¸”åŠ å…¥nginx<br><a id="more"></a></p><h2 id="åŸŸåç”³è¯·å·¥å…·-acme-sh"><a href="#åŸŸåç”³è¯·å·¥å…·-acme-sh" class="headerlink" title="åŸŸåç”³è¯·å·¥å…· acme.sh"></a>åŸŸåç”³è¯·å·¥å…· <a href="https://github.com/Neilpang/acme.sh" target="_blank" rel="noopener">acme.sh</a></h2><h3 id="ä¸‹è½½å®‰è£…-acme-sh"><a href="#ä¸‹è½½å®‰è£…-acme-sh" class="headerlink" title="ä¸‹è½½å®‰è£… acme.sh"></a>ä¸‹è½½å®‰è£… acme.sh</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl https://get.acme.sh | sh</span><br></pre></td></tr></table></figure><h3 id="é‡å¯-terminal"><a href="#é‡å¯-terminal" class="headerlink" title="é‡å¯ terminal"></a>é‡å¯ <code>terminal</code></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é‡å¯zsh</span></span><br><span class="line"><span class="built_in">exec</span> zsh -l</span><br></pre></td></tr></table></figure><h2 id="ç”Ÿæˆå®‰è£…æ³›åŸŸåè¯ä¹¦"><a href="#ç”Ÿæˆå®‰è£…æ³›åŸŸåè¯ä¹¦" class="headerlink" title="ç”Ÿæˆå®‰è£…æ³›åŸŸåè¯ä¹¦"></a>ç”Ÿæˆå®‰è£…æ³›åŸŸåè¯ä¹¦</h2><h3 id="ç”³è¯·é˜¿é‡Œäº‘-Api-key-å’Œ-Ali-Secret-å¯ä»¥æŒ‰ç…§-acme-sh-è¿›è¡Œè®¾ç½®"><a href="#ç”³è¯·é˜¿é‡Œäº‘-Api-key-å’Œ-Ali-Secret-å¯ä»¥æŒ‰ç…§-acme-sh-è¿›è¡Œè®¾ç½®" class="headerlink" title="ç”³è¯·é˜¿é‡Œäº‘ Api_key å’Œ Ali_Secret (å¯ä»¥æŒ‰ç…§ acme.sh è¿›è¡Œè®¾ç½®)"></a>ç”³è¯·é˜¿é‡Œäº‘ <code>Api_key</code> å’Œ <code>Ali_Secret</code> (å¯ä»¥æŒ‰ç…§ <a href="https://github.com/Neilpang/acme.sh#7-automatic-dns-api-integration" target="_blank" rel="noopener">acme.sh</a> è¿›è¡Œè®¾ç½®)</h3><ol><li>è®¿é—® <a href="https://ram.console.aliyun.com" target="_blank" rel="noopener">https://ram.console.aliyun.com</a></li><li>å·¦ä¾§èœå•ç‚¹å‡» ç”¨æˆ·ç®¡ç†, å³ä¸Šè§’ç‚¹å‡»åˆ›å»ºæ–°ç”¨æˆ·</li><li>å¡«å†™ç”¨æˆ·å, ç‚¹å‡»ç¡®å®š, æ³¨æ„ä¿å­˜ <code>AccessKeyId</code> å’Œ <code>AccessKeySecret</code><br><img src="/img/letsencrypt/001.png" alt=""><br><img src="/img/letsencrypt/002png" alt=""></li><li>æ·»åŠ æˆæƒ<br><img src="/img/letsencrypt/003.png" alt=""><br><img src="/img/letsencrypt/004.png" alt=""></li></ol><h2 id="ç”³è¯·-è¯ä¹¦"><a href="#ç”³è¯·-è¯ä¹¦" class="headerlink" title="ç”³è¯· è¯ä¹¦"></a>ç”³è¯· è¯ä¹¦</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> Ali_Key=<span class="string">"ä¸Šé¢ç”³è¯·çš„AccessKeyId"</span></span><br><span class="line"><span class="built_in">export</span> Ali_Secret=<span class="string">"ä¸Šé¢ç”³è¯·çš„AccessKeySecret"</span></span><br><span class="line"><span class="comment"># æŠŠä¸‹é¢çš„ *.demo.com æ”¹æˆ *.your.domain</span></span><br><span class="line">acme.sh --issue --dns dns_ali -d *.demo.com --dnssleep 0</span><br></pre></td></tr></table></figure><h2 id="å®‰è£…certå¹¶é‡å¯nginx"><a href="#å®‰è£…certå¹¶é‡å¯nginx" class="headerlink" title="å®‰è£…certå¹¶é‡å¯nginx"></a>å®‰è£…certå¹¶é‡å¯nginx</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># *.demo.com æ”¹æˆ *.your.domain</span></span><br><span class="line"><span class="comment"># /etc/nginx/ssl/*.demo.com.key å’Œ /etc/nginx/ssl/*.demo.com.cer æ”¹æˆä½ æƒ³è¦åœ¨ nginx.confä¸­å¼•å…¥é…ç½®çš„è·¯å¾„</span></span><br><span class="line"></span><br><span class="line">acme.sh --install-cert -d <span class="string">"*.demo.com"</span> \</span><br><span class="line">--key-file       <span class="string">"/etc/nginx/ssl/*.demo.com.key"</span>  \</span><br><span class="line">--fullchain-file <span class="string">"/etc/nginx/ssl/*.demo.com.cer"</span> \</span><br><span class="line">--reloadcmd     <span class="string">"systemctl reload nginx"</span></span><br></pre></td></tr></table></figure><h2 id="nginx-conf"><a href="#nginx-conf" class="headerlink" title="nginx.conf"></a>nginx.conf</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    server_name any-pre-domain.demo.com;</span><br><span class="line">    listen 80;</span><br><span class="line">    listen 443 ssl;</span><br><span class="line"></span><br><span class="line">    # é…ç½®ä½ ä¸Šé¢ --fullchain-file çš„è·¯å¾„</span><br><span class="line">    ssl_certificate /etc/nginx/ssl/*.demo.com.cer;</span><br><span class="line">    # é…ç½®ä½ ä¸Šé¢ --key-file çš„è·¯å¾„</span><br><span class="line">    ssl_certificate_key /etc/nginx/ssl/*.demo.com.key;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass http://localhost:1337;</span><br><span class="line">        proxy_http_version 1.1;</span><br><span class="line">        proxy_set_header Upgrade $http_upgrade;</span><br><span class="line">        proxy_set_header Connection &apos;upgrade&apos;;</span><br><span class="line">        proxy_set_header Host $host;</span><br><span class="line">        proxy_cache_bypass $http_upgrade;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong></p></blockquote><blockquote><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> letsencrypt </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>rabbitmqå®‰è£…å¹¶é…ç½®</title>
      <link href="/2018/02/08/rabbitmq-start/"/>
      <url>/2018/02/08/rabbitmq-start/</url>
      
        <content type="html"><![CDATA[<p>æŒ‰ç…§å®˜æ–¹æ–‡æ¡£åœ¨ubuntuä¸Šå®‰è£…rabbitmqè®°å½•<br><a id="more"></a></p><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p><a href="https://www.rabbitmq.com/install-debian.html#apt" target="_blank" rel="noopener">å®˜æ–¹å®‰è£…æ–‡æ¡£</a></p><h3 id="rabbitmq-ä¾èµ–-Erlang"><a href="#rabbitmq-ä¾èµ–-Erlang" class="headerlink" title="rabbitmq ä¾èµ– Erlang"></a><a href="https://www.rabbitmq.com/which-erlang.html" target="_blank" rel="noopener">rabbitmq ä¾èµ– Erlang</a></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wget https://packages.erlang-solutions.com/erlang-solutions_1.0_all.deb</span><br><span class="line">sudo dpkg -i erlang-solutions_1.0_all.deb</span><br><span class="line"></span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install erlang</span><br></pre></td></tr></table></figure><h3 id="Ubuntu-16-04å®‰è£…rabbitmq"><a href="#Ubuntu-16-04å®‰è£…rabbitmq" class="headerlink" title="Ubuntu 16.04å®‰è£…rabbitmq"></a>Ubuntu 16.04å®‰è£…rabbitmq</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># add  Apt repository</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"deb https://dl.bintray.com/rabbitmq/debian xenial main"</span> | sudo tee /etc/apt/sources.list.d/bintray.rabbitmq.list</span><br><span class="line"></span><br><span class="line"><span class="comment"># add public key </span></span><br><span class="line">wget -O- https://dl.bintray.com/rabbitmq/Keys/rabbitmq-release-signing-key.asc | sudo apt-key add -</span><br><span class="line"></span><br><span class="line"><span class="comment"># update the package list</span></span><br><span class="line">sudo apt-get update</span><br><span class="line"></span><br><span class="line"><span class="comment"># Install rabbitmq-server package</span></span><br><span class="line">sudo apt-get install rabbitmq-server</span><br></pre></td></tr></table></figure><h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><h3 id="é…ç½®æ–‡ä»¶ä½ç½®"><a href="#é…ç½®æ–‡ä»¶ä½ç½®" class="headerlink" title="é…ç½®æ–‡ä»¶ä½ç½®"></a><a href="https://www.rabbitmq.com/configure.html#config-location" target="_blank" rel="noopener">é…ç½®æ–‡ä»¶ä½ç½®</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Generic UNIX - $RABBITMQ_HOME/etc/rabbitmq/</span><br><span class="line">Debian - /etc/rabbitmq/</span><br><span class="line">RPM - /etc/rabbitmq/</span><br><span class="line">Mac OSX (Homebrew) - $&#123;install_prefix&#125;/etc/rabbitmq/, the Homebrew prefix is usually /usr/local</span><br><span class="line">Windows - %APPDATA%\RabbitMQ\</span><br></pre></td></tr></table></figure><h3 id="rabbitmq-conf-ä»RabbitMQ-3-7-0å¼€å§‹"><a href="#rabbitmq-conf-ä»RabbitMQ-3-7-0å¼€å§‹" class="headerlink" title="rabbitmq.conf(ä»RabbitMQ 3.7.0å¼€å§‹)"></a><a href="https://www.rabbitmq.com/configure.html#config-file" target="_blank" rel="noopener"><code>rabbitmq.conf</code>(<em>ä»RabbitMQ 3.7.0å¼€å§‹</em>)</a></h3><p>å¦‚æœä¸å­˜åœ¨ <code>rabbitmq.conf</code>, å¯ä»¥æ‰‹åŠ¨åˆ›å»ºä¸€ä¸ª, ä½¿ç”¨é»˜è®¤é…ç½®è¯·å¿½ç•¥<br>è‡ªå·±é…ç½®æŒ‰ç…§ <em><a href="https://github.com/rabbitmq/rabbitmq-server/blob/master/docs/rabbitmq.conf.example" target="_blank" rel="noopener">å®˜æ–¹ example</a></em> è¿›è¡Œä¿®æ”¹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># ä¿®æ”¹ rabbitmq ç«¯å£</span><br><span class="line">listeners.tcp.default = 2018</span><br><span class="line"># ä¿®æ”¹ rabbitmq ç®¡ç†é¡µé¢ç«¯å£</span><br><span class="line">management.listener.port = 12018</span><br></pre></td></tr></table></figure><h3 id="æ‰“å¼€ç®¡ç†é¡µé¢"><a href="#æ‰“å¼€ç®¡ç†é¡µé¢" class="headerlink" title="æ‰“å¼€ç®¡ç†é¡µé¢"></a>æ‰“å¼€ç®¡ç†é¡µé¢</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo rabbitmq-plugins <span class="built_in">enable</span> rabbitmq_management</span><br></pre></td></tr></table></figure><h3 id="æŸ¥çœ‹ç”¨æˆ·"><a href="#æŸ¥çœ‹ç”¨æˆ·" class="headerlink" title="æŸ¥çœ‹ç”¨æˆ·"></a>æŸ¥çœ‹ç”¨æˆ·</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo rabbitmqctl list_users</span><br></pre></td></tr></table></figure><h3 id="æ–°å¢ç®¡ç†å‘˜ç”¨æˆ·"><a href="#æ–°å¢ç®¡ç†å‘˜ç”¨æˆ·" class="headerlink" title="æ–°å¢ç®¡ç†å‘˜ç”¨æˆ·"></a>æ–°å¢ç®¡ç†å‘˜ç”¨æˆ·</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo rabbitmqctl add_user rabbitmqAdmin password</span><br><span class="line">sudo rabbitmqctl set_user_tags rabbitmqAdmin administrator</span><br></pre></td></tr></table></figure><h3 id="é™åˆ¶-queueçš„å¤§å°"><a href="#é™åˆ¶-queueçš„å¤§å°" class="headerlink" title="é™åˆ¶ queueçš„å¤§å°"></a>é™åˆ¶ queueçš„å¤§å°</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo rabbitmqctl set_policy --priority 1 --apply-to queues seneca seneca <span class="string">'&#123;"max-length": 1000&#125;'</span></span><br></pre></td></tr></table></figure><h2 id="å¯åŠ¨-æš‚åœ-çŠ¶æ€"><a href="#å¯åŠ¨-æš‚åœ-çŠ¶æ€" class="headerlink" title="å¯åŠ¨/æš‚åœ/çŠ¶æ€"></a>å¯åŠ¨/æš‚åœ/çŠ¶æ€</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ubuntu 16.04</span></span><br><span class="line">systemctl restart rabbitmq-server.service</span><br><span class="line">systemctl start rabbitmq-server.service</span><br><span class="line">systemctl stop rabbitmq-server.service</span><br><span class="line">systemctl status rabbitmq-server.service</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><p><a href="https://www.rabbitmq.com/configure.html" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a><br><br></p><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong></p></blockquote><blockquote><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> rabbitmq </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>harakaæ”¶å‘é‚®ä»¶åˆçº§æ•™ç¨‹</title>
      <link href="/2018/02/04/haraka-introduction/"/>
      <url>/2018/02/04/haraka-introduction/</url>
      
        <content type="html"><![CDATA[<p>harakaæ²¡æœ‰å¼€ç®±å³ç”¨, éœ€è¦ä¸€ç•ªé…ç½®, æœ¬æ–‡ç®€å•ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨harakaå’Œqqé‚®ç®±é€šè®¯<br><a id="more"></a></p><h1 id="å®‰è£…å¹¶åˆå§‹åŒ–"><a href="#å®‰è£…å¹¶åˆå§‹åŒ–" class="headerlink" title="å®‰è£…å¹¶åˆå§‹åŒ–"></a>å®‰è£…å¹¶åˆå§‹åŒ–</h1><h2 id="éœ€è¦æœ‰è‡ªå®šä¹‰åŸŸåå’Œä¿®æ”¹åŸŸåè§£æçš„æƒé™"><a href="#éœ€è¦æœ‰è‡ªå®šä¹‰åŸŸåå’Œä¿®æ”¹åŸŸåè§£æçš„æƒé™" class="headerlink" title="éœ€è¦æœ‰è‡ªå®šä¹‰åŸŸåå’Œä¿®æ”¹åŸŸåè§£æçš„æƒé™"></a>éœ€è¦æœ‰è‡ªå®šä¹‰åŸŸåå’Œä¿®æ”¹åŸŸåè§£æçš„æƒé™</h2><p><em>æœ¬åœ°æµ‹è¯•æ¥æ”¶é‚®ä»¶å¯ä»¥ä¸ä½¿ç”¨è‡ªå®šä¹‰åŸŸå, å¤–ç½‘æ¥æ”¶é‚®ä»¶, æœ¬åœ°/å¤–ç½‘å‘é€é‚®ä»¶éƒ½éœ€è¦è®¾ç½®åŸŸåè§£æ MX è®¾ç½®</em></p><h2 id="å…¨å±€å®‰è£…haraka"><a href="#å…¨å±€å®‰è£…haraka" class="headerlink" title="å…¨å±€å®‰è£…haraka"></a>å…¨å±€å®‰è£…haraka</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ³¨æ„ H ä¸ºå¤§å†™</span></span><br><span class="line">npm install -g Haraka</span><br></pre></td></tr></table></figure><h2 id="ç”Ÿæˆé…ç½®æ–‡ä»¶"><a href="#ç”Ÿæˆé…ç½®æ–‡ä»¶" class="headerlink" title="ç”Ÿæˆé…ç½®æ–‡ä»¶"></a>ç”Ÿæˆé…ç½®æ–‡ä»¶</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ~/.haraka ä¸ºé…ç½®æ–‡ä»¶ç›®å½•, è‡ªè¡Œæ›´æ”¹</span></span><br><span class="line">haraka -i ~/.haraka</span><br></pre></td></tr></table></figure><h2 id="å¯åŠ¨æµ‹è¯•"><a href="#å¯åŠ¨æµ‹è¯•" class="headerlink" title="å¯åŠ¨æµ‹è¯•"></a>å¯åŠ¨æµ‹è¯•</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å› ä¸ºéœ€è¦ç›‘å¬25ç«¯å£, éƒ¨åˆ†è´¦æˆ·éœ€è¦sudo,   ~/.harakaä¸ºé…ç½®ç›®å½•</span></span><br><span class="line">haraka -c ~/.haraka</span><br></pre></td></tr></table></figure><h2 id="å®‰è£…æµ‹è¯•å·¥å…·-swaks-éå¿…é¡»-ä½†æ˜¯å®‰è£…åæµ‹è¯•æ–¹ä¾¿"><a href="#å®‰è£…æµ‹è¯•å·¥å…·-swaks-éå¿…é¡»-ä½†æ˜¯å®‰è£…åæµ‹è¯•æ–¹ä¾¿" class="headerlink" title="å®‰è£…æµ‹è¯•å·¥å…· swaks (éå¿…é¡», ä½†æ˜¯å®‰è£…åæµ‹è¯•æ–¹ä¾¿)"></a>å®‰è£…æµ‹è¯•å·¥å…· <code>swaks</code> (éå¿…é¡», ä½†æ˜¯å®‰è£…åæµ‹è¯•æ–¹ä¾¿)</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt -y install swaks</span><br></pre></td></tr></table></figure><h1 id="æ¥å—é‚®ä»¶é…ç½®"><a href="#æ¥å—é‚®ä»¶é…ç½®" class="headerlink" title="æ¥å—é‚®ä»¶é…ç½®"></a>æ¥å—é‚®ä»¶é…ç½®</h1><h2 id="è¿›å…¥é…ç½®æ–‡ä»¶å¤¹"><a href="#è¿›å…¥é…ç½®æ–‡ä»¶å¤¹" class="headerlink" title="è¿›å…¥é…ç½®æ–‡ä»¶å¤¹"></a>è¿›å…¥é…ç½®æ–‡ä»¶å¤¹</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/.haraka/config</span><br></pre></td></tr></table></figure><h2 id="ä¿®æ”¹æ—¥å¿—level-æ–¹ä¾¿æŸ¥çœ‹é”™è¯¯"><a href="#ä¿®æ”¹æ—¥å¿—level-æ–¹ä¾¿æŸ¥çœ‹é”™è¯¯" class="headerlink" title="ä¿®æ”¹æ—¥å¿—level, æ–¹ä¾¿æŸ¥çœ‹é”™è¯¯"></a>ä¿®æ”¹æ—¥å¿—level, æ–¹ä¾¿æŸ¥çœ‹é”™è¯¯</h2><p><code>vim log.ini</code>, å°† level æ”¹æˆdebug, ä¿å­˜å¹¶é€€å‡º<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">level=debug</span><br></pre></td></tr></table></figure></p><h2 id="ä¿®æ”¹QUEUEé…ç½®ä¸º-test-queue"><a href="#ä¿®æ”¹QUEUEé…ç½®ä¸º-test-queue" class="headerlink" title="ä¿®æ”¹QUEUEé…ç½®ä¸º test_queue"></a>ä¿®æ”¹QUEUEé…ç½®ä¸º <code>test_queue</code></h2><p><code>vim plugins</code>, æ³¨é‡Š <code>queue/smtp_forward</code>, æ·»åŠ  <code>test_queue</code>, ä½¿ç”¨ä¹‹å,æ¥æ”¶åˆ°çš„é‚®ä»¶å†…å®¹ä¼šå†™å…¥<code>/tmp/mail.eml</code>æ–‡ä»¶<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># QUEUE</span></span><br><span class="line"><span class="comment"># queues: discard  qmail-queue  quarantine  smtp_forward  smtp_proxy</span></span><br><span class="line"><span class="comment"># Queue mail via smtp - see config/smtp_forward.ini for where your mail goes</span></span><br><span class="line"><span class="comment"># queue/smtp_forward</span></span><br><span class="line">test_queue</span><br></pre></td></tr></table></figure></p><figure class="image-box">                <img src="/img/haraka/1.png" alt="" title="" class="">                <p></p>            </figure><h2 id="ä¿®æ”¹-host-list-è®¾ç½®å…è®¸æ¥å—å“ªäº›åç¼€çš„-email-åœ°å€-å°†ä½ çš„åŸŸåå¡«å…¥"><a href="#ä¿®æ”¹-host-list-è®¾ç½®å…è®¸æ¥å—å“ªäº›åç¼€çš„-email-åœ°å€-å°†ä½ çš„åŸŸåå¡«å…¥" class="headerlink" title="ä¿®æ”¹ host_list, è®¾ç½®å…è®¸æ¥å—å“ªäº›åç¼€çš„ email åœ°å€, å°†ä½ çš„åŸŸåå¡«å…¥"></a>ä¿®æ”¹ <code>host_list</code>, è®¾ç½®å…è®¸æ¥å—å“ªäº›åç¼€çš„ email åœ°å€, å°†ä½ çš„åŸŸåå¡«å…¥</h2><p><code>vim host_list</code>, æ·»åŠ ä½ çš„åŸŸå, æ¯”å¦‚ <code>example.com</code><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç¬¬ä¸€è¡Œæ˜¯åŸæ¥çš„host</span></span><br><span class="line">example.com</span><br></pre></td></tr></table></figure></p><h2 id="æµ‹è¯•æ¥å—é‚®ä»¶"><a href="#æµ‹è¯•æ¥å—é‚®ä»¶" class="headerlink" title="æµ‹è¯•æ¥å—é‚®ä»¶"></a>æµ‹è¯•æ¥å—é‚®ä»¶</h2><h3 id="a-ä½¿ç”¨-swaks-æµ‹è¯•æ¥å—é‚®ä»¶-å¦‚æœæœ‰åŸŸå-å¯çœ‹ä¸‹ä¸€æ­¥-ç›´æ¥ç”¨å¤–ç½‘åŸŸåæµ‹è¯•"><a href="#a-ä½¿ç”¨-swaks-æµ‹è¯•æ¥å—é‚®ä»¶-å¦‚æœæœ‰åŸŸå-å¯çœ‹ä¸‹ä¸€æ­¥-ç›´æ¥ç”¨å¤–ç½‘åŸŸåæµ‹è¯•" class="headerlink" title="a) ä½¿ç”¨ swaks æµ‹è¯•æ¥å—é‚®ä»¶ (å¦‚æœæœ‰åŸŸå, å¯çœ‹ä¸‹ä¸€æ­¥, ç›´æ¥ç”¨å¤–ç½‘åŸŸåæµ‹è¯•)"></a>a) ä½¿ç”¨ <code>swaks</code> æµ‹è¯•æ¥å—é‚®ä»¶ (å¦‚æœæœ‰åŸŸå, å¯çœ‹ä¸‹ä¸€æ­¥, ç›´æ¥ç”¨å¤–ç½‘åŸŸåæµ‹è¯•)</h3><p>ä¸‹é¢å‘½ä»¤ä¸­<code>-t to@example.com</code> ä¸ºæœ¬åœ°æ¥å—åœ°å€, åŸŸååç¼€éœ€è¦åœ¨<code>host_list</code>ä¸­å­˜åœ¨  <code>-s localhost</code>ä¸ºæŒ‡å®šä½¿ç”¨æœ¬åœ°æœåŠ¡<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">swaks -f from@qq.com -t to@example.com -s localhost</span><br></pre></td></tr></table></figure></p><p>æŸ¥çœ‹æ˜¯å¦æ”¶åˆ°é‚®ä»¶: <code>cat /tmp/mail.eml</code><br><figure class="image-box">                <img src="/img/haraka/2.png" alt="" title="" class="">                <p></p>            </figure></p><h3 id="b-é…ç½®MXè®°å½•-æ¥æ”¶å¤–éƒ¨é‚®ä»¶-å¦‚æœæ²¡æœ‰åŸŸå-è¯·çœ‹ä¸Šä¸€æ­¥"><a href="#b-é…ç½®MXè®°å½•-æ¥æ”¶å¤–éƒ¨é‚®ä»¶-å¦‚æœæ²¡æœ‰åŸŸå-è¯·çœ‹ä¸Šä¸€æ­¥" class="headerlink" title="b) é…ç½®MXè®°å½•,æ¥æ”¶å¤–éƒ¨é‚®ä»¶ (å¦‚æœæ²¡æœ‰åŸŸå, è¯·çœ‹ä¸Šä¸€æ­¥)"></a>b) é…ç½®MXè®°å½•,æ¥æ”¶å¤–éƒ¨é‚®ä»¶ (å¦‚æœæ²¡æœ‰åŸŸå, è¯·çœ‹ä¸Šä¸€æ­¥)</h3><ol><li>å°† MX è§£æåˆ°å®‰è£… <code>Haraka</code> çš„æœåŠ¡å™¨, ä»¥ä¸‹ä¸ºé˜¿é‡Œäº‘è§£æè®¾ç½®, å…¶å®ƒè¯·è‡ªè¡Œè°·æ­Œé…ç½®<figure class="image-box">                <img src="/img/haraka/3.png" alt="" title="" class="">                <p></p>            </figure><figure class="image-box">                <img src="/img/haraka/4.png" alt="" title="" class="">                <p></p>            </figure></li><li>æŠŠä½ çš„åŸŸååœ°å€å†™å…¥åˆ° <code>host_list</code> (ä¸Šé¢å·²ç»åšè¿‡äº†)</li><li><code>haraka -c ~/.haraka</code> å¯åŠ¨æœåŠ¡</li><li>ä½¿ç”¨qqé‚®ç®±å‘é€é‚®ä»¶<figure class="image-box">                <img src="/img/haraka/5.png" alt="" title="" class="">                <p></p>            </figure></li><li>æŸ¥çœ‹æ˜¯å¦æ”¶åˆ°é‚®ä»¶ <code>cat /tmp/mail.eml</code><br>å¦‚ä¸‹å›¾å¯¹ <code>suLK1CBoYXJha2Eg1f3OxA==</code> ä½¿ç”¨GBKçš„base64è§£å¯†åä¸º<code>æµ‹è¯• haraka æ­£æ–‡</code>. è§£å¯†åœ°å€  <a href="https://1024tools.com/base64" target="_blank" rel="noopener">https://1024tools.com/base64</a></li></ol><figure class="image-box">                <img src="/img/haraka/7.png" alt="" title="" class="">                <p></p>            </figure><figure class="image-box">                <img src="/img/haraka/8.png" alt="" title="" class="">                <p></p>            </figure><h1 id="å‘é€é‚®ä»¶é…ç½®-å¿…é¡»æœ‰åŸŸåå’Œ-MX-è®°å½•"><a href="#å‘é€é‚®ä»¶é…ç½®-å¿…é¡»æœ‰åŸŸåå’Œ-MX-è®°å½•" class="headerlink" title="å‘é€é‚®ä»¶é…ç½® (å¿…é¡»æœ‰åŸŸåå’Œ MX è®°å½•)"></a>å‘é€é‚®ä»¶é…ç½® (å¿…é¡»æœ‰åŸŸåå’Œ <code>MX</code> è®°å½•)</h1><h2 id="é…ç½®-MX-è®°å½•-ä¸Šé¢å·²ç»åšè¿‡äº†-è¿›å…¥é…ç½®ç›®å½•-cd-haraka-config"><a href="#é…ç½®-MX-è®°å½•-ä¸Šé¢å·²ç»åšè¿‡äº†-è¿›å…¥é…ç½®ç›®å½•-cd-haraka-config" class="headerlink" title="é…ç½® MX è®°å½• (ä¸Šé¢å·²ç»åšè¿‡äº†), è¿›å…¥é…ç½®ç›®å½• cd ~/.haraka/config"></a>é…ç½® <code>MX</code> è®°å½• (ä¸Šé¢å·²ç»åšè¿‡äº†), è¿›å…¥é…ç½®ç›®å½• <code>cd ~/.haraka/config</code></h2><h2 id="å¯ç”¨-auth-flat-file-é…ç½®"><a href="#å¯ç”¨-auth-flat-file-é…ç½®" class="headerlink" title="å¯ç”¨ auth/flat_file é…ç½®"></a>å¯ç”¨ <code>auth/flat_file</code> é…ç½®</h2><p><code>vim plugins</code>, æ”¾å¼€ <code>auth/flat_file</code> çš„æ³¨é‡Š<br><figure class="image-box">                <img src="/img/haraka/9.png" alt="" title="" class="">                <p></p>            </figure></p><h2 id="æ·»åŠ -auth-flat-file-é…ç½®æ–‡ä»¶"><a href="#æ·»åŠ -auth-flat-file-é…ç½®æ–‡ä»¶" class="headerlink" title="æ·»åŠ  auth_flat_file é…ç½®æ–‡ä»¶"></a>æ·»åŠ  <code>auth_flat_file</code> é…ç½®æ–‡ä»¶</h2><p><code>vim auth_flat_file.ini</code>(æ–°å»ºæ–‡ä»¶), å…¶ä¸­ <code>users</code> ä¸ºé…ç½®ç”¨æˆ·åå’Œå¯†ç <br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[core]</span><br><span class="line">methods=PLAIN,LOGIN</span><br><span class="line">[users]</span><br><span class="line">username=password</span><br></pre></td></tr></table></figure></p><h2 id="å¯åŠ¨harakaæœåŠ¡"><a href="#å¯åŠ¨harakaæœåŠ¡" class="headerlink" title="å¯åŠ¨harakaæœåŠ¡"></a>å¯åŠ¨harakaæœåŠ¡</h2><p><code>haraka -c ~/.haraka</code></p><h2 id="ä½¿ç”¨-swaks-æµ‹è¯•å‘é€é‚®ä»¶"><a href="#ä½¿ç”¨-swaks-æµ‹è¯•å‘é€é‚®ä»¶" class="headerlink" title="ä½¿ç”¨ swaks æµ‹è¯•å‘é€é‚®ä»¶"></a>ä½¿ç”¨ <code>swaks</code> æµ‹è¯•å‘é€é‚®ä»¶</h2><p>å…¶ä¸­<a href="mailto:`from@example.com" target="_blank" rel="noopener">`from@example.com</a><code>æ”¹æˆä½ åŸŸååç¼€,</code><a href="mailto:to@qq.com" target="_blank" rel="noopener">to@qq.com</a><code>æ”¹æˆä½ è¦æ¥æ”¶çš„åœ°å€,</code>-s localhost`ä½¿ç”¨æœ¬åœ°æœåŠ¡<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">swaks -f <span class="keyword">from</span>@example.com -t to@qq.com -au username -ap password -s localhost</span><br></pre></td></tr></table></figure></p><h2 id="æŒ‡å®šélocalhoståœ°å€å‘é€é‚®ä»¶"><a href="#æŒ‡å®šélocalhoståœ°å€å‘é€é‚®ä»¶" class="headerlink" title="æŒ‡å®šélocalhoståœ°å€å‘é€é‚®ä»¶"></a>æŒ‡å®šélocalhoståœ°å€å‘é€é‚®ä»¶</h2><p>å› ä¸º <code>auth/flat_file</code> é’ˆå¯¹ <code>localhost</code> åœ°å€ä¼šå¿½ç•¥ <code>TLS</code> è¦æ±‚, å½“æŒ‡å®šserveråä¼šå‘é€å¤±è´¥, ä»æ—¥å¿—ä¸­å¯ä»¥çœ‹åˆ° <code>[auth/flat_file] Auth disabled for insecure public connection</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŒ‡å®šsever å‘é€</span></span><br><span class="line">swaks -f from@example.com -t to@qq.com -au username -ap password -s example.com</span><br></pre></td></tr></table></figure><h2 id="æ–°å»º-plugin-å¿½ç•¥-TSL-è¦æ±‚"><a href="#æ–°å»º-plugin-å¿½ç•¥-TSL-è¦æ±‚" class="headerlink" title="æ–°å»º plugin å¿½ç•¥ TSL è¦æ±‚"></a>æ–°å»º plugin å¿½ç•¥ <code>TSL</code> è¦æ±‚</h2><h3 id="åˆ›å»º-æ–°plugin"><a href="#åˆ›å»º-æ–°plugin" class="headerlink" title="åˆ›å»º æ–°plugin"></a>åˆ›å»º æ–°plugin</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">haraka -c ~/.haraka -p auth/insecure_flat_file</span><br></pre></td></tr></table></figure><h3 id="å¤åˆ¶-flat-file-å¹¶ä¿®æ”¹æˆå¿½ç•¥TSL-è¦æ±‚"><a href="#å¤åˆ¶-flat-file-å¹¶ä¿®æ”¹æˆå¿½ç•¥TSL-è¦æ±‚" class="headerlink" title="å¤åˆ¶ flat_file å¹¶ä¿®æ”¹æˆå¿½ç•¥TSL è¦æ±‚"></a>å¤åˆ¶ <code>flat_file</code> å¹¶ä¿®æ”¹æˆå¿½ç•¥TSL è¦æ±‚</h3><p>å°†<a href="https://github.com/haraka/Haraka/blob/bfa2156f961da0988c5e05b2e3c5582511e11b4d/plugins/auth/flat_file.js#L19" target="_blank" rel="noopener">åŸæ¥flat_file.js</a>, æ³¨é‡Šæ‰å¦‚å›¾æ‰€ç¤ºçš„è¿™ä¸€è¡Œ, ç„¶åå°†å†…å®¹å†™å…¥ <code>insecure_flat_file.js</code><br><figure class="image-box">                <img src="/img/haraka/10.png" alt="" title="" class="">                <p></p>            </figure><br><code>vim ~/.haraka/plugins/auth/insecure_flat_file.js</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Auth against a flat file</span></span><br><span class="line"></span><br><span class="line">exports.register = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> plugin = <span class="keyword">this</span>;</span><br><span class="line">    plugin.inherits(<span class="string">'auth/auth_base'</span>);</span><br><span class="line">    plugin.load_flat_ini();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">exports.load_flat_ini = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> plugin = <span class="keyword">this</span>;</span><br><span class="line">    plugin.cfg = plugin.config.get(<span class="string">'auth_flat_file.ini'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        plugin.load_flat_ini();</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">exports.hook_capabilities = <span class="function"><span class="keyword">function</span> (<span class="params">next, connection</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> plugin = <span class="keyword">this</span>;</span><br><span class="line">    <span class="comment">// don't allow AUTH unless private IP or encrypted</span></span><br><span class="line">    <span class="keyword">if</span> (!connection.remote.is_private &amp;&amp; !connection.tls.enabled) &#123;</span><br><span class="line">        connection.logdebug(plugin,<span class="string">"Auth continue, but insecure public connection"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> methods = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">if</span> (plugin.cfg.core &amp;&amp; plugin.cfg.core.methods ) &#123;</span><br><span class="line">        methods = plugin.cfg.core.methods.split(<span class="string">','</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (methods &amp;&amp; methods.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        connection.capabilities.push(<span class="string">'AUTH '</span> + methods.join(<span class="string">' '</span>));</span><br><span class="line">        connection.notes.allowed_auth_methods = methods;</span><br><span class="line">    &#125;</span><br><span class="line">    next();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">exports.get_plain_passwd = <span class="function"><span class="keyword">function</span> (<span class="params">user, connection, cb</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> plugin = <span class="keyword">this</span>;</span><br><span class="line">    <span class="keyword">if</span> (plugin.cfg.users[user]) &#123;</span><br><span class="line">        <span class="keyword">return</span> cb(plugin.cfg.users[user].toString());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> cb();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><h3 id="ä¿®æ”¹-plugins-ä½¿ç”¨-insecure-flat-file"><a href="#ä¿®æ”¹-plugins-ä½¿ç”¨-insecure-flat-file" class="headerlink" title="ä¿®æ”¹ plugins, ä½¿ç”¨ insecure_flat_file"></a>ä¿®æ”¹ plugins, ä½¿ç”¨ insecure_flat_file</h3><p><code>vim ~/.haraka/config/plugins</code>, æ·»åŠ <code>auth/insecure_flat_file</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># AUTH plugins require TLS before AUTH is advertised, see</span><br><span class="line">#     https://github.com/haraka/Haraka/wiki/Require-SSL-TLS</span><br><span class="line"># auth/flat_file</span><br><span class="line"># auth/auth_proxy</span><br><span class="line"># auth/auth_ldap</span><br><span class="line">auth/insecure_flat_file</span><br></pre></td></tr></table></figure></p><h3 id="å¯åŠ¨harakaæœåŠ¡-å¹¶æµ‹è¯•"><a href="#å¯åŠ¨harakaæœåŠ¡-å¹¶æµ‹è¯•" class="headerlink" title="å¯åŠ¨harakaæœåŠ¡ å¹¶æµ‹è¯•"></a>å¯åŠ¨harakaæœåŠ¡ å¹¶æµ‹è¯•</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">haraka -c ~<span class="regexp">/.haraka</span></span><br><span class="line"><span class="regexp">swaks -f from@example.com -t to@qq.com -au username -ap password -s example.com</span></span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><ul><li><a href="https://thihara.github.io/Creating-E-Mail-Service-with-Haraka/" target="_blank" rel="noopener">Creating Your Own E-Mail service with Haraka</a></li><li><a href="https://haraka.github.io/README.html" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a></li><li><a href="https://www.youtube.com/watch?v=6twKXMAsPsw&amp;feature=youtu.be" target="_blank" rel="noopener">å®˜æ–¹è§†é¢‘</a></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong></p></blockquote><blockquote><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> haraka </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨nvmå¯¼è‡´zshå¯åŠ¨æ…¢</title>
      <link href="/2017/06/07/zsh-nvm-slow/"/>
      <url>/2017/06/07/zsh-nvm-slow/</url>
      
        <content type="html"><![CDATA[<p>è§£å†³nvmå¯åŠ¨æ…¢, è‡ªåŠ¨æ£€æµ‹ <code>.nvmrc</code> æ…¢<br><a id="more"></a></p><h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><p>æ–°å»ºç»ˆç«¯æ—¶, ç”±äºè½½å…¥nvm, å¯¼è‡´ç»ˆç«¯è½½å…¥è¶…è¿‡1ç§’.<br>åœ¨nvmå®‰è£…æ—¶, è¦æ±‚åœ¨åœ¨ <code>~/.bash_profile, ~/.zshrc, ~/.profile, ~/.bashrc</code> ä¸­çš„ä¸€ä¸ªè½½å…¥ä»¥ä¸‹å†…å®¹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> NVM_DIR=<span class="string">"<span class="variable">$HOME</span>/.nvm"</span></span><br><span class="line">[ -s <span class="string">"<span class="variable">$NVM_DIR</span>/nvm.sh"</span> ] &amp;&amp; . <span class="string">"<span class="variable">$NVM_DIR</span>/nvm.sh"</span> <span class="comment"># This loads nvm</span></span><br></pre></td></tr></table></figure><p>å°±æ˜¯<code>. &quot;$NVM_DIR/nvm.sh&quot;</code>æ‹–æ…¢äº†ç»ˆç«¯çš„å¯åŠ¨</p><h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><p>ä»å®˜æ–¹ <a href="https://github.com/creationix/nvm/issues/860" target="_blank" rel="noopener">issue#860</a>ä¸Šäº†è§£åˆ°, å¯ä»¥ä½¿ç”¨ <code>--no-use</code> å’Œ æ‰‹åŠ¨æŒ‡å®šé»˜è®¤ <code>node</code> è·¯å¾„æ¥åŠ å¿«æ‰§è¡Œé€Ÿåº¦  </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> NVM_DIR=<span class="string">"<span class="variable">$HOME</span>/.nvm"</span></span><br><span class="line">[ -s <span class="string">"<span class="variable">$NVM_DIR</span>/nvm.sh"</span> ] &amp;&amp; . <span class="string">"<span class="variable">$NVM_DIR</span>/nvm.sh"</span>  --no-use</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$HOME</span>/.nvm/versions/node/v8.0.0/bin/:<span class="variable">$PATH</span></span><br></pre></td></tr></table></figure><p><em>é»˜è®¤è·¯å¾„å¯ä»¥é€šè¿‡ <code>nvm which default</code> è·å–</em></p><h2 id="æ£€æŸ¥-nvmrc-è‡ªåŠ¨è½½å…¥å¯¹åº”nodeç‰ˆæœ¬å¤„ç†"><a href="#æ£€æŸ¥-nvmrc-è‡ªåŠ¨è½½å…¥å¯¹åº”nodeç‰ˆæœ¬å¤„ç†" class="headerlink" title="æ£€æŸ¥ .nvmrc è‡ªåŠ¨è½½å…¥å¯¹åº”nodeç‰ˆæœ¬å¤„ç†"></a>æ£€æŸ¥ .nvmrc è‡ªåŠ¨è½½å…¥å¯¹åº”nodeç‰ˆæœ¬å¤„ç†</h2><p>é€šè¿‡åˆ¤æ–­æ˜¯å¦é¦–æ¬¡è½½å…¥æ¥åŠ å¿«é€Ÿåº¦</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è‡ªåŠ¨åˆ‡æ¢nodeç‰ˆæœ¬ #</span></span><br><span class="line">nvmVersionFirstDetect=1;</span><br><span class="line"><span class="built_in">autoload</span> -U add-zsh-hook</span><br><span class="line">load-<span class="function"><span class="title">nvmrc</span></span>() &#123;</span><br><span class="line">  <span class="built_in">local</span> node_version=<span class="string">"<span class="variable">$(nvm version)</span>"</span></span><br><span class="line">  <span class="built_in">local</span> nvmrc_path=<span class="string">"<span class="variable">$(nvm_find_nvmrc)</span>"</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> [ -n <span class="string">"<span class="variable">$nvmrc_path</span>"</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">local</span> nvmrc_node_version=$(nvm version <span class="string">"<span class="variable">$(cat "$&#123;nvmrc_path&#125;")</span>"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> [ <span class="string">"<span class="variable">$nvmrc_node_version</span>"</span> = <span class="string">"N/A"</span> ]; <span class="keyword">then</span></span><br><span class="line">      nvm install</span><br><span class="line">    <span class="keyword">elif</span> [ <span class="string">"<span class="variable">$nvmrc_node_version</span>"</span> != <span class="string">"<span class="variable">$node_version</span>"</span> ]; <span class="keyword">then</span></span><br><span class="line">      nvm use</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">  <span class="keyword">elif</span> [[ <span class="variable">$&#123;nvmVersionFirstDetect&#125;</span> -eq 0 &amp;&amp; <span class="string">"<span class="variable">$node_version</span>"</span> != <span class="string">"<span class="variable">$(nvm version default)</span>"</span> ]]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"Reverting to nvm default version"</span></span><br><span class="line">    nvm use default</span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line">  nvmVersionFirstDetect=0</span><br><span class="line">&#125;</span><br><span class="line">add-zsh-hook chpwd load-nvmrc</span><br><span class="line">load-nvmrc</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="/img/zsh-nvm-slow/1.png" alt="load-nvmrc" title="" class="">                <p>load-nvmrc</p>            </figure><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><ul><li><a href="http://mushanshitiancai.github.io/2016/07/29/js/tools/%E8%A7%A3%E5%86%B3nvm%E5%AF%BC%E8%87%B4%E7%BB%88%E7%AB%AF%E5%90%AF%E5%8A%A8%E6%85%A2%E7%9A%84%E9%97%AE%E9%A2%98/" target="_blank" rel="noopener">è§£å†³nvmå¯¼è‡´ç»ˆç«¯å¯åŠ¨æ…¢çš„é—®é¢˜</a></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong></p></blockquote><blockquote><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> nvm </tag>
            
            <tag> zsh </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>macè¿è¡Œhadoopå‡ºç° Error: Java heap space</title>
      <link href="/2017/04/27/hadoop-java-heap-space/"/>
      <url>/2017/04/27/hadoop-java-heap-space/</url>
      
        <content type="html"><![CDATA[<p>mac è¿è¡Œhadoopå‡ºç° Error: Java heap space<br><a id="more"></a></p><h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜:"></a>é—®é¢˜:</h2><p><code>Error: Java heap space</code>  </p><p><img src="/img/hadoop/1.png" alt="hadoop"></p><h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ:"></a>è§£å†³æ–¹æ¡ˆ:</h2><ul><li>ç¼–è¾‘æ–‡ä»¶ <code>/usr/local/Cellar/hadoop/2.7.3/libexec/etc/hadoop/mapred-site.xml</code> æ·»åŠ  <code>Xmx4096m</code></li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapred.child.java.opts<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>-Xmx4096m<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><p>æˆ–è€…åœ¨è¿è¡Œhadoopä¹‹å‰ <code>export HADOOP_OPTS=&quot;-Xmx4096m&quot;</code></p></li><li><p>æˆ–è€…å¯¹Hadoop 2+, ä¿®æ”¹ <code>mapreduce.map.java.opts</code></p></li></ul><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><ul><li><a href="http://stackoverflow.com/questions/15609909/error-java-heap-space?answertab=active#tab-top" target="_blank" rel="noopener">http://stackoverflow.com/questions/15609909/error-java-heap-space?answertab=active#tab-top</a></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong></p></blockquote><blockquote><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> Hadoop </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[è½¬]Mac OS X EI Capitan ä¸‹å®‰è£…åŠé…ç½®ä¼ªåˆ†å¸ƒå¼ Hadoop ç¯å¢ƒ</title>
      <link href="/2017/04/26/mac-hadoop/"/>
      <url>/2017/04/26/mac-hadoop/</url>
      
        <content type="html"><![CDATA[<p>è½¬è½½å¹¶è¿›è¡Œé€‚å½“ä¿®æ”¹<br><a id="more"></a></p><h2 id="é¢„è£…ç¯å¢ƒå˜é‡"><a href="#é¢„è£…ç¯å¢ƒå˜é‡" class="headerlink" title="é¢„è£…ç¯å¢ƒå˜é‡"></a>é¢„è£…ç¯å¢ƒå˜é‡</h2><ul><li><p><a href="https://brew.sh/" target="_blank" rel="noopener">Homebrew</a></p></li><li><p><a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html" target="_blank" rel="noopener">JDK8</a></p></li><li><p>Xcode( App Store æ›´æ–°/ä¸‹è½½)</p></li></ul><h2 id="é…ç½®-SSH"><a href="#é…ç½®-SSH" class="headerlink" title="é…ç½® SSH"></a>é…ç½® SSH</h2><p>ä¸ºäº†ä¿è¯è¿œç¨‹ç™»å½•ç®¡ç† Hadoop åŠ Hadoop èŠ‚ç‚¹ç”¨æˆ·å…±äº«çš„å®‰å…¨æ€§ï¼ŒHadoop éœ€è¦é…ç½®ä½¿ç”¨ SSH åè®®</p><ul><li><p>æ‰“å¼€ç³»ç»Ÿåå¥½è®¾ç½®-å…±äº«-è¿œç¨‹ç™»å½•-å…è®¸è®¿é—®-æ‰€æœ‰ç”¨æˆ·</p></li><li><p>æ‰“å¼€&lt;ç»ˆç«¯&gt;ï¼Œåˆ†åˆ«è¾“å…¥  </p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t dsa -P <span class="string">''</span> -f ~/.ssh/id_dsa</span><br><span class="line">cat ~/.ssh/id_dsa.pub &gt;&gt;~/.ssh/authorized_keys</span><br></pre></td></tr></table></figure><ul><li>é…ç½®å¥½ä¹‹åï¼Œè¾“å…¥  <code>ssh localhost</code>, ç™»å½•æˆåŠŸå³é…ç½®å®Œæˆ</li></ul><h2 id="å®‰è£…åŠé…ç½®-Hadoop"><a href="#å®‰è£…åŠé…ç½®-Hadoop" class="headerlink" title="å®‰è£…åŠé…ç½® Hadoop"></a>å®‰è£…åŠé…ç½® Hadoop</h2><h3 id="å®‰è£…-Hadoop"><a href="#å®‰è£…-Hadoop" class="headerlink" title="å®‰è£… Hadoop"></a>å®‰è£… Hadoop</h3><ul><li>&lt;ç»ˆç«¯&gt;è¾“å…¥  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install hadoop</span><br></pre></td></tr></table></figure></li></ul><h3 id="é…ç½®ä¼ªåˆ†å¸ƒå¼-Hadoop"><a href="#é…ç½®ä¼ªåˆ†å¸ƒå¼-Hadoop" class="headerlink" title="é…ç½®ä¼ªåˆ†å¸ƒå¼ Hadoop"></a><em>é…ç½®ä¼ªåˆ†å¸ƒå¼ Hadoop</em></h3><p><br></p><h4 id="é…ç½®-hadoop-env-sh"><a href="#é…ç½®-hadoop-env-sh" class="headerlink" title="é…ç½® hadoop-env.sh"></a>é…ç½® <code>hadoop-env.sh</code></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">open /usr/<span class="built_in">local</span>/Cellar/hadoop/2.7.3/libexec/etc/hadoop/hadoop-env.sh</span><br></pre></td></tr></table></figure><p>å°†  </p><blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export HADOOP_OPTS=&quot;$HADOOP_OPTS -Djava.net.preferIPv4Stack=true&quot;</span><br></pre></td></tr></table></figure></blockquote><p>ä¿®æ”¹ä¸º<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export HADOOP_OPTS=&quot;$HADOOP_OPTS -Djava.net.preferIPv4Stack=true -Djava.security.krb5.realm= -Djava.security.krb5.kdc=&quot;</span><br></pre></td></tr></table></figure></p><h4 id="é…ç½®-yarn-env-sh"><a href="#é…ç½®-yarn-env-sh" class="headerlink" title="é…ç½® yarn-env.sh"></a>é…ç½® <code>yarn-env.sh</code></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">oopen /usr/<span class="built_in">local</span>/Cellar/hadoop/2.7.3/libexec/etc/hadoop/yarn-env.sh</span><br></pre></td></tr></table></figure><p>æ·»åŠ <br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">YARN_OPTS=&quot;$YARN_OPTS -Djava.security.krb5.realm=OX.AC.UK -Djava.security.krb5.kdc=kdc0.ox.ac.uk:kdc1.ox.ac.uk&quot;</span><br></pre></td></tr></table></figure></p><h4 id="é…ç½®-core-site-xml"><a href="#é…ç½®-core-site-xml" class="headerlink" title="é…ç½® core-site.xml"></a>é…ç½® <code>core-site.xml</code></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">open /usr/local/Cellar/hadoop/2.7.3/libexec/etc/hadoop/core-site.xml</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ä¸º:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml-stylesheet type="text/xsl" href="configuration.xsl"?&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">  Licensed under the Apache License, Version 2.0 (the "License");</span></span><br><span class="line"><span class="comment">  you may not use this file except in compliance with the License.</span></span><br><span class="line"><span class="comment">  You may obtain a copy of the License at</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    http://www.apache.org/licenses/LICENSE-2.0</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  Unless required by applicable law or agreed to in writing, software</span></span><br><span class="line"><span class="comment">  distributed under the License is distributed on an "AS IS" BASIS,</span></span><br><span class="line"><span class="comment">  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></span><br><span class="line"><span class="comment">  See the License for the specific language governing permissions and</span></span><br><span class="line"><span class="comment">  limitations under the License. See accompanying LICENSE file.</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- Put site-specific property overrides in this file. --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>fs.defaultFS<span class="tag">&lt;/<span class="name">name</span>&gt;</span>             </span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://localhost:9000<span class="tag">&lt;/<span class="name">value</span>&gt;</span>          </span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h4 id="é…ç½®-hdfs-core-xml"><a href="#é…ç½®-hdfs-core-xml" class="headerlink" title="é…ç½® hdfs-core.xml"></a>é…ç½® <code>hdfs-core.xml</code></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">open /usr/<span class="built_in">local</span>/Cellar/hadoop/2.7.3/libexec/etc/hadoop/hdfs-site.xml</span><br></pre></td></tr></table></figure><p>é…ç½®ä¸º:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.replication<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">value</span>&gt;</span>1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h4 id="é…ç½®-mapred-site-xml"><a href="#é…ç½®-mapred-site-xml" class="headerlink" title="é…ç½® mapred-site.xml"></a>é…ç½® <code>mapred-site.xml</code></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cp /usr/<span class="built_in">local</span>/Cellar/hadoop/2.7.3/libexec/etc/hadoop/mapred-site.xml.template /usr/<span class="built_in">local</span>/Cellar/hadoop/2.7.3/libexec/etc/hadoop/mapred-site.xml</span><br><span class="line">open /usr/<span class="built_in">local</span>/Cellar/hadoop/2.7.3/libexec/etc/hadoop/mapred-site.xml</span><br></pre></td></tr></table></figure><p>é…ç½®ä¸º:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.framework.name<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>yarn<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapred.child.java.opts<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>-Xmx4096m<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h4 id="é…ç½®-yarn-site-xml"><a href="#é…ç½®-yarn-site-xml" class="headerlink" title="é…ç½® yarn-site.xml"></a>é…ç½® <code>yarn-site.xml</code></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">open /usr/<span class="built_in">local</span>/Cellar/hadoop/2.7.3/libexec/etc/hadoop/yarn-site.xml</span><br></pre></td></tr></table></figure><p>é…ç½®ä¸º:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- Site specific YARN configuration properties --&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.aux-services<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>mapreduce_shuffle<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h3 id="æ ¼å¼åŒ–-HDFS"><a href="#æ ¼å¼åŒ–-HDFS" class="headerlink" title="æ ¼å¼åŒ– HDFS"></a>æ ¼å¼åŒ– <code>HDFS</code></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rm -rf /tmp/hadoop-tanjiti</span><br><span class="line">hadoop namenode -format</span><br></pre></td></tr></table></figure><h3 id="å¯åŠ¨"><a href="#å¯åŠ¨" class="headerlink" title="å¯åŠ¨"></a>å¯åŠ¨</h3><ul><li><p>å¯åŠ¨ <code>HDFS</code>   </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/<span class="built_in">local</span>/Cellar/hadoop/2.7.3/sbin/start-dfs.sh</span><br></pre></td></tr></table></figure></li><li><p>å¯åŠ¨ MapReduce</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/<span class="built_in">local</span>/Cellar/hadoop/2.7.3/sbin/start-yarn.sh</span><br></pre></td></tr></table></figure></li><li><p>æ£€æŸ¥å¯åŠ¨æƒ…å†µ    </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jps</span><br></pre></td></tr></table></figure></li></ul><blockquote><p>ç»“æœ<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1536</span><br><span class="line">6594 NameNode</span><br><span class="line">6818 SecondaryNameNode</span><br><span class="line">65478 Jps</span><br><span class="line">6694 DataNode</span><br><span class="line">6950 ResourceManager</span><br><span class="line">7051 NodeManager</span><br><span class="line">1982 Launcher</span><br><span class="line">15903 GradleDaemon</span><br></pre></td></tr></table></figure></p></blockquote><ul><li>è¿è¡Œ MapReduce è‡ªå¸¦å®ä¾‹  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop jar /usr/<span class="built_in">local</span>/Cellar/hadoop/2.7.3/libexec/share/hadoop/mapreduce/hadoop-mapreduce-examples-2.7.3.jar pi 2 5</span><br></pre></td></tr></table></figure></li></ul><h3 id="å¯è§†åŒ–æŸ¥çœ‹"><a href="#å¯è§†åŒ–æŸ¥çœ‹" class="headerlink" title="å¯è§†åŒ–æŸ¥çœ‹"></a>å¯è§†åŒ–æŸ¥çœ‹</h3><ul><li>Cluster Status <a href="http://localhost:8088" target="_blank" rel="noopener">http://localhost:8088</a></li><li>HDFS status <a href="http://localhost:50070" target="_blank" rel="noopener">http://localhost:50070</a></li><li>secondaryNamenode <a href="http://localhost:50090" target="_blank" rel="noopener">http://localhost:50090</a></li></ul><h1 id="è½¬è½½"><a href="#è½¬è½½" class="headerlink" title="è½¬è½½"></a>è½¬è½½</h1><ul><li><a href="https://github.com/100steps/Blogs/issues/10" target="_blank" rel="noopener">https://github.com/100steps/Blogs/issues/10</a></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong></p></blockquote><blockquote><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> Hadoop </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sailsä¸­ä½¿ç”¨mongodbçš„mapReduceå‡ºç°lodashä¸­å®šä¹‰çš„root</title>
      <link href="/2017/01/13/sails-lodash-mongodb-mapReduce/"/>
      <url>/2017/01/13/sails-lodash-mongodb-mapReduce/</url>
      
        <content type="html"><![CDATA[<p>åœ¨sailsä¸­ä½¿ç”¨mongodbçš„mapReduce, å‡ºç°é”™è¯¯ ReferenceError: root is not defined<br><a id="more"></a></p><h2 id="èµ·å› "><a href="#èµ·å› " class="headerlink" title="èµ·å› "></a>èµ·å› </h2><p>åœ¨ <code>sails</code> ä¸­çš„ <code>collection.mapReduce</code>, <code>scope</code>å®šä¹‰ä¸º  </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">scope = &#123;</span><br><span class="line">  <span class="string">'å…¶å®ƒæ–¹æ³•'</span>: <span class="string">'å…¶å®ƒæ–¹æ³•'</span>,</span><br><span class="line">  getZeroDay: UtilitiesService.getZeroDay,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­è°ƒç”¨äº† <code>service</code> ä¸­å®šä¹‰çš„æ–¹æ³• <code>getZeroDay</code><br>åœ¨ sails0.10 ä¸­ä½¿ç”¨æ²¡æœ‰é—®é¢˜, ä½†æ˜¯æ›´æ–°åˆ°sails0.12åå‡ºç°äº† <code>ReferenceError: root is not defined</code></p><figure class="image-box">                <img src="/img/sails-lodash-mongodb-mapReduce/1.png" alt="" title="" class="">                <p></p>            </figure><h2 id="æ¢ç´¢"><a href="#æ¢ç´¢" class="headerlink" title="æ¢ç´¢"></a>æ¢ç´¢</h2><p>åœ¨ UtilitiesService å®šä¹‰äº†<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getZeroDay</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">global.getZeroDay = getZeroDay;</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  getZeroDay: getZeroDay,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><p>åœ¨å…¶å®ƒåœ°æ–¹è°ƒç”¨å¦‚ä¸‹å†…å®¹<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(global.getZeroDay === UtilitiesService.getZeroDay); </span><br><span class="line"><span class="built_in">console</span>.log(UtilitiesService.getZeroDay.toString());</span><br></pre></td></tr></table></figure></p><p>ç»“æœå´æ˜¯ <code>UtilitiesService.getZeroDay</code> è¢«è½¬æ¢äº†<br><figure class="image-box">                <img src="/img/sails-lodash-mongodb-mapReduce/2.png" alt="" title="" class="">                <p></p>            </figure></p><p>ä»sailsçš„æºç ä¸­å¾—çŸ¥, sails0.12ç‰ˆæœ¬å¯¹ <code>loadService</code> å¤šå‡ºäº† <code>bindToSails</code>, è€Œ <code>bindToSails</code> è°ƒç”¨äº† <code>_.bindAll</code>, æœ€åè¾“å‡ºäº†å¦‚ä¸Šå›¾æ‰€ç¤ºçš„å†…å®¹<br><figure class="image-box">                <img src="/img/sails-lodash-mongodb-mapReduce/3.png" alt="sails0.10" title="" class="">                <p>sails0.10</p>            </figure></p><figure class="image-box">                <img src="/img/sails-lodash-mongodb-mapReduce/4.png" alt="sails0.12" title="" class="">                <p>sails0.12</p>            </figure><h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><p><code>collection.mapReduce</code> çš„ <code>scope</code> ä¸è¦ä» <code>service</code> ä¸­è·å–</p><p><br></p><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> sails </tag>
            
            <tag> lodash </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>safariæ— æ³•æ‰“å¼€httpsç½‘é¡µ</title>
      <link href="/2017/01/09/safari-https-fail-to-connect/"/>
      <url>/2017/01/09/safari-https-fail-to-connect/</url>
      
        <content type="html"><![CDATA[<p>Androidå’Œæ¡Œé¢chromeä»£å¼€ç½‘å€æ²¡æœ‰é—®é¢˜,ä½†æ˜¯iphoneå’Œæ¡Œé¢safariå´å‡ºç°: ã€Œ æ— æ³•æ‰“å¼€é¡µé¢<a href="https://XXXXXï¼Œå› ä¸ºç½‘ç»œè¿æ¥è¢«é‡è®¾ã€‚å¦‚æœæœåŠ¡å™¨æˆ–ç½‘ç»œè¿æ¥å¿™ç¢Œï¼Œæ­¤é—®é¢˜å¯èƒ½å‘ç”Ÿã€‚è¯·ç­‰å¾…å‡ åˆ†é’Ÿï¼Œç„¶åå†è¯•ä¸€æ¬¡ã€‚ã€" target="_blank" rel="noopener">https://XXXXXï¼Œå› ä¸ºç½‘ç»œè¿æ¥è¢«é‡è®¾ã€‚å¦‚æœæœåŠ¡å™¨æˆ–ç½‘ç»œè¿æ¥å¿™ç¢Œï¼Œæ­¤é—®é¢˜å¯èƒ½å‘ç”Ÿã€‚è¯·ç­‰å¾…å‡ åˆ†é’Ÿï¼Œç„¶åå†è¯•ä¸€æ¬¡ã€‚ã€</a><br><a id="more"></a></p><h2 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°:"></a>é—®é¢˜æè¿°:</h2><p>æ‰“å¼€ç½‘å€å‡ºç° Safari   </p><blockquote><p>ã€Œ æ— æ³•æ‰“å¼€é¡µé¢â€https ://XXXXXâ€ï¼Œå› ä¸ºç½‘ç»œè¿æ¥è¢«é‡è®¾ã€‚å¦‚æœæœåŠ¡å™¨æˆ–ç½‘ç»œè¿æ¥å¿™ç¢Œï¼Œæ­¤é—®é¢˜å¯èƒ½å‘ç”Ÿã€‚è¯·ç­‰å¾…å‡ åˆ†é’Ÿï¼Œç„¶åå†è¯•ä¸€æ¬¡ã€‚ã€  </p></blockquote><div></div><blockquote><p>ã€Œ Safari cannot open the page because the network connection was reset. The server may be busy ã€</p></blockquote><p> <img src="/img/safari-https/1.jpg" alt=""></p><h2 id="è§£å†³æ–¹æ³•"><a href="#è§£å†³æ–¹æ³•" class="headerlink" title="è§£å†³æ–¹æ³•"></a>è§£å†³æ–¹æ³•</h2><p>åœ¨ nginxçš„ server é…ç½®ä¸­æ·»åŠ <br>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssl_session_cache shared:SSL:10m;</span><br></pre></td></tr></table></figure></p><p>è¿™ä¸ªå¯èƒ½å’Œ<a href="https://trac.nginx.org/nginx/ticket/235" target="_blank" rel="noopener">nginxçš„ä¸€ä¸ªticketç›¸å…³</a>, åœ¨nginx1.10ä¸­æ²¡æœ‰å‘ç°, åœ¨1.8ä¸­å‡ºç°äº†, å…¶å®ƒç‰ˆæœ¬æœªçŸ¥.</p><h2 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h2><ul><li><a href="http://serverfault.com/questions/646142/ssl-proxying-on-nginx-different-behavior-in-different-clients" target="_blank" rel="noopener">http://serverfault.com/questions/646142/ssl-proxying-on-nginx-different-behavior-in-different-clients</a></li><li><a href="https://community.letsencrypt.org/t/apple-safari-browsers-fail-to-connect/3731/4" target="_blank" rel="noopener">https://community.letsencrypt.org/t/apple-safari-browsers-fail-to-connect/3731/4</a></li></ul><p><br></p><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[è½¬]Lodash ä¸­ assignï¼Œextend å’Œ merge çš„åŒºåˆ«</title>
      <link href="/2016/12/23/assign-vs-extend-vs-merge-in-lodash/"/>
      <url>/2016/12/23/assign-vs-extend-vs-merge-in-lodash/</url>
      
        <content type="html"><![CDATA[<p>æˆ‘ä»¬ç»å¸¸åœ¨åˆ«äººçš„ä»£ç ä¸­çœ‹è§ assignï¼Œextendï¼Œmerge å‡½æ•°ï¼Œè¿™ä¸‰ä¸ªå‡½æ•°ç”¨èµ·æ¥å¾ˆç›¸ä¼¼ï¼Œéƒ½æ˜¯åˆå¹¶æºå¯¹è±¡çš„å±æ€§åˆ°ç›®æ ‡å¯¹è±¡ä¸­ã€‚æ—¢ç„¶éƒ½æ˜¯åˆå¹¶å¯¹è±¡ï¼Œä¸ºä»€ä¹ˆè¿˜åˆ†ä¸‰ä¸ªä¸åŒçš„å‡½æ•°å‘¢ï¼Ÿå®ƒä»¬ä¹‹é—´åˆ°åº•æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ<br><a id="more"></a></p><h2 id="assign-object-sources"><a href="#assign-object-sources" class="headerlink" title="assign(object, [sources])"></a>assign(object, [sources])</h2><p>æˆ‘ä»¬å…ˆçœ‹çœ‹å®˜æ–¹ç½‘ç«™ä¸Šé¢çš„å®šä¹‰ï¼š</p><blockquote><p>Assigns own enumerable string keyed properties of source objects to the destination object. Source objects are applied from left to right. Subsequent sources overwrite property assignments of previous sources.</p></blockquote><p>æŠŠæºå¯¹è±¡(sources)çš„å±æ€§åˆ†é…åˆ°ç›®æ ‡å¯¹è±¡(object)ï¼Œæºå¯¹è±¡ä¼šä»å·¦å¾€å³åœ°è°ƒç”¨ï¼Œåé¢å¯¹è±¡çš„å±æ€§ä¼šè¦†ç›–å‰é¢çš„ã€‚</p><p>çœ‹çœ‹ä¸‹é¢çš„ä¾‹å­:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">assign(&#123;&#125;, &#123; <span class="attr">a</span>: <span class="number">1</span> &#125;, &#123; <span class="attr">b</span>: <span class="number">2</span> &#125;);</span><br><span class="line"><span class="comment">// &#123; a: 1, b: 2 &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åé¢çš„ &#123; a: 2 &#125; æŠŠå‰é¢çš„ &#123; a: 1 &#125; è¦†ç›–äº†</span></span><br><span class="line">assign(&#123;&#125;, &#123; <span class="attr">a</span>: <span class="number">1</span> &#125;, &#123; <span class="attr">b</span>: <span class="number">2</span> &#125;, &#123; <span class="attr">a</span>: <span class="number">2</span> &#125;);</span><br><span class="line"><span class="comment">// &#123; a: 2, b: 2 &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è§‚å¯Ÿä¸‹é¢ä¸¤ä¸ªä¾‹å­ï¼Œå¦‚æœå±æ€§å€¼ä¸º objectï¼Œåé¢çš„å€¼ä¼šè¦†ç›–å‰é¢çš„å€¼</span></span><br><span class="line">assign(</span><br><span class="line">  &#123;&#125;,</span><br><span class="line">  &#123; <span class="attr">a</span>: <span class="number">1</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">b</span>: &#123; <span class="attr">c</span>: <span class="number">2</span>, <span class="attr">d</span>: <span class="number">3</span> &#125; &#125;</span><br><span class="line">)</span><br><span class="line"><span class="comment">// &#123; a: 1, b: &#123; c: 2, d: 3 &#125; &#125;</span></span><br><span class="line"></span><br><span class="line">assign(</span><br><span class="line">  &#123;&#125;,</span><br><span class="line">  &#123; <span class="attr">a</span>: <span class="number">1</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">b</span>: &#123; <span class="attr">c</span>: <span class="number">2</span>, <span class="attr">d</span>: <span class="number">3</span> &#125; &#125;,</span><br><span class="line">  &#123; <span class="attr">b</span>: &#123; <span class="attr">e</span>: <span class="number">4</span> &#125; &#125;</span><br><span class="line">)</span><br><span class="line"><span class="comment">// &#123; a: 1, b: &#123; e: 4 &#125; &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// `assign` å‡½æ•°ä¼šå¿½ç•¥åŸå‹é“¾ä¸Šçš„å±æ€§ã€‚</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Foo</span>(<span class="params"></span>) </span>&#123; <span class="keyword">this</span>.c = <span class="number">3</span>; &#125;</span><br><span class="line">Foo.prototype.d = <span class="number">4</span>;</span><br><span class="line">assign(&#123; <span class="attr">a</span>: <span class="number">1</span> &#125;, <span class="keyword">new</span> Foo());</span><br><span class="line"><span class="comment">// &#123; a: 1, c: 3 &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// `assign` ä¼šä¿®æ”¹åŸæ¥çš„å¯¹è±¡</span></span><br><span class="line"><span class="keyword">var</span> test = &#123; <span class="attr">a</span>: <span class="number">1</span> &#125;;</span><br><span class="line">assign(test, &#123; <span class="attr">b</span>: <span class="number">2</span> &#125;); <span class="comment">// &#123; a: 1, b: 2 &#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(test);      <span class="comment">// &#123; a: 1, b: 2 &#125;</span></span><br></pre></td></tr></table></figure><h2 id="extend-object-sources"><a href="#extend-object-sources" class="headerlink" title="extend(object, [sources])"></a>extend(object, [sources])</h2><p>åœ¨ 3.x ç‰ˆæœ¬ä¸­ï¼Œ<code>extend</code> æ˜¯ <code>assign</code> çš„åˆ«åï¼Œå®ƒä»¬çš„ä½œç”¨æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚<br>åœ¨ 4.x ç‰ˆæœ¬ä¸­ï¼Œ<code>extend</code> æ˜¯ <code>assignIn</code> çš„åˆ«åï¼Œå’Œ <code>assign</code> æœ‰ç‚¹åŒºåˆ«ã€‚</p><p>å®˜æ–¹å®šä¹‰å¦‚ä¸‹ï¼š</p><blockquote><p>This method is like _.assign except that it iterates over own and inherited source properties.</p></blockquote><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“ <code>assign</code> å‡½æ•°ä¸ä¼šæŠŠåŸå‹é“¾ä¸Šçš„å±æ€§åˆå¹¶åˆ°ç›®æ ‡å¯¹è±¡ï¼Œè€Œ <code>extend</code> æˆ– <code>assignIn</code> å‡½æ•°åˆ™ä¼šï¼</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Important !! this is Lodash 4.x !!</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æŠŠæºå¯¹è±¡åŸå‹é“¾ä¸Šçš„å±æ€§ä¹Ÿåˆå¹¶åˆ°ç›®æ ‡å¯¹è±¡ä¸Šï¼</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Foo</span>(<span class="params"></span>) </span>&#123; <span class="keyword">this</span>.c = <span class="number">3</span>; &#125;</span><br><span class="line">Foo.prototype.d = <span class="number">4</span>;</span><br><span class="line">extend(&#123; <span class="attr">a</span>: <span class="number">1</span> &#125;, <span class="keyword">new</span> Foo());</span><br><span class="line"><span class="comment">// &#123; a: 1, c: 3, d: 4 &#125;</span></span><br></pre></td></tr></table></figure><h2 id="merge-object-sources"><a href="#merge-object-sources" class="headerlink" title="merge(object, [sources])"></a>merge(object, [sources])</h2><p>æˆ‘ä»¬çœ‹çœ‹ <code>merge</code> å‡½æ•°çš„å®šä¹‰ï¼š</p><blockquote><p>This method is like _.assign except that it recursively merges own and inherited enumerable string keyed properties of source objects into the destination object. Source properties that resolve to undefined are skipped if a destination value exists. Array and plain object properties are merged recursively.Other objects and value types are overridden by assignment. Source objects are applied from left to right. Subsequent sources overwrite property assignments of previous sources.</p></blockquote><p><code>merge</code> ä¹Ÿå’Œ <code>assign</code> ç±»ä¼¼ï¼Œä¸åŒçš„åœ°æ–¹åœ¨äº <code>merge</code> é‡åˆ°ç›¸åŒå±æ€§çš„æ—¶å€™ï¼Œå¦‚æœå±æ€§å€¼ä¸ºçº¯å¯¹è±¡(plain object)æˆ–è€…é›†åˆ(collection)æ—¶ï¼Œä¸æ˜¯ç”¨åé¢çš„å±æ€§å€¼å»è¦†ç›–å‰é¢çš„å±æ€§å€¼ï¼Œè€Œæ˜¯ä¼šæŠŠå‰åä¸¤ä¸ªå±æ€§å€¼åˆå¹¶ã€‚<br>å¦‚æœæºå¯¹è±¡çš„å±æ€§å€¼ä¸º <code>undefined</code>ï¼Œåˆ™ä¼šå¿½ç•¥è¯¥å±æ€§ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">assign(</span><br><span class="line">  &#123;&#125;,</span><br><span class="line">  &#123; <span class="attr">a</span>: <span class="number">1</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">b</span>: &#123; <span class="attr">c</span>: <span class="number">2</span>, <span class="attr">d</span>: <span class="number">3</span>&#125; &#125;,</span><br><span class="line">  &#123; <span class="attr">b</span>: &#123; <span class="attr">e</span>: <span class="number">4</span> &#125; &#125;</span><br><span class="line">)</span><br><span class="line"><span class="comment">// &#123; a: 1, b: &#123; e: 4 &#125; &#125;</span></span><br><span class="line">merge(</span><br><span class="line">  &#123;&#125;,</span><br><span class="line">  &#123; <span class="attr">a</span>: <span class="number">1</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">b</span>: &#123; <span class="attr">c</span>: <span class="number">2</span>, <span class="attr">d</span>: <span class="number">3</span>&#125; &#125;,</span><br><span class="line">  &#123; <span class="attr">b</span>: &#123; <span class="attr">e</span>: <span class="number">4</span> &#125; &#125;</span><br><span class="line">)</span><br><span class="line"><span class="comment">// &#123; a: 1, b: &#123; c: 2, d: 3, e: 4 &#125; &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆå¹¶é›†åˆ</span></span><br><span class="line"><span class="keyword">var</span> users = &#123;</span><br><span class="line">  <span class="string">'data'</span>: [&#123; <span class="string">'user'</span>: <span class="string">'barney'</span> &#125;, &#123; <span class="string">'user'</span>: <span class="string">'fred'</span> &#125;]</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> ages = &#123;</span><br><span class="line">  <span class="string">'data'</span>: [&#123; <span class="string">'age'</span>: <span class="number">36</span> &#125;, &#123; <span class="string">'age'</span>: <span class="number">40</span> &#125;]</span><br><span class="line">&#125;;</span><br><span class="line">merge(&#123;&#125;, users, ages)</span><br><span class="line"><span class="comment">// &#123; data: [ &#123; user: 'barney', age: 36 &#125;, &#123; user: 'fred', age: 40 &#125; ] &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// merge å‡½æ•°ä¼šä¿®æ”¹åŸæ¥çš„å¯¹è±¡ï¼</span></span><br><span class="line">merge(users, ages)</span><br><span class="line"><span class="built_in">console</span>.log(users) <span class="comment">// &#123; data: [ &#123; user: 'barney', age: 36 &#125;, &#123; user: 'fred', age: 40 &#125; ]</span></span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><h3 id="ç›¸åŒä¹‹å¤„"><a href="#ç›¸åŒä¹‹å¤„" class="headerlink" title="ç›¸åŒä¹‹å¤„"></a>ç›¸åŒä¹‹å¤„</h3><ul><li>éƒ½å¯ä»¥ç”¨æ¥åˆå¹¶å¯¹è±¡</li><li>éƒ½ä¼šä¿®æ”¹åŸæ¥çš„å¯¹è±¡ (å¦‚æœåŸæ¥çš„å¯¹è±¡æ˜¯ä½œä¸ºå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°çš„è¯)</li></ul><h3 id="ä¸åŒä¹‹å¤„"><a href="#ä¸åŒä¹‹å¤„" class="headerlink" title="ä¸åŒä¹‹å¤„"></a>ä¸åŒä¹‹å¤„</h3><ul><li><p><code>assign</code> å‡½æ•°ä¸ä¼šå¤„ç†åŸå‹é“¾ä¸Šçš„å±æ€§ï¼Œä¹Ÿä¸ä¼šåˆå¹¶ç›¸åŒçš„å±æ€§ï¼Œè€Œæ˜¯ç”¨åé¢çš„å±æ€§å€¼è¦†ç›–å‰é¢çš„å±æ€§å€¼</p></li><li><p><code>extend</code></p><ul><li>3.x ç‰ˆæœ¬ä¸­å’Œ <code>assign</code> ä¸€æ ·</li><li>4.x ç‰ˆæœ¬ä¸­ä¼šåˆå¹¶åŸå‹é“¾ä¸Šçš„å±æ€§</li></ul></li><li><p><code>merge</code> é‡åˆ°ç›¸åŒå±æ€§åçš„æ—¶å€™ï¼Œå¦‚æœå±æ€§å€¼æ˜¯çº¯å¯¹è±¡æˆ–é›†åˆçš„æ—¶å€™ï¼Œä¼šåˆå¹¶å±æ€§å€¼</p></li></ul><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://lodash.com/docs" target="_blank" rel="noopener">https://lodash.com/docs</a><br><a href="http://stackoverflow.com/questions/19965844/lodash-difference-between-extend-assign-and-merge" target="_blank" rel="noopener">http://stackoverflow.com/questions/19965844/lodash-difference-between-extend-assign-and-merge</a></p><h2 id="åŸæ–‡"><a href="#åŸæ–‡" class="headerlink" title="åŸæ–‡"></a>åŸæ–‡</h2><p>  <a href="https://scarletsky.github.io/2016/04/02/assign-vs-extend-vs-merge-in-lodash/" target="_blank" rel="noopener">https://scarletsky.github.io/2016/04/02/assign-vs-extend-vs-merge-in-lodash/</a>  </p><p><br></p><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
            <tag> lodash </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¾®ä¿¡å°ç¨‹åºä¸­ä½¿ç”¨lodash</title>
      <link href="/2016/11/30/mina-lodash/"/>
      <url>/2016/11/30/mina-lodash/</url>
      
        <content type="html"><![CDATA[<p>å¾®ä¿¡å°ç¨‹åºå¼•å…¥lodashå‡ºé”™è§£å†³æ–¹æ¡ˆ<br><a id="more"></a></p><h1 id="å¾®ä¿¡å°ç¨‹åºä¸­ä½¿ç”¨lodash"><a href="#å¾®ä¿¡å°ç¨‹åºä¸­ä½¿ç”¨lodash" class="headerlink" title="å¾®ä¿¡å°ç¨‹åºä¸­ä½¿ç”¨lodash"></a>å¾®ä¿¡å°ç¨‹åºä¸­ä½¿ç”¨lodash</h1><h2 id="æ¢ç©¶è¿‡ç¨‹"><a href="#æ¢ç©¶è¿‡ç¨‹" class="headerlink" title="æ¢ç©¶è¿‡ç¨‹"></a>æ¢ç©¶è¿‡ç¨‹</h2><p><strong>ä¸æƒ³çœ‹æ¢ç©¶è¿‡ç¨‹çš„, ç»“è®ºåœ¨æœ€å.</strong> </p><ul><li><p>å®‰è£… <code>lodash.get</code>, æ‹·è´æ–‡ä»¶<code>node_modules/lodash.get/index.js</code>è‡³ <code>utils/lodash.get/index.js</code>, ç„¶åç›´æ¥  <code>require(&#39;./utils/lodash.get/index.js&#39;)</code>, å¯ä»¥æ­£å¸¸ä½¿ç”¨  </p></li><li><p>æ‹·è´ <code>node_modules/lodash/lodash.js</code> æ–‡ä»¶è‡³ <code>utils/lodash/lodash.js</code>, ç„¶åç›´æ¥ <code>require(&#39;./utils/lodash/lodash.js&#39;)</code>, å‡ºç° </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Uncaught TypeError: Cannot read property &apos;prototype&apos; of undefined</span><br></pre></td></tr></table></figure></li></ul><figure class="image-box">                <img src="/img/mina/mina-lodash1.png" alt="lodash" title="" class="">                <p>lodash</p>            </figure>  <p>è·³è½¬è‡³æºç  å‘ç° <code>Array</code> ä¸å­˜åœ¨, å› ä¸º <code>freeGlobal</code> å’Œ <code>freeSelf</code> éƒ½ä¸º <code>false</code>, å› ä¸ºå¾®ä¿¡ç›´æ¥æ³¨å…¥äº† <code>window</code> å’Œ <code>self</code>;</p><figure class="image-box">                <img src="/img/mina/mina-lodash2.png" alt="lodash" title="" class="">                <p>lodash</p>            </figure>  <p><img src="/img/mina/mina-lodash3.png" alt="lodash"> </p><figure class="image-box">                <img src="/img/mina/mina-lodash5.png" alt="lodash" title="" class="">                <p>lodash</p>            </figure>  <p> æœ€ç»ˆ, <code>Array = (Function(&#39;return this&#39;)()).Array</code> ä¸º <code>undefined</code>.</p><p> æ‰€ä»¥, åªéœ€è¦æ›¿æ¢ <code>root</code> çš„å€¼å³å¯, ä»lodashçš„æºç ä¸­å‘ç°, <code>lodash</code> ä¼špickä»¥ä¸‹å±æ€§<br> <img src="/img/mina/mina-lodash6.png" alt="lodash">    </p><p> ä½¿ç”¨<code>try catch</code> ç›‘æµ‹æ”¯æŒå±æ€§<br>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123; root.Array = <span class="built_in">Array</span> &#125; <span class="keyword">catch</span> (e) &#123; <span class="built_in">console</span>.log(<span class="string">'Array not support in MINA, skip'</span>) &#125;</span><br><span class="line"><span class="keyword">try</span> &#123; root.Buffer = Buffer &#125; <span class="keyword">catch</span> (e) &#123; <span class="built_in">console</span>.log(<span class="string">'Buffer not support in MINA, skip'</span>) &#125;</span><br><span class="line"><span class="keyword">try</span> &#123; root.DataView = <span class="built_in">DataView</span> &#125; <span class="keyword">catch</span> (e) &#123; <span class="built_in">console</span>.log(<span class="string">'DataView not support in MINA, skip'</span>) &#125;</span><br><span class="line"><span class="keyword">try</span> &#123; root.Date = <span class="built_in">Date</span> &#125; <span class="keyword">catch</span> (e) &#123; <span class="built_in">console</span>.log(<span class="string">'Date not support in MINA, skip'</span>) &#125;</span><br><span class="line"><span class="keyword">try</span> &#123; root.Error = <span class="built_in">Error</span> &#125; <span class="keyword">catch</span> (e) &#123; <span class="built_in">console</span>.log(<span class="string">'Error not support in MINA, skip'</span>) &#125;</span><br><span class="line"><span class="keyword">try</span> &#123; root.Float32Array = <span class="built_in">Float32Array</span> &#125; <span class="keyword">catch</span> (e) &#123; <span class="built_in">console</span>.log(<span class="string">'Float32Array not support in MINA, skip'</span>) &#125;</span><br><span class="line"><span class="keyword">try</span> &#123; root.Float64Array = <span class="built_in">Float64Array</span> &#125; <span class="keyword">catch</span> (e) &#123; <span class="built_in">console</span>.log(<span class="string">'Float64Array not support in MINA, skip'</span>) &#125;</span><br><span class="line"><span class="keyword">try</span> &#123; root.Function = <span class="built_in">Function</span> &#125; <span class="keyword">catch</span> (e) &#123; <span class="built_in">console</span>.log(<span class="string">'Function not support in MINA, skip'</span>) &#125;</span><br><span class="line"><span class="keyword">try</span> &#123; root.Int8Array = <span class="built_in">Int8Array</span> &#125; <span class="keyword">catch</span> (e) &#123; <span class="built_in">console</span>.log(<span class="string">'Int8Array not support in MINA, skip'</span>) &#125;</span><br><span class="line"><span class="keyword">try</span> &#123; root.Int16Array = <span class="built_in">Int16Array</span> &#125; <span class="keyword">catch</span> (e) &#123; <span class="built_in">console</span>.log(<span class="string">'Int16Array not support in MINA, skip'</span>) &#125;</span><br><span class="line"><span class="keyword">try</span> &#123; root.Int32Array = <span class="built_in">Int32Array</span> &#125; <span class="keyword">catch</span> (e) &#123; <span class="built_in">console</span>.log(<span class="string">'Int32Array not support in MINA, skip'</span>) &#125;</span><br><span class="line"><span class="keyword">try</span> &#123; root.Map = <span class="built_in">Map</span> &#125; <span class="keyword">catch</span> (e) &#123; <span class="built_in">console</span>.log(<span class="string">'Map not support in MINA, skip'</span>) &#125;</span><br><span class="line"><span class="keyword">try</span> &#123; root.Math = <span class="built_in">Math</span> &#125; <span class="keyword">catch</span> (e) &#123; <span class="built_in">console</span>.log(<span class="string">'Math not support in MINA, skip'</span>) &#125;</span><br><span class="line"><span class="keyword">try</span> &#123; root.Object = <span class="built_in">Object</span> &#125; <span class="keyword">catch</span> (e) &#123; <span class="built_in">console</span>.log(<span class="string">'Object not support in MINA, skip'</span>) &#125;</span><br><span class="line"><span class="keyword">try</span> &#123; root.Promise = <span class="built_in">Promise</span> &#125; <span class="keyword">catch</span> (e) &#123; <span class="built_in">console</span>.log(<span class="string">'Promise not support in MINA, skip'</span>) &#125;</span><br><span class="line"><span class="keyword">try</span> &#123; root.RegExp = <span class="built_in">RegExp</span> &#125; <span class="keyword">catch</span> (e) &#123; <span class="built_in">console</span>.log(<span class="string">'RegExp not support in MINA, skip'</span>) &#125;</span><br><span class="line"><span class="keyword">try</span> &#123; root.Set = <span class="built_in">Set</span> &#125; <span class="keyword">catch</span> (e) &#123; <span class="built_in">console</span>.log(<span class="string">'Set not support in MINA, skip'</span>) &#125;</span><br><span class="line"><span class="keyword">try</span> &#123; root.String = <span class="built_in">String</span> &#125; <span class="keyword">catch</span> (e) &#123; <span class="built_in">console</span>.log(<span class="string">'String not support in MINA, skip'</span>) &#125;</span><br><span class="line"><span class="keyword">try</span> &#123; root.Symbol = <span class="built_in">Symbol</span> &#125; <span class="keyword">catch</span> (e) &#123; <span class="built_in">console</span>.log(<span class="string">'Symbol not support in MINA, skip'</span>) &#125;</span><br><span class="line"><span class="keyword">try</span> &#123; root.TypeError = <span class="built_in">TypeError</span> &#125; <span class="keyword">catch</span> (e) &#123; <span class="built_in">console</span>.log(<span class="string">'TypeError not support in MINA, skip'</span>) &#125;</span><br><span class="line"><span class="keyword">try</span> &#123; root.Uint8Array = <span class="built_in">Uint8Array</span> &#125; <span class="keyword">catch</span> (e) &#123; <span class="built_in">console</span>.log(<span class="string">'Uint8Array not support in MINA, skip'</span>) &#125;</span><br><span class="line"><span class="keyword">try</span> &#123; root.Uint8ClampedArray = <span class="built_in">Uint8ClampedArray</span> &#125; <span class="keyword">catch</span> (e) &#123; <span class="built_in">console</span>.log(<span class="string">'Uint8ClampedArray not support in MINA, skip'</span>) &#125;</span><br><span class="line"><span class="keyword">try</span> &#123; root.Uint16Array = <span class="built_in">Uint16Array</span> &#125; <span class="keyword">catch</span> (e) &#123; <span class="built_in">console</span>.log(<span class="string">'Uint16Array not support in MINA, skip'</span>) &#125;</span><br><span class="line"><span class="keyword">try</span> &#123; root.Uint32Array = <span class="built_in">Uint32Array</span> &#125; <span class="keyword">catch</span> (e) &#123; <span class="built_in">console</span>.log(<span class="string">'Uint32Array not support in MINA, skip'</span>) &#125;</span><br><span class="line"><span class="keyword">try</span> &#123; root.WeakMap = <span class="built_in">WeakMap</span> &#125; <span class="keyword">catch</span> (e) &#123; <span class="built_in">console</span>.log(<span class="string">'WeakMap not support in MINA, skip'</span>) &#125;</span><br><span class="line"><span class="keyword">try</span> &#123; root._ = _ &#125; <span class="keyword">catch</span> (e) &#123; <span class="built_in">console</span>.log(<span class="string">'_ not support in MINA, skip'</span>) &#125;</span><br><span class="line"><span class="keyword">try</span> &#123; root.clearTimeout = clearTimeout &#125; <span class="keyword">catch</span> (e) &#123; <span class="built_in">console</span>.log(<span class="string">'clearTimeout not support in MINA, skip'</span>) &#125;</span><br><span class="line"><span class="keyword">try</span> &#123; root.isFinite = <span class="built_in">isFinite</span> &#125; <span class="keyword">catch</span> (e) &#123; <span class="built_in">console</span>.log(<span class="string">'isFinite not support in MINA, skip'</span>) &#125;</span><br><span class="line"><span class="keyword">try</span> &#123; root.parseInt = <span class="built_in">parseInt</span> &#125; <span class="keyword">catch</span> (e) &#123; <span class="built_in">console</span>.log(<span class="string">'parseInt not support in MINA, skip'</span>) &#125;</span><br><span class="line"><span class="keyword">try</span> &#123; root.setTimeout = setTimeout &#125; <span class="keyword">catch</span> (e) &#123; <span class="built_in">console</span>.log(<span class="string">'setTimeout not support in MINA, skip'</span>) &#125;</span><br></pre></td></tr></table></figure></p><p>  åœ¨å¾®ä¿¡Androidä¸­æµ‹è¯•å, å‘ç°å°ç¨‹åºä¸æ”¯æŒä»¥ä¸‹å±æ€§<br>  <img src="/img/mina/mina-lodash7.png" alt="lodash">    </p><h2 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h2><ol><li><p>ç›´æ¥å¼•å…¥ <code>lodash modularize</code> ä¹‹åçš„åŒ…å¯ä»¥è§£å†³</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm install lodash.get</span><br><span class="line">let get = require(&apos;./your_copy_path/lodash.get/index&apos;);</span><br><span class="line">// ç›´æ¥ä½¿ç”¨ get(obj, path);</span><br></pre></td></tr></table></figure></li><li><p>å°†lodash4.16.6 <code>lodash/lodash.js:416</code> ä¸­  </p> <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> root = freeGlobal || freeSelf || <span class="built_in">Function</span>(<span class="string">'return this'</span>)();</span><br></pre></td></tr></table></figure><p> æ›¿æ¢ä¸º  </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> root = &#123;</span><br><span class="line">  <span class="built_in">Array</span>: <span class="built_in">Array</span>,</span><br><span class="line">  <span class="built_in">Date</span>: <span class="built_in">Date</span>,</span><br><span class="line">  <span class="built_in">Error</span>: <span class="built_in">Error</span>,</span><br><span class="line">  <span class="built_in">Function</span>: <span class="built_in">Function</span>,</span><br><span class="line">  <span class="built_in">Math</span>: <span class="built_in">Math</span>,</span><br><span class="line">  <span class="built_in">Object</span>: <span class="built_in">Object</span>,</span><br><span class="line">  <span class="built_in">RegExp</span>: <span class="built_in">RegExp</span>,</span><br><span class="line">  <span class="built_in">String</span>: <span class="built_in">String</span>,</span><br><span class="line">  <span class="built_in">TypeError</span>: <span class="built_in">TypeError</span>,</span><br><span class="line">  setTimeout: setTimeout,</span><br><span class="line">  clearTimeout: clearTimeout,</span><br><span class="line">  setInterval: setInterval,</span><br><span class="line">  clearInterval: clearInterval</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li><li><p>å¦‚æœæ¯æ¬¡ä¿®æ”¹å«Œéº»çƒ¦, å¯ä»¥ä½¿ç”¨è„šæœ¬æ§åˆ¶<br>ä¹Ÿå¯ä»¥å°è¯•æˆ‘è‡ªç”¨çš„å¾®ä¿¡éª¨æ¶ <a href="https://github.com/xinshangshangxin/MINA-seed" target="_blank" rel="noopener">https://github.com/xinshangshangxin/MINA-seed</a>, <em>æ³¨å…¥äº† bluebird, lodash, promisifyäº†wx.xxxæ¥å£, ä¿®æ”¹äº† vConsole ä¸è¾“å‡ºfunctionå’Œerror</em>  </p><p><br>    </p></li></ol><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> wechat </tag>
            
            <tag> å°ç¨‹åº </tag>
            
            <tag> MINA </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¾®ä¿¡å°ç¨‹åºä¸­ä½¿ç”¨bluebird</title>
      <link href="/2016/11/24/mina-bluebird/"/>
      <url>/2016/11/24/mina-bluebird/</url>
      
        <content type="html"><![CDATA[<p>å¾®ä¿¡å°ç¨‹åºä¸æ”¯æŒPromise, å¼•å…¥bluebirdçš„æ¢ç©¶è¿‡ç¨‹<br><a id="more"></a></p><h1 id="å¾®ä¿¡å°ç¨‹åºä¸­ä½¿ç”¨bluebird"><a href="#å¾®ä¿¡å°ç¨‹åºä¸­ä½¿ç”¨bluebird" class="headerlink" title="å¾®ä¿¡å°ç¨‹åºä¸­ä½¿ç”¨bluebird"></a>å¾®ä¿¡å°ç¨‹åºä¸­ä½¿ç”¨bluebird</h1><p><strong>2017/1/13æ›´æ–°, æ·»åŠ è¯´æ˜bluebird.joinæ— æ³•ä½¿ç”¨</strong></p><h2 id="æ¢ç©¶è¿‡ç¨‹"><a href="#æ¢ç©¶è¿‡ç¨‹" class="headerlink" title="æ¢ç©¶è¿‡ç¨‹"></a>æ¢ç©¶è¿‡ç¨‹</h2><p><strong>ä¸æƒ³çœ‹æ¢ç©¶è¿‡ç¨‹çš„, ç»“è®ºåœ¨æœ€å.</strong><br>å› ä¸º <code>bluebird</code> ä¼šæŠ›å‡º <code>Unhandled rejection Error</code>, ä»¥åŠå¼ºå¤§çš„æ–¹æ³•, å¦‚ <code>map</code>, <code>props</code> ç­‰, ä½¿ç”¨ <code>es6-promise</code> æ— æ³•æ»¡è¶³æˆ‘, æ•…æ¢ç©¶å¦‚ä½•å¼•å…¥ <code>bluebird</code></p><ul><li>ç›´æ¥å¼•å…¥<br>åœ¨ <code>npm install bluebird</code> ä¹‹å, ç›´æ¥ä½¿ç”¨</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="built_in">Promise</span> = <span class="built_in">require</span>(<span class="string">'../node_modules/bluebird/js/release/bluebird.js'</span>);</span><br></pre></td></tr></table></figure><p>æç¤º <code>module &quot;node_modules/bluebird/js/release/bluebird.js&quot; is not defined</code>;</p><ul><li><p>å°†å®‰è£…åçš„æ–‡ä»¶å¤¹å¤åˆ¶<br><code>node_modules/bluebird/js/release</code> å­˜åœ¨ browser å’Œ release 2 ä¸ªæ–‡ä»¶å¤¹, ç”±äºå¾®ä¿¡å°ç¨‹åºå¹¶ä¸è¿è¡Œåœ¨æµè§ˆå™¨ä¸­, æ•…ä¸èƒ½å¼•å…¥browser; å°† release æ–‡ä»¶å¤¹æ‹·è´è‡³ utils æ–‡ä»¶å¤¹åå¼•å…¥. åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­è™½ç„¶æŠ¥äº† 8ä¸ª <code>can not create Function</code>,ä½†æ˜¯ä¾ç„¶å¯ä»¥ä½¿ç”¨.</p><p><img src="/img/mina/mina2.png" alt=""></p><p><strong>2017/1/13æ›´æ–°, 8ä¸ªwarnå·²ç»è½¬æ¢ä¸ºerror, åŸå› ä¸º Promise.joinéœ€è¦ä½¿ç”¨ <code>new Function</code>, ä½†æ˜¯å°ç¨‹åºFunction è¡¨ç°ä¸ä¸€è‡´å¯¼è‡´, æœ€ç»ˆå†³å®šå»é™¤ <code>bluebird/js/release/join.js</code>, å³ <code>bluebird.jooin</code>ä¸å·¥ä½œ</strong></p></li><li><p>çœŸæœºç¯å¢ƒæµ‹è¯•<br>åœ¨çœŸæœºç¯å¢ƒä¸­ä½¿ç”¨æ—¶(æˆ‘Android4.4), å´å‡ºç°äº† <code>cannot create property &#39;createElement&#39; of undefined</code></p><p><img src="/img/mina/mina1.png" alt=""></p></li></ul><ul><li><p>æœç´¢ <code>createElement</code> å¯»æ‰¾çº¿ç´¢<br>åœ¨ æœç´¢<code>node_modules/bluebird/js/release/</code>æ–‡ä»¶å¤¹åå‘ç°, åœ¨ <code>schedule.js</code> ä¸­å­˜åœ¨ <code>createElement</code>; </p><p><img src="/img/mina/mina3.png" alt=""></p><p>åˆ†æä»£ç åå‘ç°åœ¨çœŸæœºä¸­, ç¨‹åºè¿›å…¥äº†ä»¥ä¸‹å†…å®¹</p><p><img src="/img/mina/mina4.png" alt=""></p></li></ul><ul><li>è§£å†³æ–¹æ¡ˆ<br>ä¿®æ”¹ <code>schedule.js</code>, è®©å…¶ç›´æ¥ä½¿ç”¨ <code>setTimeout</code>.</li></ul><h2 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h2><ol><li><code>npm i bluebird</code></li><li>å°† <code>node_modules/bluebird/js/release</code> æ–‡ä»¶å¤¹æ‹·è´å‡ºæ¥, æ¯”å¦‚æ‹·è´åˆ° <code>utils</code> ç›®å½•ä¸‹</li><li><p>å°† <code>utils/bluebird/js/release/schedule.js</code> ä¸­çš„å†…å®¹æ›¿æ¢ä¸º</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> (<span class="params">fn</span>) </span>&#123;</span><br><span class="line">  setTimeout(fn, <span class="number">0</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li><li><p>require åä½¿ç”¨</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="built_in">Promise</span> = <span class="built_in">require</span>(<span class="string">'./bluebird/js/release/bluebird.js'</span>);</span><br></pre></td></tr></table></figure></li><li><p>å¦‚æœæ¯æ¬¡ä¿®æ”¹å«Œéº»çƒ¦, å¯ä»¥ä½¿ç”¨è„šæœ¬æ§åˆ¶<br>ä¹Ÿå¯ä»¥å°è¯• æˆ‘è‡ªç”¨çš„å¾®ä¿¡éª¨æ¶ <a href="https://github.com/xinshangshangxin/MINA-seed" target="_blank" rel="noopener">https://github.com/xinshangshangxin/MINA-seed</a>, <em>æ³¨å…¥äº† bluebird, lodash, promisifyäº†wx.xxxæ¥å£, ä¿®æ”¹äº† vConsole ä¸è¾“å‡ºfunctionå’Œerror</em>  </p></li></ol><h2 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h2><ul><li><a href="https://cnodejs.org/topic/57eb4e4bea2fa420446d4371" target="_blank" rel="noopener">https://cnodejs.org/topic/57eb4e4bea2fa420446d4371</a></li></ul><p><br></p><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> wechat </tag>
            
            <tag> å°ç¨‹åº </tag>
            
            <tag> MINA </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¾®ä¿¡æ€»ç»“</title>
      <link href="/2016/09/22/wechat-summary/"/>
      <url>/2016/09/22/wechat-summary/</url>
      
        <content type="html"><![CDATA[<p>é‡åˆ°çš„å‘,æˆ–è€…å…¶å®ƒæ··æ·†çš„æ¦‚å¿µ<br><a id="more"></a></p><h2 id="ç¬¬ä¸‰æ–¹å¹³å°-å’Œ-å…¬ä¼—å·è‡ªå·±å¼€å‘"><a href="#ç¬¬ä¸‰æ–¹å¹³å°-å’Œ-å…¬ä¼—å·è‡ªå·±å¼€å‘" class="headerlink" title="ç¬¬ä¸‰æ–¹å¹³å° å’Œ å…¬ä¼—å·è‡ªå·±å¼€å‘"></a>ç¬¬ä¸‰æ–¹å¹³å° å’Œ å…¬ä¼—å·è‡ªå·±å¼€å‘</h2><p>å­˜åœ¨ </p><ol><li>appid+appsecret</li><li>B ç¬¬ä¸‰æ–¹</li><li>C ç¬¬ä¸‰æ–¹</li></ol><hr><ul><li>ä¸é™åˆ¶æˆæƒç¬¬ä¸‰æ–¹çš„æ¬¡æ•°</li><li>è·å–accesstokençš„é¢åº¦ä¸ºåˆ†å¼€çš„(æ— å®˜æ–¹æ–‡æ¡£è¯´æ˜,çŒœæµ‹)</li><li>accesstokenå¯¹ä¸åŒçš„ç¬¬ä¸‰æ–¹ä¸ä¼šå†²çª</li><li>ä¸åŒçš„ç¬¬ä¸‰æ–¹ä¸»åŠ¨è°ƒç”¨APIä¸ä¼šå†²çª</li><li>äº‹ä»¶é€šçŸ¥ç›®å‰æ”¯æŒå‘æ‰€æœ‰æˆæƒçš„ç¬¬ä¸‰æ–¹å‘é€</li><li>æ¯ä¸ªç¬¬ä¸‰æ–¹éƒ½å¯ä»¥å›å¤æ¶ˆæ¯</li><li>æ¯ä¸ªç¬¬ä¸‰æ–¹å›å¤ç©ºçš„å°±æ²¡å…³ç³»ï¼Œéƒ½å›å¤ä¼šæœ‰æ··ä¹±ï¼Œåªèƒ½é å…¬ä¼—å·è‡ªå·±è·Ÿç¬¬ä¸‰æ–¹åè°ƒ</li><li>ç¬¬ä¸‰æ–¹ ç½‘é¡µæˆæƒ æ–‡æ¡£: <a href="https://open.weixin.qq.com/cgi-bin/showdocument?action=dir_list&amp;t=resource/res_list&amp;verify=1&amp;id=open1419318590&amp;token=&amp;lang=zh_CN" target="_blank" rel="noopener">https://open.weixin.qq.com/cgi-bin/showdocument?action=dir_list&amp;t=resource/res_list&amp;verify=1&amp;id=open1419318590&amp;token=&amp;lang=zh_CN</a></li></ul><h2 id="å¾®ä¿¡ä¼šè¯cookieçš„æ—¶é•¿"><a href="#å¾®ä¿¡ä¼šè¯cookieçš„æ—¶é•¿" class="headerlink" title="å¾®ä¿¡ä¼šè¯cookieçš„æ—¶é•¿"></a>å¾®ä¿¡ä¼šè¯cookieçš„æ—¶é•¿</h2><table><thead><tr><th>æ“ä½œ</th><th>æ˜¯å¦å¤±æ•ˆ</th></tr></thead><tbody><tr><td>ä»WebViewè¿”å›å¾®ä¿¡ä¸»ç•Œé¢</td><td>cookieä¸å¤±æ•ˆ</td></tr><tr><td>è¿”å›æ‰‹æœºç³»ç»Ÿä¸»ç•Œé¢</td><td>cookieä¸å¤±æ•ˆ</td></tr><tr><td>åå°å…³é—­å¾®ä¿¡è¿›ç¨‹</td><td>cookieå¤±æ•ˆ</td></tr><tr><td>å¾®ä¿¡åˆ‡æ¢è´¦å·</td><td>cookieå¤±æ•ˆ</td></tr><tr><td>å†…å­˜å°çš„æœºå‹ï¼Œè¿™éƒ¨åˆ†ä¸´æ—¶å­˜å‚¨å°±ä¼šè¢«ç³»ç»Ÿé‡Šæ”¾æ‰</td><td>cookieå¤±æ•ˆ</td></tr><tr><td>ä¸€èˆ¬æµè§ˆå™¨å½“æµè§ˆå™¨é€€å‡ºå(chromeç­‰)</td><td>cookieå¤±æ•ˆ</td></tr></tbody></table><h2 id="ç½‘é¡µæˆæƒç™»å½•-å’Œ-ç½‘ç«™åº”ç”¨ç™»å½•"><a href="#ç½‘é¡µæˆæƒç™»å½•-å’Œ-ç½‘ç«™åº”ç”¨ç™»å½•" class="headerlink" title="ç½‘é¡µæˆæƒç™»å½• å’Œ ç½‘ç«™åº”ç”¨ç™»å½•"></a>ç½‘é¡µæˆæƒç™»å½• å’Œ ç½‘ç«™åº”ç”¨ç™»å½•</h2><blockquote><table><thead><tr><th></th><th>ç½‘é¡µæˆæƒç™»å½•</th><th>ç½‘ç«™åº”ç”¨å¾®ä¿¡ç™»å½•</th></tr></thead><tbody><tr><td> å¹³å°</td><td><a href="https://mp.weixin.qq.com" target="_blank" rel="noopener">https://mp.weixin.qq.com</a></td><td><a href="https://open.weixin.qq.com/" target="_blank" rel="noopener">https://open.weixin.qq.com/</a></td></tr><tr><td>å¾®ä¿¡æ–‡æ¡£</td><td><a href="https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1421140842&amp;token=&amp;lang=zh_CN" target="_blank" rel="noopener">mp wiki</a></td><td><a href="https://open.weixin.qq.com/cgi-bin/showdocument?action=dir_list&amp;t=resource/res_list&amp;verify=1&amp;id=open1419316505&amp;token=&amp;lang=zh_CN" target="_blank" rel="noopener">open wiki</a></td></tr><tr><td>åŒºåˆ«</td><td>scopeä¸ºsnsapi_base, è·å–ç”¨æˆ·çš„openid é™é»˜æˆæƒ <br> scopeä¸ºsnsapi_userinfoè·å–ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯,å¯¹äºå·²å…³æ³¨å…¬ä¼—å·çš„ç”¨æˆ·,é™é»˜æˆæƒ,å¦åˆ™éœ€è¦ç”¨æˆ·åŒæ„ <br>æœªå…³æ³¨çš„ç”¨æˆ·ä¹Ÿèƒ½è·å–åˆ°ç”¨æˆ·ä¿¡æ¯</td><td>å¾®ä¿¡ç”¨æˆ· éœ€åŒæ„æˆæƒç¬¬ä¸‰æ–¹åº”ç”¨</td></tr></tbody></table></blockquote><h2 id="ç½‘ç«™æˆæƒç™»å½•-https-open-weixin-qq-com"><a href="#ç½‘ç«™æˆæƒç™»å½•-https-open-weixin-qq-com" class="headerlink" title="ç½‘ç«™æˆæƒç™»å½•(https://open.weixin.qq.com/)"></a>ç½‘ç«™æˆæƒç™»å½•(<a href="https://open.weixin.qq.com/" target="_blank" rel="noopener">https://open.weixin.qq.com/</a>)</h2><p><a href="https://open.weixin.qq.com/cgi-bin/showdocument?action=dir_list&amp;t=resource/res_list&amp;verify=1&amp;id=open1419316505&amp;token=&amp;lang=zh_CN" target="_blank" rel="noopener">å¾®ä¿¡æ–‡æ¡£</a><br><a href="https://github.com/liangyali/passport-wechat" target="_blank" rel="noopener">package passport-wechat</a><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// config é…ç½®</span></span><br><span class="line">auth: &#123;</span><br><span class="line">    wechat: &#123;</span><br><span class="line">      passport: &#123;</span><br><span class="line">        strategy: <span class="string">'wechat'</span>,</span><br><span class="line">        <span class="built_in">module</span>: <span class="string">'passport-wechat'</span>,</span><br><span class="line">        options: &#123;</span><br><span class="line">          appID: <span class="string">''</span>,</span><br><span class="line">          appSecret: <span class="string">''</span>,</span><br><span class="line">          callbackURL: <span class="string">'prefix/auth/wechat/callback'</span>,</span><br><span class="line">          response_type: <span class="string">'code'</span>,</span><br><span class="line">          scope: <span class="string">'snsapi_login'</span>,</span><br><span class="line">          state: <span class="literal">true</span></span><br><span class="line">        &#125;,</span><br><span class="line">        verify: <span class="function"><span class="keyword">function</span>(<span class="params">openid, profile, userInfo, done</span>) </span>&#123;</span><br><span class="line">          done(<span class="literal">null</span>, userInfo);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> passport = <span class="built_in">require</span>(<span class="string">'passport'</span>);</span><br><span class="line"><span class="keyword">var</span> WechatStrategy = <span class="built_in">require</span>(<span class="string">'passport-wechat'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> callbackURL = <span class="string">'/auth/wechat/callback'</span>;</span><br><span class="line"></span><br><span class="line">passport.serializeUser(<span class="function"><span class="keyword">function</span>(<span class="params">user, done</span>) </span>&#123;</span><br><span class="line">  done(<span class="literal">null</span>, user);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">passport.deserializeUser(<span class="function"><span class="keyword">function</span>(<span class="params">obj, done</span>) </span>&#123;</span><br><span class="line">  done(<span class="literal">null</span>, obj);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›¸å…³é…ç½®ä¸ºæµ‹è¯•è´¦å·ä¿¡æ¯</span></span><br><span class="line">passport.use(<span class="keyword">new</span> WechatStrategy(&#123;</span><br><span class="line">  appID: appID,</span><br><span class="line">  appSecret: appSecret,</span><br><span class="line">  callbackURL: callbackURL,</span><br><span class="line">  response_type: <span class="string">'code'</span>,</span><br><span class="line">  scope: <span class="string">'snsapi_login'</span>,</span><br><span class="line">  state: <span class="literal">true</span></span><br><span class="line">&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">openid, profile, userInfo, done</span>) </span>&#123;</span><br><span class="line">  done(<span class="literal">null</span>, userInfo);</span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  authCallback: <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="keyword">from</span> = <span class="built_in">encodeURIComponent</span>(req.param(<span class="string">'from'</span>)) || <span class="string">''</span>;</span><br><span class="line">    passport.authenticate(<span class="string">'wechat'</span>, &#123;</span><br><span class="line">      failureRedirect: <span class="string">'/auth/err'</span>,</span><br><span class="line">      successRedirect: <span class="string">'/auth/success'</span> + <span class="string">'?from='</span> + <span class="keyword">from</span></span><br><span class="line">    &#125;)(req, res);</span><br><span class="line">  &#125;,</span><br><span class="line">  authError: <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">    res.json(<span class="number">400</span>, &#123;</span><br><span class="line">      message: <span class="string">'error'</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  authSuccess: <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">    res.redirect(joinQueryStr((req.param(<span class="string">'from'</span>) || <span class="string">'/'</span>), &#123;</span><br><span class="line">      userInfo: req.user || &#123;&#125;,</span><br><span class="line">      unionid: (req.user || &#123;&#125;).unionid</span><br><span class="line">    &#125;));</span><br><span class="line">  &#125;,</span><br><span class="line">  authWechat: <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="keyword">from</span> = <span class="built_in">encodeURIComponent</span>(req.param(<span class="string">'from'</span>)) || <span class="string">''</span>;</span><br><span class="line">    passport.authenticate(<span class="string">'wechat'</span>, &#123;</span><br><span class="line">      callbackURL: callbackURL + <span class="string">'?from='</span> + <span class="keyword">from</span></span><br><span class="line">    &#125;)(req, res);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="ç½‘é¡µæˆæƒç™»å½•"><a href="#ç½‘é¡µæˆæƒç™»å½•" class="headerlink" title="ç½‘é¡µæˆæƒç™»å½•"></a>ç½‘é¡µæˆæƒç™»å½•</h2><p><a href="http://mp.weixin.qq.com/wiki/17/c0f37d5704f0b64713d5d2c37b468d75.html" target="_blank" rel="noopener">å¾®ä¿¡æ–‡æ¡£</a><br><a href="https://github.com/node-webot/wechat-oauth" target="_blank" rel="noopener">package wechat-oauth</a><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">auth: <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> code = req.query.code;</span><br><span class="line">    <span class="keyword">if</span>(req.query.state &amp;&amp; code === <span class="string">'authdeny'</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> res.status(<span class="number">400</span>).send(<span class="string">'ç”¨æˆ·æ‹’ç»æˆæƒ'</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!code) &#123;</span><br><span class="line">      <span class="keyword">var</span> callbackUrl = req.protocol + <span class="string">'://'</span> + req.get(<span class="string">'Host'</span>) + req.originalUrl;</span><br><span class="line">      <span class="keyword">var</span> url = oauth.getAuthorizeURL(callbackUrl, <span class="string">'random_state'</span>, <span class="string">'snsapi_userinfo'</span>);</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'redirect to'</span>, url);</span><br><span class="line">      <span class="keyword">return</span> res.redirect(url);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> openid;</span><br><span class="line">    <span class="keyword">var</span> wechatUser;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">async</span>.series([</span><br><span class="line">      <span class="function"><span class="keyword">function</span> <span class="title">getAccessToken</span>(<span class="params">cb</span>) </span>&#123;</span><br><span class="line">        oauth.getAccessToken(code, <span class="function"><span class="keyword">function</span>(<span class="params">err, result</span>) </span>&#123;</span><br><span class="line">          <span class="keyword">if</span>(err) &#123;</span><br><span class="line">            <span class="keyword">return</span> cb(err);</span><br><span class="line">          &#125;</span><br><span class="line">          openid = result.data.openid;</span><br><span class="line">          cb();</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="function"><span class="keyword">function</span> <span class="title">getWechatUser</span>(<span class="params">cb</span>) </span>&#123;</span><br><span class="line">        oauth.getUser(openid, <span class="function"><span class="keyword">function</span>(<span class="params">err, user</span>) </span>&#123;</span><br><span class="line">          req.session.wechat = user;</span><br><span class="line">          wechatUser = user;</span><br><span class="line">          cb(err, user);</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    ], <span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span>(err) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.status(<span class="number">400</span>).json(err);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'session'</span>, req.session);</span><br><span class="line">      <span class="keyword">if</span>(req.query.referer) &#123;</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line">          .redirect(UtilitiesService</span><br><span class="line">            .joinQueryStr((req.query.referer || <span class="string">'/'</span>), &#123;</span><br><span class="line">              userInfo: wechatUser || &#123;&#125;,</span><br><span class="line">              unionid: (wechatUser || &#123;&#125;).unionid</span><br><span class="line">            &#125;)</span><br><span class="line">          );</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      res.json(&#123;</span><br><span class="line">        userInfo: wechatUser,</span><br><span class="line">        unionid: openid</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      
        <tags>
            
            <tag> wechat </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ¶ä½œportableç‰ˆCygwin</title>
      <link href="/2016/06/14/cygwin-backup/"/>
      <url>/2016/06/14/cygwin-backup/</url>
      
        <content type="html"><![CDATA[<p>åˆ¶ä½œportableç‰ˆCygwinå’Œå®Œæ•´åˆ é™¤Cygwin<br><a id="more"></a></p><h2 id="åˆ¶ä½œportableç‰ˆCygwin"><a href="#åˆ¶ä½œportableç‰ˆCygwin" class="headerlink" title="åˆ¶ä½œportableç‰ˆCygwin"></a>åˆ¶ä½œportableç‰ˆCygwin</h2><h3 id="æœ¬åœ°æœºå™¨"><a href="#æœ¬åœ°æœºå™¨" class="headerlink" title="æœ¬åœ°æœºå™¨"></a>æœ¬åœ°æœºå™¨</h3><ol><li>å‹ç¼©æ‰“åŒ…å®‰è£…ç›®å½•</li><li>å¯¼å‡ºæ³¨å†Œè¡¨<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># cygwinä¸‹</span><br><span class="line">reg export HKLM\\SOFTWARE\\Cygwin cygwin.reg</span><br><span class="line"></span><br><span class="line"># cmd.exeä¸‹</span><br><span class="line">reg export HKLM\SOFTWARE\Cygwin cygwin.reg</span><br></pre></td></tr></table></figure></li></ol><h3 id="å¦ä¸€å°æœºå™¨"><a href="#å¦ä¸€å°æœºå™¨" class="headerlink" title="å¦ä¸€å°æœºå™¨"></a>å¦ä¸€å°æœºå™¨</h3><ol><li>è§£å‹ç¼©å®‰è£…ç›®å½•</li><li>ä¿®æ”¹æ³¨å†Œè¡¨ç›¸å…³æ ¹ç›®å½•</li><li>å¯¼å…¥æ³¨å†Œè¡¨: <code>reg import cygwin.reg</code></li></ol><h2 id="å®Œæ•´åˆ é™¤Cygwin"><a href="#å®Œæ•´åˆ é™¤Cygwin" class="headerlink" title="å®Œæ•´åˆ é™¤Cygwin"></a>å®Œæ•´åˆ é™¤Cygwin</h2><ol><li>åˆ é™¤ä¸‹è½½åŒ…ç›®å½•</li><li>åœæ­¢æœåŠ¡: <code>cygrunsrv -L</code>, <code>cygrunsrv -S</code>, <code>cygrunsrv -R</code></li><li>åˆ é™¤å®‰è£…ç›®å½•</li><li>åˆ é™¤æ³¨å†Œè¡¨ï¼š <code>reg delete HKLM\SOFTWARE\Cygwin /f</code>, <code>reg delete HKCU\SOFTWARE\Cygwin /f</code></li><li>åˆ é™¤ç¯å¢ƒå˜é‡: <code>PATH</code>, <code>CYGWIN</code></li></ol><h2 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h2><ul><li><a href="https://segmentfault.com/a/1190000005650072" target="_blank" rel="noopener">https://segmentfault.com/a/1190000005650072</a></li></ul><p><br></p><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> cygwin </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>windowsä¸‹å…¨å±€ç¿»å¢™</title>
      <link href="/2016/04/09/windows-bypass-firewall/"/>
      <url>/2016/04/09/windows-bypass-firewall/</url>
      
        <content type="html"><![CDATA[<p>åœ¨windwosä¸‹ä½¿ç”¨shadowsocks + Proxifier å…¨å±€ç¿»å¢™<br><a id="more"></a></p><h2 id="è½¯ä»¶ä¸‹è½½åœ°å€"><a href="#è½¯ä»¶ä¸‹è½½åœ°å€" class="headerlink" title="è½¯ä»¶ä¸‹è½½åœ°å€:"></a>è½¯ä»¶ä¸‹è½½åœ°å€:</h2><p><a href="https://github.com/shadowsocks/shadowsocks-windows/releases" target="_blank" rel="noopener">shadowsocksä¸‹è½½</a><br><a href="https://www.proxifier.com/" target="_blank" rel="noopener">proxifierå®˜ç½‘</a></p><h2 id="å¸å·-æ³¨å†Œç -ç ´è§£"><a href="#å¸å·-æ³¨å†Œç -ç ´è§£" class="headerlink" title="å¸å·/æ³¨å†Œç /ç ´è§£"></a>å¸å·/æ³¨å†Œç /ç ´è§£</h2><p><a href="http://www.ishadowsocks.net/" target="_blank" rel="noopener">shadowsockså…è´¹å¸å·</a><br><a href="http://pan.baidu.com/s/1eQ1tD9g" target="_blank" rel="noopener">proxifierä¸­æ–‡ç ´è§£ç‰ˆwindowsç‰ˆ</a></p><p>proxifieræ³¨å†Œç :<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">L6Z8A-XY2J4-BTZ3P-ZZ7DF-A2Q9C (Portable Edition)</span><br><span class="line">5EZ8G-C3WL5-B56YG-SCXM9-6QZAP (Standard Edition)</span><br><span class="line">P427L-9Y552-5433E-8DSR3-58Z68 (MAC)</span><br></pre></td></tr></table></figure></p><h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><h3 id="shadowsocksé…ç½®"><a href="#shadowsocksé…ç½®" class="headerlink" title="shadowsocksé…ç½®:"></a>shadowsocksé…ç½®:</h3><figure class="image-box">                <img src="/img/firewall/1.png" alt="" title="" class="">                <p></p>            </figure>  <p><br></p><hr><h3 id="proxifieré…ç½®"><a href="#proxifieré…ç½®" class="headerlink" title="proxifieré…ç½®"></a>proxifieré…ç½®</h3><figure class="image-box">                <img src="/img/firewall/2.png" alt="" title="" class="">                <p></p>            </figure><figure class="image-box">                <img src="/img/firewall/3.png" alt="" title="" class="">                <p></p>            </figure><figure class="image-box">                <img src="/img/firewall/4.png" alt="" title="" class="">                <p></p>            </figure><figure class="image-box">                <img src="/img/firewall/5.png" alt="" title="" class="">                <p></p>            </figure><figure class="image-box">                <img src="/img/firewall/6.png" alt="" title="" class="">                <p></p>            </figure><figure class="image-box">                <img src="/img/firewall/7.png" alt="" title="" class="">                <p></p>            </figure><figure class="image-box">                <img src="/img/firewall/8.png" alt="" title="" class="">                <p></p>            </figure><h2 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h2><ol><li>Proxifierä»£ç†è§„åˆ™ä¸­å¿…é¡»æŠŠä½ çš„ shadowsockså®¢æˆ·ç«¯è®¾ç½®æˆdirect</li><li>Proxifierä¸­åç§°è§£æ(å³DNSè§£æ) å¿…é¡»è®¾ç½®æˆ é€šè¿‡ä»£ç†è§£æä¸»æœºåœ°å€ (å¦åˆ™ä¼šå‡ºç°ä¾ç„¶æ— æ³•è®¿é—®è°·æ­Œç­‰é—®é¢˜)</li></ol><h2 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h2><ul><li><a href="http://www.jiyingss.com/117/" target="_blank" rel="noopener">http://www.jiyingss.com/117/</a></li></ul><p><br><br></p><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>openshiftä½¿ç”¨è®°å½•</title>
      <link href="/2016/03/27/use-openshift/"/>
      <url>/2016/03/27/use-openshift/</url>
      
        <content type="html"><![CDATA[<p>codingæ¼”ç¤ºå¹³å°å¼€å§‹æ”¶è´¹,è½¬æˆ˜openshift, åœ¨ä¸Šé¢å®‰è£…zshç­‰è½¯ä»¶<br><a id="more"></a></p><h1 id="åˆ©ç”¨openshiftè‡ªå¸¦çš„Node-js"><a href="#åˆ©ç”¨openshiftè‡ªå¸¦çš„Node-js" class="headerlink" title="åˆ©ç”¨openshiftè‡ªå¸¦çš„Node.js"></a>åˆ©ç”¨openshiftè‡ªå¸¦çš„Node.js</h1><h2 id="1-æ³¨å†Œ-amp-amp-ç™»å½•"><a href="#1-æ³¨å†Œ-amp-amp-ç™»å½•" class="headerlink" title="1,æ³¨å†Œ&amp;&amp;ç™»å½•"></a>1,æ³¨å†Œ&amp;&amp;ç™»å½•</h2><figure class="image-box">                <img src="/img/openshift/1.png" alt="" title="" class="">                <p></p>            </figure><h2 id="2-åˆ›å»ºåº”ç”¨-é€‰æ‹©noejsç‰ˆæœ¬"><a href="#2-åˆ›å»ºåº”ç”¨-é€‰æ‹©noejsç‰ˆæœ¬" class="headerlink" title="2,åˆ›å»ºåº”ç”¨,é€‰æ‹©noejsç‰ˆæœ¬"></a>2,åˆ›å»ºåº”ç”¨,é€‰æ‹©noejsç‰ˆæœ¬</h2><figure class="image-box">                <img src="/img/openshift/2.png" alt="" title="" class="">                <p></p>            </figure><figure class="image-box">                <img src="/img/openshift/3.png" alt="" title="" class="">                <p></p>            </figure><h2 id="3-è¯¦ç»†å†…å®¹å¡«å†™-å¦‚æœæ–°æ‰‹-å¯ä»¥åœ¨å¯¼å…¥ä»£ç å¤„ç•™ç©º-openshiftä¼šåˆ›å»ºä¸€ä¸ªdemoç¨‹åº"><a href="#3-è¯¦ç»†å†…å®¹å¡«å†™-å¦‚æœæ–°æ‰‹-å¯ä»¥åœ¨å¯¼å…¥ä»£ç å¤„ç•™ç©º-openshiftä¼šåˆ›å»ºä¸€ä¸ªdemoç¨‹åº" class="headerlink" title="3,è¯¦ç»†å†…å®¹å¡«å†™(å¦‚æœæ–°æ‰‹,å¯ä»¥åœ¨å¯¼å…¥ä»£ç å¤„ç•™ç©º,openshiftä¼šåˆ›å»ºä¸€ä¸ªdemoç¨‹åº)"></a>3,è¯¦ç»†å†…å®¹å¡«å†™(å¦‚æœæ–°æ‰‹,å¯ä»¥åœ¨å¯¼å…¥ä»£ç å¤„ç•™ç©º,openshiftä¼šåˆ›å»ºä¸€ä¸ªdemoç¨‹åº)</h2><figure class="image-box">                <img src="/img/openshift/4.png" alt="" title="" class="">                <p></p>            </figure><h2 id="4-ç‚¹å‡»-Create-Applicationå-ç­‰å¾…è¾ƒé•¿æ—¶é—´-åæ‰ä¼šè¿›å…¥ç®¡ç†é¢æ¿"><a href="#4-ç‚¹å‡»-Create-Applicationå-ç­‰å¾…è¾ƒé•¿æ—¶é—´-åæ‰ä¼šè¿›å…¥ç®¡ç†é¢æ¿" class="headerlink" title="4,ç‚¹å‡» Create Applicationå, ç­‰å¾…è¾ƒé•¿æ—¶é—´ åæ‰ä¼šè¿›å…¥ç®¡ç†é¢æ¿"></a>4,ç‚¹å‡» <code>Create Application</code>å, <strong>ç­‰å¾…è¾ƒé•¿æ—¶é—´</strong> åæ‰ä¼šè¿›å…¥ç®¡ç†é¢æ¿</h2><h1 id="DIY-å½“ä½œlinuxæœåŠ¡å™¨ä½¿ç”¨"><a href="#DIY-å½“ä½œlinuxæœåŠ¡å™¨ä½¿ç”¨" class="headerlink" title="DIY(å½“ä½œlinuxæœåŠ¡å™¨ä½¿ç”¨)"></a>DIY(å½“ä½œlinuxæœåŠ¡å™¨ä½¿ç”¨)</h1><h2 id="1-åœ¨åˆ›å»ºåº”ç”¨æ—¶é€‰æ‹©-DO-It-Yourself"><a href="#1-åœ¨åˆ›å»ºåº”ç”¨æ—¶é€‰æ‹©-DO-It-Yourself" class="headerlink" title="1,åœ¨åˆ›å»ºåº”ç”¨æ—¶é€‰æ‹© DO-It-Yourself"></a>1,åœ¨åˆ›å»ºåº”ç”¨æ—¶é€‰æ‹© DO-It-Yourself</h2><figure class="image-box">                <img src="/img/openshift/6.png" alt="" title="" class="">                <p></p>            </figure><h2 id="2-DIYä¹‹å‰çš„å†…å®¹è¡¥å……"><a href="#2-DIYä¹‹å‰çš„å†…å®¹è¡¥å……" class="headerlink" title="2,DIYä¹‹å‰çš„å†…å®¹è¡¥å……:"></a>2,DIYä¹‹å‰çš„å†…å®¹è¡¥å……:</h2><p>a: <code>openshift</code> å˜é‡<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$OPENSHIFT_REPO_DIR</span>    //sshæäº¤ä»£ç çš„ä½ç½®</span><br><span class="line"><span class="variable">$OPENSHIFT_DATA_DIR</span>    // ä¸€äº›æ•°æ®å­˜å‚¨çš„ä½ç½®</span><br><span class="line"><span class="variable">$OPENSHIFT_DIY_IP</span>     // å¤–ç½‘ç»‘å®šIP</span><br></pre></td></tr></table></figure></p><p>b: å‰©ä½™å®¹é‡<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">du -h | sort -rh | head -10    // æŸ¥æ‰¾å‰10çš„æ–‡ä»¶/æ–‡ä»¶å¤¹</span><br><span class="line">quota -s                       // æŸ¥çœ‹æ€»é‡</span><br></pre></td></tr></table></figure></p><h2 id="3-æ·»åŠ -è®¾ç½®-ssh-key"><a href="#3-æ·»åŠ -è®¾ç½®-ssh-key" class="headerlink" title="3,æ·»åŠ /è®¾ç½® ssh key"></a>3,æ·»åŠ /è®¾ç½® <code>ssh key</code></h2><figure class="image-box">                <img src="/img/openshift/7.png" alt="" title="" class="">                <p></p>            </figure><h2 id="4-é“¾æ¥openshiftæœåŠ¡å™¨"><a href="#4-é“¾æ¥openshiftæœåŠ¡å™¨" class="headerlink" title="4,é“¾æ¥openshiftæœåŠ¡å™¨"></a>4,é“¾æ¥openshiftæœåŠ¡å™¨</h2><figure class="image-box">                <img src="/img/openshift/8.png" alt="" title="" class="">                <p></p>            </figure><figure class="image-box">                <img src="/img/openshift/9.png" alt="" title="" class="">                <p></p>            </figure><h2 id="5-å®‰è£…è½¯ä»¶"><a href="#5-å®‰è£…è½¯ä»¶" class="headerlink" title="5,å®‰è£…è½¯ä»¶"></a>5,å®‰è£…è½¯ä»¶</h2><h3 id="è®¾ç½®HOMEç›®å½•-æŸäº›ç›®å½•æ— æƒé™-éœ€è¦è®¾ç½®åˆ°OPENSHIFT-DATA-DIRæ‰èƒ½å†™å…¥"><a href="#è®¾ç½®HOMEç›®å½•-æŸäº›ç›®å½•æ— æƒé™-éœ€è¦è®¾ç½®åˆ°OPENSHIFT-DATA-DIRæ‰èƒ½å†™å…¥" class="headerlink" title="è®¾ç½®HOMEç›®å½•(æŸäº›ç›®å½•æ— æƒé™,éœ€è¦è®¾ç½®åˆ°OPENSHIFT_DATA_DIRæ‰èƒ½å†™å…¥)"></a>è®¾ç½®HOMEç›®å½•(æŸäº›ç›®å½•æ— æƒé™,éœ€è¦è®¾ç½®åˆ°<code>OPENSHIFT_DATA_DIR</code>æ‰èƒ½å†™å…¥)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®¾ç½®ç›®å½•</span></span><br><span class="line">HOME=<span class="variable">$OPENSHIFT_DATA_DIR</span></span><br><span class="line"><span class="comment"># å°†ç›®å½•è®¾ç½®å†™å…¥bash_profile</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"export HOME=\"<span class="variable">$OPENSHIFT_DATA_DIR</span>\""</span> &gt;&gt; <span class="variable">$OPENSHIFT_DATA_DIR</span>/.bash_profile</span><br></pre></td></tr></table></figure><h3 id="å®‰è£…linuxbrew-openshiftä¸‹æ— æ³•ä½¿ç”¨-yum-å’Œ-apt-get"><a href="#å®‰è£…linuxbrew-openshiftä¸‹æ— æ³•ä½¿ç”¨-yum-å’Œ-apt-get" class="headerlink" title="å®‰è£…linuxbrew(openshiftä¸‹æ— æ³•ä½¿ç”¨ yum å’Œ apt-get)"></a>å®‰è£…<a href="https://github.com/Linuxbrew/linuxbrew" target="_blank" rel="noopener">linuxbrew</a>(openshiftä¸‹æ— æ³•ä½¿ç”¨ <code>yum</code> å’Œ <code>apt-get</code>)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…  </span></span><br><span class="line">ruby -e <span class="string">"<span class="variable">$(curl -fsSL https://raw.githubusercontent.com/Linuxbrew/linuxbrew/go/install)</span>"</span></span><br><span class="line"><span class="comment"># ç¯å¢ƒé…ç½®</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">'export PATH="'</span><span class="variable">$OPENSHIFT_DATA_DIR</span><span class="string">'.linuxbrew/bin:$PATH"'</span> &gt;&gt; <span class="variable">$OPENSHIFT_DATA_DIR</span>/.bash_profile</span><br><span class="line"><span class="comment"># å¯ç”¨é…ç½®</span></span><br><span class="line"><span class="built_in">source</span> <span class="variable">$OPENSHIFT_DATA_DIR</span>/.bash_profile</span><br></pre></td></tr></table></figure><h2 id="6-å®‰è£…zsh-å’Œ-oh-my-zsh"><a href="#6-å®‰è£…zsh-å’Œ-oh-my-zsh" class="headerlink" title="6,å®‰è£…zsh å’Œ oh-my-zsh"></a>6,å®‰è£…zsh å’Œ oh-my-zsh</h2><p>a: å®‰è£… zsh<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨ brew å®‰è£… zsh å¤ªæ…¢äº†!!</span></span><br><span class="line"><span class="comment"># brew install zsh</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨æºç ç›´æ¥å®‰è£…</span></span><br><span class="line">wget http://sourceforge.net/projects/zsh/files/zsh/5.2/zsh-5.2.tar.gz/download -O <span class="variable">$OPENSHIFT_DATA_DIR</span>/zsh-5.2.tar.gz</span><br><span class="line"></span><br><span class="line">tar xzvf zsh-5.2.tar.gz &amp;&amp; <span class="built_in">cd</span> zsh-5.2</span><br><span class="line">./configure --prefix=<span class="variable">$HOME</span><span class="string">""</span>.linuxbrew</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure></p><p>b: å®‰è£… <a href="https://github.com/robbyrussell/oh-my-zsh" target="_blank" rel="noopener">oh-my-zsh</a>, éœ€è¦åˆ é™¤å®˜æ–¹è„šæœ¬ä¸­ä¸‹é¢4è¡Œ:<br><figure class="image-box">                <img src="/img/openshift/10.png" alt="" title="" class="">                <p></p>            </figure></p><p>æˆ–è€…ä¸‹è½½ <a href="/other/openshift-oh-my-zsh/openshift-oh-my-zsh.sh">ä¿®æ”¹å¥½çš„è„šæœ¬openshift-oh-my-zsh</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sh -c <span class="string">"<span class="variable">$(wget http://blog.xinshangshangxin.com/other/openshift-oh-my-zsh/openshift-oh-my-zsh.sh -O -)</span>"</span></span><br></pre></td></tr></table></figure><p>c: è®¾ç½®ç¯å¢ƒå˜é‡<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é»˜è®¤å¯åŠ¨ zsh</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">'exec '</span><span class="variable">$OPENSHIFT_DATA_DIR</span><span class="string">'.linuxbrew/bin/zsh -l'</span> &gt;&gt; <span class="variable">$OPENSHIFT_DATA_DIR</span>/.bash_profile</span><br><span class="line"><span class="comment"># ç¦ç”¨oh-my-zsh æ›´æ–°</span></span><br><span class="line">sed -i <span class="string">'s/^# DISABLE_AUTO_UPDATE="true"/DISABLE_AUTO_UPDATE="true"/g'</span> ~/.zshrc</span><br><span class="line"><span class="comment"># å°† ä¸Šé¢linuxbrewçš„ç¯å¢ƒå˜é‡åŠ å…¥ .zshrc</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">'export PATH="'</span><span class="variable">$OPENSHIFT_DATA_DIR</span><span class="string">'.linuxbrew/bin:$PATH"'</span> &gt;&gt; <span class="variable">$OPENSHIFT_DATA_DIR</span>/.zshrc</span><br><span class="line"><span class="comment"># å¯ç”¨zsh</span></span><br><span class="line"><span class="built_in">source</span> <span class="variable">$OPENSHIFT_DATA_DIR</span>/.bash_profile</span><br></pre></td></tr></table></figure></p><h2 id="7-å®‰è£…mongo"><a href="#7-å®‰è£…mongo" class="headerlink" title="7,å®‰è£…mongo"></a>7,å®‰è£…mongo</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸‹è½½</span></span><br><span class="line">wget https://fastdl.mongodb.org/linux/mongodb-linux-x86_64-3.2.0.tgz</span><br><span class="line"><span class="comment"># è§£å‹ &amp;&amp; ç§»åŠ¨æ–‡ä»¶</span></span><br><span class="line">tar -zxvf mongodb-linux-x86_64-3.2.0.tgz</span><br><span class="line">mkdir softer &amp;&amp; mv mongodb-linux-x86_64-3.2.0 softer/mongodb</span><br><span class="line"><span class="comment"># é…ç½®ç¯å¢ƒå˜é‡</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">'export PATH="'</span><span class="variable">$OPENSHIFT_DATA_DIR</span><span class="string">'softer/mongodb/bin:$PATH$PATH"'</span> &gt;&gt; <span class="variable">$OPENSHIFT_DATA_DIR</span>/.zshrc</span><br><span class="line"><span class="comment"># é‡æ–°è½½å…¥ç¯å¢ƒ</span></span><br><span class="line"><span class="built_in">exec</span> zsh -l</span><br><span class="line"><span class="comment"># åˆ›å»ºmongodbå­˜å‚¨è·¯å¾„</span></span><br><span class="line"><span class="built_in">cd</span> ~ &amp;&amp; mkdir -p data/mongodb</span><br><span class="line"><span class="comment"># forkæ¨¡å¼å¯åŠ¨mongo</span></span><br><span class="line">mongod --bind_ip  <span class="variable">$OPENSHIFT_DIY_IP</span> --dbpath=<span class="variable">$OPENSHIFT_DATA_DIR</span><span class="string">""</span>data/mongodb --logpath <span class="variable">$OPENSHIFT_DATA_DIR</span><span class="string">""</span>data/mongodb.log  --fork</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‘½ä»¤è¡Œè¿æ¥</span></span><br><span class="line">mongo --host <span class="variable">$OPENSHIFT_DIY_IP</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># dump</span></span><br><span class="line">mongodump --host <span class="variable">$OPENSHIFT_DIY_IP</span> [-d &lt;dnName&gt;] [--out &lt;outPath&gt;]</span><br><span class="line">mongodump --host <span class="variable">$OPENSHIFT_DIY_IP</span> --out ~/mongodump</span><br><span class="line"></span><br><span class="line"><span class="comment"># restore</span></span><br><span class="line">mongorestore --host <span class="variable">$OPENSHIFT_DIY_IP</span> [-d &lt;dnName&gt;] &lt;restorePath&gt; [--drop]</span><br><span class="line">mongorestore --host <span class="variable">$OPENSHIFT_DIY_IP</span> ~/mongodump --drop</span><br></pre></td></tr></table></figure><h2 id="8-å®‰è£…-nvm-nodeç‰ˆæœ¬ç®¡ç†å™¨"><a href="#8-å®‰è£…-nvm-nodeç‰ˆæœ¬ç®¡ç†å™¨" class="headerlink" title="8,å®‰è£… nvm (nodeç‰ˆæœ¬ç®¡ç†å™¨)"></a>8,å®‰è£… nvm (nodeç‰ˆæœ¬ç®¡ç†å™¨)</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.29.0/install.sh | bash</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"export NVM_DIR=\"<span class="variable">$OPENSHIFT_DATA_DIR</span>.nvm\""</span> &gt;&gt; <span class="variable">$OPENSHIFT_DATA_DIR</span>/.zshrc</span><br><span class="line"><span class="built_in">echo</span> <span class="string">'[ -s "$NVM_DIR/nvm.sh" ] &amp;&amp; . "$NVM_DIR/nvm.sh"  # This loads nvm'</span> &gt;&gt; <span class="variable">$OPENSHIFT_DATA_DIR</span>/.zshrc</span><br><span class="line"><span class="built_in">exec</span> zsh -l</span><br><span class="line">nvm install 0.12.7</span><br><span class="line">nvm <span class="built_in">alias</span> default 0.12.7</span><br></pre></td></tr></table></figure><h2 id="9-åœæ­¢è‡ªå¸¦çš„rubyå ç”¨8080ç«¯å£"><a href="#9-åœæ­¢è‡ªå¸¦çš„rubyå ç”¨8080ç«¯å£" class="headerlink" title="9,åœæ­¢è‡ªå¸¦çš„rubyå ç”¨8080ç«¯å£"></a>9,åœæ­¢è‡ªå¸¦çš„rubyå ç”¨8080ç«¯å£</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ps -aux</span><br><span class="line"><span class="comment"># æ‰¾åˆ°rubyçš„PID,killæ‰</span></span><br><span class="line"><span class="built_in">kill</span> -9 xxxPID</span><br></pre></td></tr></table></figure><h2 id="10-åˆ é™¤æ— ç”¨æ–‡ä»¶"><a href="#10-åˆ é™¤æ— ç”¨æ–‡ä»¶" class="headerlink" title="10, åˆ é™¤æ— ç”¨æ–‡ä»¶"></a>10, åˆ é™¤æ— ç”¨æ–‡ä»¶</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># mongo æ— ç”¨æ–‡ä»¶</span></span><br><span class="line">rm -rf ~/data/mongodb/journal</span><br><span class="line">rm ~/mongodb-linux-x86_64-3.2.0.tgz</span><br><span class="line"><span class="comment"># zsh æ— ç”¨æ–‡ä»¶</span></span><br><span class="line">rm -r ~/zsh-5.2</span><br><span class="line">rm -r ~/zsh-5.2.tar.gz</span><br><span class="line"><span class="comment"># brew cache</span></span><br><span class="line">rm -r ~/.cache</span><br></pre></td></tr></table></figure><p><br><br><br></p><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> node </tag>
            
            <tag> openshift </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NodeJsçš„å‡ ç§æ–‡ä»¶è·¯å¾„</title>
      <link href="/2016/02/04/node-path/"/>
      <url>/2016/02/04/node-path/</url>
      
        <content type="html"><![CDATA[<p>NodeJsçš„å‡ ç§æ–‡ä»¶è·¯å¾„<br><a id="more"></a></p><hr><h2 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h2><p><code>__dirname</code> : æ€»æ˜¯è¿”å›è¢«æ‰§è¡Œçš„ js æ‰€åœ¨æ–‡ä»¶å¤¹çš„ç»å¯¹è·¯å¾„<br><code>__filename</code>: æ€»æ˜¯è¿”å›è¢«æ‰§è¡Œçš„ js çš„ç»å¯¹è·¯å¾„<br><code>process.cwd()</code>: æ€»æ˜¯è¿”å›è¿è¡Œ node å‘½ä»¤æ—¶æ‰€åœ¨çš„æ–‡ä»¶å¤¹çš„ç»å¯¹è·¯å¾„<br><code>./</code>: åœ¨ <code>require()</code> ä¸­ä½¿ç”¨æ˜¯è·Ÿ <code>__dirname</code>çš„æ•ˆæœç›¸åŒï¼Œä¸ä¼šå› ä¸ºå¯åŠ¨è„šæœ¬çš„ç›®å½•ä¸ä¸€æ ·è€Œæ”¹å˜ï¼Œåœ¨å…¶ä»–æƒ…å†µä¸‹è·Ÿ <code>process.cwd()</code> æ•ˆæœç›¸åŒï¼Œæ˜¯ç›¸å¯¹äºå¯åŠ¨è„šæœ¬æ‰€åœ¨ç›®å½•çš„è·¯å¾„ã€‚</p><h2 id="å»ºè®®"><a href="#å»ºè®®" class="headerlink" title="å»ºè®®"></a>å»ºè®®</h2><p>åªæœ‰åœ¨ <code>require()</code> æ—¶æ‰ä½¿ç”¨ç›¸å¯¹è·¯å¾„(<code>./, ../</code>) çš„å†™æ³•ï¼Œå…¶ä»–åœ°æ–¹ä¸€å¾‹ä½¿ç”¨ç»å¯¹è·¯å¾„</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å½“å‰ç›®å½•ä¸‹</span></span><br><span class="line">path.dirname(__filename) + <span class="string">'/test.js'</span>;</span><br><span class="line"><span class="comment">// ç›¸é‚»ç›®å½•ä¸‹</span></span><br><span class="line">path.resolve(__dirname, <span class="string">'../lib/common.js'</span>);</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h2><ul><li><a href="https://github.com/imsobear/blog/issues/48" target="_blank" rel="noopener">https://github.com/imsobear/blog/issues/48</a></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> node </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>nginx location è®¾ç½®</title>
      <link href="/2016/01/20/nginx-location/"/>
      <url>/2016/01/20/nginx-location/</url>
      
        <content type="html"><![CDATA[<p>nginx location è®¾ç½®<br><a id="more"></a></p><hr><h2 id="åŒ¹é…é¡ºåº-å’Œ-location-çš„ç¼–è¾‘é¡ºåºæ— å…³"><a href="#åŒ¹é…é¡ºåº-å’Œ-location-çš„ç¼–è¾‘é¡ºåºæ— å…³" class="headerlink" title="åŒ¹é…é¡ºåº(å’Œ location çš„ç¼–è¾‘é¡ºåºæ— å…³)"></a>åŒ¹é…é¡ºåº(å’Œ location çš„ç¼–è¾‘é¡ºåºæ— å…³)</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">location =            </span><br><span class="line">location å®Œæ•´è·¯å¾„</span><br><span class="line">location ^~ è·¯å¾„           </span><br><span class="line">location ~,~* æ­£åˆ™é¡ºåº  </span><br><span class="line">location éƒ¨åˆ†èµ·å§‹è·¯å¾„</span><br><span class="line">/</span><br></pre></td></tr></table></figure><h2 id="å­—æ®µè¯´æ˜"><a href="#å­—æ®µè¯´æ˜" class="headerlink" title="å­—æ®µè¯´æ˜"></a>å­—æ®µè¯´æ˜</h2><table><thead><tr><th style="text-align:left">å­—æ®µ</th><th style="text-align:left">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:left">=</td><td style="text-align:left">ç²¾ç¡®çš„æŸ¥æ‰¾åœ°å€</td></tr><tr><td style="text-align:left">^~</td><td style="text-align:left">å¼€å¤´è¡¨ç¤ºuriä»¥æŸä¸ªå¸¸è§„å­—ç¬¦ä¸²å¼€å¤´ï¼Œä¸æ˜¯æ­£åˆ™åŒ¹é…,è¡¨ç¤ºæ™®é€šå­—ç¬¦åŒ¹é…ï¼Œå¦‚æœè¯¥é€‰é¡¹åŒ¹é…ï¼ŒåªåŒ¹é…è¯¥é€‰é¡¹ï¼Œä¸åŒ¹é…åˆ«çš„é€‰é¡¹ï¼Œä¸€èˆ¬ç”¨æ¥åŒ¹é…ç›®å½• </td></tr><tr><td style="text-align:left">~</td><td style="text-align:left">å¼€å¤´è¡¨ç¤ºåŒºåˆ†å¤§å°å†™çš„æ­£åˆ™åŒ¹é…;</td></tr><tr><td style="text-align:left">~*</td><td style="text-align:left">å¼€å¤´è¡¨ç¤ºä¸åŒºåˆ†å¤§å°å†™çš„æ­£åˆ™åŒ¹é…</td></tr><tr><td style="text-align:left">/</td><td style="text-align:left">é€šç”¨åŒ¹é…, å¦‚æœæ²¡æœ‰å…¶å®ƒåŒ¹é…,ä»»ä½•è¯·æ±‚éƒ½ä¼šåŒ¹é…åˆ°</td></tr><tr><td style="text-align:left">@</td><td style="text-align:left">è¡¨ç¤ºä¸ºä¸€ä¸ªlocationè¿›è¡Œå‘½åï¼Œå³è‡ªå®šä¹‰ä¸€ä¸ªlocationï¼Œè¿™ä¸ªlocationä¸èƒ½è¢«å¤–ç•Œæ‰€è®¿é—®ï¼Œåªèƒ½ç”¨äºNginxäº§ç”Ÿçš„å­è¯·æ±‚ï¼Œä¸»è¦ä¸ºerror_pageå’Œtry_filesã€‚</td></tr><tr><td style="text-align:left">!~</td><td style="text-align:left">ä¸åŒ¹é…çš„</td></tr><tr><td style="text-align:left">!~*</td><td style="text-align:left">ä¸åŒ¹é…çš„</td></tr><tr><td style="text-align:left">.</td><td style="text-align:left">åŒ¹é…é™¤æ¢è¡Œç¬¦ä»¥å¤–çš„ä»»æ„å­—ç¬¦</td></tr><tr><td style="text-align:left">\w</td><td style="text-align:left">åŒ¹é…å­—æ¯æˆ–æ•°å­—æˆ–ä¸‹åˆ’çº¿æˆ–æ±‰å­—</td></tr><tr><td style="text-align:left">\s</td><td style="text-align:left">åŒ¹é…ä»»æ„çš„ç©ºç™½ç¬¦</td></tr><tr><td style="text-align:left">\d</td><td style="text-align:left">åŒ¹é…æ•°å­—</td></tr><tr><td style="text-align:left">\b</td><td style="text-align:left">åŒ¹é…å•è¯çš„å¼€å§‹æˆ–ç»“æŸ</td></tr><tr><td style="text-align:left">^</td><td style="text-align:left">åŒ¹é…å­—ç¬¦ä¸²çš„å¼€å§‹</td></tr><tr><td style="text-align:left">$</td><td style="text-align:left">åŒ¹é…å­—ç¬¦ä¸²çš„ç»“æŸ</td></tr><tr><td style="text-align:left">*</td><td style="text-align:left">é‡å¤é›¶æ¬¡æˆ–æ›´å¤šæ¬¡</td></tr><tr><td style="text-align:left">+</td><td style="text-align:left">é‡å¤ä¸€æ¬¡æˆ–æ›´å¤šæ¬¡</td></tr><tr><td style="text-align:left">?</td><td style="text-align:left">é‡å¤é›¶æ¬¡æˆ–ä¸€æ¬¡</td></tr><tr><td style="text-align:left">{n}</td><td style="text-align:left">é‡å¤næ¬¡</td></tr><tr><td style="text-align:left">{n,}</td><td style="text-align:left">é‡å¤næ¬¡æˆ–æ›´å¤šæ¬¡</td></tr><tr><td style="text-align:left">{n,m}</td><td style="text-align:left">é‡å¤nåˆ°mæ¬¡</td></tr><tr><td style="text-align:left">*?</td><td style="text-align:left">é‡å¤ä»»æ„æ¬¡ï¼Œä½†å°½å¯èƒ½å°‘é‡å¤</td></tr><tr><td style="text-align:left">+?</td><td style="text-align:left">é‡å¤1æ¬¡æˆ–æ›´å¤šæ¬¡ï¼Œä½†å°½å¯èƒ½å°‘é‡å¤</td></tr><tr><td style="text-align:left">??</td><td style="text-align:left">é‡å¤0æ¬¡æˆ–1æ¬¡ï¼Œä½†å°½å¯èƒ½å°‘é‡å¤</td></tr><tr><td style="text-align:left">{n,m}?</td><td style="text-align:left">é‡å¤nåˆ°mæ¬¡ï¼Œä½†å°½å¯èƒ½å°‘é‡å¤</td></tr><tr><td style="text-align:left">{n,}?</td><td style="text-align:left">é‡å¤næ¬¡ä»¥ä¸Šï¼Œä½†å°½å¯èƒ½å°‘é‡å¤</td></tr><tr><td style="text-align:left">\W</td><td style="text-align:left">åŒ¹é…ä»»æ„ä¸æ˜¯å­—æ¯ï¼Œæ•°å­—ï¼Œä¸‹åˆ’çº¿ï¼Œæ±‰å­—çš„å­—ç¬¦</td></tr><tr><td style="text-align:left">\S</td><td style="text-align:left">åŒ¹é…ä»»æ„ä¸æ˜¯ç©ºç™½ç¬¦çš„å­—ç¬¦</td></tr><tr><td style="text-align:left">\D</td><td style="text-align:left">åŒ¹é…ä»»æ„éæ•°å­—çš„å­—ç¬¦</td></tr><tr><td style="text-align:left">\B</td><td style="text-align:left">åŒ¹é…ä¸æ˜¯å•è¯å¼€å¤´æˆ–ç»“æŸçš„ä½ç½®</td></tr><tr><td style="text-align:left">[^x]</td><td style="text-align:left">åŒ¹é…é™¤äº†xä»¥å¤–çš„ä»»æ„å­—ç¬¦</td></tr><tr><td style="text-align:left">[^aeiou]</td><td style="text-align:left">åŒ¹é…é™¤äº†aeiouè¿™å‡ ä¸ªå­—æ¯ä»¥å¤–çš„ä»»æ„å­—ç¬¦</td></tr><tr><td style="text-align:left">æ•è·     (exp)</td><td style="text-align:left">åŒ¹é…exp,å¹¶æ•è·æ–‡æœ¬åˆ°è‡ªåŠ¨å‘½åçš„ç»„é‡Œ</td></tr><tr><td style="text-align:left">(?<name>exp)</name></td><td style="text-align:left">åŒ¹é…exp,å¹¶æ•è·æ–‡æœ¬åˆ°åç§°ä¸ºnameçš„ç»„é‡Œï¼Œä¹Ÿå¯ä»¥å†™æˆ(?â€™nameâ€™exp)</td></tr><tr><td style="text-align:left">(?:exp)</td><td style="text-align:left">åŒ¹é…exp,ä¸æ•è·åŒ¹é…çš„æ–‡æœ¬ï¼Œä¹Ÿä¸ç»™æ­¤åˆ†ç»„åˆ†é…ç»„å·</td></tr><tr><td style="text-align:left">é›¶å®½æ–­è¨€     (?=exp)</td><td style="text-align:left">åŒ¹é…expå‰é¢çš„ä½ç½®</td></tr><tr><td style="text-align:left">(?&lt;=exp)</td><td style="text-align:left">åŒ¹é…expåé¢çš„ä½ç½®</td></tr><tr><td style="text-align:left">(?!exp)</td><td style="text-align:left">åŒ¹é…åé¢è·Ÿçš„ä¸æ˜¯expçš„ä½ç½®</td></tr><tr><td style="text-align:left">(?&lt;!exp)</td><td style="text-align:left">åŒ¹é…å‰é¢ä¸æ˜¯expçš„ä½ç½®</td></tr><tr><td style="text-align:left">æ³¨é‡Š     (?#comment)</td><td style="text-align:left">è¿™ç§ç±»å‹çš„åˆ†ç»„ä¸å¯¹æ­£åˆ™è¡¨è¾¾å¼çš„å¤„ç†äº§ç”Ÿä»»ä½•å½±å“ï¼Œç”¨äºæä¾›æ³¨é‡Šè®©äººé˜…è¯»</td></tr></tbody></table><h2 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h2><ul><li><a href="http://seanlook.com/2015/05/17/nginx-location-rewrite/" target="_blank" rel="noopener">http://seanlook.com/2015/05/17/nginx-location-rewrite/</a></li><li><a href="http://blog.csdn.net/gzh0222/article/details/7845981" target="_blank" rel="noopener">http://blog.csdn.net/gzh0222/article/details/7845981</a></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¾®ä¿¡è°ƒè¯•æ–¹æ³•</title>
      <link href="/2016/01/10/wechat-debug/"/>
      <url>/2016/01/10/wechat-debug/</url>
      
        <content type="html"><![CDATA[<p>æœç´¢æ€»ç»“çš„å¾®ä¿¡è°ƒè¯•æ–¹æ³•<br><a id="more"></a></p><hr><h2 id="å¾®ä¿¡å®˜æ–¹æä¾›äº†-å¾®ä¿¡webå¼€å‘è€…å·¥å…·-æœ¬æ–‡ç« ä»…ä½œå¤‡ä»½"><a href="#å¾®ä¿¡å®˜æ–¹æä¾›äº†-å¾®ä¿¡webå¼€å‘è€…å·¥å…·-æœ¬æ–‡ç« ä»…ä½œå¤‡ä»½" class="headerlink" title="å¾®ä¿¡å®˜æ–¹æä¾›äº† å¾®ä¿¡webå¼€å‘è€…å·¥å…· æœ¬æ–‡ç« ä»…ä½œå¤‡ä»½"></a>å¾®ä¿¡å®˜æ–¹æä¾›äº† <code>å¾®ä¿¡webå¼€å‘è€…å·¥å…·</code> æœ¬æ–‡ç« ä»…ä½œå¤‡ä»½</h2><p><a href="http://mp.weixin.qq.com/wiki/10/e5f772f4521da17fa0d7304f68b97d7e.html" target="_blank" rel="noopener">å¾®ä¿¡webå¼€å‘è€…å·¥å…·åœ°å€</a>; </p><h2 id="æ— æœåŠ¡å™¨"><a href="#æ— æœåŠ¡å™¨" class="headerlink" title="æ— æœåŠ¡å™¨"></a>æ— æœåŠ¡å™¨</h2><hr><h3 id="js-sdkä»£ç è°ƒè¯•"><a href="#js-sdkä»£ç è°ƒè¯•" class="headerlink" title="js-sdkä»£ç è°ƒè¯•"></a>js-sdkä»£ç è°ƒè¯•</h3><h4 id="å‰ææ¡ä»¶"><a href="#å‰ææ¡ä»¶" class="headerlink" title="å‰ææ¡ä»¶:"></a>å‰ææ¡ä»¶:</h4><blockquote><ol><li>å¾®ä¿¡ç«¯çš„ <code>æ¥å£é…ç½®ä¿¡æ¯</code> å¿…é¡»å·²ç»éªŒè¯é€šè¿‡(ä¸ç®¡æ˜¯æ€ä¹ˆé€šè¿‡çš„) </li><li>æ‰‹æœºå¿…é¡»å¤„äºå’Œpcç›¸åŒçš„å±€åŸŸç½‘ä¸‹</li><li>pcä¸Šæœ‰ä»£ç†è½¯ä»¶ (macä¸‹æœ‰<code>charles</code>, windowsä¸‹æœ‰ <code>fildder</code>)</li><li>æœ‰nginxæˆ–è€…ç±»ä¼¼å·¥å…·</li></ol></blockquote><h4 id="ä½¿ç”¨æ–¹æ³•"><a href="#ä½¿ç”¨æ–¹æ³•" class="headerlink" title="ä½¿ç”¨æ–¹æ³•:"></a>ä½¿ç”¨æ–¹æ³•:</h4><blockquote><p>1.ä¿®æ”¹ <code>/etc/hosts</code>(æˆ–è€…ä½¿ç”¨ <code>Gas Mask</code> è½¯ä»¶æ¥è®¾ç½®), æ·»åŠ <br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>    å’ŒJSæ¥å£å®‰å…¨åŸŸåç›¸ç¬¦çš„è°ƒè¯•é¡µé¢ç½‘å€</span><br></pre></td></tr></table></figure></p></blockquote><blockquote><p>2.ä½¿ç”¨nginx æˆ–è€…å…¶ä»–å·¥å…·, å°† <code>è°ƒè¯•é¡µé¢ç½‘å€</code> è½¬å‘åˆ°ä½ æ­£åœ¨å¼€å‘çš„æœ¬æœºä»£ç </p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># æ­¤å¤„ä¸º nginx è®¾ç½®</span><br><span class="line"># mac ä¸‹å¯åŠ¨nginx éœ€è¦ `sudo`</span><br><span class="line">server &#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    server_name ionicdemo.xinshangshangxin.com; # ä¿®æ”¹æˆä½ é…ç½®çš„è°ƒè¯•ç½‘å€</span><br><span class="line">    location / &#123;</span><br><span class="line">      root /path/my/code;  # ä¿®æ”¹ä¸ºä½ çš„ä»£ç è·¯å¾„</span><br><span class="line">      try_files $uri $uri/ /index.html =404;</span><br><span class="line">      # index index.html index.htm;</span><br><span class="line">      error_page 404 /error.html;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>3.æ‰“å¼€ <code>charles</code>, å¼€å¯ <code>mac OS X Proxy</code><br><figure class="image-box">                <img src="/img/wechat/01.png" alt="å¼€å¯ mac OS X Proxy" title="" class="">                <p>å¼€å¯ mac OS X Proxy</p>            </figure><br>4.ç‚¹å‡» <code>Proxy Settings</code>, æŸ¥çœ‹/è®¾ç½®ç«¯å£<br><figure class="image-box">                <img src="/img/wechat/02.png" alt="" title="" class="">                <p></p>            </figure></p></blockquote><blockquote><p>5.æ‰“å¼€æ‰‹æœºæ— çº¿ç½‘ç»œ, é«˜çº§è®¾ç½®, æ‰“å¼€<code>æ‰‹åŠ¨HTTPä»£ç†</code>,<br>ä»£ç†æœåŠ¡å™¨ä¸»æœºåä¸ºå±€åŸŸç½‘ip, ç«¯å£ä¸ºä¸Šå›¾è®¾ç½®çš„ç«¯å£<br> <figure class="image-box">                <img src="/img/wechat/03.png" alt="" title="" class="">                <p></p>            </figure></p></blockquote><blockquote><p>6.æ‰‹æœºç«¯è®¿é—® ä½ è¦è°ƒè¯•çš„é¡µé¢, é»˜è®¤è½¬å‘åˆ°ä½ çš„pcç«¯äº†~</p></blockquote><blockquote><p>å€ŸåŠ©æŸäººçš„å›¾æ¥ è¯´æ˜ä¸‹åŸç†<br><figure class="image-box">                <img src="/img/wechat/04.png" alt="" title="" class="">                <p></p>            </figure></p></blockquote><hr><h3 id="æœåŠ¡å™¨ç«¯ä»£ç è°ƒè¯•"><a href="#æœåŠ¡å™¨ç«¯ä»£ç è°ƒè¯•" class="headerlink" title="æœåŠ¡å™¨ç«¯ä»£ç è°ƒè¯•"></a>æœåŠ¡å™¨ç«¯ä»£ç è°ƒè¯•</h3><blockquote><p>ä½¿ç”¨<a href="http://blog.qqbrowser.cc/" target="_blank" rel="noopener">å¾®ä¿¡å®˜æ–¹æ’ä»¶</a>, å…·ä½“æ“ä½œæ–¹æ³•è¯·çœ‹å®˜æ–¹æ–‡æ¡£<a href="http://blog.qqbrowser.cc/tag/docs/" target="_blank" rel="noopener">http://blog.qqbrowser.cc/tag/docs/</a></p></blockquote><p><em>ä¸Šé¢jssdkè°ƒè¯•ä¹Ÿå¯ä»¥ä½¿ç”¨æ­¤æ–¹æ³•</em></p><hr><hr><h2 id="æ‹¥æœ‰è‡ªå·±çš„æœåŠ¡å™¨å’Œè‡ªå·±çš„åŸŸå"><a href="#æ‹¥æœ‰è‡ªå·±çš„æœåŠ¡å™¨å’Œè‡ªå·±çš„åŸŸå" class="headerlink" title="æ‹¥æœ‰è‡ªå·±çš„æœåŠ¡å™¨å’Œè‡ªå·±çš„åŸŸå"></a>æ‹¥æœ‰è‡ªå·±çš„æœåŠ¡å™¨å’Œè‡ªå·±çš„åŸŸå</h2><h3 id="æš´åŠ›çš„æ–¹æ³•"><a href="#æš´åŠ›çš„æ–¹æ³•" class="headerlink" title="æš´åŠ›çš„æ–¹æ³•"></a>æš´åŠ›çš„æ–¹æ³•</h3><blockquote><p> ä»£ç å…¨éƒ¨ä¸Šä¼ åˆ°æœåŠ¡å™¨ä¸Šå¼€å¯è°ƒè¯•</p></blockquote><h3 id="å¿«é€Ÿä¿®æ”¹ä»£ç çš„æ–¹æ³•"><a href="#å¿«é€Ÿä¿®æ”¹ä»£ç çš„æ–¹æ³•" class="headerlink" title="å¿«é€Ÿä¿®æ”¹ä»£ç çš„æ–¹æ³•"></a>å¿«é€Ÿä¿®æ”¹ä»£ç çš„æ–¹æ³•</h3><blockquote><p>æŠŠæœåŠ¡å™¨ä¸Šçš„è¯·æ±‚ç›´æ¥ proxy åˆ°æœ¬åœ°</p></blockquote><p>1.æœåŠ¡å™¨ä¸Š <code>Nginx</code> æŠŠ <code>wechat.xinshangshangxin.com</code> çš„è¯·æ±‚è½¬å‘åˆ°æŸä¸ªç«¯å£(å¦‚ 10000)</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen <span class="number">80</span>;</span><br><span class="line">    server_name wechat.xinshangshangxin.com;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass http:<span class="comment">//127.0.0.1:10000;</span></span><br><span class="line">        proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2.åœ¨æœ¬åœ°å¼€ä¸€ä¸ªåˆ°æœåŠ¡å™¨çš„è½¬å‘é€šé“ï¼ˆè¦æ±‚æœåŠ¡å™¨å¼€å¯ sshd æœåŠ¡ï¼‰</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 1000 ä¸ºæœåŠ¡å™¨ç«¯å£;  8000 ä¸ºæœ¬æœºç«¯å£</span><br><span class="line">ssh yourname@yourip -R <span class="number">10000</span>:<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">8000</span></span><br></pre></td></tr></table></figure><p>3.è®©æœ¬åœ°å¼€å‘ç¯å¢ƒç›‘å¬ 8000 ç«¯å£; è¿™æ ·å°±å¯ä»¥ç›´æ¥åœ¨æœ¬åœ°è¾¹å¼€å‘è¾¹æµ‹è¯•äº†ï¼Œå½“ç„¶åˆ«å¿˜äº†æ ¹æ®å¾®ä¿¡çš„è§„åˆ™é…ç½® OAuth2.0ç½‘é¡µæˆæƒ ç­‰å‚æ•°</p><h2 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h2><ul><li><p><a href="https://www.zhihu.com/question/25456655" target="_blank" rel="noopener">https://www.zhihu.com/question/25456655</a></p></li><li><p><a href="http://blog.lazybee.me/wechat-development/" target="_blank" rel="noopener">http://blog.lazybee.me/wechat-development/</a></p></li></ul><hr><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> wechat </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>windowsä¸‹å®‰è£…æ’ä»¶å‡ºç°node-gyp error</title>
      <link href="/2016/01/09/windows-node-gyp-error/"/>
      <url>/2016/01/09/windows-node-gyp-error/</url>
      
        <content type="html"><![CDATA[<p>å®‰è£…æ’ä»¶å‡ºç° ImportError: No module named gyp<br><a id="more"></a></p><hr><h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><p>åœ¨windowsä¸‹ä½¿ç”¨cygwinå®‰è£…æ’ä»¶å‡ºç°<code>ImportError: No module named gyp</code></p><h2 id="åŸå› "><a href="#åŸå› " class="headerlink" title="åŸå› "></a>åŸå› </h2><ol><li>ä½¿ç”¨äº†cygwinå®‰è£…çš„python</li><li>Visual Studio2015æœªå®‰è£…</li></ol><h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><ol><li><p>å®‰è£… VS2015   </p><blockquote><p><a href="http://msdn.itellyou.cn/" target="_blank" rel="noopener">åœ¨msdn.itellyouä¸Šé€‰æ‹©å¼€å‘äººå‘˜å·¥å…·ä¸‹çš„Visual Studio 2015 Update 1å®‰è£…</a>  </p></blockquote></li><li><p>å®‰è£…Python 2.7  </p><blockquote><p><a href="https://www.python.org/downloads/" target="_blank" rel="noopener">Python 2.7å¿…é¡»ä¸ºå®‰è£…åŒ…å®‰è£…,åœ¨<code>cygwin</code>ä¸­å®‰è£…çš„<code>python</code>æ— æ•ˆ</a>  </p></blockquote></li><li><p>åœ¨<code>è®¡ç®—æœº-&gt;å±æ€§-&gt;é«˜çº§ç³»ç»Ÿè®¾ç½®-&gt;ç¯å¢ƒå˜é‡-&gt;ç³»ç»Ÿå˜é‡</code>çš„  <code>PATH</code>æ·»åŠ  <code>path\Python27\python.exe;</code> (å¿…é¡»æ·»åŠ åˆ°<code>python.exe</code>)</p></li><li>åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥<code>npm config set python path\Python27\python.exe</code><br>(<code>cygwin</code>ä¸‹ä¹Ÿå¯ä»¥åœ¨ <code>.zshrc</code>ä¸­æ·»åŠ <code>export PYTHON=&quot;D:/Python27/python.exe&quot;</code>)</li><li><code>npm config set msvs_version 2015 --global</code></li></ol><p><em>è‡³æ­¤,å®‰è£… <code>mongodb</code> ç­‰æ’ä»¶å°±èƒ½æ­£å¸¸ç¼–è¯‘äº†</em></p><h2 id="å…¶å®ƒ"><a href="#å…¶å®ƒ" class="headerlink" title="å…¶å®ƒ"></a>å…¶å®ƒ</h2><p>å¦‚æœä¾ç„¶ä¸è¡Œ,è¯·å°è¯•ä¸‹é¢è®¾ç½®åå†æ¬¡å°è¯•</p><p><code>set VCTargetsPath=C:\Program Files (x86)\MSBuild\Microsoft.Cpp\v4.0\V140</code></p><h2 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h2><ul><li><p><a href="https://github.com/nodejs/node-gyp/issues/629#issuecomment-153196245" target="_blank" rel="noopener">https://github.com/nodejs/node-gyp/issues/629#issuecomment-153196245</a></p></li><li><p><a href="https://github.com/nodejs/node-gyp" target="_blank" rel="noopener">https://github.com/nodejs/node-gyp</a></p></li><li><p><a href="https://github.com/nodejs/node-gyp/issues/807#issuecomment-163364030" target="_blank" rel="noopener">use set VCTargetsPath</a></p></li></ul><hr><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> npm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åœ¨cygwinä¸­npmå®‰è£…git packages å¤±è´¥</title>
      <link href="/2016/01/07/cygwin-npm-error/"/>
      <url>/2016/01/07/cygwin-npm-error/</url>
      
        <content type="html"><![CDATA[<p>åœ¨cygwinä¸­å®‰è£…æ˜¯å‡ºç°è·¯å¾„ä¸æ­£ç¡®,å®‰è£…å¤±è´¥<br><a id="more"></a></p><hr><h2 id="åŸå› "><a href="#åŸå› " class="headerlink" title="åŸå› "></a>åŸå› </h2><blockquote><p>npm å®˜æ–¹ä¸æ”¯æŒåœ¨cygwinä¸­å®‰è£…</p></blockquote><h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><p>æ›¿æ¢ <code>node_modules\npm\lib\utils\git.js</code> ä¸ºä¸‹é¢å†…å®¹</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// handle some git configuration for windows</span></span><br><span class="line"></span><br><span class="line">exports.spawn = spawnGit</span><br><span class="line">exports.chainableExec = chainableExec</span><br><span class="line">exports.whichAndExec = whichAndExec</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> exec = <span class="built_in">require</span>(<span class="string">"child_process"</span>).execFile</span><br><span class="line">  , spawn = <span class="built_in">require</span>(<span class="string">"./spawn"</span>)</span><br><span class="line">  , npm = <span class="built_in">require</span>(<span class="string">"../npm.js"</span>)</span><br><span class="line">  , which = <span class="built_in">require</span>(<span class="string">"which"</span>)</span><br><span class="line">  , git = npm.config.get(<span class="string">"git"</span>)</span><br><span class="line">  , assert = <span class="built_in">require</span>(<span class="string">"assert"</span>)</span><br><span class="line">  , log = <span class="built_in">require</span>(<span class="string">"npmlog"</span>)</span><br><span class="line">  , win32 = process.platform === <span class="string">"win32"</span></span><br><span class="line">  , cygwin = win32 &amp;&amp; (process.env.ORIGINAL_PATH || <span class="string">''</span>).indexOf(<span class="string">'/cygdrive/'</span>) != <span class="number">-1</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">prefixGitArgs</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> win32 ? [<span class="string">"-c"</span>, <span class="string">"core.longpaths=true"</span>] : []</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">execGit</span> (<span class="params">args, options, cb</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(cygwin &amp;&amp; args) &#123;</span><br><span class="line">      <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;args.length; i++) &#123;</span><br><span class="line">          <span class="keyword">if</span>(<span class="string">':\\'</span>.indexOf(args[i]) != <span class="number">1</span>) &#123;</span><br><span class="line">              args[i] = args[i].replace(<span class="regexp">/\\/g</span>, <span class="string">'/'</span>).replace(<span class="regexp">/^([A-Za-z])\:\//</span>, <span class="string">'/cygdrive/$1/'</span>);</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> fullArgs = prefixGitArgs().concat(args || [])</span><br><span class="line">  log.info(<span class="string">'git'</span>, fullArgs)</span><br><span class="line">  <span class="keyword">return</span> exec(git, fullArgs, options, cb)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">spawnGit</span> (<span class="params">args, options</span>) </span>&#123;</span><br><span class="line">  log.info(<span class="string">"git"</span>, args)</span><br><span class="line">  <span class="keyword">return</span> spawn(git, prefixGitArgs().concat(args || []), options)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">chainableExec</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> args = <span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>)</span><br><span class="line">  <span class="keyword">return</span> [execGit].concat(args)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">whichGit</span> (<span class="params">cb</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> which(git, cb)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">whichAndExec</span> (<span class="params">args, options, cb</span>) </span>&#123;</span><br><span class="line">  assert.equal(<span class="keyword">typeof</span> cb, <span class="string">"function"</span>, <span class="string">"no callback provided"</span>)</span><br><span class="line">  <span class="comment">// check for git</span></span><br><span class="line">  whichGit(<span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      err.code = <span class="string">"ENOGIT"</span></span><br><span class="line">      <span class="keyword">return</span> cb(err)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    execGit(args, options, cb)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£:"></a>å‚è€ƒæ–‡æ¡£:</h1><ul><li><a href="https://github.com/npm/npm/issues/7357" target="_blank" rel="noopener">https://github.com/npm/npm/issues/7357</a></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> cygwin </tag>
            
            <tag> npm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>angular ä½¿ç”¨ multipart/form-data ä¸Šä¼ æ–‡ä»¶, sails.js æ¥æ”¶æ–‡ä»¶</title>
      <link href="/2015/12/17/angular-form/"/>
      <url>/2015/12/17/angular-form/</url>
      
        <content type="html"><![CDATA[<p>angular multipart/form-data,  sails.js æ¥æ”¶æ–‡ä»¶å‡ºç°å–ä¸åˆ°å€¼<br><a id="more"></a></p><h2 id="angular-ä¸Šä¼ æ–‡ä»¶"><a href="#angular-ä¸Šä¼ æ–‡ä»¶" class="headerlink" title="angular ä¸Šä¼ æ–‡ä»¶"></a>angular ä¸Šä¼ æ–‡ä»¶</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">$http(&#123;</span><br><span class="line">  method: <span class="string">'POST'</span>,</span><br><span class="line">  url: <span class="string">'url'</span>,</span><br><span class="line">  headers: &#123;</span><br><span class="line">    <span class="string">'Content-Type'</span>: <span class="literal">undefined</span></span><br><span class="line">  &#125;,</span><br><span class="line">  transformRequest: <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> formData = <span class="keyword">new</span> FormData();</span><br><span class="line">    angular.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">value, key</span>)</span>&#123;</span><br><span class="line">      formData.append(key, value);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> formData;</span><br><span class="line">  &#125;,</span><br><span class="line">  data: &#123;</span><br><span class="line">    file: <span class="string">'xxxx'</span>,</span><br><span class="line">    otherData: <span class="string">'xxxxx'</span>  </span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="sails-æ¥æ”¶æ–‡ä»¶"><a href="#sails-æ¥æ”¶æ–‡ä»¶" class="headerlink" title="sails æ¥æ”¶æ–‡ä»¶"></a>sails æ¥æ”¶æ–‡ä»¶</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="keyword">var</span> <span class="built_in">Promise</span> = <span class="built_in">require</span>(<span class="string">'bluebird'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    req.file(<span class="string">'file'</span>).upload(<span class="function"><span class="keyword">function</span>(<span class="params">err, newFiles</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span>(err || !newFiles || !newFiles[<span class="number">0</span>]) &#123;</span><br><span class="line">        <span class="keyword">return</span> reject(err);</span><br><span class="line">      &#125;</span><br><span class="line">      resolve(newFiles[<span class="number">0</span>]);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span>(<span class="params">file</span>) </span>&#123;</span><br><span class="line">    filePath = file.fd;</span><br><span class="line">    <span class="keyword">var</span> stream = fs.createReadStream(filePath);</span><br><span class="line">    <span class="keyword">return</span> stream;</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span>(<span class="params">stream</span>)</span>&#123;</span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .finally(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    fs.unlink(filePath, <span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span>(err) &#123;</span><br><span class="line">        sails.log.warn(err);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><p>å¦‚æœä»…æœ‰æ–‡ä»¶ä¸Šä¼ , æˆ–è€…ä¸Šä¼ çš„æ–‡ä»¶è¾ƒå°,ä¸ä¼šå‘ç”Ÿé—®é¢˜,<br>ä½†æ˜¯æ—¢ä¸Šä¼ æ–‡ä»¶åˆä¸Šä¼ å…¶ä»–å­—æ®µ<br><figure class="image-box">                <img src="/img/angularjs/form_data.png" alt="" title="" class="">                <p></p>            </figure></p><p>ä¼šå¯¼è‡´ sails æ— æ³•å–å¾— requestNo çš„æ•°æ®</p><p>æ•… ä½¿ç”¨ <code>sails</code> æ¥æ”¶  <code>multipart/form-data</code> æ—¶, å‰ç«¯ä¸Šä¼ æ—¶æ–‡ä»¶å¿…é¡»æ”¾æœ€åé¢</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fd = <span class="keyword">new</span> FormData();</span><br><span class="line">fd.append(<span class="string">'requestNo'</span>, data.requestNo);</span><br><span class="line"><span class="comment">// fileæ–‡ä»¶å¿…é¡»æ”¾æœ€åé¢</span></span><br><span class="line">fd.append(<span class="string">'file'</span>, data.file);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> $http(&#123;</span><br><span class="line">    method: <span class="string">'POST'</span>,</span><br><span class="line">    url: <span class="string">'url'</span>,</span><br><span class="line">    headers: &#123;</span><br><span class="line">      <span class="string">'Content-Type'</span>: <span class="literal">undefined</span></span><br><span class="line">    &#125;,</span><br><span class="line">    data: fd,</span><br><span class="line">    transformRequest: angular.identity</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> data &amp;&amp; data.data || &#123;&#125;;</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£:"></a>å‚è€ƒæ–‡æ¡£:</h1><ul><li><a href="http://stackoverflow.com/questions/29764633/sails-js-form-post-not-submitting-any-data" target="_blank" rel="noopener">http://stackoverflow.com/questions/29764633/sails-js-form-post-not-submitting-any-data</a></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> AngularJS </tag>
            
            <tag> sails </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>angularjs ng-click è§¦å‘ä¸¤æ¬¡äº‹ä»¶</title>
      <link href="/2015/12/17/ngClick-fires-twice-on-button/"/>
      <url>/2015/12/17/ngClick-fires-twice-on-button/</url>
      
        <content type="html"><![CDATA[<p>åœ¨ pcçš„chromeä¸­æ­£å¸¸, åœ¨ chrome çš„<code>device mode</code>ä¸­è§¦å‘2æ¬¡, åœ¨æ‰‹æœºç«¯è§¦å‘2æ¬¡<br><a id="more"></a></p><h2 id="æè¿°"><a href="#æè¿°" class="headerlink" title="æè¿°"></a>æè¿°</h2><blockquote><p>åœ¨ pcçš„chromeä¸­æ­£å¸¸, åœ¨ chrome çš„<code>device mode</code>ä¸­è§¦å‘2æ¬¡, åœ¨æ‰‹æœºç«¯è§¦å‘2æ¬¡</p></blockquote><h2 id="è§¦å‘åŸå› -åŒæ—¶ä½¿ç”¨äº†-ionic-å’Œ-angular-material"><a href="#è§¦å‘åŸå› -åŒæ—¶ä½¿ç”¨äº†-ionic-å’Œ-angular-material" class="headerlink" title="è§¦å‘åŸå› : åŒæ—¶ä½¿ç”¨äº† ionic å’Œ angular-material"></a>è§¦å‘åŸå› : åŒæ—¶ä½¿ç”¨äº† ionic å’Œ angular-material</h2><blockquote><p>Note: ng-click is broken on touch devices and Chrome emulation of such. Chrome desktop is unaffected. The Codepen above: works fine using 0.6.1 or 0.7.0 â€“ broken on 0.7.1.<br>I suspect it might be because of the hammer.js change on 0.7.1 - Ionic has a similar built-in version of hammer as well</p></blockquote><h2 id="è§£å†³æ–¹æ³•"><a href="#è§£å†³æ–¹æ³•" class="headerlink" title="è§£å†³æ–¹æ³•:"></a>è§£å†³æ–¹æ³•:</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app.config(<span class="function"><span class="keyword">function</span>(<span class="params">$mdGestureProvider </span>) </span>&#123;</span><br><span class="line">  $mdGestureProvider.skipClickHijack();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£:"></a>å‚è€ƒæ–‡æ¡£:</h1><ul><li><a href="https://github.com/driftyco/ionic/issues/1022" target="_blank" rel="noopener">https://github.com/driftyco/ionic/issues/1022</a></li><li><a href="https://github.com/angular/material/issues/1406" target="_blank" rel="noopener">https://github.com/angular/material/issues/1406</a></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> AngularJS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[è½¬]HTTP Status Codes</title>
      <link href="/2015/12/06/http-status-codes/"/>
      <url>/2015/12/06/http-status-codes/</url>
      
        <content type="html"><![CDATA[<p>HTTP Status Codes<br><a id="more"></a></p><h2 id="1xxï¼ˆä¸´æ—¶å“åº”ï¼‰"><a href="#1xxï¼ˆä¸´æ—¶å“åº”ï¼‰" class="headerlink" title="1xxï¼ˆä¸´æ—¶å“åº”ï¼‰"></a>1xxï¼ˆä¸´æ—¶å“åº”ï¼‰</h2><blockquote><p>è¡¨ç¤ºä¸´æ—¶å“åº”å¹¶éœ€è¦è¯·æ±‚è€…ç»§ç»­æ‰§è¡Œæ“ä½œçš„çŠ¶æ€ä»£ç ã€‚</p></blockquote><table><thead><tr><th style="text-align:left">ä»£ç </th><th style="text-align:left">è¯´æ˜ </th></tr></thead><tbody><tr><td style="text-align:left">100   ï¼ˆç»§ç»­ï¼‰</td><td style="text-align:left">è¯·æ±‚è€…åº”å½“ç»§ç»­æå‡ºè¯·æ±‚ã€‚ æœåŠ¡å™¨è¿”å›æ­¤ä»£ç è¡¨ç¤ºå·²æ”¶åˆ°è¯·æ±‚çš„ç¬¬ä¸€éƒ¨åˆ†ï¼Œæ­£åœ¨ç­‰å¾…å…¶ä½™éƒ¨åˆ†ã€‚  </td></tr><tr><td style="text-align:left">101   ï¼ˆåˆ‡æ¢åè®®ï¼‰</td><td style="text-align:left">è¯·æ±‚è€…å·²è¦æ±‚æœåŠ¡å™¨åˆ‡æ¢åè®®ï¼ŒæœåŠ¡å™¨å·²ç¡®è®¤å¹¶å‡†å¤‡åˆ‡æ¢ã€‚</td></tr></tbody></table><h2 id="2xx-ï¼ˆæˆåŠŸï¼‰"><a href="#2xx-ï¼ˆæˆåŠŸï¼‰" class="headerlink" title="2xx  ï¼ˆæˆåŠŸï¼‰"></a>2xx  ï¼ˆæˆåŠŸï¼‰</h2><blockquote><p>è¡¨ç¤ºæˆåŠŸå¤„ç†äº†è¯·æ±‚çš„çŠ¶æ€ä»£ç ã€‚</p></blockquote><table><thead><tr><th style="text-align:left">ä»£ç </th><th style="text-align:left">è¯´æ˜ </th></tr></thead><tbody><tr><td style="text-align:left">200   ï¼ˆæˆåŠŸï¼‰</td><td style="text-align:left">æœåŠ¡å™¨å·²æˆåŠŸå¤„ç†äº†è¯·æ±‚ã€‚ é€šå¸¸ï¼Œè¿™è¡¨ç¤ºæœåŠ¡å™¨æä¾›äº†è¯·æ±‚çš„ç½‘é¡µã€‚ </td></tr><tr><td style="text-align:left">201   ï¼ˆå·²åˆ›å»ºï¼‰</td><td style="text-align:left">è¯·æ±‚æˆåŠŸå¹¶ä¸”æœåŠ¡å™¨åˆ›å»ºäº†æ–°çš„èµ„æºã€‚ </td></tr><tr><td style="text-align:left">202   ï¼ˆå·²æ¥å—ï¼‰</td><td style="text-align:left">æœåŠ¡å™¨å·²æ¥å—è¯·æ±‚ï¼Œä½†å°šæœªå¤„ç†ã€‚ </td></tr><tr><td style="text-align:left">203   ï¼ˆéæˆæƒä¿¡æ¯ï¼‰</td><td style="text-align:left">æœåŠ¡å™¨å·²æˆåŠŸå¤„ç†äº†è¯·æ±‚ï¼Œä½†è¿”å›çš„ä¿¡æ¯å¯èƒ½æ¥è‡ªå¦ä¸€æ¥æºã€‚ </td></tr><tr><td style="text-align:left">204   ï¼ˆæ— å†…å®¹ï¼‰</td><td style="text-align:left">æœåŠ¡å™¨æˆåŠŸå¤„ç†äº†è¯·æ±‚ï¼Œä½†æ²¡æœ‰è¿”å›ä»»ä½•å†…å®¹ã€‚ </td></tr><tr><td style="text-align:left">205   ï¼ˆé‡ç½®å†…å®¹ï¼‰</td><td style="text-align:left">æœåŠ¡å™¨æˆåŠŸå¤„ç†äº†è¯·æ±‚ï¼Œä½†æ²¡æœ‰è¿”å›ä»»ä½•å†…å®¹ã€‚ </td></tr><tr><td style="text-align:left">206   ï¼ˆéƒ¨åˆ†å†…å®¹ï¼‰</td><td style="text-align:left">æœåŠ¡å™¨æˆåŠŸå¤„ç†äº†éƒ¨åˆ† GET è¯·æ±‚ã€‚</td></tr></tbody></table><h2 id="3xx-ï¼ˆé‡å®šå‘ï¼‰"><a href="#3xx-ï¼ˆé‡å®šå‘ï¼‰" class="headerlink" title="3xx ï¼ˆé‡å®šå‘ï¼‰"></a>3xx ï¼ˆé‡å®šå‘ï¼‰</h2><blockquote><p>è¡¨ç¤ºè¦å®Œæˆè¯·æ±‚ï¼Œéœ€è¦è¿›ä¸€æ­¥æ“ä½œã€‚ é€šå¸¸ï¼Œè¿™äº›çŠ¶æ€ä»£ç ç”¨æ¥é‡å®šå‘ã€‚</p></blockquote><table><thead><tr><th style="text-align:left">ä»£ç </th><th style="text-align:left">è¯´æ˜ </th></tr></thead><tbody><tr><td style="text-align:left">300   ï¼ˆå¤šç§é€‰æ‹©ï¼‰</td><td style="text-align:left">é’ˆå¯¹è¯·æ±‚ï¼ŒæœåŠ¡å™¨å¯æ‰§è¡Œå¤šç§æ“ä½œã€‚ æœåŠ¡å™¨å¯æ ¹æ®è¯·æ±‚è€… (user agent) é€‰æ‹©ä¸€é¡¹æ“ä½œï¼Œæˆ–æä¾›æ“ä½œåˆ—è¡¨ä¾›è¯·æ±‚è€…é€‰æ‹©ã€‚ </td></tr><tr><td style="text-align:left">301   ï¼ˆæ°¸ä¹…ç§»åŠ¨ï¼‰</td><td style="text-align:left">è¯·æ±‚çš„ç½‘é¡µå·²æ°¸ä¹…ç§»åŠ¨åˆ°æ–°ä½ç½®ã€‚ æœåŠ¡å™¨è¿”å›æ­¤å“åº”ï¼ˆå¯¹ GET æˆ– HEAD è¯·æ±‚çš„å“åº”ï¼‰æ—¶ï¼Œä¼šè‡ªåŠ¨å°†è¯·æ±‚è€…è½¬åˆ°æ–°ä½ç½®ã€‚ </td></tr><tr><td style="text-align:left">302   ï¼ˆä¸´æ—¶ç§»åŠ¨ï¼‰</td><td style="text-align:left">æœåŠ¡å™¨ç›®å‰ä»ä¸åŒä½ç½®çš„ç½‘é¡µå“åº”è¯·æ±‚ï¼Œä½†è¯·æ±‚è€…åº”ç»§ç»­ä½¿ç”¨åŸæœ‰ä½ç½®æ¥è¿›è¡Œä»¥åçš„è¯·æ±‚ã€‚ </td></tr><tr><td style="text-align:left">303   ï¼ˆæŸ¥çœ‹å…¶ä»–ä½ç½®ï¼‰</td><td style="text-align:left">è¯·æ±‚è€…åº”å½“å¯¹ä¸åŒçš„ä½ç½®ä½¿ç”¨å•ç‹¬çš„ GET è¯·æ±‚æ¥æ£€ç´¢å“åº”æ—¶ï¼ŒæœåŠ¡å™¨è¿”å›æ­¤ä»£ç ã€‚ </td></tr><tr><td style="text-align:left">304   ï¼ˆæœªä¿®æ”¹ï¼‰</td><td style="text-align:left">è‡ªä»ä¸Šæ¬¡è¯·æ±‚åï¼Œè¯·æ±‚çš„ç½‘é¡µæœªä¿®æ”¹è¿‡ã€‚ æœåŠ¡å™¨è¿”å›æ­¤å“åº”æ—¶ï¼Œä¸ä¼šè¿”å›ç½‘é¡µå†…å®¹ã€‚ </td></tr><tr><td style="text-align:left">305   ï¼ˆä½¿ç”¨ä»£ç†ï¼‰</td><td style="text-align:left">è¯·æ±‚è€…åªèƒ½ä½¿ç”¨ä»£ç†è®¿é—®è¯·æ±‚çš„ç½‘é¡µã€‚ å¦‚æœæœåŠ¡å™¨è¿”å›æ­¤å“åº”ï¼Œè¿˜è¡¨ç¤ºè¯·æ±‚è€…åº”ä½¿ç”¨ä»£ç†ã€‚ </td></tr><tr><td style="text-align:left">307   ï¼ˆä¸´æ—¶é‡å®šå‘ï¼‰</td><td style="text-align:left">æœåŠ¡å™¨ç›®å‰ä»ä¸åŒä½ç½®çš„ç½‘é¡µå“åº”è¯·æ±‚ï¼Œä½†è¯·æ±‚è€…åº”ç»§ç»­ä½¿ç”¨åŸæœ‰ä½ç½®æ¥è¿›è¡Œä»¥åçš„è¯·æ±‚ã€‚</td></tr></tbody></table><h2 id="4xxï¼ˆè¯·æ±‚é”™è¯¯ï¼‰"><a href="#4xxï¼ˆè¯·æ±‚é”™è¯¯ï¼‰" class="headerlink" title="4xxï¼ˆè¯·æ±‚é”™è¯¯ï¼‰"></a>4xxï¼ˆè¯·æ±‚é”™è¯¯ï¼‰</h2><blockquote><p>è¿™äº›çŠ¶æ€ä»£ç è¡¨ç¤ºè¯·æ±‚å¯èƒ½å‡ºé”™ï¼Œå¦¨ç¢äº†æœåŠ¡å™¨çš„å¤„ç†ã€‚</p></blockquote><table><thead><tr><th style="text-align:left">ä»£ç </th><th style="text-align:left">è¯´æ˜ </th></tr></thead><tbody><tr><td style="text-align:left">400   ï¼ˆé”™è¯¯è¯·æ±‚ï¼‰</td><td style="text-align:left">æœåŠ¡å™¨ä¸ç†è§£è¯·æ±‚çš„è¯­æ³•ã€‚ </td></tr><tr><td style="text-align:left">401   ï¼ˆæœªæˆæƒï¼‰</td><td style="text-align:left">è¯·æ±‚è¦æ±‚èº«ä»½éªŒè¯ã€‚ å¯¹äºéœ€è¦ç™»å½•çš„ç½‘é¡µï¼ŒæœåŠ¡å™¨å¯èƒ½è¿”å›æ­¤å“åº”ã€‚ </td></tr><tr><td style="text-align:left">403   ï¼ˆç¦æ­¢ï¼‰</td><td style="text-align:left">æœåŠ¡å™¨æ‹’ç»è¯·æ±‚ã€‚ </td></tr><tr><td style="text-align:left">404   ï¼ˆæœªæ‰¾åˆ°ï¼‰</td><td style="text-align:left">æœåŠ¡å™¨æ‰¾ä¸åˆ°è¯·æ±‚çš„ç½‘é¡µã€‚ </td></tr><tr><td style="text-align:left">405   ï¼ˆæ–¹æ³•ç¦ç”¨ï¼‰</td><td style="text-align:left">ç¦ç”¨è¯·æ±‚ä¸­æŒ‡å®šçš„æ–¹æ³•ã€‚ </td></tr><tr><td style="text-align:left">406   ï¼ˆä¸æ¥å—ï¼‰</td><td style="text-align:left">æ— æ³•ä½¿ç”¨è¯·æ±‚çš„å†…å®¹ç‰¹æ€§å“åº”è¯·æ±‚çš„ç½‘é¡µã€‚ </td></tr><tr><td style="text-align:left">407   ï¼ˆéœ€è¦ä»£ç†æˆæƒï¼‰</td><td style="text-align:left">æ­¤çŠ¶æ€ä»£ç ä¸ 401ï¼ˆæœªæˆæƒï¼‰ç±»ä¼¼ï¼Œä½†æŒ‡å®šè¯·æ±‚è€…åº”å½“æˆæƒä½¿ç”¨ä»£ç†ã€‚ </td></tr><tr><td style="text-align:left">408   ï¼ˆè¯·æ±‚è¶…æ—¶ï¼‰</td><td style="text-align:left">æœåŠ¡å™¨ç­‰å€™è¯·æ±‚æ—¶å‘ç”Ÿè¶…æ—¶ã€‚ </td></tr><tr><td style="text-align:left">409   ï¼ˆå†²çªï¼‰</td><td style="text-align:left">æœåŠ¡å™¨åœ¨å®Œæˆè¯·æ±‚æ—¶å‘ç”Ÿå†²çªã€‚ æœåŠ¡å™¨å¿…é¡»åœ¨å“åº”ä¸­åŒ…å«æœ‰å…³å†²çªçš„ä¿¡æ¯ã€‚ </td></tr><tr><td style="text-align:left">410   ï¼ˆå·²åˆ é™¤ï¼‰</td><td style="text-align:left">å¦‚æœè¯·æ±‚çš„èµ„æºå·²æ°¸ä¹…åˆ é™¤ï¼ŒæœåŠ¡å™¨å°±ä¼šè¿”å›æ­¤å“åº”ã€‚ </td></tr><tr><td style="text-align:left">411   ï¼ˆéœ€è¦æœ‰æ•ˆé•¿åº¦ï¼‰</td><td style="text-align:left">æœåŠ¡å™¨ä¸æ¥å—ä¸å«æœ‰æ•ˆå†…å®¹é•¿åº¦æ ‡å¤´å­—æ®µçš„è¯·æ±‚ã€‚ </td></tr><tr><td style="text-align:left">412   ï¼ˆæœªæ»¡è¶³å‰ææ¡ä»¶ï¼‰</td><td style="text-align:left">æœåŠ¡å™¨æœªæ»¡è¶³è¯·æ±‚è€…åœ¨è¯·æ±‚ä¸­è®¾ç½®çš„å…¶ä¸­ä¸€ä¸ªå‰ææ¡ä»¶ã€‚ </td></tr><tr><td style="text-align:left">413   ï¼ˆè¯·æ±‚å®ä½“è¿‡å¤§ï¼‰</td><td style="text-align:left">æœåŠ¡å™¨æ— æ³•å¤„ç†è¯·æ±‚ï¼Œå› ä¸ºè¯·æ±‚å®ä½“è¿‡å¤§ï¼Œè¶…å‡ºæœåŠ¡å™¨çš„å¤„ç†èƒ½åŠ›ã€‚ </td></tr><tr><td style="text-align:left">414   ï¼ˆè¯·æ±‚çš„ URI è¿‡é•¿ï¼‰</td><td style="text-align:left">è¯·æ±‚çš„ URIï¼ˆé€šå¸¸ä¸ºç½‘å€ï¼‰è¿‡é•¿ï¼ŒæœåŠ¡å™¨æ— æ³•å¤„ç†ã€‚ </td></tr><tr><td style="text-align:left">415   ï¼ˆä¸æ”¯æŒçš„åª’ä½“ç±»å‹ï¼‰</td><td style="text-align:left">è¯·æ±‚çš„æ ¼å¼ä¸å—è¯·æ±‚é¡µé¢çš„æ”¯æŒã€‚ </td></tr><tr><td style="text-align:left">416   ï¼ˆè¯·æ±‚èŒƒå›´ä¸ç¬¦åˆè¦æ±‚ï¼‰</td><td style="text-align:left">å¦‚æœé¡µé¢æ— æ³•æä¾›è¯·æ±‚çš„èŒƒå›´ï¼Œåˆ™æœåŠ¡å™¨ä¼šè¿”å›æ­¤çŠ¶æ€ä»£ç ã€‚ </td></tr><tr><td style="text-align:left">417   ï¼ˆæœªæ»¡è¶³æœŸæœ›å€¼ï¼‰</td><td style="text-align:left">æœåŠ¡å™¨æœªæ»¡è¶³â€æœŸæœ›â€è¯·æ±‚æ ‡å¤´å­—æ®µçš„è¦æ±‚ã€‚</td></tr></tbody></table><h2 id="5xxï¼ˆæœåŠ¡å™¨é”™è¯¯ï¼‰"><a href="#5xxï¼ˆæœåŠ¡å™¨é”™è¯¯ï¼‰" class="headerlink" title="5xxï¼ˆæœåŠ¡å™¨é”™è¯¯ï¼‰"></a>5xxï¼ˆæœåŠ¡å™¨é”™è¯¯ï¼‰</h2><blockquote><p>è¿™äº›çŠ¶æ€ä»£ç è¡¨ç¤ºæœåŠ¡å™¨åœ¨å°è¯•å¤„ç†è¯·æ±‚æ—¶å‘ç”Ÿå†…éƒ¨é”™è¯¯ã€‚ è¿™äº›é”™è¯¯å¯èƒ½æ˜¯æœåŠ¡å™¨æœ¬èº«çš„é”™è¯¯ï¼Œè€Œä¸æ˜¯è¯·æ±‚å‡ºé”™ã€‚</p></blockquote><table><thead><tr><th style="text-align:left">ä»£ç </th><th style="text-align:left">è¯´æ˜ </th></tr></thead><tbody><tr><td style="text-align:left">500   ï¼ˆæœåŠ¡å™¨å†…éƒ¨é”™è¯¯ï¼‰</td><td style="text-align:left">æœåŠ¡å™¨é‡åˆ°é”™è¯¯ï¼Œæ— æ³•å®Œæˆè¯·æ±‚ã€‚ </td></tr><tr><td style="text-align:left">501   ï¼ˆå°šæœªå®æ–½ï¼‰</td><td style="text-align:left">æœåŠ¡å™¨ä¸å…·å¤‡å®Œæˆè¯·æ±‚çš„åŠŸèƒ½ã€‚ ä¾‹å¦‚ï¼ŒæœåŠ¡å™¨æ— æ³•è¯†åˆ«è¯·æ±‚æ–¹æ³•æ—¶å¯èƒ½ä¼šè¿”å›æ­¤ä»£ç ã€‚ </td></tr><tr><td style="text-align:left">502   ï¼ˆé”™è¯¯ç½‘å…³ï¼‰</td><td style="text-align:left">æœåŠ¡å™¨ä½œä¸ºç½‘å…³æˆ–ä»£ç†ï¼Œä»ä¸Šæ¸¸æœåŠ¡å™¨æ”¶åˆ°æ— æ•ˆå“åº”ã€‚ </td></tr><tr><td style="text-align:left">503   ï¼ˆæœåŠ¡ä¸å¯ç”¨ï¼‰</td><td style="text-align:left">æœåŠ¡å™¨ç›®å‰æ— æ³•ä½¿ç”¨ï¼ˆç”±äºè¶…è½½æˆ–åœæœºç»´æŠ¤ï¼‰ã€‚ é€šå¸¸ï¼Œè¿™åªæ˜¯æš‚æ—¶çŠ¶æ€ã€‚ </td></tr><tr><td style="text-align:left">504   ï¼ˆç½‘å…³è¶…æ—¶ï¼‰</td><td style="text-align:left">æœåŠ¡å™¨ä½œä¸ºç½‘å…³æˆ–ä»£ç†ï¼Œä½†æ˜¯æ²¡æœ‰åŠæ—¶ä»ä¸Šæ¸¸æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚ã€‚ </td></tr><tr><td style="text-align:left">505   ï¼ˆHTTP ç‰ˆæœ¬ä¸å—æ”¯æŒï¼‰</td><td style="text-align:left">æœåŠ¡å™¨ä¸æ”¯æŒè¯·æ±‚ä¸­æ‰€ç”¨çš„ HTTP åè®®ç‰ˆæœ¬ã€‚</td></tr></tbody></table><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£:"></a>å‚è€ƒæ–‡æ¡£:</h1><ul><li><a href="http://www.cnblogs.com/shanyou/archive/2012/05/06/2486134.html" target="_blank" rel="noopener">http://www.cnblogs.com/shanyou/archive/2012/05/06/2486134.html</a></li><li><a href="http://www.restapitutorial.com/httpstatuscodes.html" target="_blank" rel="noopener">http://www.restapitutorial.com/httpstatuscodes.html</a></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> http </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¡•é¼ è§£æè‡ªåŠ¨è·³è¿‡å¹¿å‘Š</title>
      <link href="/2015/11/29/flvcd-no-ad/"/>
      <url>/2015/11/29/flvcd-no-ad/</url>
      
        <content type="html"><![CDATA[<p>ç¡•é¼ è§£æè‡ªåŠ¨è·³è¿‡å¹¿å‘Š<br><a id="more"></a></p><h2 id="æ—©æœŸçš„ç¡•é¼ å¹¿å‘Š"><a href="#æ—©æœŸçš„ç¡•é¼ å¹¿å‘Š" class="headerlink" title="æ—©æœŸçš„ç¡•é¼ å¹¿å‘Š"></a>æ—©æœŸçš„ç¡•é¼ å¹¿å‘Š</h2><blockquote><p>æ—©æœŸçš„ç¡•é¼ å¹¿å‘Šåªæ˜¯é€šè¿‡URLä¸­å¸¦æœ‰ <code>go=1</code> å³å¯è·³è¿‡å¹¿å‘Š, æœ€è¿‘å‘ç°å·²å¤±æ•ˆ</p></blockquote><h2 id="ç›®å‰çš„ç¡•é¼ å¹¿å‘Š"><a href="#ç›®å‰çš„ç¡•é¼ å¹¿å‘Š" class="headerlink" title="ç›®å‰çš„ç¡•é¼ å¹¿å‘Š"></a>ç›®å‰çš„ç¡•é¼ å¹¿å‘Š</h2><blockquote><p>é€šè¿‡è®¾ç½®cookieåˆ¤æ–­æ˜¯å¦å·²ç»è§‚çœ‹å¹¿å‘Š</p></blockquote><h2 id="è§£å†³è¿‡ç¨‹"><a href="#è§£å†³è¿‡ç¨‹" class="headerlink" title="è§£å†³è¿‡ç¨‹"></a>è§£å†³è¿‡ç¨‹</h2><ol><li><p>postmanæŠ“å–é¡µé¢ <a href="http://www.flvcd.com/parse.php?flag=&amp;go=1&amp;format=&amp;kw=http%3A%2F%2Fv.youku.com%2Fv_show%2Fid_XMTI4OTgxNTE2NA%3D%3D.html%3Ffrom%3Ds1.8-1-1.1%26s%3D19545" target="_blank" rel="noopener">http://www.flvcd.com/parse.php?flag=&amp;go=1&amp;format=&amp;kw=http%3A%2F%2Fv.youku.com%2Fv_show%2Fid_XMTI4OTgxNTE2NA%3D%3D.html%3Ffrom%3Ds1.8-1-1.1%26s%3D19545</a></p></li><li><p>è§‚å¯Ÿä»£ç ,å‘ç°å¤šä¸ªevalå‡½æ•°</p></li><li>å°†evalå‡½æ•°æ›¿æ¢æˆ <code>document.write</code> è§£æevalæ··æ·†åçš„ä»£ç </li><li>å¾—åˆ°1ä¸ªå…³é”®å‡½æ•° <code>createSc</code> å’Œ 2ä¸ª <code>document.cookie=</code></li><li>æå–å…³é”®å‡½æ•°è·³è¿‡å¹¿å‘Š</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> html = <span class="built_in">document</span>.documentElement.innerHTML;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> isParsed = <span class="regexp">/&lt;input type="hidden" name="inf" value="/</span>.test(html);</span><br><span class="line"><span class="keyword">if</span> (isParsed) &#123;</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> key = ((html.match(<span class="regexp">/\='\w&#123;32,32&#125;'\;/</span>) || [])[<span class="number">0</span>] || <span class="string">''</span>).replace(<span class="string">'=\''</span>, <span class="string">''</span>).replace(<span class="string">'\';'</span>, <span class="string">''</span>);</span><br><span class="line"><span class="keyword">var</span> time = ((html.match(<span class="regexp">/\=\d&#123;13,13&#125;/</span>) || [])[<span class="number">0</span>] || <span class="string">''</span>).replace(<span class="string">'='</span>, <span class="string">''</span>);</span><br><span class="line"></span><br><span class="line">parseCookie(key, time);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">parseCookie</span>(<span class="params">key, time</span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">createSc</span>(<span class="params">a, t</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> b = <span class="string">'24227945943216730751837054267565'</span>;</span><br><span class="line">    t = <span class="built_in">Math</span>.floor(t / (<span class="number">600</span> * <span class="number">1000</span>));</span><br><span class="line">    <span class="keyword">var</span> ret = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; a.length; i++) &#123;</span><br><span class="line">      <span class="keyword">var</span> j = a.charCodeAt(i) ^ b.charCodeAt(i) ^ t;</span><br><span class="line">      j = j % <span class="string">'z'</span>.charCodeAt(<span class="number">0</span>);</span><br><span class="line">      <span class="keyword">var</span> c;</span><br><span class="line">      <span class="keyword">if</span> (j &lt; <span class="string">'0'</span>.charCodeAt(<span class="number">0</span>)) &#123;</span><br><span class="line">        c = <span class="built_in">String</span>.fromCharCode(<span class="string">'0'</span>.charCodeAt(<span class="number">0</span>) + j % <span class="number">9</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (j &gt;= <span class="string">'0'</span>.charCodeAt(<span class="number">0</span>) &amp;&amp; j &lt;= <span class="string">'9'</span>.charCodeAt(<span class="number">0</span>)) &#123;</span><br><span class="line">        c = <span class="built_in">String</span>.fromCharCode(j);</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (j &gt; <span class="string">'9'</span>.charCodeAt(<span class="number">0</span>) &amp;&amp; j &lt; <span class="string">'A'</span>.charCodeAt(<span class="number">0</span>)) &#123;</span><br><span class="line">        c = <span class="string">'9'</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (j &gt;= <span class="string">'A'</span>.charCodeAt(<span class="number">0</span>) &amp;&amp; j &lt;= <span class="string">'Z'</span>.charCodeAt(<span class="number">0</span>)) &#123;</span><br><span class="line">        c = <span class="built_in">String</span>.fromCharCode(j);</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (j &gt; <span class="string">'Z'</span>.charCodeAt(<span class="number">0</span>) &amp;&amp; j &lt; <span class="string">'a'</span>.charCodeAt(<span class="number">0</span>)) &#123;</span><br><span class="line">        c = <span class="string">'Z'</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (j &gt;= <span class="string">'z'</span>.charCodeAt(<span class="number">0</span>) &amp;&amp; j &lt;= <span class="string">'z'</span>.charCodeAt(<span class="number">0</span>)) &#123;</span><br><span class="line">        c = <span class="built_in">String</span>.fromCharCode(j);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        c = <span class="string">'z'</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      ret += c;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> g = createSc(key, time);</span><br><span class="line">  <span class="keyword">var</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">  date.setTime(date.getTime() + <span class="number">300</span> * <span class="number">1000</span>);</span><br><span class="line">  <span class="built_in">document</span>.cookie = <span class="string">'go='</span> + g + <span class="string">';expires='</span> + date.toGMTString();</span><br><span class="line">  <span class="built_in">document</span>.cookie = <span class="string">'avdGggggtt='</span> + time + <span class="string">';expires='</span> + date.toGMTString();</span><br><span class="line"></span><br><span class="line">  <span class="built_in">window</span>.setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">window</span>.location.reload();</span><br><span class="line">  &#125;, <span class="number">16</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å®Œæ•´è„šæœ¬åœ°å€"><a href="#å®Œæ•´è„šæœ¬åœ°å€" class="headerlink" title="å®Œæ•´è„šæœ¬åœ°å€:"></a>å®Œæ•´è„šæœ¬åœ°å€:</h1><ul><li><a href="https://github.com/xinshangshangxin/youkuvod/tree/flvcd" target="_blank" rel="noopener">github</a></li><li><a href="https://greasyfork.org/zh-CN/scripts/14267-flvcdnoad" target="_blank" rel="noopener">greasyfork</a></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> youkuvod </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>make: &#39;test&#39; is up to date</title>
      <link href="/2015/11/17/make-show-up-to-date/"/>
      <url>/2015/11/17/make-show-up-to-date/</url>
      
        <content type="html"><![CDATA[<p>make testä¸€ç›´æç¤º up to dateçš„è§£å†³æ–¹æ³•<br><a id="more"></a></p><h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜:"></a>é—®é¢˜:</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">make <span class="built_in">test</span></span><br><span class="line">=&gt; make: `<span class="built_in">test</span><span class="string">' is up to date.</span></span><br></pre></td></tr></table></figure><h2 id="è§£å†³åŠæ³•"><a href="#è§£å†³åŠæ³•" class="headerlink" title="è§£å†³åŠæ³•:"></a>è§£å†³åŠæ³•:</h2><blockquote><p>åœ¨Makefileä¸­æ·»åŠ  </p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.PHONY: all <span class="built_in">test</span> clean</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><ul><li><a href="http://stackoverflow.com/questions/3931741/why-does-make-think-the-target-is-up-to-date" target="_blank" rel="noopener">http://stackoverflow.com/questions/3931741/why-does-make-think-the-target-is-up-to-date</a></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> make </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cygwinä¸‹zshå®‰è£…</title>
      <link href="/2015/10/30/cygwin-zsh/"/>
      <url>/2015/10/30/cygwin-zsh/</url>
      
        <content type="html"><![CDATA[<p>cygwinä¸‹zshå®‰è£…<br><a id="more"></a></p><p>ç›¸å…³æ–‡ç« <br><a href="http://blog.xinshangshangxin.com/2015/02/22/ConEmu%E8%AE%BE%E7%BD%AE%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95%E6%89%93%E5%BC%80/">ConEmuè®¾ç½®å½“å‰ç›®å½•æ‰“å¼€å³é”®èœå•</a><br><a href="http://blog.xinshangshangxin.com/2015/05/10/cygwin%E9%85%8D%E7%BD%AE%E8%AE%B0%E5%BD%95/">cygwiné…ç½®è®°å½•</a></p><h2 id="å®‰è£…-apt-cyg-ç±»ä¼¼linuxçš„-apt-get"><a href="#å®‰è£…-apt-cyg-ç±»ä¼¼linuxçš„-apt-get" class="headerlink" title="å®‰è£… apt-cyg(ç±»ä¼¼linuxçš„ apt-get)"></a>å®‰è£… <a href="https://github.com/transcode-open/apt-cyg" target="_blank" rel="noopener"><code>apt-cyg</code></a>(ç±»ä¼¼linuxçš„ <code>apt-get</code>)</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">lynx -<span class="built_in">source</span> rawgit.com/transcode-open/apt-cyg/master/apt-cyg &gt; apt-cyg</span><br><span class="line">install apt-cyg /bin</span><br></pre></td></tr></table></figure><h2 id="å®‰è£…zsh"><a href="#å®‰è£…zsh" class="headerlink" title="å®‰è£…zsh"></a>å®‰è£…zsh</h2><blockquote><p>mac/linux æœ‰ <a href="https://github.com/robbyrussell/oh-my-zsh" target="_blank" rel="noopener">oh-my-zsh</a>, åœ¨cygwinæœ‰<a href="https://github.com/haithembelhaj/oh-my-cygwin" target="_blank" rel="noopener">oh-my-cygwin</a>;å®‰è£…<code>oh-my-cygwin</code>å‘½ä»¤:</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget --no-check-certificate https://raw.github.com/haithembelhaj/oh-my-cygwin/master/oh-my-cygwin.sh -O - | sh</span><br></pre></td></tr></table></figure><blockquote><p>å®‰è£…è¿‡ç¨‹ä¸­å‡ºç° <code>apt-cyg</code> å®‰è£…å¤±è´¥(å¯èƒ½æ˜¯è„šæœ¬é‡Œé¢åœ°å€å†™é”™äº†);ä½†æ˜¯ä¸Šé¢å·²ç»å®‰è£…è¿‡äº† <code>apt-cyg</code>, æ•…æ³¨é‡Šå®‰è£… <code>apt-cyg</code>çš„ä»£ç ,ä¿®æ”¹è„šæœ¬,æ–‡ä»¶åä¸º <code>oh-my-cygwin.sh</code>, å†…å®¹ä¸º:</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">set</span> -e</span><br><span class="line"></span><br><span class="line"><span class="comment"># cd home</span></span><br><span class="line"><span class="built_in">cd</span> ~</span><br><span class="line"></span><br><span class="line">SIMPLE_BACKUP_SUFFIX=<span class="string">".orig"</span></span><br><span class="line">APT_CYG=<span class="string">"<span class="variable">$(mktemp /tmp/apt-cyg.XXXXXXXX)</span>"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># # install apt-cyg</span></span><br><span class="line"><span class="comment"># wget --no-check-certificate "https://github.com/john-peterson/apt-cyg/raw/path/apt-cyg" -O "$&#123;APT_CYG&#125;"</span></span><br><span class="line"><span class="comment"># chmod +x "$&#123;APT_CYG&#125;"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># install some stuff like vim and git</span></span><br><span class="line">apt-cyg install zsh mintty vim curl git openssh</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># install OH MY ZSH</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/robbyrussell/oh-my-zsh.git ~/.oh-my-zsh</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create initial /etc/zshenv</span></span><br><span class="line">[[ ! -e /etc/zshenv ]] &amp;&amp; <span class="built_in">echo</span> <span class="built_in">export</span> PATH=/usr/bin:\<span class="variable">$PATH</span> &gt; /etc/zshenv</span><br><span class="line"></span><br><span class="line">install --backup ~/.oh-my-zsh/templates/zshrc.zsh-template ~/.zshrc</span><br><span class="line"></span><br><span class="line"><span class="comment">#setting up vim</span></span><br><span class="line">VIMRC_EXAMPLE=`find /usr/share/vim -<span class="built_in">type</span> f -name vimrc_example.vim | head -n 1`</span><br><span class="line"><span class="keyword">if</span> [ ! -f ~/.vimrc ] &amp;&amp; [ -n <span class="string">"<span class="variable">$&#123;VIMRC_EXAMPLE&#125;</span>"</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">  install <span class="string">"<span class="variable">$&#123;VIMRC_EXAMPLE&#125;</span>"</span> ~/.vimrc</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># install apt-cyg</span></span><br><span class="line">install --backup <span class="string">"<span class="variable">$&#123;APT_CYG&#125;</span>"</span> /bin/apt-cyg</span><br><span class="line"></span><br><span class="line"><span class="comment"># setting up zsh as default</span></span><br><span class="line">sed -i <span class="string">"s/<span class="variable">$USER</span>\:\/bin\/bash/<span class="variable">$USER</span>\:\/bin\/zsh/g"</span> /etc/passwd</span><br><span class="line"></span><br><span class="line"><span class="comment"># et voila just start it</span></span><br><span class="line">/usr/bin/env zsh</span><br></pre></td></tr></table></figure><blockquote><p>ç„¶åæ‰§è¡Œ <code>./oh-my-cygwin.sh</code>åæˆåŠŸå®‰è£…</p></blockquote><h2 id="åœ¨-ConEmu-ä¸‹è®¾ç½®çª—å£é»˜è®¤æ‰“å¼€-zsh"><a href="#åœ¨-ConEmu-ä¸‹è®¾ç½®çª—å£é»˜è®¤æ‰“å¼€-zsh" class="headerlink" title="åœ¨ ConEmu ä¸‹è®¾ç½®çª—å£é»˜è®¤æ‰“å¼€ zsh"></a>åœ¨ <code>ConEmu</code> ä¸‹è®¾ç½®çª—å£é»˜è®¤æ‰“å¼€ <code>zsh</code></h2><p><code>SET CHERE_INVOKING=1 &amp; &quot;ä½ çš„cygwinå®‰è£…ç›®å½•\bin\zsh -l -i&quot; -cur_console:t:&quot;cygwin terminal&quot;</code></p><p><img src="/img/conemu/11.png" alt="è®¾ç½® ConEmuä¸‹è®¾ç½®çª—å£é»˜è®¤æ‰“å¼€zsh"></p><h2 id="åœ¨-ConEmu-ä¸‹è®¾ç½®å³é”®å½“å‰ç›®å½•æ‰“å¼€-zsh"><a href="#åœ¨-ConEmu-ä¸‹è®¾ç½®å³é”®å½“å‰ç›®å½•æ‰“å¼€-zsh" class="headerlink" title="åœ¨ ConEmu ä¸‹è®¾ç½®å³é”®å½“å‰ç›®å½•æ‰“å¼€ zsh"></a>åœ¨ <code>ConEmu</code> ä¸‹è®¾ç½®å³é”®å½“å‰ç›®å½•æ‰“å¼€ <code>zsh</code></h2><p><code>SET CHERE_INVOKING=1 &amp; &quot;ä½ çš„cygwinå®‰è£…ç›®å½•\bin\zsh -l -i&quot; -cur_console:t:&quot;cygwin terminal&quot;</code></p><figure class="image-box">                <img src="/img/conemu/12.png" alt="åœ¨ConEmuä¸‹è®¾ç½®å³é”®å½“å‰ç›®å½•æ‰“å¼€zsh" title="" class="">                <p>åœ¨ConEmuä¸‹è®¾ç½®å³é”®å½“å‰ç›®å½•æ‰“å¼€zsh</p>            </figure><h2 id="åœ¨-ConEmu-ä¸‹è®¾ç½®-åªæ‰“å¼€ä¸€ä¸ªçª—å£-å…¨éƒ¨ä»¥æ ‡ç­¾å½¢å¼æ‰“å¼€"><a href="#åœ¨-ConEmu-ä¸‹è®¾ç½®-åªæ‰“å¼€ä¸€ä¸ªçª—å£-å…¨éƒ¨ä»¥æ ‡ç­¾å½¢å¼æ‰“å¼€" class="headerlink" title="åœ¨ ConEmu ä¸‹è®¾ç½® åªæ‰“å¼€ä¸€ä¸ªçª—å£, å…¨éƒ¨ä»¥æ ‡ç­¾å½¢å¼æ‰“å¼€"></a>åœ¨ <code>ConEmu</code> ä¸‹è®¾ç½® åªæ‰“å¼€ä¸€ä¸ªçª—å£, å…¨éƒ¨ä»¥æ ‡ç­¾å½¢å¼æ‰“å¼€</h2><p><img src="/img/conemu/13.png" alt="åœ¨ ConEmuä¸‹è®¾ç½® åªæ‰“å¼€ä¸€ä¸ªçª—å£"></p>]]></content>
      
      
      
        <tags>
            
            <tag> ConEmu </tag>
            
            <tag> cygwin </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åœ¨å·²å¿½ç•¥æ–‡ä»¶å¤¹ä¸­ä¸å¿½ç•¥æŒ‡å®šæ–‡ä»¶å¤¹</title>
      <link href="/2015/10/24/exclude-everything-except-a-specific-directory/"/>
      <url>/2015/10/24/exclude-everything-except-a-specific-directory/</url>
      
        <content type="html"><![CDATA[<p>ç½‘ä¸Šæœç´¢åˆ°çš„ç­”æ¡ˆæœ‰å¾ˆå¤šæ˜¯é”™è¯¯çš„,æ•…è®°å½•ä¹‹<br><a id="more"></a></p><ul><li>åœ¨å·²å¿½ç•¥æ–‡ä»¶å¤¹ä¸­ä¸å¿½ç•¥æŒ‡å®šæ–‡ä»¶å¤¹<code>å¿½ç•¥themesæ–‡ä»¶å¤¹æ‰€æœ‰å†…å®¹, é™¤äº† themes/jacman/æ–‡ä»¶å¤¹</code></li></ul><blockquote><p><strong><code>/*</code>  ä¸å¯çœç•¥!</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">themes/*</span><br><span class="line">!themes/jacman/</span><br></pre></td></tr></table></figure></p></blockquote><blockquote><p>(è‹±æ–‡åŸæ–‡: ) Example to exclude everything except a specific directory foo/bar (note the /* - without the slash, the wildcard would also exclude everything within foo/bar):</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># exclude everything except directory foo/bar</span><br><span class="line">/*</span><br><span class="line">!/foo</span><br><span class="line">/foo/*</span><br><span class="line">!/foo/bar</span><br></pre></td></tr></table></figure><ul><li>å…¶å®ƒæ³¨æ„ç‚¹</li></ul><ol><li>ç©ºè¡Œä¸åŒ¹é…ä»»ä½•å†…å®¹,æ‰€ä»¥å¯ä»¥ä½œä¸ºå—åˆ†éš”ç¬¦ï¼›</li><li><code>#</code> å¼€å¤´è¡¨ç¤ºæ³¨é‡Š,å¦‚æœç›¸åŒ¹é… <code>#</code>,å¯ä»¥åœ¨å‰é¢åŠ ä¸€ä¸ªåæ–œæ ,å³ <code>\#</code></li><li>é™¤éåŠ äº†åæ–œæ ,å¦åˆ™ä¸€è¿ä¸²çš„ç©ºæ ¼ä¼šè¢«å¿½ç•¥ï¼›</li><li>å¦‚æœåœ¨åŒ¹é…çš„å†…å®¹å‰é¢åŠ ä¸Š <code>!</code> ,åˆ™è¿™äº›åŒ¹é…è¿‡çš„éƒ¨åˆ†å°†è¢«ç§»å‡º,å¦‚æœè¦åŒ¹é…ä»¥  <code>!</code>  å¼€å¤´çš„å†…å®¹,éœ€è¦åŠ ä¸Šåæ–œæ ,å¦‚  <code>\!important.txt</code></li><li>å¦‚æœä¸€ä¸ªåŒ¹é… pattern åé¢æœ‰ä¸€ä¸ªæ–œæ ,å¦‚ <code>foo/</code>,åˆ™é»˜è®¤ä¼šåŒ¹é…æ‰€æœ‰ï¼ˆåŒ…å«çˆ¶å­æ–‡ä»¶å¤¹ï¼‰ä¸­çš„ foo æ–‡ä»¶å¤¹å†…å®¹</li><li>å¦‚æœä¸€ä¸ªåŒ¹é… pattern ä¸åŒ…å«æ–œæ ,å¦‚ foo,Git ä¼šå°†å…¶ä½œä¸ºä¸€ä¸ª shell çš„æŸ¥æ‰¾å‘½ä»¤åŒ¹é…å†…å®¹</li></ol><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><ul><li><a href="http://www.barretlee.com/blog/2015/09/06/set-gitignore-after-add-file/" target="_blank" rel="noopener">æ­¤æ–‡ç« ä¸ºé”™è¯¯è¯´æ˜å·²å¿½ç•¥æ–‡ä»¶å¤¹ä¸­ä¸å¿½ç•¥æŒ‡å®šæ–‡ä»¶å¤¹å†™æ³•</a></li><li><a href="http://my.oschina.net/longyuan/blog/521098" target="_blank" rel="noopener">http://my.oschina.net/longyuan/blog/521098</a></li><li><a href="https://git-scm.com/docs/gitignore" target="_blank" rel="noopener">https://git-scm.com/docs/gitignore</a></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>npm å®‰è£…æ’ä»¶æ— æƒé™</title>
      <link href="/2015/10/24/npm-throws-error-without-sudo/"/>
      <url>/2015/10/24/npm-throws-error-without-sudo/</url>
      
        <content type="html"><![CDATA[<p>å®‰è£…æ’ä»¶å‡ºç° Error: EACCES, open â€˜â€¦.â€™<br><a id="more"></a></p><ul><li>éœ€è¦è®¾ç½®æƒé™å†™æ–‡ä»¶</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo chown -R <span class="string">`whoami`</span> ~<span class="regexp">/.npm</span></span><br></pre></td></tr></table></figure><ul><li>å°è¯•å®‰è£…æ’ä»¶, å¦‚æœå‡ºé”™,ç»§ç»­æ‰§è¡Œ</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo chown -R <span class="string">`whoami`</span> /usr/local/lib/node_modules</span><br></pre></td></tr></table></figure><ul><li>å¦‚æœä¾ç„¶æœ‰é”™, å¯èƒ½éœ€è¦</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo chown -R <span class="string">`whoami`</span> /usr/local</span><br></pre></td></tr></table></figure><ul><li>è¿˜æ˜¯æŠ¥é”™,è¯· <code>sudo</code> æ‰§è¡Œå‘½ä»¤</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo npm install ...</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><ul><li><a href="http://stackoverflow.com/questions/16151018/npm-throws-error-without-sudo" target="_blank" rel="noopener">http://stackoverflow.com/questions/16151018/npm-throws-error-without-sudo</a></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> npm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Agreeing to the Xcode/iOS license requires admin privileges</title>
      <link href="/2015/10/03/Agreeing-to-the-Xcode-iOS-license-requires-admin-privileges/"/>
      <url>/2015/10/03/Agreeing-to-the-Xcode-iOS-license-requires-admin-privileges/</url>
      
        <content type="html"><![CDATA[<p>è§£å†³å‡çº§äº†xcodeåå‡ºç°çš„é—®é¢˜<br><a id="more"></a></p><ol><li>æ‰“å¼€ç»ˆç«¯ï¼Œè¾“å…¥  <code>sudo xcodebuild -license</code></li><li>ç»ˆç«¯æç¤ºæ•²å›è½¦é”®<code>(enter)</code>æ‰“å¼€è®¸å¯åè®®</li><li>ç»ˆç«¯æç¤º æŒ‰ä¸‹  <code>space</code> é”®é˜…è¯»è®¸å¯åè®®ï¼ŒæŒ‰<code>q</code> ä¸é˜…è¯»</li><li>æœ€ç»ˆï¼Œç»ˆç«¯ä¼šå‡ºç°ä¸‰ä¸ªé€‰é¡¹ï¼Œ<code>agree ã€printã€cancel</code>ï¼Œè¾“å…¥<code>agree</code>ï¼Œç„¶åå›è½¦</li></ol><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><ul><li><a href="http://blog.csdn.net/yabusai/article/details/37690783" target="_blank" rel="noopener">http://blog.csdn.net/yabusai/article/details/37690783</a></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> osx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[è½¬]promises å¾ˆé…·ï¼Œä½†å¾ˆå¤šäººå¹¶æ²¡æœ‰ç†è§£å°±åœ¨ç”¨äº†</title>
      <link href="/2015/09/29/promise-problem/"/>
      <url>/2015/09/29/promise-problem/</url>
      
        <content type="html"><![CDATA[<p>promisesè¯¦è§£<br><a id="more"></a></p><p>JavaScript å¼€å‘è€…ä»¬ï¼Œæ˜¯æ—¶å€™æ‰¿è®¤äº†ï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨<code>promises</code>çš„æ—¶å€™ï¼Œä¼šå†™å‡ºè®¸å¤šæœ‰é—®é¢˜çš„<code>promises</code>ä»£ç .ä½†å¹¶ä¸æ˜¯ <code>promises</code>æœ¬èº«æœ‰é—®é¢˜ï¼Œè¢«<a href="https://promisesaplus.com/" target="_blank" rel="noopener">A+ æ ‡å‡†</a>,å®šä¹‰çš„<code>promises</code> æ˜¯æå¥½çš„  </p><p> åœ¨è¿‡å»çš„å‡ å¹´ä¸­ï¼Œç¬”è€…çœ‹åˆ°äº†å¾ˆå¤šç¨‹åºå‘˜åœ¨è°ƒç”¨PouchDBæˆ–è€…å…¶ä»–promiseåŒ–çš„APIæ—¶é‡åˆ°äº†å¾ˆå¤šå›°éš¾ã€‚è¿™è®©ç¬”è€…è®¤è¯†åˆ°ï¼Œåœ¨JavaScriptç¨‹åºå‘˜ä¹‹ä¸­ï¼Œåªæœ‰å°‘æ•°äººæ˜¯çœŸæ­£ç†è§£äº†promiseè§„èŒƒçš„ã€‚å¦‚æœä½ è§‰å¾—è¿™ä¸å¯æ€è®®ï¼Œé‚£ä¹ˆè€ƒè™‘ä¸‹æˆ‘æœ€è¿‘<a href="https://twitter.com/nolanlawson/status/578948854411878400" target="_blank" rel="noopener">åœ¨Twitterä¸Šçš„å†™çš„ä¸€ä¸ªæ¯”è¾ƒéš¾çš„é¢˜ç›®</a>ï¼š</p><p><strong>Qï¼šä¸‹é¢å››ä¸ªä½¿ç”¨promiseçš„è¯­å¥ä¹‹é—´çš„ä¸åŒç‚¹åœ¨å“ªå„¿ï¼Ÿ</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">doSomething().then(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> doSomethingElse();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">doSomething().then(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  doSomethingElse();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">doSomething().then(doSomethingElse());</span><br><span class="line"></span><br><span class="line">doSomething().then(doSomethingElse);</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ çŸ¥é“è¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆï¼Œé‚£ä¹ˆæ­å–œä½ ï¼Œä½ å·²ç»æ˜¯ä¸€ä¸ªpromiseå¤§å¸ˆå¹¶ä¸”å¯ä»¥ç›´æ¥å…³é—­è¿™ä¸ªç½‘é¡µäº†ã€‚  </p><p>ä½†æ˜¯å¯¹äºä¸èƒ½å›ç­”è¿™ä¸ªé—®é¢˜çš„ç¨‹åºå‘˜ä¸­99.9%çš„äººï¼Œåˆ«æ‹…å¿ƒï¼Œä½ ä»¬ä¸æ˜¯å°‘æ•°æ´¾ã€‚æ²¡æœ‰äººèƒ½å¤Ÿåœ¨ç¬”è€…çš„tweetä¸Šå®Œå…¨æ­£ç¡®çš„å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œè€Œä¸”å¯¹äºç¬¬ä¸‰æ¡è¯­å¥çš„æœ€ç»ˆç­”æ¡ˆä¹Ÿä»¤æˆ‘æ„Ÿåˆ°éœ‡æƒŠï¼Œå³ä¾¿æˆ‘æ˜¯å‡ºé¢˜äººã€‚  </p><p>ç­”æ¡ˆåœ¨è¿™ç¯‡åšæ–‡çš„åº•éƒ¨ï¼Œä½†æ˜¯é¦–å…ˆï¼Œç¬”è€…å¿…é¡»å…ˆä»‹ç»ä¸ºä½•promiseæ˜¾å¾—éš¾ä»¥ç†è§£ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬å½“ä¸­æ— è®ºæ˜¯æ–°æ‰‹æˆ–è€…æ˜¯å¾ˆæ¥è¿‘ä¸“å®¶æ°´å‡†çš„äººéƒ½æœ‰è¢«promiseæŠ˜ç£¨çš„ç»å†ã€‚åŒæ—¶ï¼Œç¬”è€…ä¹Ÿä¼šç»™å‡ºè‡ªè®¤ä¸ºèƒ½å¤Ÿå¿«é€Ÿã€å‡†ç¡®ç†è§£promiseçš„æ–¹æ³•ã€‚è€Œä¸”ç¬”è€…ç¡®ä¿¡è¯»è¿‡è¿™ç¯‡æ–‡ç« ä¹‹åï¼Œç†è§£promiseä¸ä¼šé‚£ä¹ˆéš¾äº†ã€‚  </p><p>åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹æœ‰å…³promiseçš„ä¸€äº›åŸºæœ¬è®¾å®šã€‚  </p><p><strong><code>promise</code>ä»å“ªé‡Œæ¥ï¼Ÿ</strong></p><p>å¦‚æœä½ è¯»è¿‡æœ‰å…³<code>promise</code>çš„æ–‡ç« ï¼Œä½ ä¼šå‘ç°æ–‡ç« ä¸­ä¸€å®šä¼šæåˆ°å›è°ƒæ·±å‘ï¼Œä¸è¯´åˆ«çš„ï¼Œåœ¨è§†è§‰ä¸Šï¼Œå›è°ƒé‡‘å­—å¡”ä¼šè®©ä½ çš„ä»£ç æœ€ç»ˆè¶…è¿‡å±å¹•çš„å®½åº¦ã€‚<br><code>promise</code>æ˜¯èƒ½å¤Ÿè§£å†³è¿™ä¸ªé—®é¢˜çš„ï¼Œä½†æ˜¯å®ƒè§£å†³çš„é—®é¢˜ä¸ä»…ä»…æ˜¯ç¼©è¿›ã€‚åœ¨è®¨è®ºåˆ°å¦‚ä½•è§£å†³å›è°ƒé‡‘å­—å¡”é—®é¢˜çš„æ—¶å€™ï¼Œæˆ‘ä»¬é‡åˆ°çœŸæ­£çš„éš¾é¢˜æ˜¯å›è°ƒå‡½æ•°å‰¥å¤ºäº†ç¨‹åºå‘˜ä½¿ç”¨<code>return</code>å’Œ<code>throw</code>çš„èƒ½åŠ›ã€‚è€Œç¨‹åºçš„æ‰§è¡Œæµç¨‹çš„åŸºç¡€å»ºç«‹äºä¸€ä¸ªå‡½æ•°åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­è°ƒç”¨å¦ä¸€ä¸ªå‡½æ•°æ—¶äº§ç”Ÿçš„å‰¯ä½œç”¨ã€‚(è¯‘è€…æ³¨ï¼šä¸ªäººå¯¹è¿™é‡Œå‰¯ä½œç”¨çš„ç†è§£æ˜¯ï¼Œå‡½æ•°è°ƒç”¨å‡½æ•°ä¼šäº§ç”Ÿå‡½æ•°è°ƒç”¨æ ˆï¼Œè€Œå›è°ƒå‡½æ•°æ˜¯ä¸è¿è¡Œåœ¨æ ˆä¸Šçš„ï¼Œå› æ­¤ä¸èƒ½ä½¿ç”¨<code>return</code>å’Œ<code>throw</code>)ã€‚</p><p>äº‹å®ä¸Šï¼Œå›è°ƒå‡½æ•°ä¼šåšä¸€äº›æ›´é‚ªæ¶çš„äº‹æƒ…ï¼Œå®ƒä»¬å‰¥å¤ºæˆ‘ä»¬åœ¨æ ˆä¸Šæ‰§è¡Œä»£ç çš„èƒ½åŠ›ï¼Œè€Œåœ¨å…¶ä»–è¯­è¨€å½“ä¸­ï¼Œæˆ‘ä»¬å§‹ç»ˆéƒ½èƒ½å¤Ÿåœ¨æ ˆä¸Šæ‰§è¡Œä»£ç ã€‚ç¼–å†™ä¸åœ¨æ ˆä¸Šè¿è¡Œçš„ä»£ç å°±åƒé©¾é©¶æ²¡æœ‰åˆ¹è½¦çš„æ±½è½¦ä¸€æ ·ï¼Œåœ¨ä½ çœŸæ­£éœ€è¦å®ƒä¹‹å‰ï¼Œä½ æ˜¯ä¸ä¼šç†è§£ä½ æœ‰å¤šéœ€è¦å®ƒã€‚</p><p><code>promise</code>è¢«è®¾è®¡ä¸ºèƒ½å¤Ÿè®©æˆ‘ä»¬é‡æ–°ä½¿ç”¨é‚£äº›ç¼–ç¨‹è¯­è¨€çš„åŸºæœ¬è¦ç´ ï¼š<code>return</code>ï¼Œ<code>throw</code>ï¼Œæ ˆã€‚åœ¨æƒ³è¦ä½¿ç”¨<code>promise</code>ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆè¦å­¦ä¼šæ­£ç¡®ä½¿ç”¨å®ƒã€‚</p><p>æ–°æ‰‹å¸¸è§é”™è¯¯</p><p>ä¸€äº›äººå°è¯•ä½¿ç”¨æ¼«ç”»çš„æ–¹å¼è§£é‡Š<code>promise</code>ï¼Œæˆ–è€…æ˜¯åƒæ˜¯è§£é‡Šåè¯ä¸€æ ·è§£é‡Šå®ƒï¼šå®ƒè¡¨ç¤ºåŒæ­¥ä»£ç ä¸­çš„å€¼ï¼Œå¹¶ä¸”èƒ½åœ¨ä»£ç ä¸­è¢«ä¼ é€’ã€‚</p><p>ç¬”è€…å¹¶æ²¡æœ‰è§‰å¾—è¿™äº›è§£é‡Šå¯¹ç†è§£<code>promise</code>æœ‰ç”¨ã€‚ç¬”è€…è‡ªå·±çš„ç†è§£æ˜¯ï¼š<code>promise</code>æ˜¯å…³äºä»£ç ç»“æ„å’Œä»£ç è¿è¡Œæµç¨‹çš„ã€‚å› æ­¤ï¼Œç¬”è€…è®¤ä¸ºå±•ç¤ºä¸€äº›å¸¸è§é”™è¯¯ï¼Œå¹¶å‘Šè¯‰å¤§å®¶å¦‚ä½•ä¿®æ­£å®ƒæ‰æ˜¯ç‹é“ã€‚</p><p>æ‰¯è¿œä¸€ç‚¹ï¼Œå¯¹äº<code>promise</code>ä¸åŒçš„äººæœ‰ä¸åŒçš„ç†è§£ï¼Œä¸ºäº†æœ¬æ–‡çš„æœ€ç»ˆç›®çš„ï¼Œæˆ‘åœ¨è¿™é‡Œåªè®¨è®º<code>promise</code>çš„å®˜æ–¹è§„èŒƒï¼Œåœ¨è¾ƒæ–°ç‰ˆæœ¬çš„æµè§ˆå™¨ä¼šä½œä¸º<code>window</code>å¯¹è±¡çš„ä¸€ä¸ªå±æ€§è¢«æš´éœ²å‡ºæ¥ã€‚ç„¶è€Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„æµè§ˆå™¨éƒ½æ”¯æŒè¿™ä¸€ç‰¹æ€§ï¼Œä½†æ˜¯åˆ°ç›®å‰ä¸ºæ­¢æœ‰è®¸å¤šå¯¹äºè§„èŒƒçš„å®ç°ï¼Œæ¯”å¦‚è¿™ä¸ªæœ‰ç€å¾ˆåš£å¼ çš„åå­—çš„<code>promise</code>åº“ï¼š<code>lie</code>ï¼ŒåŒæ—¶å®ƒè¿˜éå¸¸ç²¾ç®€ã€‚</p><h3 id="æ–°æ‰‹é”™è¯¯No-1ï¼šå›è°ƒé‡‘å­—å¡”"><a href="#æ–°æ‰‹é”™è¯¯No-1ï¼šå›è°ƒé‡‘å­—å¡”" class="headerlink" title="æ–°æ‰‹é”™è¯¯No.1ï¼šå›è°ƒé‡‘å­—å¡”"></a>æ–°æ‰‹é”™è¯¯No.1ï¼šå›è°ƒé‡‘å­—å¡”</h3><p>PouchDBæœ‰è®¸å¤špromiseé£æ ¼çš„APIï¼Œç¨‹åºå‘˜åœ¨å†™æœ‰å…³PouchDBçš„ä»£ç çš„æ—¶å€™ï¼Œå¸¸å¸¸å°†promiseç”¨çš„ä¸€å¡Œç³Šæ¶‚ã€‚ä¸‹é¢ç»™å‡ºä¸€ç§å¾ˆå¸¸è§çš„ç³Ÿç³•å†™æ³•ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">remotedb.allDocs(&#123;</span><br><span class="line">  include_docs: <span class="literal">true</span>,</span><br><span class="line">  attachments: <span class="literal">true</span></span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> docs = result.rows;</span><br><span class="line">  docs.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">element</span>) </span>&#123;</span><br><span class="line">    localdb.put(element.doc).then(<span class="function"><span class="keyword">function</span>(<span class="params">response</span>) </span>&#123;</span><br><span class="line">      alert(<span class="string">"Pulled doc with id "</span> + element.doc._id + <span class="string">" and added to local db."</span>);</span><br><span class="line">    &#125;).catch(<span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (err.status == <span class="number">409</span>) &#123;</span><br><span class="line">        localdb.get(element.doc._id).then(<span class="function"><span class="keyword">function</span> (<span class="params">resp</span>) </span>&#123;</span><br><span class="line">          localdb.remove(resp._id, resp._rev).then(<span class="function"><span class="keyword">function</span> (<span class="params">resp</span>) </span>&#123;</span><br><span class="line"><span class="comment">// et cetera...</span></span><br></pre></td></tr></table></figure><p>ä½ ç¡®å®å¯ä»¥å°†promiseå½“åšå›è°ƒå‡½æ•°æ¥ä½¿ç”¨ï¼Œä½†è¿™å´æ˜¯ä¸€ç§æ€é¸¡ç”¨ç‰›åˆ€çš„è¡Œä¸ºã€‚ä¸è¿‡è¿™ä¹ˆåšä¹Ÿæ˜¯å¯è¡Œçš„ã€‚ ä½ å¯èƒ½ä¼šè®¤ä¸ºè¿™ç§é”™è¯¯æ˜¯é‚£äº›åˆšå…¥è¡Œçš„æ–°æ‰‹æ‰ä¼šçŠ¯çš„ã€‚ä½†æ˜¯ç¬”è€…åœ¨<a href="http://devblog.blackberry.com/2015/05/connecting-to-couchbase-with-pouchdb/" target="_blank" rel="noopener">é»‘è“çš„å¼€å‘è€…åšå®¢ä¸Š</a>æ›¾ç»çœ‹åˆ°ç±»ä¼¼çš„ä»£ç ã€‚è¿‡å»çš„ä¹¦å†™å›è°ƒå‡½æ•°çš„ä¹ æƒ¯æ˜¯å¾ˆéš¾æ”¹å˜çš„ã€‚</p><p>ä¸‹é¢ç»™å‡ºä¸€ç§ä»£ç é£æ ¼æ›´å¥½çš„å®ç°ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">remotedb.allDocs(...).then(<span class="function"><span class="keyword">function</span> (<span class="params">resultOfAllDocs</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> localdb.put(...);</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span> (<span class="params">resultOfPut</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> localdb.get(...);</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span> (<span class="params">resultOfGet</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> localdb.put(...);</span><br><span class="line">&#125;).catch(<span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(err);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è¿™å°±æ˜¯<code>promise</code>çš„é“¾å¼è°ƒç”¨ï¼Œå®ƒä½“ç°promiseçš„å¼ºå¤§ä¹‹å¤„ï¼Œæ¯ä¸ªå‡½æ•°åœ¨ä¸Šä¸€ä¸ªpromiseçš„çŠ¶æ€å˜ä¸ºresolvedçš„æ—¶å€™æ‰ä¼šè¢«è°ƒç”¨ï¼Œå¹¶ä¸”èƒ½å¤Ÿå¾—åˆ°ä¸Šä¸€ä¸ªpromiseçš„è¾“å‡ºç»“æœã€‚ç¨åè¿˜æœ‰è¯¦ç»†çš„è§£é‡Šã€‚</p><p>æ–°æ‰‹é”™è¯¯2ï¼šæ€æ ·ç”¨<code>forEach()</code>å¤„ç†<code>promise</code></p><p>è¿™ä¸ªé—®é¢˜æ˜¯å¤§å¤šæ•°äººæŒæ¡<code>promise</code>çš„æ‹¦è·¯è™ï¼Œå½“è¿™äº›äººæƒ³åœ¨ä»£ç ä¸­ä½¿ç”¨ä»–ä»¬ç†Ÿæ‚‰çš„<code>forEach()</code>æ–¹æ³•æˆ–è€…æ˜¯å†™ä¸€ä¸ª<code>for</code>å¾ªç¯ï¼Œäº¦æˆ–æ˜¯<code>while</code>å¾ªç¯çš„æ—¶å€™ï¼Œéƒ½ä¼šä¸ºå¦‚ä½•ä½¿ç”¨<code>promise</code>è€Œç–‘æƒ‘ä¸å·²ã€‚ä»–ä»¬ä¼šå†™ä¸‹è¿™æ ·çš„ä»£ç ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// I want to remove() all docs</span></span><br><span class="line">db.allDocs(&#123;<span class="attr">include_docs</span>: <span class="literal">true</span>&#125;).then(<span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span>&#123;</span><br><span class="line">  result.rows.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">row</span>) </span>&#123;</span><br><span class="line">    db.remove(row.doc);  </span><br><span class="line">  &#125;);</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// I naively believe all docs have been removed() now!</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è¿™æ®µä»£ç çš„é—®é¢˜åœ¨äºç¬¬ä¸€ä¸ªå›è°ƒå‡½æ•°å®é™…ä¸Šè¿”å›çš„æ˜¯<code>undefined</code>ï¼Œä¹Ÿå°±æ„å‘³ç€ç¬¬äºŒä¸ªå‡½æ•°å¹¶ä¸æ˜¯åœ¨æ‰€æœ‰çš„<code>db.remove()</code>æ‰§è¡Œç»“æŸä¹‹åæ‰æ‰§è¡Œã€‚äº‹å®ä¸Šï¼Œç¬¬äºŒä¸ªå‡½æ•°çš„æ‰§è¡Œä¸ä¼šæœ‰ä»»ä½•å»¶æ—¶ï¼Œå®ƒæ‰§è¡Œçš„æ—¶å€™è¢«åˆ é™¤çš„docæ•°é‡å¯èƒ½ä¸ºä»»æ„æ•´æ•°ã€‚  </p><p>è¿™æ®µä»£ç çœ‹èµ·æ¥æ˜¯èƒ½å¤Ÿæ­£å¸¸å·¥ä½œçš„ï¼Œå› æ­¤è¿™ä¸ªbugä¹Ÿå…·æœ‰ä¸€å®šçš„éšè—æ€§ã€‚å†™ä¸‹è¿™æ®µä»£ç çš„äººè®¾æƒ³PouchDBå·²ç»åˆ é™¤äº†è¿™äº›docsï¼Œå¯ä»¥æ›´æ–°UIäº†ã€‚è¿™ä¸ªbugä¼šåœ¨ä¸€å®šå‡ ç‡ä¸‹å‡ºç°ï¼Œæˆ–è€…æ˜¯ç‰¹å®šçš„æµè§ˆå™¨ã€‚è€Œä¸”ä¸€æ—¦å‡ºç°ï¼Œè¿™ç§bugæ˜¯å¾ˆéš¾è°ƒè¯•çš„ã€‚</p><p>æ€»ç»“èµ·æ¥è¯´ï¼Œå‡ºç°è¿™ä¸ªbugå¹¶ä¸æ˜¯<code>promise</code>çš„é”™ï¼Œè¿™ä¸ªé»‘é”…åº”è¯¥<code>forEach()/for/while</code>æ¥èƒŒã€‚è¿™æ—¶å€™ä½ éœ€è¦çš„æ˜¯<code>Promise.all()</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">db.allDocs(&#123;<span class="attr">include_docs</span>: <span class="literal">true</span>&#125;).then(<span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Promise</span>.all(result.rows.map(<span class="function"><span class="keyword">function</span> (<span class="params">row</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> db.remove(row.doc);</span><br><span class="line">  &#125;));</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span> (<span class="params">arrayOfResults</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// All docs have really been removed() now!</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="æ–°æ‰‹é”™è¯¯3ï¼šå¿˜è®°æ·»åŠ catch-æ–¹æ³•"><a href="#æ–°æ‰‹é”™è¯¯3ï¼šå¿˜è®°æ·»åŠ catch-æ–¹æ³•" class="headerlink" title="æ–°æ‰‹é”™è¯¯3ï¼šå¿˜è®°æ·»åŠ catch()æ–¹æ³•"></a>æ–°æ‰‹é”™è¯¯3ï¼šå¿˜è®°æ·»åŠ catch()æ–¹æ³•</h3><p>è¿™æ˜¯ä¸€ä¸ªå¾ˆå¸¸è§çš„é”™è¯¯ã€‚å¾ˆå¤šç¨‹åºå‘˜å¯¹ä»–ä»¬ä»£ç ä¸­çš„<code>promise</code>è°ƒç”¨ååˆ†è‡ªä¿¡ï¼Œè§‰å¾—ä»£ç æ°¸è¿œä¸ä¼šæŠ›å‡ºä¸€ä¸ª<code>error</code>ï¼Œä¹Ÿå¯èƒ½ä»–ä»¬åªæ˜¯ç®€å•çš„å¿˜äº†åŠ <code>catch()</code>æ–¹æ³•ã€‚ä¸å¹¸çš„æ˜¯ï¼Œä¸åŠ <code>catch()</code>æ–¹æ³•ä¼šè®©å›è°ƒå‡½æ•°ä¸­æŠ›å‡ºçš„å¼‚å¸¸è¢«åå™¬ï¼Œåœ¨ä½ çš„æ§åˆ¶å°æ˜¯çœ‹ä¸åˆ°ç›¸åº”çš„é”™è¯¯çš„ï¼Œè¿™å¯¹è°ƒè¯•æ¥è¯´æ˜¯éå¸¸ç—›è‹¦çš„ã€‚</p><p>ä¸ºäº†é¿å…è¿™ç§ç³Ÿç³•çš„æƒ…å†µï¼Œæˆ‘å·²ç»å…»æˆäº†åœ¨è‡ªå·±çš„<code>promise</code>è°ƒç”¨é“¾æœ€åæ·»åŠ å¦‚ä¸‹ä»£ç çš„ä¹ æƒ¯ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">somePromise().then(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> anotherPromise();</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> yetAnotherPromise();</span><br><span class="line">&#125;).catch(<span class="built_in">console</span>.log.bind(<span class="built_in">console</span>)); <span class="comment">// &lt;-- this is badass</span></span><br></pre></td></tr></table></figure><p>å³ä½¿ä½ å¹¶ä¸æ‰“ç®—åœ¨ä»£ç ä¸­å¤„ç†å¼‚å¸¸ï¼Œåœ¨ä»£ç ä¸­æ·»åŠ catch()ä¹Ÿæ˜¯ä¸€ä¸ªè°¨æ…çš„ç¼–ç¨‹é£æ ¼çš„ä½“ç°ã€‚åœ¨æŸç§æƒ…å†µä¸‹ä½ åŸå…ˆçš„å‡è®¾å‡ºé”™çš„æ—¶å€™ï¼Œè¿™ä¼šè®©ä½ çš„è°ƒè¯•å·¥ä½œè½»æ¾ä¸€äº›ã€‚</p><p>æ–°æ‰‹é”™è¯¯4ï¼šä½¿ç”¨<code>deferred</code></p><p>è¿™ç±»å‹é”™è¯¯ç¬”è€…ç»å¸¸çœ‹åˆ°ï¼Œåœ¨è¿™é‡Œæˆ‘ä¹Ÿä¸æƒ³é‡å¤å®ƒäº†ã€‚ç®€è€Œè¨€ä¹‹ï¼Œpromiseç»è¿‡äº†å¾ˆé•¿ä¸€æ®µæ—¶é—´çš„å‘å±•ï¼Œæœ‰ä¸€å®šçš„å†å²åŒ…è¢±ã€‚JavaScriptç¤¾åŒºç”¨äº†å¾ˆé•¿çš„æ—¶é—´æ‰çº æ­£äº†å‘å±•é“è·¯ä¸Šçš„ä¸€äº›é”™è¯¯ã€‚åœ¨æ—©äº›æ—¶å€™ï¼ŒjQueryå’ŒAngularéƒ½åœ¨ä½¿ç”¨â€™deferredâ€™ç±»å‹çš„promiseã€‚è€Œåœ¨æœ€æ–°çš„ES6çš„Promiseæ ‡å‡†ä¸­ï¼Œè¿™ç§å®ç°æ–¹å¼å·²ç»è¢«æ›¿ä»£äº†ï¼ŒåŒæ—¶ï¼Œä¸€äº›Promiseçš„åº“ï¼Œæ¯”å¦‚Qï¼Œbluebidï¼Œlieä¹Ÿæ˜¯å‚ç…§ES6çš„æ ‡å‡†æ¥å®ç°çš„ã€‚</p><p>å¦‚æœä½ è¿˜åœ¨ä»£ç ä¸­ä½¿ç”¨deferredçš„è¯ï¼Œé‚£ä¹ˆä½ å°±æ˜¯èµ°åœ¨é”™è¯¯çš„é“è·¯ä¸Šäº†ï¼Œè¿™é‡Œç¬”è€…ç»™å‡ºä¸€äº›ä¿®æ­£çš„åŠæ³•ã€‚</p><p>é¦–å…ˆï¼Œç»å¤§å¤šæ•°çš„åº“éƒ½ç»™å‡ºäº†å°†ç¬¬ä¸‰æ–¹åº“çš„æ–¹æ³•åŒ…è£…æˆpromiseå¯¹è±¡çš„æ–¹æ³•ã€‚<br>ä¸¾ä¾‹æ¥è¯´ï¼ŒAngularçš„(<code>q</code>æ¨¡å—å¯ä»¥ä½¿ç”¨)<code>q.when()</code>å®Œæˆè¿™ä¸€åŒ…è£…è¿‡ç¨‹ã€‚å› æ­¤ï¼Œåœ¨Angularä¸­ï¼ŒåŒ…è£…PouchDBçš„promise APIçš„ä»£ç å¦‚ä¸‹ï¼š<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$q.when(db.put(doc)).then(<span class="comment">/* ... */</span>); <span class="comment">// &lt;-- this is all the code you need</span></span><br></pre></td></tr></table></figure></p><p>å¦ä¸€ç§æ–¹æ³•å°±æ˜¯ä½¿ç”¨æš´éœ²ç»™ç¨‹åºå‘˜çš„æ„é€ å‡½æ•°ã€‚<code>promise</code>çš„æ„é€ å‡½æ•°èƒ½å¤ŸåŒ…è£…é‚£äº›é<code>promise</code>çš„APIã€‚<br>ä¸‹é¢ç»™å‡ºä¸€ä¸ªä¾‹å­ï¼Œåœ¨è¯¥ä¾‹ä¸­å°†node.jsæä¾›çš„fs.readFile()æ–¹æ³•åŒ…è£…æˆpromiseã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">  fs.readFile(<span class="string">'myfile.txt'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, file</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      <span class="keyword">return</span> reject(err);</span><br><span class="line">    &#125;</span><br><span class="line">    resolve(file);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;).then(<span class="comment">/* ... */</span>)</span><br></pre></td></tr></table></figure><blockquote><p>ä¸ºä»€ä¹ˆè¿™æ˜¯ä¸€ç§åæ¨¡å¼æ›´å¤šçš„ä¿¡æ¯å¯ä»¥æŸ¥çœ‹ï¼š <a href="https://github.com/petkaantonov/bluebird/wiki/Promise-anti-patterns#the-deferred-anti-pattern" target="_blank" rel="noopener">the Bluebird wiki page on promise anti-patterns</a>.</p></blockquote><h3 id="æ–°æ‰‹å¸¸è§é”™è¯¯ï¼ƒ5-ä½¿ç”¨å…¶å‰¯ä½œç”¨è€Œä¸æ˜¯return"><a href="#æ–°æ‰‹å¸¸è§é”™è¯¯ï¼ƒ5-ä½¿ç”¨å…¶å‰¯ä½œç”¨è€Œä¸æ˜¯return" class="headerlink" title="æ–°æ‰‹å¸¸è§é”™è¯¯ï¼ƒ5:ä½¿ç”¨å…¶å‰¯ä½œç”¨è€Œä¸æ˜¯return"></a>æ–°æ‰‹å¸¸è§é”™è¯¯ï¼ƒ5:ä½¿ç”¨å…¶å‰¯ä½œç”¨è€Œä¸æ˜¯return</h3><p>ä¸‹é¢çš„ä»£ç æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">somePromise().then(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  someOtherPromise();</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// Gee, I hope someOtherPromise() has resolved!</span></span><br><span class="line">  <span class="comment">// Spoiler alert: it hasn't.</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>Okï¼Œç°åœ¨æ˜¯æ—¶å€™è®¨è®ºæ‰€æœ‰éœ€è¦äº†è§£çš„å…³äº<code>promise</code>çš„çŸ¥è¯†ç‚¹äº†ã€‚ç†è§£äº†è¿™ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼Œç¬”è€…æåˆ°çš„ä¸€äº›é”™è¯¯ä½ éƒ½ä¸ä¼šçŠ¯äº†ã€‚</p><p>å°±åƒæˆ‘ä¹‹å‰è¯´è¿‡çš„ï¼Œpromiseçš„ç¥å¥‡ä¹‹å¤„åœ¨äºè®©æˆ‘ä»¬èƒ½å¤Ÿåœ¨å›è°ƒå‡½æ•°é‡Œé¢ä½¿ç”¨returnå’Œthrowã€‚ä½†æ˜¯å®è·µçš„æ—¶å€™æ˜¯ä»€ä¹ˆæ ·å­å‘¢ï¼Ÿ</p><p>æ¯ä¸€ä¸ªpromiseå¯¹è±¡éƒ½ä¼šæä¾›ä¸€ä¸ªthenæ–¹æ³•æˆ–è€…æ˜¯catchæ–¹æ³•</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">somePromise().then(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// I'm inside a then() function!</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬åœ¨è¿™é‡Œèƒ½åšä»€ä¹ˆå‘¢ï¼Ÿæœ‰ä¸‰ç§äº‹å¯ä»¥åšï¼š</p><ol><li>è¿”å›å¦ä¸€ä¸ªpromiseï¼›</li><li>è¿”å›ä¸€ä¸ªåŒæ­¥å€¼ï¼ˆæˆ–è€…undefined</li><li>æŠ›å‡ºä¸€ä¸ªåŒæ­¥é”™è¯¯ã€‚</li></ol><p>ç†è§£è¿™ä¸‰ç§æƒ…å†µä¹‹åï¼Œä½ å°±ä¼šç†è§£promiseäº†ã€‚</p><h3 id="1-è¿”å›å¦ä¸€ä¸ªpromiseå¯¹è±¡"><a href="#1-è¿”å›å¦ä¸€ä¸ªpromiseå¯¹è±¡" class="headerlink" title="1.è¿”å›å¦ä¸€ä¸ªpromiseå¯¹è±¡"></a>1.è¿”å›å¦ä¸€ä¸ªpromiseå¯¹è±¡</h3><p>åœ¨æœ‰å…³promiseçš„ç›¸å…³æ–‡ç« ä¸­ï¼Œè¿™ç§å†™æ³•å¾ˆå¸¸è§ï¼Œå°±åƒä¸Šæ–‡æåˆ°çš„æ„æˆpromiseé“¾çš„ä¸€æ®µä»£ç ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">getUserByName(<span class="string">'nolan'</span>).then(<span class="function"><span class="keyword">function</span> (<span class="params">user</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> getUserAccountById(user.id);</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span> (<span class="params">userAccount</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// I got a user account!</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è¿™æ®µä»£ç é‡Œé¢çš„returnéå¸¸å…³é”®ï¼Œæ²¡æœ‰è¿™ä¸ªreturnçš„è¯ï¼ŒgetUserAccountByIdåªæ˜¯ä¸€ä¸ªæ™®é€šçš„è¢«åˆ«çš„å‡½æ•°è°ƒç”¨çš„å‡½æ•°ã€‚ä¸‹ä¸€ä¸ªå›è°ƒå‡½æ•°ä¼šæ¥æ”¶åˆ°undefinedè€Œä¸æ˜¯userAccount</p><h3 id="2-è¿”å›ä¸€ä¸ªåŒæ­¥çš„å€¼æˆ–è€…æ˜¯undefined"><a href="#2-è¿”å›ä¸€ä¸ªåŒæ­¥çš„å€¼æˆ–è€…æ˜¯undefined" class="headerlink" title="2.è¿”å›ä¸€ä¸ªåŒæ­¥çš„å€¼æˆ–è€…æ˜¯undefined"></a>2.è¿”å›ä¸€ä¸ªåŒæ­¥çš„å€¼æˆ–è€…æ˜¯undefined</h3><p>è¿”å›ä¸€ä¸ªundefinedå¤§å¤šæ•°æƒ…å†µä¸‹æ˜¯é”™è¯¯çš„ï¼Œä½†æ˜¯è¿”å›ä¸€ä¸ªåŒæ­¥çš„å€¼ç¡®å®æ˜¯ä¸€ä¸ªå°†åŒæ­¥ä»£ç è½¬åŒ–æˆpromiseé£æ ¼ä»£ç çš„å¥½æ–¹æ³•ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œç°åœ¨åœ¨å†…å­˜ä¸­æœ‰usersã€‚æˆ‘ä»¬å¯ä»¥ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">getUserByName(<span class="string">'nolan'</span>).then(<span class="function"><span class="keyword">function</span> (<span class="params">user</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (inMemoryCache[user.id]) &#123;</span><br><span class="line">    <span class="keyword">return</span> inMemoryCache[user.id];    <span class="comment">// returning a synchronous value!</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> getUserAccountById(user.id); <span class="comment">// returning a promise!</span></span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span> (<span class="params">userAccount</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// I got a user account!</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒä¸ªå›è°ƒå‡½æ•°å¹¶ä¸å…³å¿ƒuserAccountæ˜¯é€šè¿‡åŒæ­¥çš„æ–¹å¼å¾—åˆ°çš„è¿˜æ˜¯å¼‚æ­¥çš„æ–¹å¼å¾—åˆ°çš„ï¼Œè€Œç¬¬ä¸€ä¸ªå›è°ƒå‡½æ•°å³å¯ä»¥è¿”å›åŒæ­¥çš„å€¼åˆå¯ä»¥è¿”å›å¼‚æ­¥çš„å€¼ã€‚<br>ä¸å¹¸çš„æ˜¯ï¼Œå¦‚æœä¸æ˜¾å¼è°ƒç”¨returnè¯­å¥çš„è¯ï¼ŒjavaScripté‡Œçš„å‡½æ•°ä¼šè¿”å›undefinedã€‚è¿™ä¹Ÿå°±æ„å‘³ç€åœ¨ä½ æƒ³è¿”å›ä¸€äº›å€¼çš„æ—¶å€™ï¼Œä¸æ˜¾å¼è°ƒç”¨returnä¼šäº§ç”Ÿä¸€äº›å‰¯ä½œç”¨ã€‚<br>å‡ºäºä¸Šè¿°åŸå› ï¼Œç¬”è€…å…»æˆäº†ä¸€ä¸ªä¸ªäººä¹ æƒ¯å°±æ˜¯åœ¨thenæ–¹æ³•å†…éƒ¨æ°¸è¿œæ˜¾å¼çš„è°ƒç”¨returnæˆ–è€…throwã€‚ç¬”è€…ä¹Ÿæ¨èä½ è¿™æ ·åšã€‚</p><h3 id="3-æŠ›å‡ºä¸€ä¸ªåŒæ­¥çš„é”™è¯¯"><a href="#3-æŠ›å‡ºä¸€ä¸ªåŒæ­¥çš„é”™è¯¯" class="headerlink" title="3.æŠ›å‡ºä¸€ä¸ªåŒæ­¥çš„é”™è¯¯"></a>3.æŠ›å‡ºä¸€ä¸ªåŒæ­¥çš„é”™è¯¯</h3><p>è¯´åˆ°throwï¼Œè¿™åˆä½“ç°äº†promiseçš„åŠŸèƒ½å¼ºå¤§ã€‚åœ¨ç”¨æˆ·é€€å‡ºçš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„ä»£ç ä¸­ä¼šé‡‡ç”¨æŠ›å‡ºå¼‚å¸¸çš„æ–¹å¼è¿›è¡Œå¤„ç†ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">getUserByName(<span class="string">'nolan'</span>).then(<span class="function"><span class="keyword">function</span> (<span class="params">user</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (user.isLoggedOut()) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'user logged out!'</span>); <span class="comment">// throwing a synchronous error!</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (inMemoryCache[user.id]) &#123;</span><br><span class="line">    <span class="keyword">return</span> inMemoryCache[user.id];       <span class="comment">// returning a synchronous value!</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> getUserAccountById(user.id);    <span class="comment">// returning a promise!</span></span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span> (<span class="params">userAccount</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// I got a user account!</span></span><br><span class="line">&#125;).catch(<span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// Boo, I got an error!</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>å¦‚æœç”¨æˆ·å·²ç»ç™»å‡ºçš„è¯ï¼Œcatch()ä¼šæ”¶åˆ°ä¸€ä¸ªåŒæ­¥çš„é”™è¯¯ï¼Œå¦‚æœæœ‰promiseå¯¹è±¡çš„çŠ¶æ€å˜ä¸ºrejectedçš„è¯ï¼Œå®ƒè¿˜ä¼šæ”¶åˆ°ä¸€ä¸ªå¼‚æ­¥çš„é”™è¯¯ã€‚catch()çš„å›è°ƒå‡½æ•°ä¸ç”¨å…³å¿ƒé”™è¯¯æ˜¯å¼‚æ­¥çš„è¿˜æ˜¯åŒæ­¥çš„ã€‚</p><p>åœ¨ä½¿ç”¨promiseçš„æ—¶å€™æŠ›å‡ºå¼‚å¸¸åœ¨å¼€å‘é˜¶æ®µå¾ˆæœ‰ç”¨ï¼Œå®ƒèƒ½å¸®åŠ©æˆ‘ä»¬å®šä½ä»£ç ä¸­çš„é”™è¯¯ã€‚æ¯”æ–¹è¯´ï¼Œåœ¨thenå‡½æ•°å†…éƒ¨è°ƒç”¨JSON.parseï¼ˆï¼‰ï¼Œå¦‚æœJSONå¯¹è±¡ä¸åˆæ³•çš„è¯ï¼Œå¯èƒ½ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œåœ¨å›è°ƒå‡½æ•°ä¸­ï¼Œè¿™ä¸ªå¼‚å¸¸ä¼šè¢«åå™¬ï¼Œä½†æ˜¯åœ¨ä½¿ç”¨promiseä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ•è·åˆ°è¿™ä¸ªå¼‚å¸¸äº†ã€‚</p><h2 id="è¿›é˜¶é”™è¯¯"><a href="#è¿›é˜¶é”™è¯¯" class="headerlink" title="è¿›é˜¶é”™è¯¯"></a>è¿›é˜¶é”™è¯¯</h2><p>æ¥ä¸‹æ¥æˆ‘ä»¬è®¨è®ºä¸€ä¸‹ä½¿ç”¨promiseçš„è¾¹ç•Œæƒ…å†µã€‚</p><p>ä¸‹é¢çš„é”™è¯¯ç¬”è€…å°†ä»–ä»¬å½’ç±»ä¸ºâ€œè¿›é˜¶é”™è¯¯â€ï¼Œå› ä¸ºè¿™äº›é”™è¯¯å‘ç”Ÿåœ¨é‚£äº›å·²ç»ç›¸å¯¹ç†Ÿç»ƒä½¿ç”¨promiseçš„ç¨‹åºå‘˜èº«ä¸Šã€‚ä½†æ˜¯ä¸ºäº†è§£å†³æœ¬æ–‡å¼€å¤´æå‡ºçš„é—®é¢˜ï¼Œè¿˜æ˜¯æœ‰å¿…è¦å¯¹å…¶è¿›è¡Œè®¨è®ºã€‚</p><h3 id="è¿›é˜¶é”™è¯¯1ï¼šä¸äº†è§£Promise-resolve"><a href="#è¿›é˜¶é”™è¯¯1ï¼šä¸äº†è§£Promise-resolve" class="headerlink" title="è¿›é˜¶é”™è¯¯1ï¼šä¸äº†è§£Promise.resolve()"></a>è¿›é˜¶é”™è¯¯1ï¼šä¸äº†è§£Promise.resolve()</h3><p>å°±åƒä¹‹å‰æ‰€è¯´çš„ï¼Œpromiseèƒ½å¤Ÿå°†åŒæ­¥ä»£ç åŒ…è£…æˆå¼‚æ­¥çš„å½¢å¼ã€‚ç„¶è€Œï¼Œå¦‚æœä½ ç»å¸¸å†™å‡ºå¦‚ä¸‹çš„ä»£ç ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">  resolve(someSynchronousValue);</span><br><span class="line">&#125;).then(<span class="comment">/* ... */</span>);</span><br></pre></td></tr></table></figure><p>ä½ å¯ä»¥ä½¿ç”¨Promise.resolve()å°†ä¸Šè¿°ä»£ç ç²¾ç®€ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Promise</span>.resolve(someSynchronousValue).then(<span class="comment">/* ... */</span>);</span><br></pre></td></tr></table></figure><p>åœ¨æ•è·åŒæ­¥å¼‚å¸¸çš„æ—¶å€™è¿™ä¸ªåšæ³•ä¹Ÿæ˜¯å¾ˆæœ‰æ•ˆçš„ã€‚æˆ‘åœ¨ç¼–å†™APIçš„æ—¶å€™å·²ç»å…»æˆäº†ä½¿ç”¨Promise.resolve()çš„ä¹ æƒ¯ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">somePromiseAPI</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve().then(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    doSomethingThatMayThrow();</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'foo'</span>;</span><br><span class="line">  &#125;).then(<span class="comment">/* ... */</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è®°ä½ï¼Œæœ‰å¯èƒ½æŠ›å‡ºé”™è¯¯çš„ä»£ç éƒ½æœ‰å¯èƒ½å› ä¸ºé”™è¯¯è¢«åå™¬è€Œå¯¹ä½ çš„å·¥ä½œé€ æˆå›°æ‰°ã€‚ä½†æ˜¯å¦‚æœä½ ç”¨Promise.resolve()åŒ…è£…äº†ä»£ç çš„è¯ï¼Œä½ æ°¸è¿œéƒ½å¯ä»¥åœ¨ä»£ç åé¢åŠ ä¸Šcatch()ã€‚</p><p>ç›¸åŒçš„ï¼Œä½¿ç”¨Promise.reject()å¯ä»¥ç«‹å³è¿”å›ä¸€ä¸ªçŠ¶æ€ä¸ºrejectedçš„promiseå¯¹è±¡ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Promise</span>.reject(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'some awful error'</span>));</span><br></pre></td></tr></table></figure><h3 id="è¿›é˜¶é”™è¯¯2ï¼šcacth-å’Œthen-null-â€¦-å¹¶ä¸å®Œå…¨ç›¸åŒ"><a href="#è¿›é˜¶é”™è¯¯2ï¼šcacth-å’Œthen-null-â€¦-å¹¶ä¸å®Œå…¨ç›¸åŒ" class="headerlink" title="è¿›é˜¶é”™è¯¯2ï¼šcacth()å’Œthen(null, â€¦)å¹¶ä¸å®Œå…¨ç›¸åŒ"></a>è¿›é˜¶é”™è¯¯2ï¼šcacth()å’Œthen(null, â€¦)å¹¶ä¸å®Œå…¨ç›¸åŒ</h3><p>ç¬”è€…æåˆ°è¿‡è¿‡cacth()æ˜¯then(null, â€¦)çš„è¯­æ³•ç³–ï¼Œå› æ­¤ä¸‹é¢ä¸¤ä¸ªä»£ç ç‰‡æ®µæ˜¯ç­‰ä»·çš„</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">somePromise().catch(<span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// handle error</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">somePromise().then(<span class="literal">null</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// handle error</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯ï¼Œè¿™å¹¶ä¸æ„å‘³ç€ä¸‹é¢çš„ä¸¤ä¸ªä»£ç ç‰‡æ®µæ˜¯ç­‰ä»·çš„</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">somePromise().then(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> someOtherPromise();</span><br><span class="line">&#125;).catch(<span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// handle error</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">somePromise().then(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> someOtherPromise();</span><br><span class="line">&#125;, <span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// handle error</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ ä¸ç†è§£çš„è¯ï¼Œé‚£ä¹ˆè¯·æ€è€ƒä¸€ä¸‹å¦‚æœç¬¬ä¸€ä¸ªå›è°ƒå‡½æ•°æŠ›å‡ºä¸€ä¸ªé”™è¯¯ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">somePromise().then(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'oh noes'</span>);</span><br><span class="line">&#125;).catch(<span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// I caught your error! :)</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">somePromise().then(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'oh noes'</span>);</span><br><span class="line">&#125;, <span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// I didn't catch your error! :(</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ç»“è®ºå°±æ˜¯ï¼Œå½“ä½¿ç”¨then(resolveHandler, rejectHandler)ï¼ŒrejectHandlerä¸ä¼šæ•è·åœ¨resolveHandlerä¸­æŠ›å‡ºçš„é”™è¯¯ã€‚</p><p>å› ä¸ºï¼Œç¬”è€…çš„ä¸ªäººä¹ æƒ¯æ˜¯ä»ä¸ä½¿ç”¨thenæ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œè½¬è€Œä½¿ç”¨catch()æ–¹æ³•ã€‚ä½†æ˜¯ä¹Ÿæœ‰ä¾‹å¤–ï¼Œå°±æ˜¯åœ¨ç¬”è€…å†™å¼‚æ­¥çš„Mochaçš„æµ‹è¯•ç”¨ä¾‹çš„æ—¶å€™ï¼Œå¦‚æœæƒ³ç¡®è®¤ä¸€ä¸ªé”™è¯¯è¢«æŠ›å‡ºçš„è¯ï¼Œä»£ç æ˜¯è¿™æ ·çš„ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">it(<span class="string">'should throw an error'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> doSomethingThatThrows().then(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'I expected an error!'</span>);</span><br><span class="line">  &#125;, <span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span><br><span class="line">    should.exist(err);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è¯´åˆ°æµ‹è¯•ï¼Œå°†<a href="http://mochajs.org/" target="_blank" rel="noopener">Mocha</a> å’Œ <a href="http://chaijs.com/" target="_blank" rel="noopener">Chai</a> è”åˆä½¿ç”¨æ˜¯ä¸€ç§å¾ˆå¥½çš„æµ‹è¯•promise APIçš„æ–¹æ¡ˆã€‚</p><p>. The <a href="https://github.com/pouchdb/plugin-seed" target="_blank" rel="noopener">pouchdb-plugin-seed</a> é¡¹ç›®æœ‰å¾ˆå¤šä½ <a href="https://github.com/pouchdb/plugin-seed/blob/master/test/test.js" target="_blank" rel="noopener">å¯ä»¥å…¥æ‰‹çš„ç®€å•çš„æµ‹è¯•ã€‚</a></p><h3 id="è¿›é˜¶é”™è¯¯3ï¼špromise-vs-promise-factories"><a href="#è¿›é˜¶é”™è¯¯3ï¼špromise-vs-promise-factories" class="headerlink" title="è¿›é˜¶é”™è¯¯3ï¼špromise vs promise factories"></a>è¿›é˜¶é”™è¯¯3ï¼špromise vs promise factories</h3><p>æŸäº›æƒ…å†µä¸‹ä½ æƒ³ä¸€ä¸ªæ¥ä¸€ä¸ªçš„æ‰§è¡Œä¸€ç³»åˆ—promiseï¼Œè¿™æ—¶å€™ä½ æƒ³è¦ä¸€ä¸ªç±»ä¼¼äºPromise.all()çš„æ–¹æ³•ï¼Œä½†æ˜¯Proimise.all()æ˜¯å¹¶è¡Œæ‰§è¡Œçš„ï¼Œä¸ç¬¦åˆè¦æ±‚ã€‚ä½ å¯èƒ½ä¸€æ—¶è„‘æŠ½å†™ä¸‹è¿™æ ·çš„ä»£ç </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">executeSequentially</span>(<span class="params">promises</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> result = <span class="built_in">Promise</span>.resolve();</span><br><span class="line">  promises.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">promise</span>) </span>&#123;</span><br><span class="line">    result = result.then(promise);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸å¹¸çš„æ˜¯ï¼Œè¿™æ®µä»£ç ä¸ä¼šæŒ‰ç…§ä½ æ‰€æƒ³çš„é‚£æ ·æ‰§è¡Œï¼Œé‚£äº›promiseå¯¹è±¡é‡Œçš„å¼‚æ­¥è°ƒç”¨è¿˜æ˜¯ä¼šå¹¶è¡Œçš„æ‰§è¡Œã€‚åŸå› æ˜¯ä½ æ ¹æœ¬ä¸åº”å½“åœ¨promiseå¯¹è±¡ç»„æˆçš„æ•°ç»„è¿™ä¸ªå±‚çº§ä¸Šæ“ä½œã€‚å¯¹äºæ¯ä¸ªpromiseå¯¹è±¡æ¥è¯´ï¼Œä¸€æ—¦å®ƒè¢«åˆ›å»ºï¼Œç›¸å…³çš„å¼‚æ­¥ä»£ç å°±å¼€å§‹æ‰§è¡Œäº†ã€‚å› æ­¤ï¼Œè¿™é‡Œä½ çœŸæ­£æƒ³è¦çš„æ˜¯ä¸€ä¸ªpromiseå·¥å‚ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">executeSequentially</span>(<span class="params">promiseFactories</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> result = <span class="built_in">Promise</span>.resolve();</span><br><span class="line">  promiseFactories.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">promiseFactory</span>) </span>&#123;</span><br><span class="line">    result = result.then(promiseFactory);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸€ä¸ªpromiseå·¥å‚éå¸¸ç®€å•ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªè¿”å›promiseå¯¹è±¡çš„å‡½æ•°</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myPromiseFactory</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> somethingThatCreatesAPromise();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸ºä»€ä¹ˆå¯ä»¥è¾¾åˆ°ç›®çš„å‘¢ï¼Ÿå› ä¸ºpromiseå·¥å‚åªæœ‰åœ¨è°ƒç”¨çš„æ—¶å€™æ‰ä¼šåˆ›å»ºpromiseå¯¹è±¡ã€‚å®ƒå’Œthen()æ–¹æ³•çš„å·¥ä½œæ–¹å¼å¾ˆåƒï¼Œäº‹å®ä¸Šï¼Œå®ƒä»¬å°±æ˜¯ä¸€æ ·çš„ä¸œè¥¿ã€‚</p><h3 id="è¿›é˜¶é”™è¯¯4ï¼šå¦‚æœæˆ‘æƒ³è¦ä¸¤ä¸ªpromiseçš„ç»“æœåº”å½“å¦‚ä½•åšå‘¢ï¼Ÿ"><a href="#è¿›é˜¶é”™è¯¯4ï¼šå¦‚æœæˆ‘æƒ³è¦ä¸¤ä¸ªpromiseçš„ç»“æœåº”å½“å¦‚ä½•åšå‘¢ï¼Ÿ" class="headerlink" title="è¿›é˜¶é”™è¯¯4ï¼šå¦‚æœæˆ‘æƒ³è¦ä¸¤ä¸ªpromiseçš„ç»“æœåº”å½“å¦‚ä½•åšå‘¢ï¼Ÿ"></a>è¿›é˜¶é”™è¯¯4ï¼šå¦‚æœæˆ‘æƒ³è¦ä¸¤ä¸ªpromiseçš„ç»“æœåº”å½“å¦‚ä½•åšå‘¢ï¼Ÿ</h3><p>å¾ˆå¤šæ—¶å€™ï¼Œä¸€ä¸ªpromiseçš„æ‰§è¡Œæ˜¯ä¾èµ–å¦ä¸€ä¸ªpromiseçš„ã€‚ä½†æ˜¯åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æƒ³å¾—åˆ°ä¸¤ä¸ªpromiseçš„æ‰§è¡Œç»“æœï¼Œæ¯”æ–¹è¯´ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">getUserByName(<span class="string">'nolan'</span>).then(<span class="function"><span class="keyword">function</span> (<span class="params">user</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> getUserAccountById(user.id);</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span> (<span class="params">userAccount</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// dangit, I need the "user" object too!</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ä¸ºäº†é¿å…äº§ç”Ÿå›è°ƒé‡‘å­—å¡”ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šåœ¨å¤–å±‚ä½œç”¨åŸŸå­˜å‚¨userå¯¹è±¡ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> user;</span><br><span class="line">getUserByName(<span class="string">'nolan'</span>).then(<span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span>&#123;</span><br><span class="line">  user = result;</span><br><span class="line">  <span class="keyword">return</span> getUserAccountById(user.id);</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span> (<span class="params">userAccount</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// okay, I have both the "user" and the "userAccount"</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä»£ç èƒ½å¤Ÿåˆ°è¾¾æƒ³è¦çš„æ•ˆæœï¼Œä½†æ˜¯è¿™ç§å®ç°æœ‰ä¸€ç‚¹ä¸æ­£å¼çš„æˆåˆ†åœ¨é‡Œé¢ï¼Œæˆ‘çš„å»ºè®®æ˜¯ï¼Œè¿™æ—¶å€™éœ€è¦æŠ›å¼€æˆè§ï¼Œæ‹¥æŠ±å›è°ƒé‡‘å­—å¡”ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">getUserByName(<span class="string">'nolan'</span>).then(<span class="function"><span class="keyword">function</span> (<span class="params">user</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> getUserAccountById(user.id).then(<span class="function"><span class="keyword">function</span> (<span class="params">userAccount</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// okay, I have both the "user" and the "userAccount"</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è‡³å°‘ï¼Œæ˜¯æš‚æ—¶æ‹¥æŠ±å›è°ƒé‡‘å­—å¡”ã€‚å¦‚æœç¼©è¿›çœŸçš„æˆä¸ºäº†ä½ ä»£ç ä¸­çš„ä¸€ä¸ªå¤§é—®é¢˜ï¼Œé‚£ä¹ˆä½ å¯ä»¥åƒæ¯ä¸€ä¸ªJavaScriptç¨‹åºå‘˜ä»å¼€å§‹å†™ä»£ç èµ·å°±è¢«æ•™å¯¼çš„ä¸€æ ·ï¼Œå°†å…¶ä¸­çš„éƒ¨åˆ†æŠ½å‡ºæ¥ä½œä¸ºä¸€ä¸ªå•ç‹¬çš„å‡½æ•°ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">onGetUserAndUserAccount</span>(<span class="params">user, userAccount</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> doSomething(user, userAccount);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">onGetUser</span>(<span class="params">user</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> getUserAccountById(user.id).then(<span class="function"><span class="keyword">function</span> (<span class="params">userAccount</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> onGetUserAndUserAccount(user, userAccount);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">getUserByName(<span class="string">'nolan'</span>)</span><br><span class="line">  .then(onGetUser)</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// at this point, doSomething() is done, and we are back to indentation 0</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>éšç€ä½ çš„promiseä»£ç è¶Šæ¥è¶Šå¤æ‚ï¼Œä½ ä¼šå°†è¶Šæ¥è¶Šå¤šçš„ä»£ç ä½œä¸ºå‡½æ•°æŠ½ç¦»å‡ºæ¥ã€‚ç¬”è€…å‘ç°è¿™ä¼šä¿ƒè¿›ä»£ç é£æ ¼å˜å¾—ä¼˜ç¾ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">putYourRightFootIn()</span><br><span class="line">  .then(putYourRightFootOut)</span><br><span class="line">  .then(putYourRightFootIn)  </span><br><span class="line">  .then(shakeItAllAbout);</span><br></pre></td></tr></table></figure><p>Thatâ€™s what promises are all about.</p><p>è¿™å°±æ˜¯promiseçš„æœ€ç»ˆç›®çš„ã€‚</p><h3 id="è¿›é˜¶é”™è¯¯5ï¼špromiseå è½ç°è±¡"><a href="#è¿›é˜¶é”™è¯¯5ï¼špromiseå è½ç°è±¡" class="headerlink" title="è¿›é˜¶é”™è¯¯5ï¼špromiseå è½ç°è±¡"></a>è¿›é˜¶é”™è¯¯5ï¼špromiseå è½ç°è±¡</h3><p>è¿™ä¸ªé”™è¯¯æˆ‘åœ¨å‰æ–‡ä¸­æåˆ°çš„é—®é¢˜ä¸­é—´æ¥çš„ç»™å‡ºäº†ã€‚è¿™ä¸ªæƒ…å†µæ¯”è¾ƒæ·±å¥¥ï¼Œæˆ–è®¸ä½ æ°¸è¿œå†™ä¸å‡ºè¿™æ ·çš„ä»£ç ï¼Œä½†æ˜¯è¿™ç§å†™æ³•è¿˜æ˜¯è®©ç¬”è€…æ„Ÿåˆ°éœ‡æƒŠã€‚ ä½ è®¤ä¸ºä¸‹é¢çš„ä»£ç ä¼šè¾“å‡ºä»€ä¹ˆï¼Ÿ</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Promise</span>.resolve(<span class="string">'foo'</span>).then(<span class="built_in">Promise</span>.resolve(<span class="string">'bar'</span>)).then(<span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(result);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ è®¤ä¸ºè¾“å‡ºçš„æ˜¯barï¼Œé‚£ä¹ˆä½ å°±é”™äº†ã€‚å®é™…ä¸Šå®ƒè¾“å‡ºçš„æ˜¯fooï¼</p><p>äº§ç”Ÿè¿™æ ·çš„è¾“å‡ºæ˜¯å› ä¸ºä½ ç»™thenæ–¹æ³•ä¼ é€’äº†ä¸€ä¸ªéå‡½æ•°ï¼ˆæ¯”å¦‚promiseå¯¹è±¡ï¼‰çš„å€¼ï¼Œä»£ç ä¼šè¿™æ ·ç†è§£ï¼šthen(null)ï¼Œå› æ­¤å¯¼è‡´å‰ä¸€ä¸ªpromiseçš„ç»“æœäº§ç”Ÿäº†å è½çš„æ•ˆæœã€‚ä½ å¯ä»¥è‡ªå·±æµ‹è¯•ä¸€ä¸‹ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Promise</span>.resolve(<span class="string">'foo'</span>).then(<span class="literal">null</span>).then(<span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(result);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è®©æˆ‘ä»¬å›åˆ°ä¹‹å‰è®²è§£promise vs promise factoriesdeçš„åœ°æ–¹ã€‚ç®€è€Œè¨€ä¹‹ï¼Œå¦‚æœä½ ç›´æ¥ç»™thenæ–¹æ³•ä¼ é€’ä¸€ä¸ªpromiseå¯¹è±¡ï¼Œä»£ç çš„è¿è¡Œæ˜¯å’Œä½ æ‰€æƒ³çš„ä¸ä¸€æ ·çš„ã€‚thenæ–¹æ³•åº”å½“æ¥å—ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ã€‚å› æ­¤ä½ åº”å½“è¿™æ ·ä¹¦å†™ä»£ç ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Promise</span>.resolve(<span class="string">'foo'</span>).then(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve(<span class="string">'bar'</span>);</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(result);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è¿™æ¬¡ä¼šå¦‚æˆ‘ä»¬é¢„æœŸçš„é‚£æ ·è¿”å›barã€‚</p><p>æ‰€ä»¥è¦æé†’ä½ è‡ªå·±ï¼šæ°¸è¿œç»™then()ä¼ é€’ä¸€ä¸ªå‡½æ•°å‚æ•°ã€‚</p><h2 id="è§£å†³ç–‘æƒ‘"><a href="#è§£å†³ç–‘æƒ‘" class="headerlink" title="è§£å†³ç–‘æƒ‘"></a>è§£å†³ç–‘æƒ‘</h2><p>ç°åœ¨æˆ‘ä»¬å·²ç»å­¦ä¹ äº†å…³äºpromisesè¦çŸ¥é“çš„æ‰€æœ‰çš„ä¸œè¥¿ï¼ˆæˆ–è€…æ¥è¿‘äºæ­¤ï¼‰ï¼Œæˆ‘ä»¬åº”è¯¥èƒ½å¤Ÿè§£å†³æˆ‘åœ¨è¿™ç¯‡æ–‡ç« å¼€å§‹æ—¶æå‡ºçš„ç–‘æƒ‘äº†ã€‚</p><p>ä¸‹é¢ç»™å‡ºå‰æ–‡é¢˜ç›®çš„è§£ç­”</p><h3 id="Puzzleï¼ƒ1"><a href="#Puzzleï¼ƒ1" class="headerlink" title="Puzzleï¼ƒ1:"></a>Puzzleï¼ƒ1:</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">doSomething().then(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> doSomethingElse();</span><br><span class="line">&#125;).then(finalHandler);</span><br></pre></td></tr></table></figure><p>Answer:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">doSomething</span><br><span class="line">|-----------------|</span><br><span class="line">                  doSomethingElse(<span class="literal">undefined</span>)</span><br><span class="line">                  |------------------|</span><br><span class="line">                                     finalHandler(resultOfDoSomethingElse)</span><br><span class="line">                                     |------------------|</span><br></pre></td></tr></table></figure><h3 id="Puzzle-2"><a href="#Puzzle-2" class="headerlink" title="Puzzle #2"></a>Puzzle #2</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">doSomething().then(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  doSomethingElse();</span><br><span class="line">&#125;).then(finalHandler);</span><br></pre></td></tr></table></figure><p>Answer:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">doSomething</span><br><span class="line">|-----------------|</span><br><span class="line">                  doSomethingElse(<span class="literal">undefined</span>)</span><br><span class="line">                  |------------------|</span><br><span class="line">                  finalHandler(<span class="literal">undefined</span>)</span><br><span class="line">                  |------------------|</span><br></pre></td></tr></table></figure><h3 id="Puzzle-3"><a href="#Puzzle-3" class="headerlink" title="Puzzle #3"></a>Puzzle #3</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">doSomething().then(doSomethingElse())</span><br><span class="line">  .then(finalHandler);</span><br></pre></td></tr></table></figure><p>Answer:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">doSomething</span><br><span class="line">|-----------------|</span><br><span class="line">doSomethingElse(<span class="literal">undefined</span>)</span><br><span class="line">|---------------------------------|</span><br><span class="line">                  finalHandler(resultOfDoSomething)</span><br><span class="line">                  |------------------|</span><br></pre></td></tr></table></figure><h3 id="Puzzle-4"><a href="#Puzzle-4" class="headerlink" title="Puzzle #4"></a>Puzzle #4</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">doSomething().then(doSomethingElse)</span><br><span class="line">  .then(finalHandler);</span><br></pre></td></tr></table></figure><p>Answer:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">doSomething</span><br><span class="line">|-----------------|</span><br><span class="line">                  doSomethingElse(resultOfDoSomething)</span><br><span class="line">                  |------------------|</span><br><span class="line">                                     finalHandler(resultOfDoSomethingElse)</span><br><span class="line">                                     |------------------|</span><br></pre></td></tr></table></figure><p>å¦‚æœè¿™äº›ç­”æ¡ˆä»ç„¶æ²¡æœ‰è®²é€šï¼Œé‚£ä¹ˆæˆ‘é¼“åŠ±é‡æ–°é˜…è¯»æ–‡ç« ï¼Œæˆ–è€…å»å®šä¹‰doSomething()ä»¥åŠdoSomethingElse()ç„¶ååœ¨ä½ çš„æµè§ˆå™¨ä¸­è‡ªå·±å°è¯•ã€‚</p><p>éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œåœ¨ä¸Šè¿°çš„ä¾‹å­ä¸­ï¼Œæˆ‘éƒ½å‡è®¾doSomething()å’ŒdoSomethingElse()è¿”å›ä¸€ä¸ªpromiseå¯¹è±¡ï¼Œè¿™äº›promiseå¯¹è±¡éƒ½ä»£è¡¨äº†ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼Œè¿™æ ·çš„æ“ä½œä¼šåœ¨å½“å‰event loopä¹‹å¤–ç»“æŸï¼Œæ¯”å¦‚è¯´æœ‰å…³IndexedDBï¼Œnetworkçš„æ“ä½œï¼Œæˆ–è€…æ˜¯ä½¿ç”¨setTimeoutã€‚è¿™é‡Œç»™å‡º<a href="http://jsbin.com/tuqukakawo/1/edit?js,console,output" target="_blank" rel="noopener">JSBinä¸Šçš„ç¤ºä¾‹</a>ã€‚</p><p>Promisesæ›´å¤šçš„ä½¿ç”¨è¯´æ˜ï¼Œè¯·å‚è€ƒæˆ‘çš„promiseä¸»è¦ç”¨æ³•èƒŒå¿˜å•ã€‚ <a href="https://gist.github.com/nolanlawson/6ce81186421d2fa109a4" target="_blank" rel="noopener">promise protips cheat sheet</a>.</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Promise.all is good for executing many promises at once</span></span><br><span class="line"><span class="built_in">Promise</span>.all([</span><br><span class="line">  promise1,</span><br><span class="line">  promise2</span><br><span class="line">]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Promise.resolve is good for wrapping synchronous code</span></span><br><span class="line"><span class="built_in">Promise</span>.resolve().then(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (somethingIsNotRight()) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"I will be rejected asynchronously!"</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"This string will be resolved asynchronously!"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// execute some promises one after the other.</span></span><br><span class="line"><span class="comment">// this takes an array of promise factories, i.e.</span></span><br><span class="line"><span class="comment">// an array of functions that RETURN a promise</span></span><br><span class="line"><span class="comment">// (not an array of promises themselves; those would execute immediately)</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sequentialize</span>(<span class="params">promiseFactories</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> chain = <span class="built_in">Promise</span>.resolve();</span><br><span class="line">  promiseFactories.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">promiseFactory</span>) </span>&#123;</span><br><span class="line">    chain = chain.then(promiseFactory);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> chain;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Promise.race is good for setting a timeout:</span></span><br><span class="line"><span class="built_in">Promise</span>.race([</span><br><span class="line">  <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    setTimeout(reject, <span class="number">10000</span>); <span class="comment">// timeout after 10 secs</span></span><br><span class="line">  &#125;),</span><br><span class="line">  doSomethingThatMayTakeAwhile()</span><br><span class="line">]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Promise finally util similar to Q.finally</span></span><br><span class="line"><span class="comment">// e.g. promise.then(...).catch().then(...).finally(...)</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">finally</span> (<span class="params">promise, cb</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> promise.then(<span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> promise2 = cb();</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> promise2.then === <span class="string">'function'</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> promise2.then(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">  &#125;, <span class="function"><span class="keyword">function</span> (<span class="params">reason</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> promise2 = cb();</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> promise2.then === <span class="string">'function'</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> promise2.then(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> reason;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">throw</span> reason;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="æœ€åå†è¯´ä¸¤å¥"><a href="#æœ€åå†è¯´ä¸¤å¥" class="headerlink" title="æœ€åå†è¯´ä¸¤å¥"></a>æœ€åå†è¯´ä¸¤å¥</h2><p>promiseæ˜¯ä¸ªå¥½ä¸œè¥¿ã€‚å¦‚æœä½ è¿˜åœ¨ä½¿ç”¨ä¼ ç»Ÿçš„å›è°ƒå‡½æ•°çš„è¯ï¼Œæˆ‘å»ºè®®ä½ è¿ç§»åˆ°promiseä¸Šã€‚è¿™æ ·ä½ çš„ä»£ç ä¼šæ›´ç®€ä»‹ï¼Œæ›´ä¼˜é›…ï¼Œå¯è¯»æ€§ä¹Ÿæ›´å¼ºã€‚</p><p>æœ‰è¿™æ ·çš„è§‚ç‚¹ï¼špromiseæ˜¯ä¸å®Œç¾çš„ã€‚promiseç¡®å®æ¯”ä½¿ç”¨å›è°ƒå‡½æ•°å¥½ï¼Œä½†æ˜¯ï¼Œå¦‚æœä½ æœ‰åˆ«çš„é€‰æ‹©çš„è¯ï¼Œè¿™ä¸¤ç§æ–¹å¼æœ€å¥½éƒ½ä¸è¦ç”¨ã€‚</p><p>å°½ç®¡ç›¸æ¯”å›è°ƒå‡½æ•°æœ‰è®¸å¤šä¼˜ç‚¹ï¼Œpromiseä»ç„¶æ˜¯éš¾äºç†è§£çš„ï¼Œå¹¶ä¸”ä½¿ç”¨èµ·æ¥å¾ˆå®¹æ˜“å‡ºé”™ã€‚æ–°æ‰‹å’Œè€é¸Ÿéƒ½ä¼šç»å¸¸å°†promiseç”¨çš„ä¹±ä¸ƒå…«ç³Ÿã€‚ä¸è¿‡è¯´çœŸçš„ï¼Œè¿™ä¸æ˜¯ä»–ä»¬çš„é”™ï¼Œåº”è¯¥ç”©é”…ç»™promiseã€‚å› ä¸ºå®ƒå’Œæˆ‘ä»¬åœ¨åŒæ­¥ç¯å¢ƒçš„ä»£ç å¾ˆåƒï¼Œä½†ä»…ä»…æ˜¯åƒï¼Œæ˜¯ä¸€ä¸ªä¼˜é›…çš„æ›¿ä»£å“ã€‚</p><p>åœ¨åŒæ­¥ç¯å¢ƒä¸‹ï¼Œä½ æ— éœ€å­¦ä¹ è¿™äº›ä»¤äººè´¹è§£çš„è§„åˆ™å’Œä¸€äº›æ–°çš„APIã€‚ä½ å¯ä»¥éšæ„ä½¿ç”¨åƒreturnï¼Œcatchï¼Œthrowè¿™æ ·çš„å…³é”®å­—ä»¥åŠforå¾ªç¯ã€‚ä½ ä¸éœ€è¦æ—¶åˆ»åœ¨è„‘ä¸­ä¿æŒä¸¤ä¸ªç›¸å¹¶åˆ—çš„ç¼–ç¨‹æ€æƒ³ã€‚</p><p>ç­‰å¾…async/await</p><p>ç¬”è€…åœ¨äº†è§£äº†ES7ä¸­çš„asyncå’Œawaitå…³é”®å­—ï¼Œä»¥åŠå®ƒä»¬æ˜¯å¦‚ä½•å°†promiseçš„æ€æƒ³èå…¥åˆ°è¯­è¨€æœ¬èº«å½“ä¸­ä¹‹åï¼Œå†™äº†è¿™æ ·ä¸€ç¯‡åšæ–‡ç”¨ES7é©¯æœå¼‚æ­¥è¿™ä¸ªçŒ›å…½ã€‚ä½¿ç”¨ES7ï¼Œæˆ‘ä»¬å°†æ²¡æœ‰å¿…è¦å†å†™catch()è¿™æ ·çš„ä¼ªåŒæ­¥çš„ä»£ç ï¼Œæˆ‘ä»¬å°†èƒ½ä½¿ç”¨try/catch/returnè¿™æ ·çš„å…³é”®å­—ï¼Œå°±åƒåˆšå¼€å§‹å­¦è®¡ç®—æœºé‚£æ ·ã€‚</p><p>è¿™å¯¹JavaScriptè¿™é—¨è¯­è¨€æ¥è¯´æ˜¯å¾ˆå¥½çš„ï¼Œå› ä¸ºåˆ°å¤´æ¥ï¼Œåªè¦æ²¡æœ‰å·¥å…·æé†’æˆ‘ä»¬ï¼Œè¿™äº›promiseçš„åæ¨¡å¼ä¼šæŒç»­å‡ºç°ã€‚</p><p>ä»JavaScriptå‘å±•å†å²ä¸­è·ç¦»æ¥è¯´ï¼Œç¬”è€…è®¤ä¸ºJSLintå’ŒJSHintå¯¹ç¤¾åŒºçš„è´¡çŒ®è¦å¤§äºJavaScript:The Good Partsï¼Œå°½ç®¡å®ƒä»¬å®é™…ä¸ŠåŒ…å«çš„ä¿¡æ¯æ˜¯ç›¸åŒçš„ã€‚åŒºåˆ«å°±åœ¨äºä½¿ç”¨å·¥å…·å¯ä»¥å‘Šè¯‰ç¨‹åºå‘˜ä»£ç ä¸­æ‰€çŠ¯çš„é”™è¯¯ï¼Œè€Œé˜…è¯»å´æ˜¯è®©ä½ äº†è§£åˆ«äººçŠ¯çš„é”™è¯¯ã€‚</p><p>ES7ä¸­çš„asyncå’Œawaitå…³é”®å­—çš„ç¾å¦™ä¹‹å¤„åœ¨äºï¼Œä½ ä»£ç ä¸­çš„é”™è¯¯å°†ä¼šæˆä¸ºè¯­æ³•é”™è¯¯æˆ–è€…æ˜¯ç¼–è¯‘é”™è¯¯ï¼Œè€Œä¸æ˜¯ç»†å¾®çš„è¿è¡Œæ—¶é”™è¯¯ã€‚åˆ°äº†é‚£æ—¶ï¼Œæˆ‘ä»¬ä¼šå®Œå…¨æŒæ¡promiseç©¶ç«Ÿèƒ½åšä»€ä¹ˆï¼Œä»¥åŠåœ¨ES5å’ŒES6ä¸­å¦‚ä½•åˆç†çš„åº”ç”¨ã€‚</p><p>æ›´æ–°ï¼šå·²ç»æœ‰äººè·Ÿæˆ‘æŒ‡å‡ºBluebird 3.0èƒ½æ‰“å°å‡ºè­¦å‘Šæ¥é¿å…æˆ‘åœ¨è¿™ç¯‡æ–‡ç« ä¸­æ‰€é‰´å®šçš„ä¸€äº›é”™è¯¯ã€‚æ‰€ä»¥åœ¨æˆ‘ä»¬è¿˜åœ¨ç­‰å¾…ES7çš„æ—¶å€™ä½¿ç”¨Bluebirdæ˜¯å¦ä¸€ä¸ªå¾ˆæ£’çš„é€‰æ‹©ã€‚</p><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><ul><li><a href="http://pouchdb.com/2015/05/18/we-have-a-problem-with-promises.html" target="_blank" rel="noopener">(è‹±æ–‡åŸæ–‡)we-have-a-problem-with-promises</a></li><li><a href="http://web.jobbole.com/82601/" target="_blank" rel="noopener">(ä¸­æ–‡ç¿»è¯‘)promises å¾ˆé…·ï¼Œä½†å¾ˆå¤šäººå¹¶æ²¡æœ‰ç†è§£å°±åœ¨ç”¨äº†</a></li><li><a href="http://web.jobbole.com/82950/" target="_blank" rel="noopener">(ä¸­æ–‡ç¿»è¯‘)è°ˆè°ˆä½¿ç”¨promiseæ—¶å€™çš„ä¸€äº›åæ¨¡å¼</a></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
            <tag> promise </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>gitæ–‡ä»¶åå¤§å°å†™æ•æ„Ÿ</title>
      <link href="/2015/09/20/git%E6%96%87%E4%BB%B6%E5%90%8D%E5%A4%A7%E5%B0%8F%E5%86%99%E6%95%8F%E6%84%9F/"/>
      <url>/2015/09/20/git%E6%96%87%E4%BB%B6%E5%90%8D%E5%A4%A7%E5%B0%8F%E5%86%99%E6%95%8F%E6%84%9F/</url>
      
        <content type="html"><![CDATA[<p>å› ä¸ºgitæ–‡ä»¶åå¤§å°å†™äº§ç”Ÿçš„é—®é¢˜åŠè®¾ç½®<br><a id="more"></a></p><h2 id="gité»˜è®¤"><a href="#gité»˜è®¤" class="headerlink" title="gité»˜è®¤"></a>gité»˜è®¤</h2><p>gité»˜è®¤æ˜¯ä¸åŒºåˆ†æ–‡ä»¶åçš„å¤§å°å†™,å³:<br>ç¬¬ä¸€æ¬¡æ–‡ä»¶åä¸º A.js,<br>ä¿®æ”¹æ–‡ä»¶åä¸º  a.js<br>gité»˜è®¤ä¸ºæœªä¿®æ”¹æ–‡ä»¶</p><h2 id="é…ç½®gitè¯†åˆ«å¤§å°å†™"><a href="#é…ç½®gitè¯†åˆ«å¤§å°å†™" class="headerlink" title="é…ç½®gitè¯†åˆ«å¤§å°å†™"></a>é…ç½®gitè¯†åˆ«å¤§å°å†™</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config core.ignorecase false</span><br></pre></td></tr></table></figure><h2 id="æ³¨æ„é—®é¢˜"><a href="#æ³¨æ„é—®é¢˜" class="headerlink" title="æ³¨æ„é—®é¢˜"></a>æ³¨æ„é—®é¢˜</h2><p>åœ¨ä¸Šé¢è®¾ç½®å¹¶commitæ–‡ä»¶ä¹‹å, ä½¿ç”¨ <code>git rebase -i HEAD~2</code>ä¼šæç¤º<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">the following untracked working tree files would be overwritten by checkout:</span><br></pre></td></tr></table></figure></p><p>è§£å†³åŠæ³•:</p><ul><li>é‡æ–°è®¾ç½®å¤§å°å†™<strong>ä¸</strong>æ•æ„Ÿ,</li><li>å†æ¬¡æ‰§è¡Œ<code>git rebase -i HEAD~2</code></li><li>è®¾ç½®å¤§å°å†™æ•æ„Ÿ</li></ul><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><ul><li><a href="http://yijiebuyi.com/blog/e96eccc4e6f7168e0ce92fa9c79f0d23.html" target="_blank" rel="noopener">http://yijiebuyi.com/blog/e96eccc4e6f7168e0ce92fa9c79f0d23.html</a></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>nodeå‘½ä»¤è¡Œå’Œæ§åˆ¶å°å‚æ•°è·å–</title>
      <link href="/2015/09/19/node%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%92%8C%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%8F%82%E6%95%B0%E8%8E%B7%E5%8F%96/"/>
      <url>/2015/09/19/node%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%92%8C%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%8F%82%E6%95%B0%E8%8E%B7%E5%8F%96/</url>
      
        <content type="html"><![CDATA[<p>nodeå‘½ä»¤è¡Œå’Œæ§åˆ¶å°å‚æ•°è·å–ç¬”è®°<br><a id="more"></a></p><h2 id="å‘½ä»¤è¡Œå‚æ•°çš„åŸå§‹å†™æ³•"><a href="#å‘½ä»¤è¡Œå‚æ•°çš„åŸå§‹å†™æ³•" class="headerlink" title="å‘½ä»¤è¡Œå‚æ•°çš„åŸå§‹å†™æ³•"></a>å‘½ä»¤è¡Œå‚æ•°çš„åŸå§‹å†™æ³•</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="built_in">arguments</span> = process.argv.splice(<span class="number">2</span>);</span><br></pre></td></tr></table></figure><blockquote><p>processæ˜¯ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œargvè¿”å›çš„æ˜¯ä¸€ç»„åŒ…å«å‘½ä»¤è¡Œå‚æ•°çš„æ•°ç»„ã€‚ç¬¬ä¸€é¡¹ä¸ºâ€™nodeâ€™ï¼Œç¬¬äºŒé¡¹ä¸ºæ‰§è¡Œçš„jsçš„å®Œæ•´è·¯å¾„ï¼Œåé¢æ˜¯é™„åŠ åœ¨å‘½ä»¤è¡Œåçš„å‚æ•°</p></blockquote><h2 id="yargs-æ¨¡å—"><a href="#yargs-æ¨¡å—" class="headerlink" title="yargs æ¨¡å—"></a>yargs æ¨¡å—</h2><p><a href="https://github.com/bcoe/yargs" target="_blank" rel="noopener">https://github.com/bcoe/yargs</a></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> argv = <span class="built_in">require</span>(<span class="string">'yargs'</span>)</span><br><span class="line">  .option(<span class="string">'n'</span>, &#123;</span><br><span class="line">    alias : <span class="string">'name'</span>,</span><br><span class="line">    demand: <span class="literal">true</span>,</span><br><span class="line">    <span class="keyword">default</span>: <span class="string">'tom'</span>,</span><br><span class="line">    describe: <span class="string">'your name'</span>,</span><br><span class="line">    type: <span class="string">'string'</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .argv;</span><br><span class="line"><span class="built_in">console</span>.log(argv.n);</span><br></pre></td></tr></table></figure><h2 id="commander-js-æ¨¡å—"><a href="#commander-js-æ¨¡å—" class="headerlink" title="commander.js æ¨¡å—"></a>commander.js æ¨¡å—</h2><p><a href="https://github.com/tj/commander.js" target="_blank" rel="noopener">https://github.com/tj/commander.js</a></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> program = <span class="built_in">require</span>(<span class="string">'commander'</span>);</span><br><span class="line"></span><br><span class="line">program</span><br><span class="line">  .version(<span class="string">'0.0.1'</span>)</span><br><span class="line">  .option(<span class="string">'-p, --peppers'</span>, <span class="string">'Add peppers'</span>)</span><br><span class="line">  .option(<span class="string">'-P, --pineapple'</span>, <span class="string">'Add pineapple'</span>)</span><br><span class="line">  .option(<span class="string">'-b, --bbq-sauce'</span>, <span class="string">'Add bbq sauce'</span>)</span><br><span class="line">  .option(<span class="string">'-c, --cheese [type]'</span>, <span class="string">'Add the specified type of cheese [marble]'</span>, <span class="string">'marble'</span>)</span><br><span class="line">  .parse(process.argv);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'you ordered a pizza with:'</span>);</span><br><span class="line"><span class="keyword">if</span> (program.peppers) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'  - peppers'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (program.pineapple) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'  - pineapple'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (program.bbqSauce) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'  - bbq'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'  - %s cheese'</span>, program.cheese);</span><br></pre></td></tr></table></figure><h2 id="æ§åˆ¶å°è¾“å…¥"><a href="#æ§åˆ¶å°è¾“å…¥" class="headerlink" title="æ§åˆ¶å°è¾“å…¥"></a>æ§åˆ¶å°è¾“å…¥</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">process.stdin.setEncoding(<span class="string">'utf8'</span>);</span><br><span class="line"></span><br><span class="line">process.stdin.on(<span class="string">'readable'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> chunk = process.stdin.read();</span><br><span class="line">  <span class="keyword">if</span> (chunk !== <span class="literal">null</span>) &#123;</span><br><span class="line">    process.stdout.write(<span class="string">'data: '</span> + chunk);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">process.stdin.on(<span class="string">'end'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  process.stdout.write(<span class="string">'end'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="å¯æ‰§è¡Œè„šæœ¬"><a href="#å¯æ‰§è¡Œè„šæœ¬" class="headerlink" title="å¯æ‰§è¡Œè„šæœ¬"></a>å¯æ‰§è¡Œè„šæœ¬</h2><ul><li>ä½¿ç”¨ JavaScript è¯­è¨€,å†™ä¸€ä¸ªå¯æ‰§è¡Œè„šæœ¬hello</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env node</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'hello world'</span>);</span><br></pre></td></tr></table></figure><ul><li>ä¿®æ”¹ hello çš„æƒé™</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod <span class="number">755</span> hello</span><br></pre></td></tr></table></figure><ul><li>æ‰§è¡Œè„šæœ¬</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./hello</span><br></pre></td></tr></table></figure><ul><li>æŠŠ hello å‰é¢çš„è·¯å¾„å»é™¤: åœ¨å½“å‰ç›®å½•ä¸‹æ–°å»º <code>package.json</code></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"name"</span>: <span class="string">"hello"</span>,</span><br><span class="line">  <span class="string">"bin"</span>: &#123;</span><br><span class="line">    <span class="string">"hello"</span>: <span class="string">"hello"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æ‰§è¡Œ <code>npm link</code> å‘½ä»¤</li><li>ç°åœ¨å†æ‰§è¡Œ helloå°±ä¸ç”¨è¾“å…¥è·¯å¾„äº†</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hello</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><ul><li><a href="http://www.ruanyifeng.com/blog/2015/05/command-line-with-node.html" target="_blank" rel="noopener">http://www.ruanyifeng.com/blog/2015/05/command-line-with-node.html</a></li><li><a href="https://nodejs.org/api/process.html#process_process_stdin" target="_blank" rel="noopener">https://nodejs.org/api/process.html#process_process_stdin</a></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> node </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iTerm2</title>
      <link href="/2015/09/13/iTerm2/"/>
      <url>/2015/09/13/iTerm2/</url>
      
        <content type="html"><![CDATA[<p>iTerm2æŠ˜è…¾ç¬”è®°<br><a id="more"></a></p><h2 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h2><p><a href="https://www.iterm2.com/" target="_blank" rel="noopener">https://www.iterm2.com/</a></p><h2 id="ä¸€äº›é…ç½®"><a href="#ä¸€äº›é…ç½®" class="headerlink" title="ä¸€äº›é…ç½®"></a>ä¸€äº›é…ç½®</h2><ul><li>ä¿å­˜sshè¿œç¨‹ç™»å½•æŒ‡ä»¤(1)</li><li>æ‰“å¼€æ–°çª—å£è‡ªåŠ¨å®šä½åˆ°ä½¿ç”¨tabé”®æ‰€åœ¨çš„ç›®å½•(2)</li></ul><figure class="image-box">                <img src="/img/iterm2/3.png" alt="shang" title="" class="">                <p>shang</p>            </figure><ul><li>æ¯æ¬¡æ–°æ‰“å¼€ç»ˆç«¯éƒ½ä¼šå›ºå®šå‡ºç°åœ¨å±å¹•çš„é¡¶ç«¯ä¸”ä¸ä¼šæœ‰çª—å£è¾¹æ¡†</li></ul><figure class="image-box">                <img src="/img/iterm2/1.png" alt="shang" title="" class="">                <p>shang</p>            </figure><ul><li>èƒŒæ™¯é€æ˜åº¦</li></ul><figure class="image-box">                <img src="/img/iterm2/2.png" alt="shang" title="" class="">                <p>shang</p>            </figure><ul><li>ä½¿ç”¨ <code>option</code> + â€˜-&gt;â€™ åœ¨å•è¯é—´è·³è½¬</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> è®¾ç½®å·¦ <span class="string">`option`</span></span><br><span class="line"><span class="number">2.</span> Keyboard Shortcut: âŒ¥â†</span><br><span class="line">Action: Send Escape Sequence</span><br><span class="line">Esc+: b</span><br><span class="line"><span class="number">3.</span> Keyboard Shortcut: âŒ¥â†’</span><br><span class="line">Action: Send Escape Sequence</span><br><span class="line">Esc+: f</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="/img/iterm2/4.png" alt="shang" title="" class="">                <p>shang</p>            </figure><ul><li>å…¨å±€å¿«æ·é”®<figure class="image-box">                <img src="/img/iterm2/7.png" alt="shang" title="" class="">                <p>shang</p>            </figure></li></ul><h2 id="å¿«æ·é”®"><a href="#å¿«æ·é”®" class="headerlink" title="å¿«æ·é”®"></a>å¿«æ·é”®</h2><h3 id="æ ‡ç­¾é¡µæ“ä½œ"><a href="#æ ‡ç­¾é¡µæ“ä½œ" class="headerlink" title="æ ‡ç­¾é¡µæ“ä½œ"></a>æ ‡ç­¾é¡µæ“ä½œ</h3><ul><li>æ–°å»ºæ ‡ç­¾é¡µ: <code>Command + T</code></li><li>å…³é—­æ ‡ç­¾é¡µ: <code>Command + W</code></li><li>çª—å£åˆ‡æ¢: <code>Command + æ–¹å‘é”®  æˆ–   Command + çª—å£ç¼–å·</code></li></ul><h3 id="é¢æ¿æ“ä½œ"><a href="#é¢æ¿æ“ä½œ" class="headerlink" title="é¢æ¿æ“ä½œ"></a>é¢æ¿æ“ä½œ</h3><ul><li>å‚ç›´åˆ†å‰²: <code>Command + D</code></li><li>æ°´å¹³åˆ†å‰²: <code>Shift + Command + D</code></li><li>å‰ä¸€ä¸ªé¢æ¿: <code>Command + [</code></li><li>åä¸€ä¸ªé¢æ¿: <code>Command + ]</code></li><li>åˆ‡æ¢åˆ°ä¸Š/ä¸‹/å·¦/å³é¢æ¿: <code>Option + Command + ä¸Šä¸‹å·¦å³æ–¹å‘é”®</code></li></ul><h3 id="æœç´¢æŸ¥æ‰¾"><a href="#æœç´¢æŸ¥æ‰¾" class="headerlink" title="æœç´¢æŸ¥æ‰¾"></a>æœç´¢æŸ¥æ‰¾</h3><ul><li><p><code>âŒ˜ + f</code>æŸ¥æ‰¾ã€‚æ”¯æŒæ­£åˆ™ã€‚<br>å…¶ä¸­æŸ¥æ‰¾çš„å†…å®¹ä¼šè¢«è‡ªåŠ¨å¤åˆ¶(é¼ æ ‡å»é€‰ä¸­çš„å†…å®¹ä¹Ÿä¼šè‡ªåŠ¨å¤åˆ¶,ä¹Ÿå¯ä»¥é¼ æ ‡ä¸­é”®ç›´æ¥ç²˜è´´)<br>é”®å…¥æœç´¢å…³é”®è¯ï¼Œç„¶åç”¨<code>shift+tab</code>æˆ–è€…<code>tab</code>å·¦å³è‡ªåŠ¨è¡¥å…¨<br><code>option + enter</code> åˆ™è‡ªåŠ¨å°†æœç´¢ç»“æœé”®å…¥,å¹¶ä¸”å¤åˆ¶åˆ°å‰ªè´´æ¿</p></li><li><p><code>âŒ˜ + opt + e</code> Exposeæ ‡ç­¾</p></li></ul><figure class="image-box">                <img src="/img/iterm2/8.png" alt="shang" title="" class="">                <p>shang</p>            </figure><ul><li><p><code>Command + /</code>: æŸ¥çœ‹å½“å‰ç»ˆç«¯ä¸­å…‰æ ‡çš„ä½ç½®</p></li><li><p><code></code>âŒ˜ + opt + b` :å¿«ç…§å›æ”¾, å¯¹ä½ çš„æ“ä½œæ ¹æ®æ—¶é—´è½´è¿›è¡Œå›æ”¾. å¯ä»¥æ‹–åŠ¨ä¸‹æ–¹çš„æ—¶é—´è½´ï¼Œä¹Ÿå¯ä»¥æŒ‰å·¦å³æ–¹å‘é”®</p></li><li><p><code>Command + shift + H</code> iterm2å°†è‡ªåŠ¨åˆ—å‡ºå‰ªåˆ‡æ¿çš„å†å²è®°å½•</p></li></ul><h3 id="å…¶ä»–åŠŸèƒ½"><a href="#å…¶ä»–åŠŸèƒ½" class="headerlink" title="å…¶ä»–åŠŸèƒ½"></a>å…¶ä»–åŠŸèƒ½</h3><ul><li>è¿›å…¥å’Œé€€å‡ºå…¨å±: <code>Command + Enter</code></li><li>å¼€å¯å’Œå…³é—­èƒŒæ™¯åŠé€æ˜: <code>Command + U</code></li><li>æ¸…å±ï¼ˆå…¶å®æ˜¯æ»šåˆ°æ–°çš„ä¸€å±ï¼Œå¹¶æ²¡æœ‰æ¸…ç©ºï¼‰: <code>Command + R</code></li><li>æ¸…å±: <code>Ctrl+L</code></li><li>æ¸…ç©ºå½“å‰è¡Œï¼Œæ— è®ºå…‰æ ‡åœ¨ä»€ä¹ˆä½ç½®: <code>ctrl + U</code></li><li>åˆ°è¡Œé¦–: <code>ctrl + A  æˆ– fn + å·¦æ–¹å‘é”®</code></li><li>åˆ°è¡Œæœ«: <code>ctrl + E æˆ– fn + å³æ–¹å‘é”®</code></li><li>æœç´¢å‘½ä»¤å†å²: <code>ctrl + R</code></li><li>è°ƒæ•´å­—ä½“å¤§å°: <code>âŒ˜ + â€”/+/0</code></li><li>å‘½ä»¤è‡ªåŠ¨è¡¥å…¨: <code>Command + ;</code>ï¼ˆå¾ˆå°‘ç”¨è¿™ä¸ª)</li></ul><h2 id="æ–‡æœ¬é€‰å–"><a href="#æ–‡æœ¬é€‰å–" class="headerlink" title="æ–‡æœ¬é€‰å–"></a>æ–‡æœ¬é€‰å–</h2><ul><li>å¸¸è§çš„ç‚¹å‡»å¹¶æ‹–æ‹½æ–¹å¼</li><li>åŒå‡»é€‰å–æ•´ä¸ªå•è¯</li><li>ä¸‰å‡»é€‰å–æ•´è¡Œ</li><li>é€‰å–æŸä¸€éƒ¨åˆ†ï¼ŒæŒ‰ä½Shiftï¼Œå†ç‚¹å‡»æŸå¤„ï¼Œå¯ä»¥é€‰å–æ•´ä¸ªçŸ©å½¢å†…çš„æ–‡æœ¬ï¼ˆç±»ä¼¼Windowsä¸‹æŒ‰ä½Shiftå¯ä»¥æ‰¹é‡é€‰å–å›¾æ ‡ï¼‰</li><li>æŒ‰ä½Command + Optionï¼Œå¯ä»¥ç”¨é¼ æ ‡ç”»å‡ºä¸€ä¸ªçŸ©å½¢ï¼Œç”¨ç±»ä¼¼æˆªå›¾çš„æ–¹å¼é€‰å–æ–‡æœ¬ å¦å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨é¼ æ ‡å®Œæˆä»¥ä¸‹æ“ä½œï¼š </li><li>æŒ‰ä½Commandç„¶åç‚¹å‡»æŸä¸ªURLï¼Œä¼šåœ¨æµè§ˆå™¨ä¸­æ‰“å¼€è¿™ä¸ªURLï¼Œ</li><li>ç‚¹å‡»æŸä¸ªæ–‡ä»¶å¤¹ï¼Œä¼šåœ¨Finderé‡Œæ‰“å¼€è¿™ä¸ªæ–‡ä»¶å¤¹</li><li>ç‚¹å‡»æŸä¸ªæ–‡ä»¶åï¼Œä¼šæ‰“å¼€è¿™ä¸ªæ–‡ä»¶ï¼ˆæ–‡æœ¬æ–‡ä»¶æ”¯æŒMacVimï¼ŒTextMateå’ŒBBEditï¼Œå¦‚æœåé¢è·Ÿéšä¸€ä¸ªå†’å·å’Œè¡Œå·ï¼Œæ–‡ä»¶ä¼šåœ¨è¡Œå·å¤„æ‰“å¼€ï¼Œå…¶å®ƒæ ¼å¼çš„æ–‡ä»¶ä¼¼ä¹ä¸èƒ½è°ƒç”¨é»˜è®¤ç¨‹åºæ‰“å¼€ï¼‰ </li></ul><h2 id="æ ‡ç­¾å˜è‰²"><a href="#æ ‡ç­¾å˜è‰²" class="headerlink" title="æ ‡ç­¾å˜è‰²"></a>æ ‡ç­¾å˜è‰²</h2><blockquote><p>iTerm2 çš„æ ‡ç­¾çš„é¢œè‰²ä¼šå˜åŒ–,ä»¥æŒ‡ç¤ºè¯¥ tab å½“å‰çš„çŠ¶æ€.å½“è¯¥æ ‡ç­¾æœ‰æ–°è¾“å‡ºçš„æ—¶å€™,<br>æ ‡ç­¾ä¼šå˜æˆæ´‹çº¢è‰²;æ–°çš„è¾“å‡ºé•¿æ—¶é—´æ²¡æœ‰æŸ¥çœ‹,æ ‡ç­¾ä¼šå˜æˆçº¢è‰².å¯åœ¨è®¾ç½®ä¸­å…³æ‰è¯¥åŠŸèƒ½</p></blockquote><h2 id="é…è‰²"><a href="#é…è‰²" class="headerlink" title="é…è‰²"></a>é…è‰²</h2><p>è‡ªè¡Œç ”ç©¶ <a href="http://iterm2colorschemes.com/" target="_blank" rel="noopener">http://iterm2colorschemes.com/</a></p><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><ul><li><a href="https://coderwall.com/p/h6yfda/use-and-to-jump-forwards-backwards-words-in-iterm-2-on-os-x" target="_blank" rel="noopener">https://coderwall.com/p/h6yfda/use-and-to-jump-forwards-backwards-words-in-iterm-2-on-os-x</a></li><li><a href="http://pengjunjie.com/articles/mac-soft-iterm2/" target="_blank" rel="noopener">http://pengjunjie.com/articles/mac-soft-iterm2/</a></li><li><a href="http://wulfric.me/2015/08/iterm2/" target="_blank" rel="noopener">http://wulfric.me/2015/08/iterm2/</a></li><li><a href="http://www.wangyuxiong.com/archives/52137" target="_blank" rel="noopener">http://www.wangyuxiong.com/archives/52137</a></li><li><a href="http://xingrz.me/2013/2013-06-19/terminal-zhuangbility.html" target="_blank" rel="noopener">http://xingrz.me/2013/2013-06-19/terminal-zhuangbility.html</a></li></ul><hr><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong></p></blockquote><blockquote><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> iTerm2 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[è½¬]AngularJSä¸­çš„Providerä»¬ï¼šServiceå’ŒFactoryç­‰çš„åŒºåˆ«</title>
      <link href="/2015/08/30/%E8%BD%AC-AngularJS%E4%B8%AD%E7%9A%84Provider%E4%BB%AC%EF%BC%9AService%E5%92%8CFactory%E7%AD%89%E7%9A%84%E5%8C%BA%E5%88%AB/"/>
      <url>/2015/08/30/%E8%BD%AC-AngularJS%E4%B8%AD%E7%9A%84Provider%E4%BB%AC%EF%BC%9AService%E5%92%8CFactory%E7%AD%89%E7%9A%84%E5%8C%BA%E5%88%AB/</url>
      
        <content type="html"><![CDATA[<p>AngularJSä¸­çš„Providerä»¬ï¼šServiceå’ŒFactoryç­‰çš„åŒºåˆ«<br><a id="more"></a></p><h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p>çœ‹äº†å¾ˆå¤šæ–‡ç« å¯èƒ½è¿˜æ˜¯ä¸å¤ªè¯´å¾—å‡º<code>AngularJS</code>ä¸­çš„å‡ ä¸ªåˆ›å»ºä¾›åº”å•†(<code>provider</code>)çš„æ–¹æ³•(<code>factory(),service(),provider()</code>)åˆ°åº•æœ‰å•¥åŒºåˆ«ï¼Œå•¥æ—¶å€™è¯¥ç”¨å•¥ï¼Œä¹‹å‰ä¸€ç›´å‚»å‚»åˆ†ä¸æ¸…æ¥šï¼Œç°åœ¨æ¥æ€»ç»“ä¸€ä¸‹ã€‚  </p><p>ä¸‹æ–‡ä¸­æ³›æŒ‡ç»Ÿä¸€ç”¨ä¸­æ–‡ï¼Œè‹±æ–‡å³ä¸ºç‰¹æŒ‡$provideæ–¹æ³•ä¸­å¯¹åº”æ–¹æ³•åˆ›å»ºå‡ºçš„ä¸œä¸œ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ä¾›åº”å•†==&gt;æ³›æŒ‡provider</span><br><span class="line">æœåŠ¡==&gt;æ³›æŒ‡service</span><br><span class="line"></span><br><span class="line">provider==&gt;provider()æ–¹æ³•åˆ›å»ºçš„ä¸œä¸œ</span><br><span class="line">service==&gt;service()æ–¹æ³•åˆ›å»ºçš„ä¸œä¸œ</span><br></pre></td></tr></table></figure><h2 id="å…ˆè¯´è¯´ä¾›åº”å•†ï¼ˆ-provideï¼‰"><a href="#å…ˆè¯´è¯´ä¾›åº”å•†ï¼ˆ-provideï¼‰" class="headerlink" title="å…ˆè¯´è¯´ä¾›åº”å•†ï¼ˆ$provideï¼‰"></a>å…ˆè¯´è¯´ä¾›åº”å•†ï¼ˆ<code>$provide</code>ï¼‰</h2><p><code>$provide</code>æœåŠ¡è´Ÿè´£å‘Šè¯‰Angularå¦‚ä½•åˆ›é€ ä¸€ä¸ªæ–°çš„å¯æ³¨å…¥çš„ä¸œè¥¿ï¼šå³æœåŠ¡ã€‚æœåŠ¡ä¼šè¢«å«åšä¾›åº”å•†çš„ä¸œè¥¿æ¥å®šä¹‰ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>$provide</code>æ¥åˆ›å»ºä¸€ä¸ªä¾›åº”å•†ã€‚ä½ éœ€è¦ä½¿ç”¨<code>$provide</code>ä¸­çš„<code>provider()</code>æ–¹æ³•æ¥å®šä¹‰ä¸€ä¸ªä¾›åº”å•†ï¼ŒåŒæ—¶ä½ ä¹Ÿå¯ä»¥é€šè¿‡è¦æ±‚$provideè¢«æ³¨å…¥åˆ°ä¸€ä¸ªåº”ç”¨çš„configå‡½æ•°ä¸­æ¥è·å¾—<code>$provide</code>æœåŠ¡ã€‚</p><p>ä¸Šé¢çš„æè¿°æ˜¯å®˜æ–¹wikiçš„ç¿»è¯‘ç‰ˆï¼Œå¦‚æœæœ‰äº›ç»•çš„è¯ï¼Œçœ‹ä¸‹è¿™å¼ å›¾ï¼š<br><figure class="image-box">                <img src="/img/provider/provider1.png" alt="" title="" class="">                <p></p>            </figure></p><ul><li><code>$provide</code>æ˜¯ä¸€ä¸ªæœåŠ¡ï¼Œåœ¨<code>Auto</code>æ¨¡å—ä¸­</li><li>è¿™ä¸ªæœåŠ¡ä¸‹é¢æœ‰å¥½å¤šæ–¹æ³•ï¼Œæ˜¯ç”¨æ¥å®šä¹‰ä¾›åº”å•†</li><li>è€Œä¾›åº”å•†æ˜¯ç”¨æ¥æä¾›æœåŠ¡çš„ï¼Œè¢«æ³¨å…¥æ¥æ³¨å…¥å»çš„ä¸œè¥¿å°±æ˜¯ä¾›åº”å•†ä»¬æä¾›çš„æœåŠ¡äº†</li></ul><p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">myMod.config(<span class="function"><span class="keyword">function</span>(<span class="params">$provide</span>) </span>&#123;</span><br><span class="line">  $provide.provider(<span class="string">'greeting'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.$get = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">        alert(<span class="string">"Hello, "</span> + name);</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªä¾‹å­å¯ä»¥è¯´æ˜¯æœ€ç»ˆå½¢æ€ï¼Œå…ˆå¤§æ¦‚çœ‹ä¸‹</p><h2 id="å®šä¹‰ä¾›åº”å•†çš„æ–¹æ³•ä»¬"><a href="#å®šä¹‰ä¾›åº”å•†çš„æ–¹æ³•ä»¬" class="headerlink" title="å®šä¹‰ä¾›åº”å•†çš„æ–¹æ³•ä»¬"></a>å®šä¹‰ä¾›åº”å•†çš„æ–¹æ³•ä»¬</h2><p><code>AngularJS</code>ç”¨<code>$provide</code>å»å®šä¹‰ä¸€ä¸ªä¾›åº”å•†,è¿™ä¸ª<code>$provide</code>æœ‰5ä¸ªç”¨æ¥åˆ›å»ºä¾›åº”å•†çš„æ–¹æ³•ï¼š</p><ul><li>constant</li><li>value</li><li>service</li><li>factory</li><li>provider</li><li>decorator æˆ‘æ²¡æœ‰è¯´æˆ‘ä¹Ÿæ˜¯ï¼Œæˆ‘åªæ˜¯è·¯è¿‡o(â•¯â–¡â•°)o</li></ul><h3 id="Constant"><a href="#Constant" class="headerlink" title="Constant"></a>Constant</h3><p>å®šä¹‰å¸¸é‡ç”¨çš„ï¼Œè¿™è´§å®šä¹‰çš„å€¼å½“ç„¶å°±ä¸èƒ½è¢«æ”¹å˜ï¼Œå®ƒå¯ä»¥è¢«æ³¨å…¥åˆ°ä»»ä½•åœ°æ–¹ï¼Œä½†æ˜¯ä¸èƒ½è¢«è£…é¥°å™¨(<code>decorator</code>)è£…é¥°</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> app = angular.module(<span class="string">'app'</span>, []);</span><br><span class="line"> </span><br><span class="line">app.config(<span class="function"><span class="keyword">function</span> (<span class="params">$provide</span>) </span>&#123;</span><br><span class="line">  $provide.constant(<span class="string">'movieTitle'</span>, <span class="string">'The Matrix'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line">app.controller(<span class="string">'ctrl'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">movieTitle</span>) </span>&#123;</span><br><span class="line">  expect(movieTitle).toEqual(<span class="string">'The Matrix'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è¯­æ³•ç³–ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.constant(<span class="string">'movieTitle'</span>, <span class="string">'The Matrix'</span>);</span><br></pre></td></tr></table></figure><h3 id="Value"><a href="#Value" class="headerlink" title="Value"></a>Value</h3><p>è¿™è´§å¯ä»¥æ˜¯<code>string,number</code>ç”šè‡³<code>function</code>,å®ƒå’Œ<code>constant</code>çš„ä¸åŒä¹‹å¤„åœ¨äº<br>å®ƒå¯ä»¥è¢«ä¿®æ”¹ï¼Œä¸èƒ½è¢«æ³¨å…¥åˆ°<code>config</code>ä¸­ï¼Œä½†æ˜¯å®ƒå¯ä»¥è¢«<code>decorator</code>è£…é¥°</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> app = angular.module(<span class="string">'app'</span>, []);</span><br><span class="line"> </span><br><span class="line">app.config(<span class="function"><span class="keyword">function</span> (<span class="params">$provide</span>) </span>&#123;</span><br><span class="line">  $provide.value(<span class="string">'movieTitle'</span>, <span class="string">'The Matrix'</span>)</span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line">app.controller(<span class="string">'ctrl'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">movieTitle</span>) </span>&#123;</span><br><span class="line">  expect(movieTitle).toEqual(<span class="string">'The Matrix'</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>è¯­æ³•ç³–ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.value(<span class="string">'movieTitle'</span>, <span class="string">'The Matrix'</span>);</span><br></pre></td></tr></table></figure><h3 id="Service"><a href="#Service" class="headerlink" title="Service"></a>Service</h3><p>å®ƒæ˜¯ä¸€ä¸ªå¯æ³¨å…¥çš„æ„é€ å™¨ï¼Œåœ¨<code>AngularJS</code>ä¸­å®ƒæ˜¯å•ä¾‹çš„ï¼Œç”¨å®ƒåœ¨<code>Controller</code>ä¸­é€šä¿¡æˆ–è€…å…±äº«æ•°æ®éƒ½å¾ˆåˆé€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> app = angular.module(<span class="string">'app'</span> ,[]);</span><br><span class="line"> </span><br><span class="line">app.config(<span class="function"><span class="keyword">function</span> (<span class="params">$provide</span>) </span>&#123;</span><br><span class="line">  $provide.service(<span class="string">'movie'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.title = <span class="string">'The Matrix'</span>;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line">app.controller(<span class="string">'ctrl'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">movie</span>) </span>&#123;</span><br><span class="line">  expect(movie.title).toEqual(<span class="string">'The Matrix'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è¯­æ³•ç³–ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app.service(<span class="string">'movie'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.title = <span class="string">'The Matrix'</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>åœ¨serviceé‡Œé¢å¯ä»¥ä¸ç”¨è¿”å›ä¸œè¥¿ï¼Œå› ä¸ºAngularJSä¼šè°ƒç”¨newå…³é”®å­—æ¥åˆ›å»ºå¯¹è±¡ã€‚ä½†æ˜¯è¿”å›ä¸€ä¸ªè‡ªå®šä¹‰å¯¹è±¡å¥½åƒä¹Ÿä¸ä¼šå‡ºé”™ã€‚</p><h3 id="Factory"><a href="#Factory" class="headerlink" title="Factory"></a>Factory</h3><p>å®ƒæ˜¯ä¸€ä¸ªå¯æ³¨å…¥çš„<code>function</code>ï¼Œå®ƒå’Œ<code>service</code>çš„åŒºåˆ«å°±æ˜¯ï¼š<code>factory</code>æ˜¯æ™®é€š<code>function</code>ï¼Œè€Œ<code>service</code>æ˜¯ä¸€ä¸ªæ„é€ å™¨(<code>constructor</code>)ï¼Œè¿™æ ·<code>Angular</code>åœ¨è°ƒç”¨<code>service</code>æ—¶ä¼šç”¨<code>new</code>å…³é”®å­—ï¼Œè€Œè°ƒç”¨<code>factory</code>æ—¶åªæ˜¯è°ƒç”¨æ™®é€šçš„<code>function</code>ï¼Œæ‰€ä»¥<code>factory</code>å¯ä»¥è¿”å›ä»»ä½•ä¸œè¥¿ï¼Œè€Œ<code>service</code>å¯ä»¥ä¸è¿”å›(å¯æŸ¥é˜…newå…³é”®å­—çš„ä½œç”¨)</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> app = angular.module(<span class="string">'app'</span>, []);</span><br><span class="line"> </span><br><span class="line">app.config(<span class="function"><span class="keyword">function</span> (<span class="params">$provide</span>) </span>&#123;</span><br><span class="line">  $provide.factory(<span class="string">'movie'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      title: <span class="string">'The Matrix'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line">app.controller(<span class="string">'ctrl'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">movie</span>) </span>&#123;</span><br><span class="line">  expect(movie.title).toEqual(<span class="string">'The Matrix'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è¯­æ³•ç³–ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">app.factory(<span class="string">'movie'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    title: <span class="string">'The Matrix'</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><code>factory</code>å¯ä»¥è¿”å›ä»»ä½•ä¸œè¥¿ï¼Œå®ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ªåªæœ‰<code>$get</code>æ–¹æ³•çš„<code>provider</code></p><h3 id="Provider"><a href="#Provider" class="headerlink" title="Provider"></a>Provider</h3><p><code>provider</code>æ˜¯ä»–ä»¬çš„è€å¤§ï¼Œä¸Šé¢çš„å‡ ä¹(é™¤äº†<code>constant</code>)éƒ½æ˜¯<code>provider</code>çš„å°è£…ï¼Œ<code>provider</code>å¿…é¡»æœ‰ä¸€ä¸ª<code>$get</code>æ–¹æ³•ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥è¯´<code>provider</code>æ˜¯ä¸€ä¸ªå¯é…ç½®çš„<code>factory</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> app = angular.module(<span class="string">'app'</span>, []);</span><br><span class="line"> </span><br><span class="line">app.provider(<span class="string">'movie'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> version;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    setVersion: <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">      version = value;</span><br><span class="line">    &#125;,</span><br><span class="line">    $get: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">          title: <span class="string">'The Matrix'</span> + <span class="string">' '</span> + version</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line">app.config(<span class="function"><span class="keyword">function</span> (<span class="params">movieProvider</span>) </span>&#123;</span><br><span class="line">  movieProvider.setVersion(<span class="string">'Reloaded'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line">app.controller(<span class="string">'ctrl'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">movie</span>) </span>&#123;</span><br><span class="line">  expect(movie.title).toEqual(<span class="string">'The Matrix Reloaded'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>æ³¨æ„è¿™é‡Œ<code>confi</code>gæ–¹æ³•æ³¨å…¥çš„æ˜¯<code>movieProvider</code>ï¼Œä¸Šé¢å®šä¹‰äº†ä¸€ä¸ªä¾›åº”å•†å«<code>movie</code>ï¼Œä½†æ˜¯æ³¨å…¥åˆ°<code>config</code>ä¸­ä¸èƒ½ç›´æ¥å†™<code>movie</code>ï¼Œå› ä¸ºå‰æ–‡è®²äº†æ³¨å…¥çš„é‚£ä¸ªä¸œè¥¿å°±æ˜¯æœåŠ¡ï¼Œæ˜¯ä¾›åº”å•†æä¾›å‡ºæ¥çš„ï¼Œè€Œ<code>config</code>ä¸­åˆåªèƒ½æ³¨å…¥ä¾›åº”å•†ï¼ˆä¸¤ä¸ªä¾‹å¤–æ˜¯<code>$provide</code>å’Œ<code>$injector</code>ï¼‰ï¼Œæ‰€ä»¥ç”¨é©¼å³°å‘½åæ³•å†™æˆ<code>movieProvider</code>ï¼Œ<code>Angular</code>å°±ä¼šå¸®ä½ æ³¨å…¥å®ƒçš„ä¾›åº”å•†ã€‚ï¼ˆæ›´è¯¦ç»†å¯å‚è€ƒæ–‡æœ«å®˜æ–¹wikiç¿»è¯‘ç‰ˆä¸­çš„é…ç½®<code>provider</code>ï¼‰</p><h3 id="Decorator"><a href="#Decorator" class="headerlink" title="Decorator"></a>Decorator</h3><p>è¿™ä¸ªæ¯”è¾ƒç‰¹æ®Šï¼Œå®ƒä¸æ˜¯<code>provider</code>,å®ƒæ˜¯ç”¨æ¥è£…é¥°å…¶ä»–<code>provider</code>çš„ï¼Œè€Œå‰é¢ä¹Ÿè¯´è¿‡ï¼Œä»–ä¸èƒ½è£…é¥°<code>Constant</code>ï¼Œå› ä¸ºå®é™…ä¸Š<code>Constant</code>ä¸æ˜¯é€šè¿‡<code>provider()</code>æ–¹æ³•åˆ›å»ºçš„ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> app = angular.module(<span class="string">'app'</span>, []);</span><br><span class="line"> </span><br><span class="line">app.value(<span class="string">'movieTitle'</span>, <span class="string">'The Matrix'</span>);</span><br><span class="line"> </span><br><span class="line">app.config(<span class="function"><span class="keyword">function</span> (<span class="params">$provide</span>) </span>&#123;</span><br><span class="line">  $provide.decorator(<span class="string">'movieTitle'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">$delegate</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> $delegate + <span class="string">' - starring Keanu Reeves'</span>;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line">app.controller(<span class="string">'myController'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">movieTitle</span>) </span>&#123;</span><br><span class="line">  expect(movieTitle).toEqual(<span class="string">'The Matrix - starring Keanu Reeves'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul><li>æ‰€æœ‰çš„ä¾›åº”å•†éƒ½åªè¢«å®ä¾‹åŒ–ä¸€æ¬¡ï¼Œä¹Ÿå°±è¯´ä»–ä»¬éƒ½æ˜¯å•ä¾‹çš„</li><li>é™¤äº†constantï¼Œæ‰€æœ‰çš„ä¾›åº”å•†éƒ½å¯ä»¥è¢«è£…é¥°å™¨(decorator)è£…é¥°</li><li>valueå°±æ˜¯ä¸€ä¸ªç®€å•çš„å¯æ³¨å…¥çš„å€¼</li><li>serviceæ˜¯ä¸€ä¸ªå¯æ³¨å…¥çš„æ„é€ å™¨</li><li>factoryæ˜¯ä¸€ä¸ªå¯æ³¨å…¥çš„æ–¹æ³•</li><li>decoratorå¯ä»¥ä¿®æ”¹æˆ–å°è£…å…¶ä»–çš„ä¾›åº”å•†ï¼Œå½“ç„¶é™¤äº†constant</li><li>provideræ˜¯ä¸€ä¸ªå¯é…ç½®çš„factory</li></ul><p>æœ€åæ¥çœ‹ä¸€å¼ å¯¹æ¯”å›¾ï¼š</p><figure class="image-box">                <img src="/img/provider/provider2.png" alt="" title="" class="">                <p></p>            </figure><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><ul><li><a href="http://segmentfault.com/a/1190000003096933" target="_blank" rel="noopener">(è½¬è½½è‡ª)http://segmentfault.com/a/1190000003096933</a></li><li><a href="http://blog.xebia.com/2013/09/01/differences-between-providers-in-angularjs/" target="_blank" rel="noopener">Differences Between Providers in AngularJS</a></li><li><a href="https://github.com/angular/angular.js/wiki/Understanding-Dependency-Injection" target="_blank" rel="noopener">å®˜æ–¹wikiï¼šUnderstanding Dependency Injection</a></li><li><a href="http://www.html-js.com/article/1980" target="_blank" rel="noopener">å®˜æ–¹wikiç¿»è¯‘ç‰ˆï¼šç†è§£ä¾èµ–æ³¨å…¥</a></li><li><a href="http://my.oschina.net/tommyfok/blog/299231" target="_blank" rel="noopener">AngularJSä¸­çš„Provider</a></li><li><a href="http://hellobug.github.io/blog/angularjs-providers/" target="_blank" rel="noopener">ä¼¤ä¸èµ·çš„providerä»¬</a></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> AngularJS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[è½¬]MongoDBå‘½ä»¤è¡Œæ“ä½œ</title>
      <link href="/2015/08/18/%E8%BD%AC-MongoDB%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%93%8D%E4%BD%9C/"/>
      <url>/2015/08/18/%E8%BD%AC-MongoDB%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%93%8D%E4%BD%9C/</url>
      
        <content type="html"><![CDATA[<p>MongoDBå‘½ä»¤è¡Œæ“ä½œ<br><a id="more"></a></p><p>2.1 æŸ¥çœ‹æœåŠ¡å™¨ä¸Šçš„æ•°æ®åº“  </p><blockquote><p>show dbs  </p></blockquote><p>2.2 åˆ‡æ¢æ•°æ®åº“<br>åˆ‡æ¢åˆ°tempæ•°æ®åº“(ä»é»˜è®¤çš„testæ•°æ®åº“)  </p><blockquote><p>use temp  </p></blockquote><p>2.3 æŸ¥çœ‹å½“å‰æ•°æ®åº“ä¸­çš„æ‰€æœ‰é›†åˆ  </p><blockquote><p>show collections  </p></blockquote><p>2.4 åˆ›å»ºæ•°æ®åº“  </p><p><strong>mongoä¸­åˆ›å»ºæ•°æ®åº“é‡‡ç”¨çš„ä¹Ÿæ˜¯useå‘½ä»¤ï¼Œå¦‚æœuseåé¢è·Ÿçš„æ•°æ®åº“åä¸å­˜åœ¨ï¼Œé‚£ä¹ˆmongoå°†ä¼šæ–°å»ºè¯¥æ•°æ®åº“ã€‚ä¸è¿‡ï¼Œå®é™…ä¸Šåªæ‰§è¡Œuseå‘½ä»¤åï¼Œmongoæ˜¯ä¸ä¼šæ–°å»ºè¯¥æ•°æ®åº“çš„ï¼Œç›´åˆ°ä½ åƒè¯¥æ•°æ®åº“ä¸­æ’å…¥äº†æ•°æ®</strong></p><blockquote><p>use test2 </p></blockquote><p><code>switched to db test2</code></p><blockquote><p>show dbs  </p></blockquote><p><code>åˆ°è¿™é‡Œå¹¶æ²¡æœ‰çœ‹åˆ°åˆšæ‰æ–°å»ºçš„test2æ•°æ®åº“</code></p><blockquote><p>db.hello.insert({â€œnameâ€:â€testdbâ€})</p></blockquote><p><code>è¯¥æ“ä½œä¼šåœ¨test2æ•°æ®åº“ä¸­æ–°å»ºä¸€ä¸ªhelloé›†åˆï¼Œå¹¶åœ¨å…¶ä¸­æ’å…¥ä¸€æ¡è®°å½•ã€‚</code></p><blockquote><p>show dbs </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">test    (empty)  </span><br><span class="line">test2   <span class="number">0.203125</span>GB</span><br></pre></td></tr></table></figure><blockquote><p>show collections  </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hello  </span><br><span class="line">system.indexes</span><br></pre></td></tr></table></figure><p><code>è¿™æ ·ï¼Œä¾¿å¯ä»¥çœ‹åˆ°mongoçš„ç¡®åˆ›å»ºäº†test2æ•°æ®åº“ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªhelloé›†åˆã€‚</code> </p><p>2.5 åˆ é™¤æ•°æ®åº“  </p><blockquote><p>db.dropDatabase()  </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="string">"dropped"</span> : <span class="string">"test2"</span>, <span class="string">"ok"</span> : <span class="number">1</span> &#125;</span><br></pre></td></tr></table></figure><p>2.6 æŸ¥çœ‹å½“å‰æ•°æ®åº“  </p><blockquote><p>db   </p></blockquote><p><code>test2</code><br><code>å¯ä»¥çœ‹å‡ºåˆ é™¤test2æ•°æ®åº“ä¹‹åï¼Œå½“å‰çš„dbè¿˜æ˜¯æŒ‡å‘å®ƒï¼Œåªæœ‰å½“åˆ‡æ¢æ•°æ®åº“ä¹‹åï¼Œtest2æ‰ä¼šå½»åº•æ¶ˆå¤±</code> </p><p>3.1 æ–°å»ºcollection  </p><blockquote><p>db.createCollection(â€œHelloâ€)  </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="string">"ok"</span> : <span class="number">1</span> &#125;</span><br></pre></td></tr></table></figure><blockquote><p>show collections  </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Hello  </span><br><span class="line">system.indexes  </span><br><span class="line">ä»ä¸Šé¢<span class="number">2.4</span>ä¹Ÿå¯ä»¥çœ‹å‡ºï¼Œç›´æ¥å‘ä¸€ä¸ªä¸å­˜åœ¨çš„collectionä¸­æ’å…¥æ•°æ®ä¹Ÿèƒ½åˆ›å»ºä¸€ä¸ªcollectionã€‚</span><br></pre></td></tr></table></figure><blockquote><p>db.hello2.insert({â€œnameâ€:â€lfqyâ€})<br>show collections   </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Hello  </span><br><span class="line">hello2  </span><br><span class="line">system.indexes</span><br></pre></td></tr></table></figure><p>3.2 åˆ é™¤collection  </p><blockquote><p>db.Hello.drop()  </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">true</span>  </span><br><span class="line">è¿”å›<span class="literal">true</span>è¯´æ˜åˆ é™¤æˆåŠŸï¼Œ<span class="literal">false</span>è¯´æ˜æ²¡æœ‰åˆ é™¤æˆåŠŸã€‚</span><br></pre></td></tr></table></figure><blockquote><p>db.hello.drop()  </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">false</span>  </span><br><span class="line">ä¸å­˜åœ¨åä¸ºhelloçš„collectionï¼Œå› æ­¤ï¼Œåˆ é™¤å¤±è´¥ã€‚</span><br></pre></td></tr></table></figure><p>3.3 é‡å‘½åcollection  </p><p><code>å°†hello2é›†åˆé‡å‘½åä¸ºHELLO</code></p><blockquote><p>show collections  </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hello2  </span><br><span class="line">system.indexes</span><br></pre></td></tr></table></figure><blockquote><p>db.hello2.renameCollection(â€œHELLOâ€)  </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="string">"ok"</span> : <span class="number">1</span> &#125;</span><br></pre></td></tr></table></figure><blockquote><p>show collections  </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">HELLO  </span><br><span class="line">system.indexes</span><br></pre></td></tr></table></figure><p>3.4 æŸ¥çœ‹å½“å‰æ•°æ®åº“ä¸­çš„æ‰€æœ‰collection </p><blockquote><p>show collections  </p></blockquote><p>3.5 ç´¢å¼•æ“ä½œ<br><code>åœ¨HELLOé›†åˆä¸Šï¼Œå»ºç«‹å¯¹IDå­—æ®µçš„ç´¢å¼•ï¼Œ1ä»£è¡¨å‡åº</code></p><blockquote><p>db.HELLO.ensureIndex({ID:1})  </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">åœ¨HELLOé›†åˆä¸Šï¼Œå»ºç«‹å¯¹IDå­—æ®µã€Nameå­—æ®µå’ŒGenderå­—æ®µå»ºç«‹ç´¢å¼•</span><br></pre></td></tr></table></figure><blockquote><p>db.HELLO.ensureIndex({ID:1,Name:1,Gender:-1})<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æŸ¥çœ‹HELLOé›†åˆä¸Šçš„æ‰€æœ‰ç´¢å¼•</span><br></pre></td></tr></table></figure></p></blockquote><blockquote><p>db.HELLO.getIndexes()  </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">åˆ é™¤ç´¢å¼•ç”¨db.collection.dropIndex()ï¼Œæœ‰ä¸€ä¸ªå‚æ•°ï¼Œå¯ä»¥æ˜¯å»ºç«‹ç´¢å¼•æ—¶æŒ‡å®šçš„å­—æ®µï¼Œä¹Ÿå¯ä»¥æ˜¯getIndexçœ‹åˆ°çš„ç´¢å¼•åç§°ã€‚</span><br></pre></td></tr></table></figure><blockquote><p>db.HELLO.dropIndex( â€œIDIdxâ€ )<br>db.HELLO.dropIndex({ID:1})  </p></blockquote><p>3.6 ä¸ºé›†åˆä¸­çš„æ¯ä¸€æ¡è®°å½•æ·»åŠ ä¸€ä¸ªå­—æ®µ<br><code>ä¸ºuseré›†åˆä¸­çš„æ¯ä¸€æ¡è®°å½•æ·»åŠ ä¸€ä¸ªåä¸ºexçš„å­—æ®µï¼Œå¹¶èµ‹å€¼ä¸ºbarrymore</code></p><blockquote><p>db.user.update({},{$set:{â€œexâ€:â€barrymoreâ€}},false,true)  </p></blockquote><p>3.7 é‡å‘½åå­—æ®µ<br><code>å°†é›†åˆä¸­çš„æ‰€æœ‰è®°å½•çš„genderå­—æ®µçš„åå­—ä¿®æ”¹ä¸ºsex</code></p><blockquote><p>db.user.update({},{$rename:{â€œgenderâ€:â€sexâ€}},false,true)  </p></blockquote><p>3.8 åˆ é™¤å­—æ®µ<br><code>åˆ é™¤é›†åˆä¸­æ‰€æœ‰è®°å½•çš„exå­—æ®µ</code></p><blockquote><p>db.user.update({},{â€œ$unsetâ€:{â€œexâ€:1}},false,true)  </p></blockquote><p>4.1 å‘useré›†åˆä¸­æ’å…¥ä¸¤æ¡è®°å½•  </p><blockquote><p>db.user.insert({â€˜nameâ€™:â€™Gal Gadotâ€™,â€™genderâ€™:â€™femaleâ€™,â€™ageâ€™:28,â€™salaryâ€™:11000})<br>db.user.insert({â€˜nameâ€™:â€™Mikie Haraâ€™,â€™genderâ€™:â€™femaleâ€™,â€™ageâ€™:26,â€™salaryâ€™:7000})  </p></blockquote><p>4.2 åŒæ ·ä¹Ÿå¯ä»¥ç”¨saveå®Œæˆç±»ä¼¼çš„æ’å…¥æ“ä½œ  </p><blockquote><p>db.user.save({â€˜nameâ€™:â€™Wentworth Earl Millerâ€™,â€™genderâ€™:â€™maleâ€™,â€™ageâ€™:41,â€™salaryâ€™:33000})</p></blockquote><p>5.1 æŸ¥æ‰¾é›†åˆä¸­çš„æ‰€æœ‰è®°å½•</p><blockquote><p>db.user.find()  </p></blockquote><p>5.2 æŸ¥æ‰¾é›†åˆä¸­çš„ç¬¦åˆæ¡ä»¶çš„è®°å½•</p><p>5.2.1 å•ä¸€æ¡ä»¶<br>5.2.1.1 Exact Equal:<br><code>æŸ¥è¯¢ageä¸ºäº†23çš„æ•°æ®</code></p><blockquote><p>db.user.find({â€œageâ€:23})  </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52442736d8947fb501000001"</span>), <span class="string">"name"</span> : <span class="string">"lfqy"</span>, <span class="string">"gender"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">23</span>, <span class="string">"salary"</span> : <span class="number">15</span> &#125;</span><br></pre></td></tr></table></figure><p>5.2.1.2 Great Than:  </p><p><code>æŸ¥è¯¢salaryå¤§äº5000çš„æ•°æ®</code></p><blockquote><p>db.user.find({salary:{$gt:5000}})  </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453cfb25e437dfea8fd4f4"</span>), <span class="string">"name"</span> : <span class="string">"Gal Gadot"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">28</span>, <span class="string">"salary"</span> : <span class="number">11000</span> &#125;  </span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453d8525e437dfea8fd4f5"</span>), <span class="string">"name"</span> : <span class="string">"Mikie Hara"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">26</span>, <span class="string">"salary"</span> : <span class="number">7000</span> &#125;  </span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453e2125e437dfea8fd4f6"</span>), <span class="string">"name"</span> : <span class="string">"Wentworth Earl Miller"</span>, <span class="string">"gender"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">41</span>, <span class="string">"salary"</span> : <span class="number">33000</span> &#125;</span><br><span class="line"><span class="string">``</span><span class="string">`  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">5.2.1.3 Fuzzy Match  </span></span><br><span class="line"><span class="string">`</span>æŸ¥è¯¢nameä¸­åŒ…å«<span class="string">'a'</span>çš„æ•°æ®<span class="string">`</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&gt; db.user.find(&#123;name:/a/&#125;)  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>js</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453cfb25e437dfea8fd4f4"</span>), <span class="string">"name"</span> : <span class="string">"Gal Gadot"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">28</span>, <span class="string">"salary"</span> : <span class="number">11000</span> &#125;  </span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453d8525e437dfea8fd4f5"</span>), <span class="string">"name"</span> : <span class="string">"Mikie Hara"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">26</span>, <span class="string">"salary"</span> : <span class="number">7000</span> &#125;  </span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453e2125e437dfea8fd4f6"</span>), <span class="string">"name"</span> : <span class="string">"Wentworth Earl Miller"</span>, <span class="string">"gender"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">41</span>, <span class="string">"salary"</span> : <span class="number">33000</span> &#125;</span><br></pre></td></tr></table></figure><p><code>æŸ¥è¯¢nameä»¥Gæ‰“å¤´çš„æ•°æ®</code></p><blockquote><p>db.user.find({name:/^G/})  </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453cfb25e437dfea8fd4f4"</span>), <span class="string">"name"</span> : <span class="string">"Gal Gadot"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">28</span>, <span class="string">"salary"</span> : <span class="number">11000</span> &#125;</span><br></pre></td></tr></table></figure><p>5.2.2 å¤šæ¡ä»¶â€ä¸â€<br><code>æŸ¥è¯¢ageå°äº30ï¼Œsalaryå¤§äº6000çš„æ•°æ®</code></p><blockquote><p>db.user.find({age:{$lt:30},salary:{$gt:6000}})  </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453cfb25e437dfea8fd4f4"</span>), <span class="string">"name"</span> : <span class="string">"Gal Gadot"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">28</span>, <span class="string">"salary"</span> : <span class="number">11000</span> &#125;  </span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453d8525e437dfea8fd4f5"</span>), <span class="string">"name"</span> : <span class="string">"Mikie Hara"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">26</span>, <span class="string">"salary"</span> : <span class="number">7000</span> &#125;  </span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52454155d8947fb70d000000"</span>), <span class="string">"name"</span> : <span class="string">"not known"</span>, <span class="string">"sex_orientation"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">13</span>, <span class="string">"salary"</span> : <span class="number">30000</span> &#125;</span><br></pre></td></tr></table></figure><p>5.2.3 å¤šæ¡ä»¶â€æˆ–â€<br><code>æŸ¥è¯¢ageå°äº25ï¼Œæˆ–è€…salaryå¤§äº10000çš„è®°å½•</code></p><blockquote><p>db.user.find({$or:[{salary:{$gt:10000}},{age:{$lt:25}}]})  </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52442736d8947fb501000001"</span>), <span class="string">"name"</span> : <span class="string">"lfqy"</span>, <span class="string">"gender"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">23</span>, <span class="string">"salary"</span> : <span class="number">15</span> &#125;  </span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453cfb25e437dfea8fd4f4"</span>), <span class="string">"name"</span> : <span class="string">"Gal Gadot"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">28</span>, <span class="string">"salary"</span> : <span class="number">11000</span> &#125;  </span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453e2125e437dfea8fd4f6"</span>), <span class="string">"name"</span> : <span class="string">"Wentworth Earl Miller"</span>, <span class="string">"gender"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">41</span>, <span class="string">"salary"</span> : <span class="number">33000</span> &#125;  </span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52454155d8947fb70d000000"</span>), <span class="string">"name"</span> : <span class="string">"not known"</span>, <span class="string">"sex_orientation"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">13</span>, <span class="string">"salary"</span> : <span class="number">30000</span> &#125;</span><br></pre></td></tr></table></figure><p>5.2.4ä¸ç­‰äºæŸ¥è¯¢<br><code>æŸ¥è¯¢å¹´é¾„ä¸ç­‰äº23çš„è®°å½•(è¿™é‡Œè¿”å›ç»“æœä¸­ï¼Œä¼šåŒ…å«æ²¡æœ‰å¹´é¾„å­—æ®µçš„è®°å½•)</code></p><blockquote><p>db.user.find({â€œageâ€:{ $ne: 23}})  </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453cfb25e437dfea8fd4f4"</span>), <span class="string">"name"</span> : <span class="string">"Gal Gadot"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">28</span>, <span class="string">"salary"</span> : <span class="number">11050</span> &#125;  </span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453d8525e437dfea8fd4f5"</span>), <span class="string">"name"</span> : <span class="string">"Mikie Hara"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">26</span>, <span class="string">"salary"</span> : <span class="number">7050</span> &#125;  </span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453e2125e437dfea8fd4f6"</span>), <span class="string">"name"</span> : <span class="string">"Wentworth Earl Miller"</span>, <span class="string">"gender"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">41</span>, <span class="string">"salary"</span> : <span class="number">33000</span> &#125;  </span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52454155d8947fb70d000000"</span>), <span class="string">"name"</span> : <span class="string">"not known"</span>, <span class="string">"sex_orientation"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">13</span>, <span class="string">"salary"</span> : <span class="number">30000</span> &#125;  </span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"524562d681c83a5bf26fc286"</span>), <span class="string">"gender"</span> : <span class="string">"female1"</span>, <span class="string">"salary"</span> : <span class="number">50</span> &#125;  </span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"524563e881c83a5bf26fc287"</span>), <span class="string">"gender"</span> : <span class="string">"x"</span> &#125;  </span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"5245648081c83a5bf26fc288"</span>), <span class="string">"gender"</span> : <span class="string">"x"</span> &#125;  </span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"5245648e81c83a5bf26fc289"</span>), <span class="string">"age"</span> : <span class="string">"x"</span> &#125;  </span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"524564c181c83a5bf26fc28a"</span>), <span class="string">"age"</span> : <span class="string">"x"</span>, <span class="string">"gender"</span> : <span class="number">4</span> &#125;</span><br></pre></td></tr></table></figure><p>5.2.5 åˆ©ç”¨æ­£åˆ™è¡¨è¾¾å¼çš„æŸ¥è¯¢<br><code>æŸ¥è¯¢åå­—ä¸­å«æœ‰å­—æ¯Eçš„è®°å½•(iè¡¨ç¤ºå¿½ç•¥å¤§å°å†™)</code></p><blockquote><p>db.user.find({name:/E/i})  </p></blockquote><p><code>ä¹Ÿå¯ä»¥ç”¨ï¼š</code>  </p><blockquote><p>db.user.find({name:{$regex:â€™Eâ€™,$options:â€™iâ€™}})  </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453d8525e437dfea8fd4f5"</span>), <span class="string">"age"</span> : <span class="number">26</span>, <span class="string">"ex"</span> : <span class="string">"barrymore"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"name"</span> : <span class="string">"Mikie Hara"</span>, <span class="string">"salary"</span> : <span class="number">7050</span> &#125;  </span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453e2125e437dfea8fd4f6"</span>), <span class="string">"age"</span> : <span class="number">41</span>, <span class="string">"ex"</span> : <span class="string">"barrymore"</span>, <span class="string">"gender"</span> : <span class="string">"male"</span>, <span class="string">"name"</span> : <span class="string">"Wentworth Earl Miller"</span>, <span class="string">"salary"</span> : <span class="number">33000</span> &#125;</span><br></pre></td></tr></table></figure><p><code>æŸ¥è¯¢åå­—ä¸­å«æœ‰å­—æ¯Eçš„è®°å½•(é»˜è®¤åŒºåˆ†å¤§å°å†™)</code></p><blockquote><p>db.user.find({name:/E/})  </p></blockquote><p><code>ç­‰ä»·äºï¼š</code>  </p><blockquote><p>db.user.find({name:{$regex:â€™Eâ€™}})  </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453e2125e437dfea8fd4f6"</span>), <span class="string">"age"</span> : <span class="number">41</span>, <span class="string">"ex"</span> : <span class="string">"barrymore"</span>, <span class="string">"gender"</span> : <span class="string">"male"</span>, <span class="string">"name"</span> : <span class="string">"Wentworth Earl Miller"</span>, <span class="string">"salary"</span> : <span class="number">33000</span> &#125;</span><br></pre></td></tr></table></figure><p><code>æŸ¥è¯¢æŸä¸ªå­—æ®µä»¥â€œ.0â€ç»“å°¾çš„è®°å½•</code></p><blockquote><p>db.user.find(name:/.0$/)  </p></blockquote><p><strong>è¿™é‡Œçš„â€//â€œä¸­çš„å†…å®¹è¡¨ç¤ºæ˜¯æ­£åˆ™è¡¨è¾¾å¼ï¼Œâ€.â€éœ€è¦è½¬ä¹‰ï¼Œâ€$â€ç¬¦å·è¡¨ç¤ºç»“å°¾</strong></p><p>5.3 æŸ¥æ‰¾ç¬¦åˆæ¡ä»¶çš„ç¬¬ä¸€æ¡è®°å½•</p><blockquote><p>db.user.findOne({$or:[{salary:{$gt:10000}},<br>{age:{$lt:25}}]})  </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;  </span><br><span class="line">    <span class="string">"_id"</span> : ObjectId(<span class="string">"52442736d8947fb501000001"</span>),  </span><br><span class="line">    <span class="string">"name"</span> : <span class="string">"lfqy"</span>,  </span><br><span class="line">    <span class="string">"gender"</span> : <span class="string">"male"</span>,  </span><br><span class="line">    <span class="string">"age"</span> : <span class="number">23</span>,  </span><br><span class="line">    <span class="string">"salary"</span> : <span class="number">15</span>  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>5.4 æŸ¥è¯¢è®°å½•çš„æŒ‡å®šå­—æ®µ</p><p><code>æŸ¥è¯¢useré›†åˆä¸­æ‰€æœ‰è®°å½•çš„name,age,salary,sex_orientationå­—æ®µ</code></p><blockquote><p>db.user.find({},{name:1,age:1,salary:1,sex_orientation:true})  </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52442736d8947fb501000001"</span>), <span class="string">"name"</span> : <span class="string">"lfqy"</span>, <span class="string">"age"</span> : <span class="number">23</span>, <span class="string">"salary"</span> : <span class="number">15</span> &#125;  </span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453cfb25e437dfea8fd4f4"</span>), <span class="string">"name"</span> : <span class="string">"Gal Gadot"</span>, <span class="string">"age"</span> : <span class="number">28</span>, <span class="string">"salary"</span> : <span class="number">11000</span> &#125;  </span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453d8525e437dfea8fd4f5"</span>), <span class="string">"name"</span> : <span class="string">"Mikie Hara"</span>, <span class="string">"age"</span> : <span class="number">26</span>, <span class="string">"salary"</span> : <span class="number">7000</span> &#125;  </span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453e2125e437dfea8fd4f6"</span>), <span class="string">"name"</span> : <span class="string">"Wentworth Earl Miller"</span>, <span class="string">"age"</span> : <span class="number">41</span>, <span class="string">"salary"</span> : <span class="number">33000</span> &#125;  </span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52454155d8947fb70d000000"</span>), <span class="string">"name"</span> : <span class="string">"not known"</span>, <span class="string">"sex_orientation"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">13</span>, <span class="string">"salary"</span> : <span class="number">30000</span> &#125;</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼šè¿™é‡Œçš„1è¡¨ç¤ºæ˜¾ç¤ºæ­¤åˆ—çš„æ„æ€ï¼Œä¹Ÿå¯ä»¥ç”¨trueè¡¨ç¤ºã€‚<br>å¯ä»¥çœ‹åˆ°ï¼Œé»˜è®¤_idï¼Œå­—æ®µéƒ½æ˜¯æ˜¾ç¤ºçš„ã€‚å¦‚æœè¦å…¶ä¸æ˜¾ç¤ºï¼Œåªéœ€å°†å…¶æ˜¾ç¤ºæŒ‡å®šä¸ºfalse:</strong></p><blockquote><p>db.user.find({},{name:1,age:1,salary:1,sex_orientation:true,_id:false})  </p></blockquote><p>5.5 æŸ¥è¯¢æŒ‡å®šå­—æ®µçš„æ•°æ®ï¼Œå¹¶å»é‡</p><p><code>æŸ¥è¯¢genderå­—æ®µçš„æ•°æ®ï¼Œå¹¶å»æ‰é‡å¤æ•°æ®</code></p><blockquote><p>db.user.distinct(â€˜genderâ€™)  </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[ <span class="string">"male"</span>, <span class="string">"female"</span> ]</span><br></pre></td></tr></table></figure><p>5.6 å¯¹æŸ¥è¯¢ç»“æœé›†çš„æ“ä½œ</p><p>5.6.1 pretty print  </p><p><code>ä¸ºäº†æ–¹ä¾¿ï¼Œmongoä¹Ÿæä¾›äº†pretty printå·¥å…·db.collection.pretty()æˆ–è€…æ˜¯db.collection.forEach(printjson)</code></p><blockquote><p>db.user.find().pretty()  </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&#123;  </span><br><span class="line">    <span class="string">"_id"</span> : ObjectId(<span class="string">"52442736d8947fb501000001"</span>),  </span><br><span class="line">    <span class="string">"name"</span> : <span class="string">"lfqy"</span>,  </span><br><span class="line">    <span class="string">"gender"</span> : <span class="string">"male"</span>,  </span><br><span class="line">    <span class="string">"age"</span> : <span class="number">23</span>,  </span><br><span class="line">    <span class="string">"salary"</span> : <span class="number">15</span>  </span><br><span class="line">&#125;  </span><br><span class="line">&#123;  </span><br><span class="line">    <span class="string">"_id"</span> : ObjectId(<span class="string">"52453cfb25e437dfea8fd4f4"</span>),  </span><br><span class="line">    <span class="string">"name"</span> : <span class="string">"Gal Gadot"</span>,  </span><br><span class="line">    <span class="string">"gender"</span> : <span class="string">"female"</span>,  </span><br><span class="line">    <span class="string">"age"</span> : <span class="number">28</span>,  </span><br><span class="line">    <span class="string">"salary"</span> : <span class="number">11000</span>  </span><br><span class="line">&#125;  </span><br><span class="line">&#123;  </span><br><span class="line">    <span class="string">"_id"</span> : ObjectId(<span class="string">"52453d8525e437dfea8fd4f5"</span>),  </span><br><span class="line">    <span class="string">"name"</span> : <span class="string">"Mikie Hara"</span>,  </span><br><span class="line">    <span class="string">"gender"</span> : <span class="string">"female"</span>,  </span><br><span class="line">    <span class="string">"age"</span> : <span class="number">26</span>,  </span><br><span class="line">    <span class="string">"salary"</span> : <span class="number">7000</span>  </span><br><span class="line">&#125;  </span><br><span class="line">&#123;  </span><br><span class="line">    <span class="string">"_id"</span> : ObjectId(<span class="string">"52453e2125e437dfea8fd4f6"</span>),  </span><br><span class="line">    <span class="string">"name"</span> : <span class="string">"Wentworth Earl Miller"</span>,  </span><br><span class="line">    <span class="string">"gender"</span> : <span class="string">"male"</span>,  </span><br><span class="line">    <span class="string">"age"</span> : <span class="number">41</span>,  </span><br><span class="line">    <span class="string">"salary"</span> : <span class="number">33000</span>  </span><br><span class="line">&#125;  </span><br><span class="line">&#123;  </span><br><span class="line">    <span class="string">"_id"</span> : ObjectId(<span class="string">"52454155d8947fb70d000000"</span>),  </span><br><span class="line">    <span class="string">"name"</span> : <span class="string">"not known"</span>,  </span><br><span class="line">    <span class="string">"sex_orientation"</span> : <span class="string">"male"</span>,  </span><br><span class="line">    <span class="string">"age"</span> : <span class="number">13</span>  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>5.6.2 æŒ‡å®šç»“æœé›†æ˜¾ç¤ºçš„æ¡ç›®<br>5.6.2.1 æ˜¾ç¤ºç»“æœé›†ä¸­çš„å‰3æ¡è®°å½•  </p><blockquote><p>db.user.find().limit(3)  </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52442736d8947fb501000001"</span>), <span class="string">"name"</span> : <span class="string">"lfqy"</span>, <span class="string">"gender"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">23</span>, <span class="string">"salary"</span> : <span class="number">15</span> &#125;  </span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453cfb25e437dfea8fd4f4"</span>), <span class="string">"name"</span> : <span class="string">"Gal Gadot"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">28</span>, <span class="string">"salary"</span> : <span class="number">11000</span> &#125;  </span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453d8525e437dfea8fd4f5"</span>), <span class="string">"name"</span> : <span class="string">"Mikie Hara"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">26</span>, <span class="string">"salary"</span> : <span class="number">7000</span> &#125;</span><br></pre></td></tr></table></figure><p>5.6.2.2 æŸ¥è¯¢ç¬¬1æ¡ä»¥åçš„æ‰€æœ‰æ•°æ®  </p><blockquote><p>db.user.find().skip(1)  </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453cfb25e437dfea8fd4f4"</span>), <span class="string">"name"</span> : <span class="string">"Gal Gadot"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">28</span>, <span class="string">"salary"</span> : <span class="number">11000</span> &#125;  </span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453d8525e437dfea8fd4f5"</span>), <span class="string">"name"</span> : <span class="string">"Mikie Hara"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">26</span>, <span class="string">"salary"</span> : <span class="number">7000</span> &#125;  </span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453e2125e437dfea8fd4f6"</span>), <span class="string">"name"</span> : <span class="string">"Wentworth Earl Miller"</span>, <span class="string">"gender"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">41</span>, <span class="string">"salary"</span> : <span class="number">33000</span> &#125;  </span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52454155d8947fb70d000000"</span>), <span class="string">"name"</span> : <span class="string">"not known"</span>, <span class="string">"sex_orientation"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">13</span>, <span class="string">"salary"</span> : <span class="number">30000</span> &#125;</span><br></pre></td></tr></table></figure><p>5.6.2.3 å¯¹ç»“æœé›†æ’åº<br><code>å‡åº</code></p><blockquote><p>db.user.find().sort({salary:1})  </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52442736d8947fb501000001"</span>), <span class="string">"name"</span> : <span class="string">"lfqy"</span>, <span class="string">"gender"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">23</span>, <span class="string">"salary"</span> : <span class="number">15</span> &#125;  </span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453d8525e437dfea8fd4f5"</span>), <span class="string">"name"</span> : <span class="string">"Mikie Hara"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">26</span>, <span class="string">"salary"</span> : <span class="number">7000</span> &#125;  </span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453cfb25e437dfea8fd4f4"</span>), <span class="string">"name"</span> : <span class="string">"Gal Gadot"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">28</span>, <span class="string">"salary"</span> : <span class="number">11000</span> &#125;  </span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52454155d8947fb70d000000"</span>), <span class="string">"name"</span> : <span class="string">"not known"</span>, <span class="string">"sex_orientation"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">13</span>, <span class="string">"salary"</span> : <span class="number">30000</span> &#125;  </span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453e2125e437dfea8fd4f6"</span>), <span class="string">"name"</span> : <span class="string">"Wentworth Earl Miller"</span>, <span class="string">"gender"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">41</span>, <span class="string">"salary"</span> : <span class="number">33000</span> &#125;</span><br></pre></td></tr></table></figure><p><code>é™åº</code></p><blockquote><p>db.user.find().sort({salary:-1})  </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453e2125e437dfea8fd4f6"</span>), <span class="string">"name"</span> : <span class="string">"Wentworth Earl Miller"</span>, <span class="string">"gender"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">41</span>, <span class="string">"salary"</span> : <span class="number">33000</span> &#125;  </span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52454155d8947fb70d000000"</span>), <span class="string">"name"</span> : <span class="string">"not known"</span>, <span class="string">"sex_orientation"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">13</span>, <span class="string">"salary"</span> : <span class="number">30000</span> &#125;  </span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453cfb25e437dfea8fd4f4"</span>), <span class="string">"name"</span> : <span class="string">"Gal Gadot"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">28</span>, <span class="string">"salary"</span> : <span class="number">11000</span> &#125;  </span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453d8525e437dfea8fd4f5"</span>), <span class="string">"name"</span> : <span class="string">"Mikie Hara"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">26</span>, <span class="string">"salary"</span> : <span class="number">7000</span> &#125;  </span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52442736d8947fb501000001"</span>), <span class="string">"name"</span> : <span class="string">"lfqy"</span>, <span class="string">"gender"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">23</span>, <span class="string">"salary"</span> : <span class="number">15</span> &#125;</span><br></pre></td></tr></table></figure><p><code>ä¹Ÿå¯ä»¥å°†æ’åºä¾æ®çš„å­—æ®µï¼Œå†™åœ¨ä¸€ä¸ªlisté‡Œé¢ï¼Œå¦‚ä¸‹ï¼š</code></p><blockquote><p>db.user.find().sort([(â€œsalaryâ€,1),(â€œnameâ€,-1)]) </p></blockquote><p>5.7 ç»Ÿè®¡æŸ¥è¯¢ç»“æœä¸­è®°å½•çš„æ¡æ•°</p><p>5.7.1 ç»Ÿè®¡é›†åˆä¸­çš„æ‰€æœ‰è®°å½•æ¡æ•°  </p><blockquote><p>db.user.find().count()  </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">5</span></span><br></pre></td></tr></table></figure><p>5.7.2 æŸ¥è¯¢ç¬¦åˆæ¡ä»¶çš„è®°å½•æ•°  </p><p><code>æŸ¥è¯¢salaryå°äº4000æˆ–å¤§äº10000çš„è®°å½•æ•°</code></p><blockquote><p>db.user.find({$or: [{salary: {$lt:4000}}, {salary: {$gt:10000}}]}).count()  </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">4</span></span><br></pre></td></tr></table></figure><p>5.8 æŸ¥è¯¢å­˜åœ¨(æˆ–ä¸å­˜åœ¨)æŒ‡å®šå­—æ®µçš„è®°å½•</p><p><code>æŸ¥è¯¢ä¸å­˜åœ¨ageå­—æ®µï¼Œä½†æ˜¯æœ‰genderå­—æ®µï¼Œå¹¶ä¸”exä¸ºbarrymoreçš„è®°å½•</code></p><blockquote><p>db.user.find({â€œageâ€:{$exists:false},â€genderâ€:{$exists:true},â€exâ€:â€barrymoreâ€})  </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"524562d681c83a5bf26fc286"</span>), <span class="string">"ex"</span> : <span class="string">"barrymore"</span>, <span class="string">"gender"</span> : <span class="string">"female1"</span>, <span class="string">"salary"</span> : <span class="number">50</span> &#125;  </span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"524563e881c83a5bf26fc287"</span>), <span class="string">"ex"</span> : <span class="string">"barrymore"</span>, <span class="string">"gender"</span> : <span class="string">"x"</span> &#125;  </span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"5245648081c83a5bf26fc288"</span>), <span class="string">"ex"</span> : <span class="string">"barrymore"</span>, <span class="string">"gender"</span> : <span class="string">"x"</span> &#125;</span><br></pre></td></tr></table></figure><p>6.1 åˆ é™¤æ•´ä¸ªé›†åˆä¸­çš„æ‰€æœ‰æ•°æ®</p><blockquote><p>db.test.insert({name:â€asdfâ€})<br>show collections  </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">book  </span><br><span class="line">system.indexes  </span><br><span class="line">test  </span><br><span class="line">user</span><br></pre></td></tr></table></figure><p><code>åˆ°è¿™é‡Œæ–°å»ºäº†ä¸€ä¸ªé›†åˆï¼Œåä¸ºtestã€‚</code><br><code>åˆ é™¤testä¸­çš„æ‰€æœ‰è®°å½•ã€‚</code></p><blockquote><p>db.test.remove()<br>show collections  </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">book  </span><br><span class="line">system.indexes  </span><br><span class="line">test  </span><br><span class="line">user</span><br></pre></td></tr></table></figure><blockquote><p>db.test.find()</p></blockquote><p><code>å¯è§testä¸­çš„è®°å½•å…¨éƒ¨è¢«åˆ é™¤</code></p><p><strong>æ³¨æ„db.collection.remove()å’Œdrop()çš„åŒºåˆ«ï¼Œremove()åªæ˜¯åˆ é™¤äº†é›†åˆä¸­æ‰€æœ‰çš„è®°å½•ï¼Œè€Œé›†åˆä¸­åŸæœ‰çš„ç´¢å¼•ç­‰ä¿¡æ¯è¿˜åœ¨ï¼Œè€Œdrop()åˆ™æŠŠé›†åˆç›¸å…³ä¿¡æ¯æ•´ä¸ªåˆ é™¤(åŒ…æ‹¬ç´¢å¼•)</strong></p><p>6.2 åˆ é™¤é›†åˆä¸­ç¬¦åˆæ¡ä»¶çš„æ‰€æœ‰è®°å½•</p><blockquote><p>db.user.remove({name:â€™lfqyâ€™})</p></blockquote><blockquote><p>db.user.find()</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453cfb25e437dfea8fd4f4"</span>), <span class="string">"name"</span> : <span class="string">"Gal Gadot"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">28</span>, <span class="string">"salary"</span> : <span class="number">11000</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453d8525e437dfea8fd4f5"</span>), <span class="string">"name"</span> : <span class="string">"Mikie Hara"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">26</span>, <span class="string">"salary"</span> : <span class="number">7000</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453e2125e437dfea8fd4f6"</span>), <span class="string">"name"</span> : <span class="string">"Wentworth Earl Miller"</span>, <span class="string">"gender"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">41</span>, <span class="string">"salary"</span> : <span class="number">33000</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52454155d8947fb70d000000"</span>), <span class="string">"name"</span> : <span class="string">"not known"</span>, <span class="string">"sex_orientation"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">13</span>, <span class="string">"salary"</span> : <span class="number">30000</span> &#125;</span><br></pre></td></tr></table></figure><blockquote><p>db.user.find()<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453cfb25e437dfea8fd4f4"</span>), <span class="string">"name"</span> : <span class="string">"Gal Gadot"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">28</span>, <span class="string">"salary"</span> : <span class="number">11000</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453d8525e437dfea8fd4f5"</span>), <span class="string">"name"</span> : <span class="string">"Mikie Hara"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">26</span>, <span class="string">"salary"</span> : <span class="number">7000</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453e2125e437dfea8fd4f6"</span>), <span class="string">"name"</span> : <span class="string">"Wentworth Earl Miller"</span>, <span class="string">"gender"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">41</span>, <span class="string">"salary"</span> : <span class="number">33000</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52454155d8947fb70d000000"</span>), <span class="string">"name"</span> : <span class="string">"not known"</span>, <span class="string">"sex_orientation"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">13</span>, <span class="string">"salary"</span> : <span class="number">30000</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52455cc825e437dfea8fd4f8"</span>), <span class="string">"name"</span> : <span class="string">"2"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">28</span>, <span class="string">"salary"</span> : <span class="number">2</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52455d8a25e437dfea8fd4fa"</span>), <span class="string">"name"</span> : <span class="string">"1"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">28</span>, <span class="string">"salary"</span> : <span class="number">1</span> &#125;</span><br></pre></td></tr></table></figure></p></blockquote><blockquote><p>db.user.remove( {salary :{$lt:10}})<br>db.user.find()</p></blockquote><figure class="highlight plain"><figcaption><span>"_id" : ObjectId("52453cfb25e437dfea8fd4f4"), "name" : "Gal Gadot", "gender" : "female", "age" : 28, "salary" : 11000 &#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123; &quot;_id&quot; : ObjectId(&quot;52453d8525e437dfea8fd4f5&quot;), &quot;name&quot; : &quot;Mikie Hara&quot;, &quot;gender&quot; : &quot;female&quot;, &quot;age&quot; : 26, &quot;salary&quot; : 7000 &#125;</span><br><span class="line">&#123; &quot;_id&quot; : ObjectId(&quot;52453e2125e437dfea8fd4f6&quot;), &quot;name&quot; : &quot;Wentworth Earl Miller&quot;, &quot;gender&quot; : &quot;male&quot;, &quot;age&quot; : 41, &quot;salary&quot; : 33000 &#125;</span><br><span class="line">&#123; &quot;_id&quot; : ObjectId(&quot;52454155d8947fb70d000000&quot;), &quot;name&quot; : &quot;not known&quot;, &quot;sex_orientation&quot; : &quot;male&quot;, &quot;age&quot; : 13, &quot;salary&quot; : 30000 &#125;</span><br></pre></td></tr></table></figure><p>6.3  åˆ é™¤é›†åˆä¸­ç¬¦åˆæ¡ä»¶çš„ä¸€æ¡è®°å½•</p><blockquote><p>db.user.find()</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453cfb25e437dfea8fd4f4"</span>), <span class="string">"name"</span> : <span class="string">"Gal Gadot"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">28</span>, <span class="string">"salary"</span> : <span class="number">11000</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453d8525e437dfea8fd4f5"</span>), <span class="string">"name"</span> : <span class="string">"Mikie Hara"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">26</span>, <span class="string">"salary"</span> : <span class="number">7000</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453e2125e437dfea8fd4f6"</span>), <span class="string">"name"</span> : <span class="string">"Wentworth Earl Miller"</span>, <span class="string">"gender"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">41</span>, <span class="string">"salary"</span> : <span class="number">33000</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52454155d8947fb70d000000"</span>), <span class="string">"name"</span> : <span class="string">"not known"</span>, <span class="string">"sex_orientation"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">13</span>, <span class="string">"salary"</span> : <span class="number">30000</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52455de325e437dfea8fd4fb"</span>), <span class="string">"name"</span> : <span class="string">"1"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">28</span>, <span class="string">"salary"</span> : <span class="number">1</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52455de925e437dfea8fd4fc"</span>), <span class="string">"name"</span> : <span class="string">"2"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">28</span>, <span class="string">"salary"</span> : <span class="number">2</span> &#125;</span><br></pre></td></tr></table></figure><blockquote><p>db.user.remove({salary :{$lt:10}},1)<br>db.user.find()</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453cfb25e437dfea8fd4f4"</span>), <span class="string">"name"</span> : <span class="string">"Gal Gadot"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">28</span>, <span class="string">"salary"</span> : <span class="number">11000</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453d8525e437dfea8fd4f5"</span>), <span class="string">"name"</span> : <span class="string">"Mikie Hara"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">26</span>, <span class="string">"salary"</span> : <span class="number">7000</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453e2125e437dfea8fd4f6"</span>), <span class="string">"name"</span> : <span class="string">"Wentworth Earl Miller"</span>, <span class="string">"gender"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">41</span>, <span class="string">"salary"</span> : <span class="number">33000</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52454155d8947fb70d000000"</span>), <span class="string">"name"</span> : <span class="string">"not known"</span>, <span class="string">"sex_orientation"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">13</span>, <span class="string">"salary"</span> : <span class="number">30000</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52455de925e437dfea8fd4fc"</span>), <span class="string">"name"</span> : <span class="string">"2"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">28</span>, <span class="string">"salary"</span> : <span class="number">2</span> &#125;</span><br></pre></td></tr></table></figure><p><code>å½“ç„¶ï¼Œä¹Ÿå¯ä»¥æ˜¯db.user.remove({salary :{$lt:10}},true)</code></p><p>7 æ›´æ–°æ“ä½œ<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">db.collection.update(æŸ¥è¯¢æ¡ä»¶, </span><br><span class="line">æ›´æ–°å†…å®¹,</span><br><span class="line">[é»˜è®¤æ˜¯<span class="literal">false</span>ï¼Œä¸å­˜åœ¨updateçš„è®°å½•,ä¸æ’å…¥,<span class="literal">true</span>ä¸ºæ’å…¥], </span><br><span class="line">[é»˜è®¤<span class="literal">false</span>,åªæ›´æ–°æ‰¾åˆ°çš„ç¬¬ä¸€æ¡è®°å½•ï¼Œå¦‚æœè¿™ä¸ªå‚æ•°ä¸º<span class="literal">true</span>,å°±æŠŠæŒ‰æ¡ä»¶æŸ¥å‡ºæ¥å¤šæ¡è®°å½•å…¨éƒ¨æ›´æ–°ã€‚] )</span><br></pre></td></tr></table></figure></p><p>7.1 èµ‹å€¼æ›´æ–°</p><blockquote><p>db.user.find()</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453cfb25e437dfea8fd4f4"</span>), <span class="string">"name"</span> : <span class="string">"Gal Gadot"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">28</span>, <span class="string">"salary"</span> : <span class="number">11000</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453d8525e437dfea8fd4f5"</span>), <span class="string">"name"</span> : <span class="string">"Mikie Hara"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">26</span>, <span class="string">"salary"</span> : <span class="number">7000</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453e2125e437dfea8fd4f6"</span>), <span class="string">"name"</span> : <span class="string">"Wentworth Earl Miller"</span>, <span class="string">"gender"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">41</span>, <span class="string">"salary"</span> : <span class="number">33000</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52454155d8947fb70d000000"</span>), <span class="string">"name"</span> : <span class="string">"not known"</span>, <span class="string">"sex_orientation"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">13</span>, <span class="string">"salary"</span> : <span class="number">30000</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52455f8925e437dfea8fd4fd"</span>), <span class="string">"name"</span> : <span class="string">"lfqy"</span>, <span class="string">"gender"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">28</span>, <span class="string">"salary"</span> : <span class="number">1</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"5245607525e437dfea8fd4fe"</span>), <span class="string">"name"</span> : <span class="string">"lfqy"</span>, <span class="string">"gender"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">28</span>, <span class="string">"salary"</span> : <span class="number">2</span> &#125;</span><br></pre></td></tr></table></figure><blockquote><p>db.user.update({name:â€™lfqyâ€™},{$set:{age:23}},false,true)<br>db.user.find()</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453cfb25e437dfea8fd4f4"</span>), <span class="string">"name"</span> : <span class="string">"Gal Gadot"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">28</span>, <span class="string">"salary"</span> : <span class="number">11000</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453d8525e437dfea8fd4f5"</span>), <span class="string">"name"</span> : <span class="string">"Mikie Hara"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">26</span>, <span class="string">"salary"</span> : <span class="number">7000</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453e2125e437dfea8fd4f6"</span>), <span class="string">"name"</span> : <span class="string">"Wentworth Earl Miller"</span>, <span class="string">"gender"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">41</span>, <span class="string">"salary"</span> : <span class="number">33000</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52454155d8947fb70d000000"</span>), <span class="string">"name"</span> : <span class="string">"not known"</span>, <span class="string">"sex_orientation"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">13</span>, <span class="string">"salary"</span> : <span class="number">30000</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52455f8925e437dfea8fd4fd"</span>), <span class="string">"name"</span> : <span class="string">"lfqy"</span>, <span class="string">"gender"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">23</span>, <span class="string">"salary"</span> : <span class="number">1</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"5245607525e437dfea8fd4fe"</span>), <span class="string">"name"</span> : <span class="string">"lfqy"</span>, <span class="string">"gender"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">23</span>, <span class="string">"salary"</span> : <span class="number">2</span> &#125;</span><br><span class="line">db.user.find()</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453cfb25e437dfea8fd4f4"</span>), <span class="string">"name"</span> : <span class="string">"Gal Gadot"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">28</span>, <span class="string">"salary"</span> : <span class="number">11000</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453d8525e437dfea8fd4f5"</span>), <span class="string">"name"</span> : <span class="string">"Mikie Hara"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">26</span>, <span class="string">"salary"</span> : <span class="number">7000</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453e2125e437dfea8fd4f6"</span>), <span class="string">"name"</span> : <span class="string">"Wentworth Earl Miller"</span>, <span class="string">"gender"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">41</span>, <span class="string">"salary"</span> : <span class="number">33000</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52454155d8947fb70d000000"</span>), <span class="string">"name"</span> : <span class="string">"not known"</span>, <span class="string">"sex_orientation"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">13</span>, <span class="string">"salary"</span> : <span class="number">30000</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52455f8925e437dfea8fd4fd"</span>), <span class="string">"name"</span> : <span class="string">"lfqy"</span>, <span class="string">"gender"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">23</span>, <span class="string">"salary"</span> : <span class="number">1</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"5245607525e437dfea8fd4fe"</span>), <span class="string">"name"</span> : <span class="string">"lfqy"</span>, <span class="string">"gender"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">23</span>, <span class="string">"salary"</span> : <span class="number">2</span> &#125;</span><br></pre></td></tr></table></figure><blockquote><p>db.user.update({name:â€™lfqy1â€™},{$set:{age:23}},true,true)<br>db.user.find()</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453cfb25e437dfea8fd4f4"</span>), <span class="string">"name"</span> : <span class="string">"Gal Gadot"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">28</span>, <span class="string">"salary"</span> : <span class="number">11000</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453d8525e437dfea8fd4f5"</span>), <span class="string">"name"</span> : <span class="string">"Mikie Hara"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">26</span>, <span class="string">"salary"</span> : <span class="number">7000</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453e2125e437dfea8fd4f6"</span>), <span class="string">"name"</span> : <span class="string">"Wentworth Earl Miller"</span>, <span class="string">"gender"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">41</span>, <span class="string">"salary"</span> : <span class="number">33000</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52454155d8947fb70d000000"</span>), <span class="string">"name"</span> : <span class="string">"not known"</span>, <span class="string">"sex_orientation"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">13</span>, <span class="string">"salary"</span> : <span class="number">30000</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52455f8925e437dfea8fd4fd"</span>), <span class="string">"name"</span> : <span class="string">"lfqy"</span>, <span class="string">"gender"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">23</span>, <span class="string">"salary"</span> : <span class="number">1</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"5245607525e437dfea8fd4fe"</span>), <span class="string">"name"</span> : <span class="string">"lfqy"</span>, <span class="string">"gender"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">23</span>, <span class="string">"salary"</span> : <span class="number">2</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"5245610881c83a5bf26fc285"</span>), <span class="string">"age"</span> : <span class="number">23</span>, <span class="string">"name"</span> : <span class="string">"lfqy1"</span> &#125;</span><br></pre></td></tr></table></figure><blockquote><p>db.user.update({name:â€™lfqyâ€™},{$set:{interest:â€NBAâ€}},false,true)<br>db.user.find()</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453cfb25e437dfea8fd4f4"</span>), <span class="string">"name"</span> : <span class="string">"Gal Gadot"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">28</span>, <span class="string">"salary"</span> : <span class="number">11000</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453d8525e437dfea8fd4f5"</span>), <span class="string">"name"</span> : <span class="string">"Mikie Hara"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">26</span>, <span class="string">"salary"</span> : <span class="number">7000</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453e2125e437dfea8fd4f6"</span>), <span class="string">"name"</span> : <span class="string">"Wentworth Earl Miller"</span>, <span class="string">"gender"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">41</span>, <span class="string">"salary"</span> : <span class="number">33000</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52454155d8947fb70d000000"</span>), <span class="string">"name"</span> : <span class="string">"not known"</span>, <span class="string">"sex_orientation"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">13</span>, <span class="string">"salary"</span> : <span class="number">30000</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"5245610881c83a5bf26fc285"</span>), <span class="string">"age"</span> : <span class="number">23</span>, <span class="string">"name"</span> : <span class="string">"lfqy1"</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52455f8925e437dfea8fd4fd"</span>), <span class="string">"age"</span> : <span class="number">23</span>, <span class="string">"gender"</span> : <span class="string">"male"</span>, <span class="string">"interest"</span> : <span class="string">"NBA"</span>, <span class="string">"name"</span> : <span class="string">"lfqy"</span>, <span class="string">"salary"</span> : <span class="number">1</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"5245607525e437dfea8fd4fe"</span>), <span class="string">"age"</span> : <span class="number">23</span>, <span class="string">"gender"</span> : <span class="string">"male"</span>, <span class="string">"interest"</span> : <span class="string">"NBA"</span>, <span class="string">"name"</span> : <span class="string">"lfqy"</span>, <span class="string">"salary"</span> : <span class="number">2</span> &#125;</span><br></pre></td></tr></table></figure><p>7.2 å¢å€¼æ›´æ–°</p><blockquote><p>db.user.find()</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453cfb25e437dfea8fd4f4"</span>), <span class="string">"name"</span> : <span class="string">"Gal Gadot"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">28</span>, <span class="string">"salary"</span> : <span class="number">11000</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453d8525e437dfea8fd4f5"</span>), <span class="string">"name"</span> : <span class="string">"Mikie Hara"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">26</span>, <span class="string">"salary"</span> : <span class="number">7000</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453e2125e437dfea8fd4f6"</span>), <span class="string">"name"</span> : <span class="string">"Wentworth Earl Miller"</span>, <span class="string">"gender"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">41</span>, <span class="string">"salary"</span> : <span class="number">33000</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52454155d8947fb70d000000"</span>), <span class="string">"name"</span> : <span class="string">"not known"</span>, <span class="string">"sex_orientation"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">13</span>, <span class="string">"salary"</span> : <span class="number">30000</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"5245610881c83a5bf26fc285"</span>), <span class="string">"age"</span> : <span class="number">23</span>, <span class="string">"name"</span> : <span class="string">"lfqy1"</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52455f8925e437dfea8fd4fd"</span>), <span class="string">"age"</span> : <span class="number">23</span>, <span class="string">"gender"</span> : <span class="string">"male"</span>, <span class="string">"interest"</span> : <span class="string">"NBA"</span>, <span class="string">"name"</span> : <span class="string">"lfqy"</span>, <span class="string">"salary"</span> : <span class="number">1</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"5245607525e437dfea8fd4fe"</span>), <span class="string">"age"</span> : <span class="number">23</span>, <span class="string">"gender"</span> : <span class="string">"male"</span>, <span class="string">"interest"</span> : <span class="string">"NBA"</span>, <span class="string">"name"</span> : <span class="string">"lfqy"</span>, <span class="string">"salary"</span> : <span class="number">2</span> &#125;</span><br></pre></td></tr></table></figure><blockquote><p>db.user.update({gender:â€™femaleâ€™},{$inc:{salary:50}},false,true)<br>db.user.find()</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453cfb25e437dfea8fd4f4"</span>), <span class="string">"name"</span> : <span class="string">"Gal Gadot"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">28</span>, <span class="string">"salary"</span> : <span class="number">11050</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453d8525e437dfea8fd4f5"</span>), <span class="string">"name"</span> : <span class="string">"Mikie Hara"</span>, <span class="string">"gender"</span> : <span class="string">"female"</span>, <span class="string">"age"</span> : <span class="number">26</span>, <span class="string">"salary"</span> : <span class="number">7050</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52453e2125e437dfea8fd4f6"</span>), <span class="string">"name"</span> : <span class="string">"Wentworth Earl Miller"</span>, <span class="string">"gender"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">41</span>, <span class="string">"salary"</span> : <span class="number">33000</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52454155d8947fb70d000000"</span>), <span class="string">"name"</span> : <span class="string">"not known"</span>, <span class="string">"sex_orientation"</span> : <span class="string">"male"</span>, <span class="string">"age"</span> : <span class="number">13</span>, <span class="string">"salary"</span> : <span class="number">30000</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"5245610881c83a5bf26fc285"</span>), <span class="string">"age"</span> : <span class="number">23</span>, <span class="string">"name"</span> : <span class="string">"lfqy1"</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"52455f8925e437dfea8fd4fd"</span>), <span class="string">"age"</span> : <span class="number">23</span>, <span class="string">"gender"</span> : <span class="string">"male"</span>, <span class="string">"interest"</span> : <span class="string">"NBA"</span>, <span class="string">"name"</span> : <span class="string">"lfqy"</span>, <span class="string">"salary"</span> : <span class="number">1</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : ObjectId(<span class="string">"5245607525e437dfea8fd4fe"</span>), <span class="string">"age"</span> : <span class="number">23</span>, <span class="string">"gender"</span> : <span class="string">"male"</span>, <span class="string">"interest"</span> : <span class="string">"NBA"</span>, <span class="string">"name"</span> : <span class="string">"lfqy"</span>, <span class="string">"salary"</span> : <span class="number">2</span> &#125;</span><br></pre></td></tr></table></figure><p>å…³äºæ›´æ–°æ“ä½œï¼ˆdb.collection.update(criteria, objNew, upsert, multi )ï¼‰ï¼Œè¦è¯´æ˜çš„æ˜¯ï¼Œå¦‚æœupsertä¸ºtrueï¼Œé‚£ä¹ˆåœ¨æ²¡æœ‰æ‰¾åˆ°ç¬¦åˆæ›´æ–°æ¡ä»¶çš„æƒ…å†µä¸‹ï¼Œmongoä¼šåœ¨é›†åˆä¸­æ’å…¥ä¸€æ¡è®°å½•å…¶å€¼æ»¡è¶³æ›´æ–°æ¡ä»¶çš„è®°å½•(å…¶ä¸­çš„å­—æ®µåªæœ‰æ›´æ–°æ¡ä»¶ä¸­æ¶‰åŠçš„å­—æ®µï¼Œå­—æ®µçš„å€¼æ»¡è¶³æ›´æ–°æ¡ä»¶)ï¼Œç„¶åå°†å…¶æ›´æ–°ï¼ˆæ³¨æ„ï¼Œå¦‚æœæ›´æ–°æ¡ä»¶æ˜¯$ltè¿™ç§ä¸ç­‰å¼æ¡ä»¶ï¼Œé‚£ä¹ˆupsertæ’å…¥çš„è®°å½•åªä¼šåŒ…å«æ›´æ–°æ“ä½œæ¶‰åŠçš„å­—æ®µï¼Œè€Œä¸ä¼šæœ‰æ›´æ–°æ¡ä»¶ä¸­çš„å­—æ®µã€‚è¿™ä¹Ÿå¾ˆå¥½ç†è§£ï¼Œå› ä¸ºæ²¡æ³•ä¸ºè¿™ç§å­—æ®µå®šå€¼ï¼Œmongoç´¢æ€§å°±ä¸å–è¿™äº›å­—æ®µï¼‰ã€‚å¦‚æœç¬¦åˆæ¡ä»¶çš„è®°å½•ä¸­æ²¡æœ‰è¦æ›´æ–°çš„å­—æ®µï¼Œé‚£ä¹ˆmongoä¼šä¸ºå…¶åˆ›å»ºè¯¥å­—æ®µï¼Œå¹¶æ›´æ–°ã€‚</p><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><ul><li><a href="http://blog.csdn.net/xia7139/article/details/12570569" target="_blank" rel="noopener">http://blog.csdn.net/xia7139/article/details/12570569</a></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> mongodb </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åœ¨sailsä¸­ä½¿ç”¨gulpä»£æ›¿gruntä¸ªäººæ€»ç»“</title>
      <link href="/2015/08/16/%E5%9C%A8sails%E4%B8%AD%E4%BD%BF%E7%94%A8gulp%E4%BB%A3%E6%9B%BFgrunt%E4%B8%AA%E4%BA%BA%E6%80%BB%E7%BB%93/"/>
      <url>/2015/08/16/%E5%9C%A8sails%E4%B8%AD%E4%BD%BF%E7%94%A8gulp%E4%BB%A3%E6%9B%BFgrunt%E4%B8%AA%E4%BA%BA%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<p>gruntçš„é€Ÿåº¦å¤ªæ…¢,å°è¯•ä½¿ç”¨gulpæ›¿æ¢gruntçš„ä½¿ç”¨è®°å½•<br><a id="more"></a></p><h1 id="åœ¨sailsä¸­ä½¿ç”¨gulpä»£æ›¿grunt"><a href="#åœ¨sailsä¸­ä½¿ç”¨gulpä»£æ›¿grunt" class="headerlink" title="åœ¨sailsä¸­ä½¿ç”¨gulpä»£æ›¿grunt"></a>åœ¨sailsä¸­ä½¿ç”¨gulpä»£æ›¿grunt</h1><h2 id="ç°æˆçš„ä¾èµ–åŒ…-https-github-com-Karnith-sails-generate-new-gulp"><a href="#ç°æˆçš„ä¾èµ–åŒ…-https-github-com-Karnith-sails-generate-new-gulp" class="headerlink" title="ç°æˆçš„ä¾èµ–åŒ…: https://github.com/Karnith/sails-generate-new-gulp"></a>ç°æˆçš„ä¾èµ–åŒ…: <a href="https://github.com/Karnith/sails-generate-new-gulp" target="_blank" rel="noopener">https://github.com/Karnith/sails-generate-new-gulp</a></h2><ul><li>é¦–å…ˆå®‰è£…ä¾èµ–é¡¹</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">npm install -g sails-generate-backend-gulp</span><br><span class="line">npm install -g sails-generate-gulpfile</span><br><span class="line">npm install -g sails-generate-frontend-gulp</span><br><span class="line">npm install -g sails-generate-new-gulp</span><br></pre></td></tr></table></figure><ul><li>åœ¨å·¥ä½œç›®å½•ä¸‹æ·»åŠ æ–‡ä»¶ <code>.sailsrc</code></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;generators&quot;: &#123;</span><br><span class="line">        &quot;modules&quot;: &#123;</span><br><span class="line">            &quot;new&quot;: &quot;sails-generate-new-gulp&quot;,</span><br><span class="line">            &quot;frontend&quot;: &quot;sails-generate-frontend-gulp&quot;,</span><br><span class="line">            &quot;backend&quot;: &quot;sails-generate-backend-gulp&quot;,</span><br><span class="line">            &quot;gulpfile&quot;: &quot;sails-generate-gulpfile&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>åœ¨ä¸Šé¢çš„å·¥ä½œç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåŸºäºgulpçš„sailsé¡¹ç›®</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sails new &lt;project name&gt;</span><br></pre></td></tr></table></figure><p><strong>æ¯”åŸæ¥çš„sails_grunté¡¹ç›®,å¤šå‡ºäº†æ–‡ä»¶ <code>api/hooks/gulp/index.js</code>(ç”¨äº sails liftæ—¶ä½¿ç”¨gulpä½œä¸ºé»˜è®¤),ä¿®æ”¹äº† <code>.sailsrc</code> å’Œ <code>package.json</code></strong></p><h2 id="æˆ‘çš„ä¸€äº›ä¿®æ”¹å’Œæ·»åŠ "><a href="#æˆ‘çš„ä¸€äº›ä¿®æ”¹å’Œæ·»åŠ " class="headerlink" title="æˆ‘çš„ä¸€äº›ä¿®æ”¹å’Œæ·»åŠ "></a>æˆ‘çš„ä¸€äº›ä¿®æ”¹å’Œæ·»åŠ </h2><h3 id="ä½¿ç”¨-del-æ¥åˆ é™¤æ–‡ä»¶-æ–‡ä»¶å¤¹"><a href="#ä½¿ç”¨-del-æ¥åˆ é™¤æ–‡ä»¶-æ–‡ä»¶å¤¹" class="headerlink" title="ä½¿ç”¨ del æ¥åˆ é™¤æ–‡ä»¶/æ–‡ä»¶å¤¹"></a>ä½¿ç”¨ <code>del</code> æ¥åˆ é™¤æ–‡ä»¶/æ–‡ä»¶å¤¹</h3><p><code>npm install --save-dev del</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨ tasks/config ä¸‹ ä¿®æ”¹ clean.jsæ–‡ä»¶</span></span><br><span class="line"><span class="keyword">var</span> del = <span class="built_in">require</span>(<span class="string">'del'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span>(<span class="params">gulp, plugins, growl</span>) </span>&#123;</span><br><span class="line">  gulp.task(<span class="string">'clean:dev'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">cb</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> del([<span class="string">'.tmp/public/**/*'</span>], cb);     <span class="comment">// æ”¹æˆä½ çš„è·¯å¾„</span></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  gulp.task(<span class="string">'clean:build'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">cb</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> del([<span class="string">'deployment/**/*'</span>], cb);     <span class="comment">// æ”¹æˆä½ çš„è·¯å¾„</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="html2js"><a href="#html2js" class="headerlink" title="html2js"></a>html2js</h3><p><code>npm install --save-dev gulp-html2js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨ tasks/config ä¸‹ æ–°å»º html2js.jsæ–‡ä»¶</span></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span>(<span class="params">gulp, plugins, growl</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  gulp.task(<span class="string">'html2jsfrontend'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.src([<span class="string">'assets/frontend/**/*.html'</span>])  <span class="comment">// è·¯å¾„éœ€è¦ä¿®æ”¹</span></span><br><span class="line">      .pipe(plugins.html2js(&#123;</span><br><span class="line">        outputModuleName: <span class="string">'Frontend'</span>,               <span class="comment">// éœ€è¦ä¿®æ”¹</span></span><br><span class="line">        base: <span class="string">'assets/'</span>,</span><br><span class="line">        useStrict: <span class="literal">true</span></span><br><span class="line">      &#125;))</span><br><span class="line">      .pipe(plugins.concat(<span class="string">'template-frontend.js'</span>))  <span class="comment">// ç”Ÿæˆçš„æ–‡ä»¶å</span></span><br><span class="line">      .pipe(gulp.dest(<span class="string">'.tmp/public/frontend/'</span>));     <span class="comment">// destçš„ç›®å½•</span></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  gulp.task(<span class="string">'html2jsapp'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.src([<span class="string">'assets/app/**/*.html'</span>])       <span class="comment">// è·¯å¾„éœ€è¦ä¿®æ”¹</span></span><br><span class="line">      .pipe(plugins.html2js(&#123;</span><br><span class="line">        outputModuleName: <span class="string">'App'</span>,            <span class="comment">// éœ€è¦ä¿®æ”¹</span></span><br><span class="line">        base: <span class="string">'assets/'</span>,</span><br><span class="line">        useStrict: <span class="literal">true</span></span><br><span class="line">      &#125;))</span><br><span class="line">      .pipe(plugins.concat(<span class="string">'template-app.js'</span>))</span><br><span class="line">      .pipe(gulp.dest(<span class="string">'.tmp/public/app'</span>));</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  gulp.task(<span class="string">'html2js'</span>, [<span class="string">'html2jsfrontend'</span>, <span class="string">'html2jsapp'</span>]);  <span class="comment">// ä¹‹æ‰€ä»¥è¿™æ ·å†™,æ˜¯å› ä¸ºgulpæ­£ç¡®çš„å®ç°å¼‚æ­¥ï¼šæ¥æ”¶ä¸€ä¸ªå›è°ƒå‡½æ•°æˆ–è€…è¿”å›ä¸€ä¸ª promise å¯¹è±¡æˆ–è€…äº‹ä»¶æµï¼ˆevent streamï¼‰</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="æ·»åŠ jshint"><a href="#æ·»åŠ jshint" class="headerlink" title="æ·»åŠ jshint"></a>æ·»åŠ jshint</h3><p><code>npm install --save-dev map-stream gulp-jshint</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨ tasks/config ä¸‹ æ–°å»º jshint.jsæ–‡ä»¶</span></span><br><span class="line"><span class="keyword">var</span> map = <span class="built_in">require</span>(<span class="string">'map-stream'</span>),</span><br><span class="line">  events = <span class="built_in">require</span>(<span class="string">'events'</span>),</span><br><span class="line">  emmitter = <span class="keyword">new</span> events.EventEmitter(),</span><br><span class="line">  path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> jsHintErrorReporter = <span class="function"><span class="keyword">function</span>(<span class="params">file, cb</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> map(<span class="function"><span class="keyword">function</span>(<span class="params">file, cb</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!file.jshint.success) &#123;</span><br><span class="line">      file.jshint.results.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">          <span class="built_in">console</span>.log(err);</span><br><span class="line">          <span class="comment">// Error message</span></span><br><span class="line">          <span class="keyword">var</span> msg = [</span><br><span class="line">            path.basename(file.path),</span><br><span class="line">            <span class="string">'Line: '</span> + err.error.line,</span><br><span class="line">            <span class="string">'Reason: '</span> + err.error.reason</span><br><span class="line">          ];</span><br><span class="line"></span><br><span class="line">          <span class="comment">// Emit this error event</span></span><br><span class="line">          emmitter.emit(<span class="string">'error'</span>, <span class="keyword">new</span> <span class="built_in">Error</span>(msg.join(<span class="string">'\n'</span>)));</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    cb(<span class="literal">null</span>, file);</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span>(<span class="params">gulp, plugins, growl</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  gulp.task(<span class="string">'api'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.src([</span><br><span class="line">        <span class="string">'api/controllers/*.js'</span>,</span><br><span class="line">        <span class="string">'api/services/**/*.js'</span>,</span><br><span class="line">        <span class="string">'api/policies/*.js'</span>,</span><br><span class="line">        <span class="string">'api/models/*.js'</span></span><br><span class="line">      ])</span><br><span class="line">      .pipe(plugins.jshint(<span class="string">'.jshintrc_api'</span>, &#123;</span><br><span class="line">        fail: <span class="literal">true</span></span><br><span class="line">      &#125;))</span><br><span class="line">      .pipe(plugins.jshint.reporter(<span class="string">'default'</span>)) <span class="comment">// Console output</span></span><br><span class="line">      .pipe(jsHintErrorReporter()) <span class="comment">// If error pop up a notify alert</span></span><br><span class="line">      .on(<span class="string">'error'</span>, plugins.notify.onError(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> error.message;</span><br><span class="line">      &#125;));</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  gulp.task(<span class="string">'assets'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.src([<span class="string">'æ”¹æˆä½ çš„è·¯å¾„!!'</span>])              <span class="comment">// æ”¹æˆä½ çš„è·¯å¾„</span></span><br><span class="line">      .pipe(plugins.jshint(<span class="string">'.jshintrc'</span>, &#123;</span><br><span class="line">        fail: <span class="literal">true</span></span><br><span class="line">      &#125;))</span><br><span class="line">      .pipe(plugins.jshint.reporter(<span class="string">'default'</span>)) <span class="comment">// Console output</span></span><br><span class="line">      .pipe(jsHintErrorReporter()) <span class="comment">// If error pop up a notify alert</span></span><br><span class="line">      .on(<span class="string">'error'</span>, plugins.notify.onError(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> error.message;</span><br><span class="line">      &#125;));</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  gulp.task(<span class="string">'jshint'</span>, [<span class="string">'api'</span>, <span class="string">'assets'</span>]);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="æ·»åŠ -ng-annotate"><a href="#æ·»åŠ -ng-annotate" class="headerlink" title="æ·»åŠ  ng-annotate"></a>æ·»åŠ  <code>ng-annotate</code></h3><p><code>npm install --save-dev gulp-ng-annotate</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨ tasks/config ä¸‹ æ–°å»ºng-annotate.jsæ–‡ä»¶</span></span><br><span class="line"><span class="keyword">var</span> ngAnnotate = <span class="built_in">require</span>(<span class="string">'gulp-ng-annotate'</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span>(<span class="params">gulp, plugins, growl</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  gulp.task(<span class="string">'ngAnnotateapp'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.src([<span class="string">'app/**/*.js'</span>, <span class="string">'*.js'</span>], &#123;</span><br><span class="line">        cwd: <span class="string">'.tmp/public'</span>,</span><br><span class="line">        base: <span class="string">'.tmp/public'</span></span><br><span class="line">      &#125;)</span><br><span class="line">      .pipe(ngAnnotate())</span><br><span class="line">      .pipe(gulp.dest(<span class="string">'.tmp/public'</span>));</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  gulp.task(<span class="string">'ngAnnotatefrontend'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    gulp.src([<span class="string">'frontend/**/*.js'</span>, <span class="string">'*.js'</span>], &#123;</span><br><span class="line">        cwd: <span class="string">'.tmp/public'</span>,</span><br><span class="line">        base: <span class="string">'.tmp/public'</span></span><br><span class="line">      &#125;)</span><br><span class="line">      .pipe(ngAnnotate())</span><br><span class="line">      .pipe(gulp.dest(<span class="string">'.tmp/public'</span>));</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  gulp.task(<span class="string">'ngAnnotate'</span>, [<span class="string">'ngAnnotateapp'</span>, <span class="string">'ngAnnotatefrontend'</span>]);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="ä¿®æ”¹-sails-linker-gulp-js"><a href="#ä¿®æ”¹-sails-linker-gulp-js" class="headerlink" title="ä¿®æ”¹ sails-linker-gulp.js"></a>ä¿®æ”¹ <code>sails-linker-gulp.js</code></h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨ tasks/config ä¸‹ ä¿®æ”¹ sails-linker-gulp.jsæ–‡ä»¶</span></span><br><span class="line"><span class="comment">// ç›´æ¥ä»¿å†™åŸæ¥çš„å³å¯</span></span><br></pre></td></tr></table></figure><h3 id="ä¿®æ”¹-api-register-ä¸‹æ–‡ä»¶-ä»¥æ³¨å†Œä¸Šé¢æ·»åŠ çš„å†…å®¹"><a href="#ä¿®æ”¹-api-register-ä¸‹æ–‡ä»¶-ä»¥æ³¨å†Œä¸Šé¢æ·»åŠ çš„å†…å®¹" class="headerlink" title="ä¿®æ”¹ api/register ä¸‹æ–‡ä»¶,ä»¥æ³¨å†Œä¸Šé¢æ·»åŠ çš„å†…å®¹"></a>ä¿®æ”¹ <code>api/register</code> ä¸‹æ–‡ä»¶,ä»¥æ³¨å†Œä¸Šé¢æ·»åŠ çš„å†…å®¹</h3><p><code>buildProd.js</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span>(<span class="params">gulp, plugins</span>) </span>&#123;</span><br><span class="line">  gulp.task(<span class="string">'buildProd'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">cb</span>) </span>&#123;</span><br><span class="line">    plugins.sequence(</span><br><span class="line">      <span class="string">'compileAssets'</span>,</span><br><span class="line">      <span class="string">'ngAnnotate'</span>,                        <span class="comment">// æ·»åŠ  ngAnnotate</span></span><br><span class="line">      <span class="string">'concat:js'</span>,</span><br><span class="line">      <span class="string">'concat:css'</span>,</span><br><span class="line">      <span class="string">'uglify:dist'</span>,</span><br><span class="line">      <span class="string">'cssmin:dist'</span>,</span><br><span class="line">      <span class="string">'linkAssetsBuildProd'</span>,</span><br><span class="line">      <span class="string">'clean:build'</span>,</span><br><span class="line">      <span class="string">'copy:build'</span>,</span><br><span class="line">      cb</span><br><span class="line">    );</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><p><code>compileAssets.js</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> (<span class="params">gulp, plugins</span>) </span>&#123;</span><br><span class="line">gulp.task(<span class="string">'compileAssets'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">cb</span>) </span>&#123;</span><br><span class="line">plugins.sequence(</span><br><span class="line"><span class="string">'clean:dev'</span>,</span><br><span class="line"><span class="string">'jshint'</span>,                              <span class="comment">// æ·»åŠ jshint</span></span><br><span class="line"><span class="string">'jst:dev'</span>,</span><br><span class="line"><span class="string">'less:dev'</span>,</span><br><span class="line"><span class="string">'sync:dev'</span>,</span><br><span class="line"><span class="string">'copy:dev'</span>,</span><br><span class="line"><span class="string">'coffee:dev'</span>,</span><br><span class="line"><span class="string">'html2js'</span>,       <span class="comment">// æ·»åŠ html2js</span></span><br><span class="line">cb</span><br><span class="line">);</span><br><span class="line">&#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><h2 id="ä¸€äº›ä¸ªäººè§è§£"><a href="#ä¸€äº›ä¸ªäººè§è§£" class="headerlink" title="ä¸€äº›ä¸ªäººè§è§£"></a>ä¸€äº›ä¸ªäººè§è§£</h2><h3 id="ä½¿ç”¨-grunt-è€Œä¸æ˜¯-gulp"><a href="#ä½¿ç”¨-grunt-è€Œä¸æ˜¯-gulp" class="headerlink" title="ä½¿ç”¨ grunt è€Œä¸æ˜¯ gulp"></a>ä½¿ç”¨ grunt è€Œä¸æ˜¯ gulp</h3><ul><li>gruntåŸºäºé…ç½®, æ‰€ä»¥é¡¹ç›®å˜åŒ–,ä¿®æ”¹çš„tasks ä¸å¤š, gulpæ˜¯ â€˜å°†é…ç½®å†™å…¥ä»£ç â€™, æ‰€ä»¥é¡¹ç›®åˆ‡æ¢,ä¿®æ”¹æ–‡ä»¶å¾ˆå¤š  </li></ul><blockquote><p>15/08/24 update:<br>gulp ä¹Ÿå¯ä»¥åŸºäºé…ç½®</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> config = <span class="built_in">require</span>(<span class="string">'./tasks/config.js'</span>);</span><br><span class="line"></span><br><span class="line">gulp</span><br><span class="line">  .src(config.less.src, config.less.opt)</span><br><span class="line">  .pipe(less(&#123;</span><br><span class="line">    expand: <span class="literal">true</span>,</span><br><span class="line">    ext: <span class="string">'.css'</span></span><br><span class="line">  &#125;))</span><br><span class="line">  .pipe(gulp.dest(config.less.dest));</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// config.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="string">'less'</span>: &#123;</span><br><span class="line">    <span class="string">'src'</span>: [</span><br><span class="line">      <span class="string">'styles/**/*.less'</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="string">'opt'</span>: &#123;</span><br><span class="line">      <span class="string">'cwd'</span>: <span class="string">'static'</span>,</span><br><span class="line">      <span class="string">'base'</span>: <span class="string">'static'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">'dest'</span>: <span class="string">'sites/public'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>gruntè¿›è¡Œå¤§é¡¹ç›®çš„jshintæ¯”gulpå¿«çš„å¤š, æ‰€ä»¥å¦‚æœéœ€è¦jshint,å¹¶ä¸”æ–‡ä»¶å¾ˆå¤š,å»ºè®®ä¸è¦åˆ‡æ¢</li><li>gruntçš„uglifyæ¯”gulpå¾—uglifyå¿«çš„å¤šå¾—å¤š,æ‰€ä»¥é¡¹ç›®è¶Šå¤§,å»ºè®®ä¸è¦åˆ‡æ¢</li><li>ä¸æƒ³æŠ˜è…¾,ç›´æ¥å®˜æ–¹çš„ä¸Š</li></ul><h3 id="ä½¿ç”¨-gulp-è€Œä¸æ˜¯-grunt"><a href="#ä½¿ç”¨-gulp-è€Œä¸æ˜¯-grunt" class="headerlink" title="ä½¿ç”¨ gulp è€Œä¸æ˜¯ grunt"></a>ä½¿ç”¨ gulp è€Œä¸æ˜¯ grunt</h3><ul><li>æ— æ³•å¿å— grunt æ…¢(æ¯æ¬¡ä¿®æ”¹å‰ç«¯æ–‡ä»¶,éƒ½è¦åˆ·æ–°2éæ‰æœ‰æ•ˆæœ)</li><li>jshintå•ç‹¬å¤„ç†æˆ–è€…åœ¨å¼€å‘æ—¶ä¸ä½¿ç”¨jshint</li><li>å°é¡¹ç›®,è€Œä¸æ˜¯æ–‡ä»¶æ•°ç›®å¾ˆå¤šçš„å¤§é¡¹ç›®æœ‰</li></ul><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><ul><li><a href="https://github.com/Karnith/sails-generate-new-gulp" target="_blank" rel="noopener">https://github.com/Karnith/sails-generate-new-gulp</a></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong></p></blockquote><blockquote><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> sails </tag>
            
            <tag> gulp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>7æœˆangularä½¿ç”¨ç¬”è®°</title>
      <link href="/2015/08/02/7%E6%9C%88angular%E4%BD%BF%E7%94%A8%E7%AC%94%E8%AE%B0/"/>
      <url>/2015/08/02/7%E6%9C%88angular%E4%BD%BF%E7%94%A8%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<p>7æœˆä½¿ç”¨angularæ€»ç»“,åŒ…æ‹¬ä¸€äº›åº“/è§„èŒƒ/ä»£ç è®°å½•<br><a id="more"></a></p><h1 id="angularä½¿ç”¨ç¬”è®°"><a href="#angularä½¿ç”¨ç¬”è®°" class="headerlink" title="angularä½¿ç”¨ç¬”è®°"></a>angularä½¿ç”¨ç¬”è®°</h1><h2 id="ä¸€äº›åº“çš„ä½¿ç”¨"><a href="#ä¸€äº›åº“çš„ä½¿ç”¨" class="headerlink" title="ä¸€äº›åº“çš„ä½¿ç”¨"></a>ä¸€äº›åº“çš„ä½¿ç”¨</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">angular.module(&apos;XXXXX&apos;, [</span><br><span class="line">  &apos;ngResource&apos;,// restfulè¯·æ±‚çš„å°è£…</span><br><span class="line">  &apos;ui.router&apos;,// åŸºäºçŠ¶æ€å¯¼èˆª</span><br><span class="line">  &apos;ui.bootstrap&apos;// bootstrap çš„ angularç‰ˆ</span><br><span class="line">  ])</span><br></pre></td></tr></table></figure><h2 id="ä¸€äº›è§„èŒƒ"><a href="#ä¸€äº›è§„èŒƒ" class="headerlink" title="ä¸€äº›è§„èŒƒ"></a>ä¸€äº›è§„èŒƒ</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">app    </span><br><span class="line">â”œâ”€â”€ components   // å†™ä¸€äº›å…¬å…±ç”¨çš„æ¨¡æ¿,æ–¹æ³•</span><br><span class="line">â”‚    â”œâ”€â”€ entity</span><br><span class="line">â”‚    â”‚  â””â”€â”€ entities-factory.js  // restful è¯·æ±‚ç›®å½•</span><br><span class="line">â”‚    â”‚</span><br><span class="line">â”‚    â””â”€â”€  notification// å…¬ç”¨æ–¹æ³•</span><br><span class="line">â”‚       â”œâ”€â”€ notification-drtv.js  (directive)</span><br><span class="line">â”‚       â”œâ”€â”€ notification.tpl.html</span><br><span class="line">â”‚       â””â”€â”€ notification-service.js</span><br><span class="line">â”‚       </span><br><span class="line">â”‚</span><br><span class="line">â”œâ”€â”€ home// ä¸ºæ¯ä¸€ä¸ª state éƒ½åˆ†å‰²æˆä¸€ä¸ªæ–‡ä»¶å¤¹</span><br><span class="line">â”‚  â”œâ”€â”€ home.html</span><br><span class="line">â”‚  â”œâ”€â”€ home-controller.js</span><br><span class="line">â”‚  â””â”€â”€ home-routers.js</span><br><span class="line">â”‚</span><br><span class="line">â”‚       </span><br><span class="line">â”œâ”€â”€  news</span><br><span class="line">â”‚    â”œâ”€â”€ news-list.html</span><br><span class="line">â”‚   â”œâ”€â”€ news-controller.js</span><br><span class="line">â”‚   â””â”€â”€ news-routers.js    </span><br><span class="line">â”‚</span><br><span class="line">â”œâ”€â”€ public    // æ­¤å¤„å­˜æ”¾ä¸éœ€è¦æƒé™éªŒè¯çš„é¡µé¢</span><br><span class="line">â”‚</span><br><span class="line">â””â”€â”€ member    // æ­¤å¤„å­˜æ”¾æ‰€æœ‰éœ€è¦æƒé™éªŒè¯çš„é¡µé¢</span><br></pre></td></tr></table></figure><h2 id="ä¸€äº›ä»£ç çš„è®°å½•"><a href="#ä¸€äº›ä»£ç çš„è®°å½•" class="headerlink" title="ä¸€äº›ä»£ç çš„è®°å½•"></a>ä¸€äº›ä»£ç çš„è®°å½•</h2><blockquote><p><code>entities-factory.js</code> <strong>å­˜æ”¾æ‰€æœ‰çš„restfulè¯·æ±‚</strong></p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">angular.module(<span class="string">'XXXX'</span>)</span><br><span class="line"> .factory(<span class="string">'newsEntity'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">$resource</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> $resource(</span><br><span class="line">      <span class="string">'api/v1/news/:id'</span>,</span><br><span class="line">      &#123;<span class="attr">id</span>: <span class="string">'@id'</span>&#125;,<span class="comment">// ç»„åˆurlä¸º  api/v1/news/123</span></span><br><span class="line">      &#123;<span class="attr">update</span>: &#123;<span class="attr">method</span>: <span class="string">'PUT'</span>&#125;&#125;<span class="comment">// å¢åŠ  restfulçš„update</span></span><br><span class="line">    );</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="comment">// ........</span></span><br></pre></td></tr></table></figure><blockquote><p>news-routers.js <strong>æ¯ä¸ªstateéƒ½æœ‰ä¸€ä¸ªè‡ªå·±çš„è·¯ç”±</strong></p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">angular.module(<span class="string">'XXXXX'</span>)</span><br><span class="line">  .config(<span class="function"><span class="keyword">function</span>(<span class="params">$stateProvider</span>) </span>&#123;</span><br><span class="line">    $stateProvider</span><br><span class="line">      .state(<span class="string">'home.news'</span>, &#123;</span><br><span class="line">        url: <span class="string">'/news'</span>,</span><br><span class="line">        template: <span class="string">'&lt;div ui-view&gt;&lt;/div&gt;'</span>,    <span class="comment">// templateå’Œabstract è”åˆä½¿ç”¨,åªæ˜¯ä½œä¸ºçˆ¶çŠ¶æ€å­˜åœ¨</span></span><br><span class="line">        abstract: <span class="literal">true</span></span><br><span class="line">      &#125;)</span><br><span class="line">      .state(<span class="string">'home.news.list'</span>, &#123;</span><br><span class="line">        url: <span class="string">''</span>,</span><br><span class="line">        controller: <span class="string">'NewsListCtrl'</span>,   <span class="comment">// ç›´æ¥åœ¨ routersä¸­æŒ‡å®š controller, æ— éœ€å† htmlä¸­æŒ‡å®š</span></span><br><span class="line">        templateUrl: <span class="string">'app/news/news-list.html'</span>,</span><br><span class="line">        resolve: &#123;</span><br><span class="line">          NewsList: <span class="function"><span class="keyword">function</span>(<span class="params">newsEntity</span>) </span>&#123;    <span class="comment">// newsEntityå®šä¹‰åœ¨componentsçš„entityçš„entities-factory.js            return newsEntity.query().$promise;    // è¿”å›æ•°ç»„æ•°æ®çš„promise</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">      .state(<span class="string">'home..news.add'</span>, &#123;</span><br><span class="line">        url: <span class="string">'/add'</span>,</span><br><span class="line">        controller: <span class="string">'SingleNewsCtrl'</span>,</span><br><span class="line">        templateUrl: <span class="string">'app/news/news-add-edit.html'</span>,</span><br><span class="line">        resolve: &#123;</span><br><span class="line">          News: <span class="function"><span class="keyword">function</span>(<span class="params">newsEntity</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> newsEntity();          <span class="comment">// é€šè¿‡newä¸€ä¸ªå¯¹è±¡æ¥ä½¿ç”¨restfulçš„$save</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">      .state(<span class="string">'home.news.edit'</span>, &#123;</span><br><span class="line">        url: <span class="string">'/edit/:id'</span>,         <span class="comment">// æ­¤å¤„çš„ /:id æ˜¯ç”¨äº ui.router ä¼ é€’ idå‚æ•°</span></span><br><span class="line">        controller: <span class="string">'SingleNewsCtrl'</span>,</span><br><span class="line">        templateUrl: <span class="string">'app/news/news-add-edit.html'</span>,</span><br><span class="line">        resolve: &#123;</span><br><span class="line">          News: <span class="function"><span class="keyword">function</span>(<span class="params">newsEntity, $stateParams</span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log($stateParams.id);        <span class="comment">// æ­¤å¤„å¾—åˆ° id</span></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> newsEntity(&#123;<span class="attr">id</span>: $stateParams.id&#125;).$get();  <span class="comment">// ä»æœåŠ¡å™¨è·å–æ­¤idçš„æ•°æ®</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><blockquote><p>notification <strong>å…¬ç”¨çš„æ–¹æ³•</strong></p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// notification.tpl.html</span><br><span class="line">// æ­¤å¤„ä½¿ç”¨äº† ui.bootstrap</span><br><span class="line"><span class="tag">&lt;<span class="name">alert</span> <span class="attr">class</span>=<span class="string">"center-block col-sm-6"</span> <span class="attr">ng-repeat</span>=<span class="string">"notification in notifications"</span> <span class="attr">type</span>=<span class="string">"&#123;&#123;types[notification.type]&#125;&#125;"</span> <span class="attr">close</span>=<span class="string">"close($index)"</span>&gt;</span>&#123;&#123;notification.message&#125;&#125;<span class="tag">&lt;/<span class="name">alert</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// notification-service.js</span></span><br><span class="line"></span><br><span class="line">angular.module(<span class="string">'XXXXXXX'</span>)</span><br><span class="line">  .service(<span class="string">'notificationService'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">$timeout</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> notifications = [], svc = <span class="keyword">this</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.getNotifications = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> notifications;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.removeNotification = <span class="function"><span class="keyword">function</span> (<span class="params">notification</span>) </span>&#123;</span><br><span class="line">      notifications.splice(notifications.indexOf(notification), <span class="number">1</span>);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.error = <span class="function"><span class="keyword">function</span> (<span class="params">message</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> notification = &#123; <span class="attr">type</span>: <span class="string">'error'</span>, <span class="attr">message</span>: message &#125;;</span><br><span class="line">      notifications.push(notification);</span><br><span class="line">      $timeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        svc.removeNotification(notification);</span><br><span class="line">      &#125;, <span class="number">10000</span>);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.info = <span class="function"><span class="keyword">function</span> (<span class="params">message</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> notification = &#123; <span class="attr">type</span>: <span class="string">'info'</span>, <span class="attr">message</span>: message &#125;;</span><br><span class="line">      notifications.push(notification);</span><br><span class="line">      $timeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        svc.removeNotification(notification);</span><br><span class="line">      &#125;, <span class="number">5000</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// notification-drtv.js </span></span><br><span class="line"></span><br><span class="line">angular.module(<span class="string">'XXXXX'</span>)</span><br><span class="line">.directive(<span class="string">'notificationBar'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    restrict: <span class="string">'EA'</span>,</span><br><span class="line">    templateUrl: <span class="string">'app/components/notification/notification-bar.tpl.html'</span>,</span><br><span class="line">    controller: <span class="function"><span class="keyword">function</span> (<span class="params">$scope, notificationService</span>) </span>&#123;</span><br><span class="line">      $scope.notifications = notificationService.getNotifications();</span><br><span class="line">      $scope.types = &#123;</span><br><span class="line">        error: <span class="string">'danger'</span>,</span><br><span class="line">        warn: <span class="string">'warning'</span>,</span><br><span class="line">        info: <span class="string">'info'</span></span><br><span class="line">      &#125;;</span><br><span class="line">      $scope.close = <span class="function"><span class="keyword">function</span> (<span class="params">index</span>) </span>&#123;</span><br><span class="line">        $scope.notifications.splice(index, <span class="number">1</span>);</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><ul><li>CRMå¼€å‘</li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> AngularJS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sailsåˆå­¦ç¬”è®°</title>
      <link href="/2015/07/25/sails%E5%88%9D%E5%AD%A6%E7%AC%94%E8%AE%B0/"/>
      <url>/2015/07/25/sails%E5%88%9D%E5%AD%A6%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<p>åˆæ¬¡sailsä½¿ç”¨çš„ä¸€äº›ç¬”è®°<br><a id="more"></a></p><h2 id="å…¨å±€ä¸‹å®‰è£…Sails"><a href="#å…¨å±€ä¸‹å®‰è£…Sails" class="headerlink" title="å…¨å±€ä¸‹å®‰è£…Sails"></a>å…¨å±€ä¸‹å®‰è£…Sails</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo npm install sails -g</span><br></pre></td></tr></table></figure><h2 id="åœ¨ç©ºè·¯å¾„ä¸‹-æ–°å»ºä¸€ä¸ªé¡¹ç›®"><a href="#åœ¨ç©ºè·¯å¾„ä¸‹-æ–°å»ºä¸€ä¸ªé¡¹ç›®" class="headerlink" title="åœ¨ç©ºè·¯å¾„ä¸‹,æ–°å»ºä¸€ä¸ªé¡¹ç›®"></a>åœ¨ç©ºè·¯å¾„ä¸‹,æ–°å»ºä¸€ä¸ªé¡¹ç›®</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sails <span class="keyword">new</span> newApp</span><br></pre></td></tr></table></figure><h2 id="è¿è¡Œ"><a href="#è¿è¡Œ" class="headerlink" title="è¿è¡Œ"></a>è¿è¡Œ</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sails lift</span><br></pre></td></tr></table></figure><h1 id="é¡¹ç›®æ¶æ„"><a href="#é¡¹ç›®æ¶æ„" class="headerlink" title="é¡¹ç›®æ¶æ„"></a>é¡¹ç›®æ¶æ„</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">â”œâ”€â”€ api    </span><br><span class="line">â”‚   â”œâ”€â”€ controllers  </span><br><span class="line">â”‚   â”‚       æ§åˆ¶å±‚ï¼Œè¯¥å±‚æ˜¯Httpè¯·æ±‚çš„å…¥å£</span><br><span class="line">â”‚   â”‚       sailså®˜æ–¹å»ºè®®è¯¥å±‚åªå¤„ç†è¯·æ±‚çš„è½¬å‘å’Œé¡µé¢çš„æ¸²æŸ“,</span><br><span class="line">â”‚   â”‚       å…·ä½“çš„é€»è¾‘å®ç°åº”è¯¥äº¤ç»™Serviceå±‚.</span><br><span class="line">â”‚   â”‚</span><br><span class="line">â”‚   â”œâ”€â”€ models</span><br><span class="line">â”‚   â”‚     æ¨¡å‹å±‚</span><br><span class="line">â”‚   â”‚</span><br><span class="line">â”‚   â”œâ”€â”€ policies</span><br><span class="line">â”‚   â”‚     è¿‡æ»¤å±‚,è¯¥å±‚åœ¨Controllerå±‚ä¹‹å‰å¯¹Httpè¯·æ±‚åšå¤„ç†</span><br><span class="line">â”‚   â”‚     åœ¨è¿™ä¸€å±‚ä¸­ï¼Œå¯ä»¥å®šäºä¸€äº›è§„åˆ™æ¥è¿‡æ»¤Httpè¯·æ±‚,</span><br><span class="line">â”‚   â”‚     æ¯”å¦‚èº«ä»½è®¤è¯ä»€ä¹ˆçš„.</span><br><span class="line">â”‚   â”‚</span><br><span class="line">â”‚   â”œâ”€â”€ responses</span><br><span class="line">â”‚   â”‚</span><br><span class="line">â”‚   â”‚     httpå“åº”çš„æ–¹æ³•éƒ½æ”¾è¿™é‡Œ</span><br><span class="line">â”‚   â”‚     ä¾‹å¦‚æœåŠ¡å™¨é”™è¯¯ã€è¯·æ±‚é”™è¯¯ã€404é”™è¯¯ç­‰</span><br><span class="line">â”‚   â”‚     å®šä¹‰åœ¨responsesæ–‡ä»¶å¤¹é‡Œé¢çš„æ–¹æ³•ï¼Œ</span><br><span class="line">â”‚   â”‚     éƒ½ä¼šèµ‹å€¼åˆ°controllerå±‚çš„reqå¯¹è±¡ä¸­</span><br><span class="line">â”‚   â”‚</span><br><span class="line">â”‚   â”‚</span><br><span class="line">â”‚   â””â”€â”€ services</span><br><span class="line">â”‚        æœåŠ¡å±‚,è¯¥å±‚åŒ…å«é€»è¾‘å¤„ç†çš„æ–¹æ³•</span><br><span class="line">â”‚        æ‰€æœ‰Serviceéƒ½å¯ä»¥å…¨å±€æ€§è®¿é—®</span><br><span class="line">â”‚</span><br><span class="line">â”œâ”€â”€ views</span><br><span class="line">â”‚        è§†å›¾å±‚,å­˜æ”¾è§†å›¾æ¨¡ç‰ˆæ–‡ä»¶çš„åœ°æ–¹</span><br><span class="line">â”‚</span><br><span class="line">â”œâ”€â”€ assets</span><br><span class="line">â”‚       èµ„æºæ–‡ä»¶å¤¹</span><br><span class="line">â”‚       åœ¨Sailså¯åŠ¨çš„æ—¶å€™,</span><br><span class="line">â”‚       ä¼šå¯åŠ¨æŸä¸€ä¸ªGruntä»»åŠ¡,</span><br><span class="line">â”‚       æŠŠassetsæ–‡ä»¶å¤¹é‡Œçš„å†…å®¹æˆ–å‹ç¼©æˆ–ç¼–è¯‘</span><br><span class="line">â”‚       æˆ–å¤åˆ¶åˆ°æ ¹ç›®å½•ä¸‹çš„.tmpç›®å½•</span><br><span class="line">â”‚   </span><br><span class="line">â”œâ”€â”€ config </span><br><span class="line">â”‚     â”‚   é…ç½®æ–‡ä»¶å¤¹</span><br><span class="line">â”‚     â”‚   è®¿é—®æ–¹æ³•  sails.config.XXX</span><br><span class="line">â”‚     â”‚ </span><br><span class="line">â”‚     â”œâ”€â”€ adapters.js</span><br><span class="line">â”‚     â”‚     æœ¬åœ°æ•°æ®åº“é…ç½®</span><br><span class="line">â”‚     â”‚</span><br><span class="line">â”‚     â”œâ”€â”€ csrf.js</span><br><span class="line">â”‚     â”‚       è·¨åŸŸåŠ å¯†</span><br><span class="line">â”‚     â”‚</span><br><span class="line">â”‚     â”œâ”€â”€ session.js</span><br><span class="line">â”‚     â”‚       sessioné…ç½®</span><br><span class="line">â”‚     â”‚</span><br><span class="line">â”‚     â”œâ”€â”€  routes.js</span><br><span class="line">â”‚     â”‚     routesè·¯ç”±é…ç½®</span><br><span class="line">â”‚     â”‚</span><br><span class="line">â”‚     â”œâ”€â”€ env  åœ¨å®é™…å¼€å‘ä¸­,å¸¸é…ç½®æ•°æ®åº“ç­‰ä¿¡æ¯</span><br><span class="line">|     â”‚    â”‚</span><br><span class="line">â”‚     |    â””â”€â”€ development.js</span><br><span class="line">|     â”‚    â”‚</span><br><span class="line">â”‚     |    â””â”€â”€ production.js</span><br><span class="line">â”‚     â”‚</span><br><span class="line">â”‚     â””â”€â”€ cors.js</span><br><span class="line">â”‚          è·¨åŸŸé…ç½®</span><br><span class="line">â”‚    </span><br><span class="line">â”œâ”€â”€ tasks</span><br><span class="line">â”‚       Gruntçš„é…ç½®å’Œä»»åŠ¡æ³¨å†Œ</span><br><span class="line">â”‚    </span><br><span class="line">â”œâ”€â”€ node_modules</span><br><span class="line">â”œâ”€â”€ package.json</span><br><span class="line">â”œâ”€â”€ Gruntfile.js</span><br><span class="line">â”œâ”€â”€ README.md</span><br><span class="line">â””â”€â”€ app.js</span><br></pre></td></tr></table></figure><p>åŒæ—¶åˆ›å»ºmodelå’Œå¯¹åº”çš„Controllerçš„å‘½ä»¤<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sails generate api API_NAME</span><br></pre></td></tr></table></figure></p><p>Sailsä¸­çš„è·¯ç”±: <code>blueprint</code></p><h2 id="RESTful-routes"><a href="#RESTful-routes" class="headerlink" title="RESTful routes"></a>RESTful routes</h2><p>å½“è·¯å¾„è¯¸å¦‚ï¼š/:modelIdentity æˆ–è€… /:modelIdentity/:idçš„æ—¶å€™ï¼Œblueprintä¼šæ ¹æ®HTTPçš„åŠ¨ä½œï¼ˆGETã€POSTã€DELETEã€PUTç­‰ï¼‰æ¥åˆ†é…åˆ°ç›¸åº”çš„Controllerä¸‹ç›¸åº”çš„Actionæ¥å¤„ç†ã€‚ä¾‹å¦‚ä¸€ä¸ªPOSTè¯·æ±‚/userä¼šåˆ›å»ºä¸€ä¸ªç”¨æˆ·ï¼Œä¸€ä¸ªDELETEè¯·æ±‚/user/123ä¼šåˆ é™¤idä¸º123çš„ç”¨æˆ·ã€‚</p><h2 id="Shortcut-routes"><a href="#Shortcut-routes" class="headerlink" title="Shortcut routes"></a>Shortcut routes</h2><p>ç”Ÿäº§ç¯å¢ƒä¸‹éœ€è¦å…³é—­</p><h2 id="Action-routes"><a href="#Action-routes" class="headerlink" title="Action routes"></a>Action routes</h2><p>è¿™ç§è·¯ç”±ä¼šè‡ªåŠ¨çš„ä¸ºControllerå±‚çš„æ¯ä¸€ä¸ªActionåˆ›å»ºä¸€ä¸ªè·¯ç”±ï¼Œä¾‹å¦‚ä½ çš„Controllerå±‚æœ‰ä¸€ä¸ªFooController.jsï¼Œé‡Œé¢æœ‰ä¸€ä¸ªActionbarï¼Œé‚£ä¹ˆè¯·æ±‚/foo/barå°±ä¼šåˆ†é…åˆ°barActionã€‚</p><p>å½“ç„¶Sailsä¹Ÿä¼šæä¾›è‡ªå®šä¹‰çš„è·¯ç”±ï¼Œç”¨æˆ·å¯ä»¥åœ¨config/routes.jså’Œconfig/polices.jsè¿™ä¸¤ä¸ªé…ç½®æ–‡ä»¶ä¸­é€‰æ‹©å…³é—­æˆ–è€…æ‰“å¼€blueprintæä¾›çš„è·¯ç”±ï¼Œå’Œå®šä¹‰è‡ªå·±çš„è·¯ç”±ã€‚</p><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><ul><li><a href="https://cnodejs.org/topic/553c7b4a1a6e36a27780ee65" target="_blank" rel="noopener">https://cnodejs.org/topic/553c7b4a1a6e36a27780ee65</a></li><li><a href="https://cnodejs.org/topic/555c3c82e684c4c8088a0ca1" target="_blank" rel="noopener">https://cnodejs.org/topic/555c3c82e684c4c8088a0ca1</a></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> node </tag>
            
            <tag> sails </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JSè®¾è®¡æ¨¡å¼ç¬”è®°(é€‚é…å™¨æ¨¡å¼)</title>
      <link href="/2015/07/05/JS%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0-%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F/"/>
      <url>/2015/07/05/JS%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0-%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<p>JSè®¾è®¡æ¨¡å¼ç¬”è®°(é€‚é…å™¨æ¨¡å¼)<br><a id="more"></a></p><h1 id="é€‚é…å™¨æ¨¡å¼"><a href="#é€‚é…å™¨æ¨¡å¼" class="headerlink" title="é€‚é…å™¨æ¨¡å¼"></a>é€‚é…å™¨æ¨¡å¼</h1><p><strong>ä½œç”¨: è§£å†³ä¸¤ä¸ªè½¯ä»¶å®ä½“é—´çš„æ¥å£ä¸å…¼å®¹é—®é¢˜</strong></p><h2 id="ç™¾åº¦åœ°å›¾å’Œè°·æ­Œåœ°å›¾æ¸²æŸ“"><a href="#ç™¾åº¦åœ°å›¾å’Œè°·æ­Œåœ°å›¾æ¸²æŸ“" class="headerlink" title="ç™¾åº¦åœ°å›¾å’Œè°·æ­Œåœ°å›¾æ¸²æŸ“"></a>ç™¾åº¦åœ°å›¾å’Œè°·æ­Œåœ°å›¾æ¸²æŸ“</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> googleMap = &#123;</span><br><span class="line">    show: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'å¼€å§‹æ¸²æŸ“è°·æ­Œåœ°å›¾'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> baiduMap = &#123;</span><br><span class="line">    display: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'å¼€å§‹æ¸²æŸ“ç™¾åº¦åœ°å›¾'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> baiduMapAdapter = &#123;</span><br><span class="line">    show: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> baiduMap.display();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> renderMap = <span class="function"><span class="keyword">function</span>(<span class="params">map</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (map.show <span class="keyword">instanceof</span> <span class="built_in">Function</span>) &#123;</span><br><span class="line">        map.show();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">renderMap(googleMap); <span class="comment">// å¼€å§‹æ¸²æŸ“è°·æ­Œåœ°å›¾</span></span><br><span class="line">renderMap(baiduMapAdapter); <span class="comment">//å¼€å§‹æ¸²æŸ“ç™¾åº¦åœ°å›¾</span></span><br></pre></td></tr></table></figure><h2 id="åœ°å€åæ ‡è½¬æ¢"><a href="#åœ°å€åæ ‡è½¬æ¢" class="headerlink" title="åœ°å€åæ ‡è½¬æ¢"></a>åœ°å€åæ ‡è½¬æ¢</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> guangdongCity = &#123;</span><br><span class="line">    shenzhen: <span class="number">11</span>,</span><br><span class="line">    guangzhou: <span class="number">12</span>,</span><br><span class="line">    zhuhai: <span class="number">13</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> getGuangdongCity = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> guangdongCity = [</span><br><span class="line">        &#123;</span><br><span class="line">            name: <span class="string">'shenzhen'</span>,</span><br><span class="line">            id: <span class="number">11</span></span><br><span class="line">        &#125;, &#123;</span><br><span class="line">            name: <span class="string">'guangzhou'</span>,</span><br><span class="line">            id: <span class="number">12</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    ];</span><br><span class="line">    <span class="keyword">return</span> guangdongCity;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> render = <span class="function"><span class="keyword">function</span>(<span class="params">fn</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'å¼€å§‹æ¸²æŸ“å¹¿ä¸œçœåœ°å›¾'</span>);</span><br><span class="line">    <span class="built_in">document</span>.write(<span class="built_in">JSON</span>.stringify(fn()));</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> addressAdapter = <span class="function"><span class="keyword">function</span>(<span class="params">oldAddressfn</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> address = &#123;&#125;,</span><br><span class="line">        oldAddress = oldAddressfn();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, c; c = oldAddress[i++];) &#123;</span><br><span class="line">        address[c.name] = c.id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> address;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">render(addressAdapter(getGuangdongCity));</span><br></pre></td></tr></table></figure><h2 id="é€‚é…å™¨æ¨¡å¼-è£…é¥°è€…æ¨¡å¼-ä»£ç†æ¨¡å¼å’Œå¤–è§‚æ¨¡å¼åŒºåˆ«"><a href="#é€‚é…å™¨æ¨¡å¼-è£…é¥°è€…æ¨¡å¼-ä»£ç†æ¨¡å¼å’Œå¤–è§‚æ¨¡å¼åŒºåˆ«" class="headerlink" title="é€‚é…å™¨æ¨¡å¼,è£…é¥°è€…æ¨¡å¼,ä»£ç†æ¨¡å¼å’Œå¤–è§‚æ¨¡å¼åŒºåˆ«"></a>é€‚é…å™¨æ¨¡å¼,è£…é¥°è€…æ¨¡å¼,ä»£ç†æ¨¡å¼å’Œå¤–è§‚æ¨¡å¼åŒºåˆ«</h2><ul><li>é€‚é…å™¨æ¨¡å¼ä¸»è¦ç”¨æ¥è§£å†³ä¸¤ä¸ªå·²æœ‰æ¥å£ä¹‹é—´ä¸åŒ¹é…é—®é¢˜,å®ƒä¸è€ƒè™‘è¿™äº›æ¥å£æ˜¯æ€ä¹ˆå®ç°çš„,ä¹Ÿä¸è€ƒè™‘å®ƒä»¬å°†æ¥å¯èƒ½ä¼šå¦‚ä½•æ¼”åŒ–.é€‚é…å™¨æ¨¡å¼ä¸éœ€è¦æ”¹å˜å·²æœ‰çš„æ¥å£,å°±èƒ½ä½¿å®ƒä»¬ååŒå·¥ä½œ</li><li>è£…é¥°è€…æ¨¡å¼çš„ä½œç”¨æ˜¯ä¸ºäº†ç»™å¯¹è±¡å¢åŠ åŠŸèƒ½,ä¸ä¼šæ”¹å˜å·²æœ‰çš„æ¥å£,é€šå¸¸åŒ…è£…ä¸€æ¬¡</li><li>ä»£ç†æ¨¡å¼æ˜¯ä¸ºäº†æ§åˆ¶å¯¹å¯¹è±¡çš„é˜²é£,ä¸ä¼šæ”¹å˜å·²æœ‰çš„æ¥å£,é€šå¸¸åŒ…è£…ä¸€æ¬¡</li><li>å¤–è§‚æ¨¡å¼å®šä¹‰äº†ä¸€ä¸ªæ–°çš„æ¥å£</li></ul><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><ul><li><em>å®ä½“ä¹¦:</em> <code>JavaScriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µ(æ›¾æ¢)</code></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JSè®¾è®¡æ¨¡å¼ç¬”è®°(çŠ¶æ€æ¨¡å¼)</title>
      <link href="/2015/07/03/JS%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0-%E7%8A%B6%E6%80%81%E6%A8%A1%E5%BC%8F/"/>
      <url>/2015/07/03/JS%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0-%E7%8A%B6%E6%80%81%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<p>JSè®¾è®¡æ¨¡å¼ç¬”è®°(çŠ¶æ€æ¨¡å¼)<br><a id="more"></a></p><h1 id="çŠ¶æ€æ¨¡å¼"><a href="#çŠ¶æ€æ¨¡å¼" class="headerlink" title="çŠ¶æ€æ¨¡å¼"></a>çŠ¶æ€æ¨¡å¼</h1><p><strong>å®šä¹‰:å…è®¸ä¸€ä¸ªå¯¹è±¡åœ¨å…¶å†…éƒ¨çŠ¶æ€æ”¹å˜æ—¶æ”¹å˜å®ƒçš„è¡Œä¸º,å¯¹è±¡çœ‹èµ·æ¥ä¼¼ä¹ä¿®æ”¹äº†å®ƒçš„ç±»</strong></p><blockquote><ol><li>ç¬¬ä¸€éƒ¨åˆ†çš„æ„æ€: å°†çŠ¶æ€å°è£…æˆç‹¬ç«‹çš„ç±»,å¹¶å°†è¯·æ±‚å§”æ‰˜ç»™å½“å‰çš„çŠ¶æ€å¯¹è±¡,å½“å¯¹è±¡çš„å†…éƒ¨çŠ¶æ€æ”¹å˜æ—¶,ä¼šå¸¦æ¥ä¸åŒçš„è¡Œä¸ºå˜åŒ–</li><li>ç¬¬äºŒéƒ¨åˆ†çš„æ„æ€: ä»å®¢æˆ·è§’åº¦æ¥çœ‹,æˆ‘ä»¬ä½¿ç”¨çš„å¯¹è±¡,åœ¨ä¸åŒçŠ¶æ€ä¸‹å…·æœ‰æˆªç„¶ä¸åŒçš„è¡Œä¸º</li></ol></blockquote><h2 id="JavaScriptç‰ˆæœ¬çš„çŠ¶æ€æœº"><a href="#JavaScriptç‰ˆæœ¬çš„çŠ¶æ€æœº" class="headerlink" title="JavaScriptç‰ˆæœ¬çš„çŠ¶æ€æœº"></a>JavaScriptç‰ˆæœ¬çš„çŠ¶æ€æœº</h2><p><em>çŠ¶æ€æ¨¡å¼æ˜¯çŠ¶æ€æœºçš„å®ç°ä¹‹ä¸€</em></p><p><strong>é€šè¿‡Function.prototype.callç›´æ¥æŠŠè¯·æ±‚å§”æ‰˜ç»™æŸä¸ªå­—é¢å¯¹è±¡æ¥æ‰§è¡Œ</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Light = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.currState = FSM.off; <span class="comment">// è®¾ç½®å½“å‰çŠ¶æ€</span></span><br><span class="line">    <span class="keyword">this</span>.button = <span class="literal">null</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Light.prototype.init = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> button = <span class="built_in">document</span>.createElement(<span class="string">'button'</span>);</span><br><span class="line">    <span class="keyword">var</span> _this = <span class="keyword">this</span>;</span><br><span class="line"></span><br><span class="line">    button.innerHTML = <span class="string">'å·²å…³ç¯'</span>;</span><br><span class="line">    <span class="keyword">this</span>.button = <span class="built_in">document</span>.body.appendChild(button);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.button.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        _this.currState.buttonWasPressed.call(_this); <span class="comment">// æŠŠè¯·æ±‚å§”æ‰˜ç»™FSMçŠ¶æ€æœº</span></span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> FSM = &#123;</span><br><span class="line">    off: &#123;</span><br><span class="line">        buttonWasPressed: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'å…³ç¯'</span>);</span><br><span class="line">            <span class="keyword">this</span>.button.innerHTML = <span class="string">'ä¸‹ä¸€æ¬¡æŒ‰æˆ‘å¼€ç¯'</span>;</span><br><span class="line">            <span class="keyword">this</span>.currState = FSM.on;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    on: &#123;</span><br><span class="line">        buttonWasPressed: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'å¼€ç¯'</span>);</span><br><span class="line">            <span class="keyword">this</span>.button.innerHTML = <span class="string">'ä¸‹ä¸€æ¬¡æŒ‰æˆ‘å…³ç¯'</span>;</span><br><span class="line">            <span class="keyword">this</span>.currState = FSM.off;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> light = <span class="keyword">new</span> Light();</span><br><span class="line">light.init();</span><br></pre></td></tr></table></figure></p><figure class="image-box">                <img src="/img/design/light.png" alt="light" title="" class="">                <p>light</p>            </figure><hr><p><strong>æŠŠå˜é‡å°é—­åœ¨é—­åŒ…å†…</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> delegate = <span class="function"><span class="keyword">function</span>(<span class="params">client, delegation</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="comment">// å°†å®¢æˆ·çš„æ“ä½œå§”æ‰˜ç»™delegationå¯¹è±¡</span></span><br><span class="line">        buttonWasPressed: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> delegation.buttonWasPressed.apply(client, <span class="built_in">arguments</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> FSM = &#123;</span><br><span class="line">    off: &#123;</span><br><span class="line">        buttonWasPressed: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'å…³ç¯'</span>);</span><br><span class="line">            <span class="keyword">this</span>.button.innerHTML = <span class="string">'ä¸‹ä¸€æ¬¡æŒ‰æˆ‘å¼€ç¯'</span>;</span><br><span class="line">            <span class="keyword">this</span>.currState = FSM.on;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    on: &#123;</span><br><span class="line">        buttonWasPressed: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'å¼€ç¯'</span>);</span><br><span class="line">            <span class="keyword">this</span>.button.innerHTML = <span class="string">'ä¸‹ä¸€æ¬¡æŒ‰æˆ‘å…³ç¯'</span>;</span><br><span class="line">            <span class="keyword">this</span>.currState = FSM.off;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> Light = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.offState = delegate(<span class="keyword">this</span>, FSM.off);</span><br><span class="line">    <span class="keyword">this</span>.onState = delegate(<span class="keyword">this</span>, FSM.on);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.currState = <span class="keyword">this</span>.offState;</span><br><span class="line">    <span class="keyword">this</span>.button = <span class="literal">null</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Light.prototype.init = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> button = <span class="built_in">document</span>.createElement(<span class="string">'button'</span>);</span><br><span class="line">    <span class="keyword">var</span> _this = <span class="keyword">this</span>;</span><br><span class="line"></span><br><span class="line">    button.innerHTML = <span class="string">'å·²å…³ç¯'</span>;</span><br><span class="line">    <span class="keyword">this</span>.button = <span class="built_in">document</span>.body.appendChild(button);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.button.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        _this.currState.buttonWasPressed.call(_this); <span class="comment">// æŠŠè¯·æ±‚å§”æ‰˜ç»™FSMçŠ¶æ€æœº</span></span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> light = <span class="keyword">new</span> Light();</span><br><span class="line">light.init();</span><br></pre></td></tr></table></figure></p><h2 id="è¡¨é©±åŠ¨çš„æœ‰é™çŠ¶æ€æœº"><a href="#è¡¨é©±åŠ¨çš„æœ‰é™çŠ¶æ€æœº" class="headerlink" title="è¡¨é©±åŠ¨çš„æœ‰é™çŠ¶æ€æœº"></a>è¡¨é©±åŠ¨çš„æœ‰é™çŠ¶æ€æœº</h2><p><strong>æˆ‘ä»¬å¯ä»¥åœ¨è¡¨ä¸­å¾ˆæ¸…æ¥šçš„çœ‹åˆ°ä¸‹ä¸€ä¸ªçŠ¶æ€æ˜¯ç”±å½“å‰çŠ¶æ€å’Œè¡Œä¸ºå…±åŒå†³å®šçš„</strong></p><table><thead><tr><th style="text-align:center">å½“å‰çŠ¶æ€ â†’ æ¡ä»¶â†“</th><th style="text-align:center">çŠ¶æ€A</th><th style="text-align:center">çŠ¶æ€B</th><th style="text-align:center">çŠ¶æ€C</th></tr></thead><tbody><tr><td style="text-align:center">æ¡ä»¶X</td><td style="text-align:center">â€¦â€¦</td><td style="text-align:center">â€¦..</td><td style="text-align:center">â€¦â€¦</td></tr><tr><td style="text-align:center">æ¡ä»¶Y</td><td style="text-align:center">â€¦â€¦</td><td style="text-align:center">çŠ¶æ€C</td><td style="text-align:center">â€¦â€¦</td></tr><tr><td style="text-align:center">æ¡ä»¶Z</td><td style="text-align:center">â€¦â€¦</td><td style="text-align:center">â€¦..</td><td style="text-align:center">â€¦â€¦</td></tr></tbody></table><p>githubä¸Šæœ‰å¯¹åº”çš„åº“å®ç°:<br><a href="https://github.com/jakesgordon/javascript-state-machine" target="_blank" rel="noopener">https://github.com/jakesgordon/javascript-state-machine</a></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- https://github.com/jakesgordon/javascript-state-machine --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"http://upload.xinshangshangxin.com/state-machine-2.3.5.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> fsm = StateMachine.create(&#123;</span></span><br><span class="line"><span class="javascript">            initial: <span class="string">'off'</span>,</span></span><br><span class="line"><span class="undefined">            events: [</span></span><br><span class="line"><span class="javascript">                &#123;<span class="attr">name</span>: <span class="string">'buttonWasPressed'</span>, <span class="attr">from</span>: <span class="string">'off'</span>, <span class="attr">to</span>: <span class="string">'on'</span>&#125;,</span></span><br><span class="line"><span class="javascript">                &#123;<span class="attr">name</span>: <span class="string">'buttonWasPressed'</span>, <span class="attr">from</span>: <span class="string">'on'</span>, <span class="attr">to</span>: <span class="string">'off'</span>&#125;</span></span><br><span class="line"><span class="undefined">            ],</span></span><br><span class="line"><span class="undefined">            callbacks: &#123;</span></span><br><span class="line"><span class="javascript">                onbuttonWasPressed: <span class="function"><span class="keyword">function</span>(<span class="params">event, from, to, msg</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                    <span class="built_in">console</span>.log(<span class="built_in">arguments</span>);</span></span><br><span class="line"><span class="undefined">                &#125;</span></span><br><span class="line"><span class="undefined">            &#125;,</span></span><br><span class="line"><span class="javascript">            error: <span class="function"><span class="keyword">function</span>(<span class="params">eventName, from, to, args, errorCode, errorMessage</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="built_in">console</span>.log(<span class="built_in">arguments</span>); <span class="comment">// ä»ä¸€ç§çŠ¶æ€è¯•å›¾åˆ‡æ¢åˆ°ä¸€ç§ä¸å¯èƒ½çš„åˆ°è¾¾çš„çŠ¶æ€çš„æ—¶å€™</span></span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> button = <span class="built_in">document</span>.createElement(<span class="string">'button'</span>);</span></span><br><span class="line"><span class="javascript">        button.innerHTML = <span class="string">'test'</span>;</span></span><br><span class="line"><span class="javascript">        button = <span class="built_in">document</span>.body.appendChild(button);</span></span><br><span class="line"><span class="javascript">        button.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="undefined">            fsm.buttonWasPressed();</span></span><br><span class="line"><span class="undefined">        &#125;;</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="/img/design/fsm.png" alt="fsm" title="" class="">                <p>fsm</p>            </figure><h2 id="çŠ¶æ€æ¨¡å¼å’Œç­–ç•¥æ¨¡å¼çš„å…³ç³»"><a href="#çŠ¶æ€æ¨¡å¼å’Œç­–ç•¥æ¨¡å¼çš„å…³ç³»" class="headerlink" title="çŠ¶æ€æ¨¡å¼å’Œç­–ç•¥æ¨¡å¼çš„å…³ç³»"></a>çŠ¶æ€æ¨¡å¼å’Œç­–ç•¥æ¨¡å¼çš„å…³ç³»</h2><ol><li>çŠ¶æ€æ¨¡å¼å’Œç­–ç•¥æ¨¡å¼ éƒ½å°è£…äº†ä¸€ç³»åˆ—ç®—æ³•æˆ–è€…è¡Œä¸º, éƒ½æœ‰ä¸€ä¸ªä¸Šä¸‹æ–‡,ä¸€äº›ç­–ç•¥æˆ–è€…çŠ¶æ€ç±»,ä¸Šä¸‹æ–‡æŠŠè¯·æ±‚å§”æ‰˜ç»™è¿™äº›ç±»æ¥æ‰§è¡Œ</li><li>ç­–ç•¥æ¨¡å¼ä¸­å„ä¸ªç­–ç•¥ç±»ä¹‹é—´çš„æ˜¯å¹³ç­‰åˆå¹³è¡Œçš„,å®ƒä»¬ä¹‹é—´æ²¡æœ‰ä»»ä½•è”ç³»,æ‰€ä»¥å®¢æˆ·å¿…é¡»ç†ŸçŸ¥è¿™äº›ç­–ç•¥ç±»çš„ä½œç”¨,ä¸€è¾¹å®¢æˆ·å¯ä»¥éšæ—¶ä¸»åŠ¨åˆ‡æ¢ç®—æ³•</li><li>çŠ¶æ€æ¨¡å¼ä¸­,çŠ¶æ€å’ŒçŠ¶æ€æ‰€å¯¹åº”çš„è¡Œä¸ºæ˜¯æ—©å·²è¢«å°è£…å¥½çš„,çŠ¶æ€ä¹‹é—´çš„åˆ‡æ¢ä¹Ÿæ˜¯æ—©è¢«è§„å®šå®Œæˆ,â€æ”¹å˜è¡Œä¸ºâ€è¿™ä»¶äº‹çš„å‘ç”Ÿåœ¨çŠ¶æ€æ¨¡å¼å†…éƒ¨,å¯¹å®¢æˆ·æ¥è¯´,å¹¶ä¸éœ€è¦äº†è§£è¿™äº›ç»†èŠ‚</li></ol><p><strong>è™½ç„¶çŠ¶æ¨¡å¼ä¸€å¼€å§‹å¹¶ä¸æ˜¯éå¸¸å®¹æ˜“ç†è§£,ä½†æˆ‘ä»¬æœ‰å¿…é¡»å»å¥½å¥½æŒæ¡è¿™ç§è®¾è®¡æ¨¡å¼</strong></p><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><ul><li><em>å®ä½“ä¹¦:</em> <code>JavaScriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µ(æ›¾æ¢)</code></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JSè®¾è®¡æ¨¡å¼ç¬”è®°(è£…é¥°è€…æ¨¡å¼)</title>
      <link href="/2015/07/02/JS%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0-%E8%A3%85%E9%A5%B0%E8%80%85%E6%A8%A1%E5%BC%8F/"/>
      <url>/2015/07/02/JS%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0-%E8%A3%85%E9%A5%B0%E8%80%85%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<p>JSè®¾è®¡æ¨¡å¼ç¬”è®°(è£…é¥°è€…æ¨¡å¼)<br><a id="more"></a></p><h1 id="è£…é¥°è€…æ¨¡å¼"><a href="#è£…é¥°è€…æ¨¡å¼" class="headerlink" title="è£…é¥°è€…æ¨¡å¼"></a>è£…é¥°è€…æ¨¡å¼</h1><p><strong>åœ¨ä¸æ”¹å˜å¯¹è±¡è‡ªèº«çš„åŸºç¡€ä¸Š,åœ¨ç¨‹åºè¿è¡ŒæœŸé—´ç»™å¯¹è±¡åŠ¨æ€çš„æ·»åŠ èŒè´£</strong></p><h2 id="ç”¨AOPè£…é¥°å‡½æ•°"><a href="#ç”¨AOPè£…é¥°å‡½æ•°" class="headerlink" title="ç”¨AOPè£…é¥°å‡½æ•°"></a>ç”¨AOPè£…é¥°å‡½æ•°</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Function</span>.prototype.before = <span class="function"><span class="keyword">function</span>(<span class="params">beforefn</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> _this = <span class="keyword">this</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        beforefn.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">        <span class="keyword">return</span> _this.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">Function</span>.prototype.after = <span class="function"><span class="keyword">function</span>(<span class="params">afterfn</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> _this = <span class="keyword">this</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> ret = _this.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">        afterfn.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> testAfter = test.before(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">0</span>);</span><br><span class="line">&#125;).after(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">2</span>);</span><br><span class="line">&#125;).after(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">3</span>);</span><br><span class="line">&#125;).after(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">4</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">testAfter();<span class="comment">//0 1 2 3 4</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> before = <span class="function"><span class="keyword">function</span>(<span class="params">fn, beforefn</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        beforefn.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">        <span class="keyword">return</span> fn.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> after = <span class="function"><span class="keyword">function</span>(<span class="params">fn, afterfn</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        fn.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">        <span class="keyword">return</span> afterfn.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a = before(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">3</span>);</span><br><span class="line">&#125;, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">2</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">a = after(a, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">4</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">a();  <span class="comment">// 2  3  4</span></span><br></pre></td></tr></table></figure><h2 id="ç”¨aopåŠ¨æ€æ”¹å˜å‡½æ•°çš„å‚æ•°"><a href="#ç”¨aopåŠ¨æ€æ”¹å˜å‡½æ•°çš„å‚æ•°" class="headerlink" title="ç”¨aopåŠ¨æ€æ”¹å˜å‡½æ•°çš„å‚æ•°"></a>ç”¨aopåŠ¨æ€æ”¹å˜å‡½æ•°çš„å‚æ•°</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Function</span>.prototype.before = <span class="function"><span class="keyword">function</span>(<span class="params">beforefn</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> _this = <span class="keyword">this</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        beforefn.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">        <span class="keyword">return</span> _this.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ajax = <span class="function"><span class="keyword">function</span>(<span class="params">type, url, param</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(param);         <span class="comment">// &#123; name: 'shang', token: 'token' &#125;</span></span><br><span class="line">    <span class="comment">// æ­£çœŸè¯·æ±‚ç•¥</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> getToken = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'token'</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">ajax = ajax.before(<span class="function"><span class="keyword">function</span>(<span class="params">type, url, param</span>) </span>&#123;</span><br><span class="line">    param.token = getToken();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">ajax(<span class="string">'get'</span>, <span class="string">'url'</span>, &#123;<span class="attr">name</span>: <span class="string">'shang'</span>&#125;);</span><br></pre></td></tr></table></figure><p><strong>ç”¨AOPçš„æ–¹å¼ç»™ajaxå‡½æ•°åŠ¨æ€è£…é¥°ä¸Štokenå‚æ•°,ä¿è¯äº†ajaxå‡½æ•°æ˜¯ä¸€ä¸ªç›¸å¯¹çº¯å‡€çš„å‡½æ•°,æé«˜äº†ajaxå‡½æ•°çš„å¯å¤ç”¨æ€§</strong></p><h2 id="æ’ä»¶å¼è¡¨å•éªŒè¯"><a href="#æ’ä»¶å¼è¡¨å•éªŒè¯" class="headerlink" title="æ’ä»¶å¼è¡¨å•éªŒè¯"></a>æ’ä»¶å¼è¡¨å•éªŒè¯</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    ç”¨æˆ·åï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"username"</span> <span class="attr">type</span>=<span class="string">"text"</span>/&gt;</span></span><br><span class="line">    å¯†ç ï¼š <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"password"</span> <span class="attr">type</span>=<span class="string">"password"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"submitBtn"</span>&gt;</span>æäº¤<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> username = <span class="built_in">document</span>.getElementById(<span class="string">'username'</span>);</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> password = <span class="built_in">document</span>.getElementById(<span class="string">'password'</span>);</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> submitBtn = <span class="built_in">document</span>.getElementById(<span class="string">'submitBtn'</span>);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">        <span class="built_in">Function</span>.prototype.before = <span class="function"><span class="keyword">function</span>(<span class="params">beforefn</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">var</span> _this = <span class="keyword">this</span>;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">if</span> (beforefn.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>) === <span class="literal">false</span>) &#123;</span></span><br><span class="line"><span class="javascript">                    <span class="keyword">return</span>;</span></span><br><span class="line"><span class="undefined">                &#125;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">return</span> _this.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> validate = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">if</span> (username.value === <span class="string">''</span>) &#123;</span></span><br><span class="line"><span class="javascript">                alert(<span class="string">'ç”¨æˆ·åä¸èƒ½ä¸ºç©º'</span>);</span></span><br><span class="line"><span class="javascript">                <span class="keyword">return</span> <span class="literal">false</span>;</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">if</span> (password.value === <span class="string">''</span>) &#123;</span></span><br><span class="line"><span class="javascript">                alert(<span class="string">'å¯†ç ä¸èƒ½ä¸ºç©º'</span>);</span></span><br><span class="line"><span class="javascript">                <span class="keyword">return</span> <span class="literal">false</span>;</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> formSubmit = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">var</span> param = &#123;</span></span><br><span class="line"><span class="undefined">                username: username.value,</span></span><br><span class="line"><span class="undefined">                password: password.value</span></span><br><span class="line"><span class="undefined">            &#125;;</span></span><br><span class="line"><span class="javascript">            alert(<span class="string">'æäº¤æ•°æ®: '</span> + <span class="built_in">JSON</span>.stringify(param));</span></span><br><span class="line"><span class="javascript">            <span class="comment">// ajax;</span></span></span><br><span class="line"><span class="undefined">        &#125;;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">        formSubmit = formSubmit.before(validate);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">        submitBtn.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="undefined">            formSubmit();</span></span><br><span class="line"><span class="undefined">        &#125;;</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„"></a>æ³¨æ„</h2><ol><li>å› ä¸ºå‡½æ•°é€šè¿‡ <code>Function.prototype.before</code> æˆ–è€… <code>Function.prototype.after</code> è¢«è£…é¥°ä¹‹å,è¿”å›çš„å®é™…ä¸Šæ˜¯ä¸€ä¸ªæ–°çš„å‡½æ•°,å¦‚æœåŸå‡½æ•°ä¸Šä¿å­˜äº†ä¸€äº›å±æ€§,é‚£ä¹ˆè¿™äº›å±æ€§ä¼šä¸¢å¤±</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> func = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    alert(<span class="number">1</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">func.a = <span class="string">'a'</span>;</span><br><span class="line"></span><br><span class="line">func = func.after(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    alert(<span class="number">2</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">alert(func.a); <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure><ol start="2"><li>è¿™ç§è£…é¥°æ–¹å¼ä¹Ÿå åŠ äº†å‡½æ•°çš„ä½œç”¨åŸŸ,å¦‚æœè£…é¥°çš„é“¾æ¡è¿‡é•¿,æ€§èƒ½ä¸Šä¹Ÿä¼šæ”¶åˆ°ä¸€äº›å½±å“</li></ol><h2 id="è£…é¥°è€…æ¨¡å¼å’Œä»£ç†æ¨¡å¼"><a href="#è£…é¥°è€…æ¨¡å¼å’Œä»£ç†æ¨¡å¼" class="headerlink" title="è£…é¥°è€…æ¨¡å¼å’Œä»£ç†æ¨¡å¼"></a>è£…é¥°è€…æ¨¡å¼å’Œä»£ç†æ¨¡å¼</h2><p><strong>ç›¸åŒ</strong></p><ul><li>éƒ½æè¿°äº†æ€æ ·ä¸ºå¯¹è±¡æä¾›ä¸€å®šç¨‹åº¦ä¸Šçš„é—´æ¥å¼•ç”¨</li><li>å®ƒä»¬çš„å®ç°éƒ¨åˆ†éƒ½ä¿ç•™å¯å¯¹å¦å¤–ä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨,å¹¶å‘é‚£ä¸ªå¯¹è±¡å‘é€è¯·æ±‚</li></ul><p><strong>åŒºåˆ«</strong></p><blockquote><ul><li>ä»£ç†æ¨¡å¼çš„ç›®çš„æ˜¯:å½“ç›´æ¥è®¿é—®æœ¬ä½“ä¸æ–¹ä¾¿æˆ–è€…ä¸ç¬¦åˆéœ€è¦æ—¶,ä¸ºè¿™ä¸ªæœ¬ä½“æä¾›ä¸€ä¸ªæ›¿ä»£è€….æœ¬ä½“å®šä¹‰äº†å…³é”®åŠŸèƒ½,è€Œä»£ç†æä¾›æˆ–æ‹’ç»å¯¹å®ƒçš„è®¿é—®,æˆ–è€…åœ¨è®¿é—®æœ¬ä½“ä¹‹å‰åšä¸€äº›é¢å¤–çš„äº‹æƒ…</li><li>è£…é¥°è€…æ¨¡å¼çš„ä½œç”¨å°±æ˜¯ä¸ºäº†å¯¹è±¡åŠ¨æ€åŠ å…¥è¡Œä¸º</li></ul></blockquote><blockquote><ul><li>ä»£ç†æ¨¡å¼å¼ºè°ƒçš„ä¸€ç§ç®¡ç†(proxyå’Œå®ƒå®ä½“ä¹‹é—´çš„å…³ç³»),è¿™ç§å…³ç³»åœ¨ä¸€å¼€å§‹å°±å¯ä»¥è¢«ç¡®å®š</li><li>è£…é¥°è€…æ¨¡å¼ç”¨äºä¸€å¼€å§‹ä¸èƒ½ç¡®å®šå¯¹è±¡çš„å…¨éƒ¨åŠŸèƒ½</li></ul></blockquote><blockquote><ul><li>ä»£ç†æ¨¡å¼é€šå¸¸åªæœ‰ä¸€å±‚ä»£ç†-å¯¹è±¡çš„å¼•ç”¨</li><li>è£…é¥°è€…æ¨¡å¼ç»å¸¸ä¼šå½¢æˆä¸€æ¡å¸¸å¸¸çš„è£…é¥°é“¾</li></ul></blockquote><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><ul><li><em>å®ä½“ä¹¦:</em> <code>JavaScriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µ(æ›¾æ¢)</code></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong></p></blockquote><blockquote><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JSè®¾è®¡æ¨¡å¼ç¬”è®°(ä¸­ä»‹è€…æ¨¡å¼)</title>
      <link href="/2015/07/01/JS%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0-%E4%B8%AD%E4%BB%8B%E8%80%85%E6%A8%A1%E5%BC%8F/"/>
      <url>/2015/07/01/JS%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0-%E4%B8%AD%E4%BB%8B%E8%80%85%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<p>JSè®¾è®¡æ¨¡å¼ç¬”è®°(ä¸­ä»‹è€…æ¨¡å¼)<br><a id="more"></a></p><h1 id="ä¸­ä»‹è€…æ¨¡å¼"><a href="#ä¸­ä»‹è€…æ¨¡å¼" class="headerlink" title="ä¸­ä»‹è€…æ¨¡å¼"></a>ä¸­ä»‹è€…æ¨¡å¼</h1><p><strong>ä¸­ä»‹è€…æ¨¡å¼çš„ä½œç”¨æ˜¯è§£é™¤å¯¹è±¡å’Œå¯¹è±¡ä¹‹é—´çš„ç´§è€¦åˆå…³ç³».</strong></p><h2 id="æ³¡æ³¡å ‚æ¸¸æˆ-å®ä¾‹"><a href="#æ³¡æ³¡å ‚æ¸¸æˆ-å®ä¾‹" class="headerlink" title="æ³¡æ³¡å ‚æ¸¸æˆ-å®ä¾‹"></a>æ³¡æ³¡å ‚æ¸¸æˆ-å®ä¾‹</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Player</span>(<span class="params">name, teamColor</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;               <span class="comment">// è§’è‰²åç§°</span></span><br><span class="line">    <span class="keyword">this</span>.teamColor = teamColor;     <span class="comment">// é˜Ÿä¼é¢œè‰²</span></span><br><span class="line">    <span class="keyword">this</span>.state = <span class="string">'alive'</span>;           <span class="comment">// ç©å®¶ç”Ÿå­˜çŠ¶æ€</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Player.prototype.win = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name + <span class="string">' won '</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Player.prototype.lose = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name + <span class="string">' lost'</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Player.prototype.die = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.state = <span class="string">'dead'</span>;</span><br><span class="line">    PlayerDirector.ReceiveMessage(<span class="string">'playerDead'</span>, <span class="keyword">this</span>);  <span class="comment">// ç»™ä¸­ä»‹è€…å‘é€æ¶ˆæ¯,ç©å®¶æ­»äº¡</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Player.prototype.remove = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    PlayerDirector.ReceiveMessage(<span class="string">'removePlayer'</span>, <span class="keyword">this</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Player.prototype.changeTeam = <span class="function"><span class="keyword">function</span>(<span class="params">color</span>) </span>&#123;</span><br><span class="line">    PlayerDirector.ReceiveMessage(<span class="string">'changeTeam'</span>, <span class="keyword">this</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> PlayerFactory = <span class="function"><span class="keyword">function</span>(<span class="params">name, teamColor</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> newPlayer = <span class="keyword">new</span> Player(name, teamColor);</span><br><span class="line">    PlayerDirector.ReceiveMessage(<span class="string">'addPlayer'</span>, newPlayer);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> newPlayer;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> PlayerDirector = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> players = &#123;&#125;;</span><br><span class="line">    <span class="keyword">var</span> operations = &#123;&#125;;  <span class="comment">//ä¸­ä»‹è€…å¯ä»¥æ‰§è¡Œçš„æ“ä½œ;</span></span><br><span class="line"></span><br><span class="line">    operations.addPlayer = <span class="function"><span class="keyword">function</span>(<span class="params">player</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> teamColor = player.teamColor;</span><br><span class="line">        <span class="comment">// å¦‚æœç»™é¢œè‰²çš„ç©å®¶æ²¡æœ‰æˆç«‹é˜Ÿä¼,åˆ™æ–°å»ºä¸€ä¸ªé˜Ÿä¼</span></span><br><span class="line">        players[teamColor] = players[teamColor] || [];</span><br><span class="line">        players[teamColor].push(player);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    operations.removePlayer = <span class="function"><span class="keyword">function</span>(<span class="params">player</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> teamColor = player.teamColor;</span><br><span class="line">        <span class="keyword">var</span> teamPlayers = players[teamColor];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = teamPlayers.length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">            <span class="keyword">if</span> (teamPlayers[i] === player) &#123;</span><br><span class="line">                teamPlayers.splice(i, <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    operations.changeTeam = <span class="function"><span class="keyword">function</span>(<span class="params">player, newTeamColor</span>) </span>&#123;</span><br><span class="line">        operations.removePlayer(player);</span><br><span class="line">        player.teamColor = <span class="keyword">new</span> newTeamColor;</span><br><span class="line">        operations.addPlayer(player);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    operations.playerDead = <span class="function"><span class="keyword">function</span>(<span class="params">player</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> teamColor = player.teamColor;</span><br><span class="line">        <span class="keyword">var</span> teamPlayers = players[teamColor];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> all_dead = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, p; p = teamPlayers[i++]; ) &#123;</span><br><span class="line">            <span class="keyword">if</span> (p.state !== <span class="string">'dead'</span>) &#123;</span><br><span class="line">                all_dead = <span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (all_dead) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, p; p = teamPlayers[i++]; ) &#123;</span><br><span class="line">                p.lose();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> color <span class="keyword">in</span> players) &#123;</span><br><span class="line">                <span class="keyword">if</span> (color !== teamColor) &#123;</span><br><span class="line">                    <span class="keyword">var</span> teamPlayers = players[color];</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, p; p = teamPlayers[i++];) &#123;</span><br><span class="line">                        p.win();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> ReceiveMessage = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> message = [].shift.call(<span class="built_in">arguments</span>);</span><br><span class="line">        operations[message].apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        ReceiveMessage: ReceiveMessage</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;());</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> player1 = PlayerFactory(<span class="string">'red1'</span>, <span class="string">'red'</span>);</span><br><span class="line"><span class="keyword">var</span> player2 = PlayerFactory(<span class="string">'red2'</span>, <span class="string">'red'</span>);</span><br><span class="line"><span class="keyword">var</span> player3 = PlayerFactory(<span class="string">'red3'</span>, <span class="string">'red'</span>);</span><br><span class="line"><span class="keyword">var</span> player4 = PlayerFactory(<span class="string">'red4'</span>, <span class="string">'red'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> player5 = PlayerFactory(<span class="string">'blue1'</span>, <span class="string">'blue'</span>);</span><br><span class="line"><span class="keyword">var</span> player6 = PlayerFactory(<span class="string">'blue2'</span>, <span class="string">'blue'</span>);</span><br><span class="line"><span class="keyword">var</span> player7 = PlayerFactory(<span class="string">'blue3'</span>, <span class="string">'blue'</span>);</span><br><span class="line"><span class="keyword">var</span> player8 = PlayerFactory(<span class="string">'blue4'</span>, <span class="string">'blue'</span>);</span><br><span class="line"></span><br><span class="line">player1.die();</span><br><span class="line">player2.die();</span><br><span class="line">player3.die();</span><br><span class="line">player4.die();</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> red1 lost</span></span><br><span class="line"><span class="comment"> red2 lost</span></span><br><span class="line"><span class="comment"> red3 lost</span></span><br><span class="line"><span class="comment"> red4 lost</span></span><br><span class="line"><span class="comment"> blue1 won</span></span><br><span class="line"><span class="comment"> blue2 won</span></span><br><span class="line"><span class="comment"> blue3 won</span></span><br><span class="line"><span class="comment"> blue4 won </span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure><p><strong>å¦‚æœå¯¹è±¡ä¹‹é—´çš„å¤æ‚è€¦åˆç¡®å®å¯¼è‡´è°ƒç”¨å’Œç»´æŠ¤å‡ºç°äº†å›°éš¾,è€Œä¸”è¿™äº›è€¦åˆåº¦éšé¡¹ç›®çš„å˜åŒ–å‘ˆæŒ‡æ•°å¢é•¿æ›²çº¿,é‚£æˆ‘ä»¬å°±å¯ä»¥è€ƒè™‘ç”¨ä¸­ä»‹è€…æ¨¡å¼é‡æ„ä»£ç </strong></p><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><ul><li><em>å®ä½“ä¹¦:</em> <code>JavaScriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µ(æ›¾æ¢)</code></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JSè®¾è®¡æ¨¡å¼ç¬”è®°(èŒè´£é“¾æ¨¡å¼)</title>
      <link href="/2015/06/30/JS%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0-%E8%81%8C%E8%B4%A3%E9%93%BE%E6%A8%A1%E5%BC%8F/"/>
      <url>/2015/06/30/JS%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0-%E8%81%8C%E8%B4%A3%E9%93%BE%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<p>JSè®¾è®¡æ¨¡å¼ç¬”è®°(èŒè´£é“¾æ¨¡å¼)<br><a id="more"></a></p><h1 id="èŒè´£é“¾æ¨¡å¼"><a href="#èŒè´£é“¾æ¨¡å¼" class="headerlink" title="èŒè´£é“¾æ¨¡å¼"></a>èŒè´£é“¾æ¨¡å¼</h1><p><strong>å®šä¹‰: ä½¿å¤šä¸ªå¯¹è±¡éƒ½æœ‰æœºä¼šå¤„ç†è¯·æ±‚,ä»è€Œé¿å…è¯·æ±‚å‘é€è¿™å’Œæ¥å—è¿™ä¹‹é—´çš„è€¦åˆå…³ç³»,å°†è¿™äº›å¯¹è±¡ç»ƒæˆä¸€æ¡é“¾,å¹¶æ²¿ç€è¿™æ¡é“¾ä¼ é€’è¯¥è¯·æ±‚,ç›´åˆ°æœ‰ä¸€ä¸ªå¯¹è±¡å¤„ç†å®ƒä¸ºæ­¢</strong></p><h2 id="å•†å“è´­ä¹°-èŒè´£é“¾å®ä¾‹"><a href="#å•†å“è´­ä¹°-èŒè´£é“¾å®ä¾‹" class="headerlink" title="å•†å“è´­ä¹°-èŒè´£é“¾å®ä¾‹"></a>å•†å“è´­ä¹°-èŒè´£é“¾å®ä¾‹</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> order500 = <span class="function"><span class="keyword">function</span>(<span class="params">orderType, pay, stock</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(orderType === <span class="number">1</span> &amp;&amp; pay === <span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'500å®šé‡‘é¢„å®š,å¾—åˆ°100ä¼˜æƒ å·'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        order200(orderType, pay, stock);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> order200 = <span class="function"><span class="keyword">function</span>(<span class="params">orderType, pay, stock</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (orderType === <span class="number">2</span> &amp;&amp; pay === <span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'200 å®šé‡‘é¢„å®š,å¾—åˆ°50ä¼˜æƒ å·'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        orderNomal(orderType, pay, stock);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> orderNomal = <span class="function"><span class="keyword">function</span>(<span class="params">orderType, pay, stock</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (stock &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'æ™®é€šè´­ä¹°,æ— ä¼˜æƒ å·'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'åº“å­˜ä¸è¶³'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">order500(<span class="number">1</span>, <span class="literal">false</span>, <span class="number">500</span>); <span class="comment">// æ™®é€šè´­ä¹°,æ— ä¼˜æƒ å·</span></span><br><span class="line">order500(<span class="number">3</span>, <span class="literal">false</span>, <span class="number">0</span>);  <span class="comment">// åº“å­˜ä¸è¶³</span></span><br></pre></td></tr></table></figure><h2 id="çµæ´»å¯æ‹†åˆ†çš„èŒè´£é“¾èŠ‚ç‚¹"><a href="#çµæ´»å¯æ‹†åˆ†çš„èŒè´£é“¾èŠ‚ç‚¹" class="headerlink" title="çµæ´»å¯æ‹†åˆ†çš„èŒè´£é“¾èŠ‚ç‚¹"></a>çµæ´»å¯æ‹†åˆ†çš„èŒè´£é“¾èŠ‚ç‚¹</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> order500 = <span class="function"><span class="keyword">function</span>(<span class="params">orderType, pay, stock</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(orderType === <span class="number">1</span> &amp;&amp; pay === <span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'500å®šé‡‘é¢„å®š,å¾—åˆ°100ä¼˜æƒ å·'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="string">'nextSuccessor'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> order200 = <span class="function"><span class="keyword">function</span>(<span class="params">orderType, pay, stock</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (orderType === <span class="number">2</span> &amp;&amp; pay === <span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'200 å®šé‡‘é¢„å®š,å¾—åˆ°50ä¼˜æƒ å·'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'nextSuccessor'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> orderNomal = <span class="function"><span class="keyword">function</span>(<span class="params">orderType, pay, stock</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (stock &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'æ™®é€šè´­ä¹°,æ— ä¼˜æƒ å·'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'åº“å­˜ä¸è¶³'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> Chain = <span class="function"><span class="keyword">function</span>(<span class="params">fn</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.fn = fn;</span><br><span class="line">    <span class="keyword">this</span>.successor = <span class="literal">null</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Chain.prototype.setNextSuccessor = <span class="function"><span class="keyword">function</span>(<span class="params">successor</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.successor = successor;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Chain.prototype.passRequest = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> ret = <span class="keyword">this</span>.fn.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (ret === <span class="string">'nextSuccessor'</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.successor &amp;&amp; <span class="keyword">this</span>.successor.passRequest.apply(<span class="keyword">this</span>.successor, <span class="built_in">arguments</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> chainOrder500 = <span class="keyword">new</span> Chain(order500);</span><br><span class="line"><span class="keyword">var</span> chainOrder200 = <span class="keyword">new</span> Chain(order200);</span><br><span class="line"><span class="keyword">var</span> chainOrderNormal = <span class="keyword">new</span> Chain(orderNomal);</span><br><span class="line"></span><br><span class="line">chainOrder500.setNextSuccessor(chainOrder200);</span><br><span class="line">chainOrder200.setNextSuccessor(chainOrderNormal);</span><br><span class="line"></span><br><span class="line">chainOrder500.passRequest(<span class="number">3</span>, <span class="literal">true</span>, <span class="number">500</span>); <span class="comment">// æ™®é€šè´­ä¹°,æ— ä¼˜æƒ å·</span></span><br></pre></td></tr></table></figure><h2 id="ä¼˜ç¼ºç‚¹"><a href="#ä¼˜ç¼ºç‚¹" class="headerlink" title="ä¼˜ç¼ºç‚¹"></a>ä¼˜ç¼ºç‚¹</h2><p><strong>ä¼˜ç‚¹</strong></p><ol><li>è§£è€¦äº†è¯·æ±‚å‘é€è€…å’ŒNä¸ªæ¥å—è€…ä¹‹é—´çš„å¤æ‚å…³ç³»</li><li>é“¾ä¸­çš„èŠ‚ç‚¹å¯¹è±¡å¯ä»¥çµæ´»çš„æ‹†åˆ†é‡ç»„</li><li>å¯ä»¥æ‰‹åŠ¨æŒ‡å®šå…¶å®èŠ‚ç‚¹</li></ol><p><strong>ç¼ºç‚¹</strong></p><ul><li>é¿å…è¿‡é•¿çš„èŒè´£é“¾å¸¦æ¥çš„æ€§èƒ½æŸè€—</li></ul><h2 id="åˆ©ç”¨aopå®ç°èŒè´£é“¾"><a href="#åˆ©ç”¨aopå®ç°èŒè´£é“¾" class="headerlink" title="åˆ©ç”¨aopå®ç°èŒè´£é“¾"></a>åˆ©ç”¨aopå®ç°èŒè´£é“¾</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> order500 = <span class="function"><span class="keyword">function</span>(<span class="params">orderType, pay, stock</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (orderType === <span class="number">1</span> &amp;&amp; pay === <span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'500å®šé‡‘é¢„å®š,å¾—åˆ°100ä¼˜æƒ å·'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'nextSuccessor'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> order200 = <span class="function"><span class="keyword">function</span>(<span class="params">orderType, pay, stock</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (orderType === <span class="number">2</span> &amp;&amp; pay === <span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'200 å®šé‡‘é¢„å®š,å¾—åˆ°50ä¼˜æƒ å·'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'nextSuccessor'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> orderNomal = <span class="function"><span class="keyword">function</span>(<span class="params">orderType, pay, stock</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (stock &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'æ™®é€šè´­ä¹°,æ— ä¼˜æƒ å·'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'åº“å­˜ä¸è¶³'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Function</span>.prototype.after = <span class="function"><span class="keyword">function</span>(<span class="params">fn</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> _this = <span class="keyword">this</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> ret = _this.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">        <span class="keyword">if</span> (ret === <span class="string">'nextSuccessor'</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> fn.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> order = order500.after(order200).after(orderNomal);</span><br><span class="line"></span><br><span class="line">order(<span class="number">1</span>, <span class="literal">false</span>, <span class="number">500</span>); <span class="comment">// æ™®é€šè´­ä¹°,æ— ä¼˜æƒ å·</span></span><br></pre></td></tr></table></figure><p><strong>å¢åŠ äº†å‡½æ•°çš„ä½œç”¨åŸŸ,å¦‚æœé“¾æ¡å¤ªé•¿,ä¼šå¯¹æ€§èƒ½æœ‰è¾ƒå¤§çš„å½±å“</strong></p><h2 id="è·å–æ–‡ä»¶ä¸Šä¼ å¯¹è±¡-èŒè´£é“¾å®ä¾‹"><a href="#è·å–æ–‡ä»¶ä¸Šä¼ å¯¹è±¡-èŒè´£é“¾å®ä¾‹" class="headerlink" title="è·å–æ–‡ä»¶ä¸Šä¼ å¯¹è±¡-èŒè´£é“¾å®ä¾‹"></a>è·å–æ–‡ä»¶ä¸Šä¼ å¯¹è±¡-èŒè´£é“¾å®ä¾‹</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Function</span>.prototype.after = <span class="function"><span class="keyword">function</span>(<span class="params">fn</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> _this = <span class="keyword">this</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> ret = _this.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">        <span class="keyword">if</span> (ret === <span class="string">'nextSuccessor'</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> fn.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> getActiveUploadObj = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ActiveXObject(<span class="string">'TXFTNActivex.FTMUpload'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'nextSuccessor'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> getFlashUploadObj = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (supportFlash()) &#123;  <span class="comment">// supportFlashæœªå®ç°</span></span><br><span class="line">        <span class="keyword">var</span> str = <span class="string">'&lt;object type="application/x-shockwave-flash"&gt;&lt;/object&gt;'</span>;</span><br><span class="line">        <span class="keyword">return</span> $(str).appendTo($(<span class="string">'body'</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'nextSuccessor'</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> getFormUploadObj = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> str = <span class="string">'&lt;input name="file" type="file"&gt;'</span>;</span><br><span class="line">    <span class="keyword">return</span> $(str).appendTo($(<span class="string">'body'</span>));</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> getUploadObj = getActiveUploadObj.after(getFlashUploadObj).after(getFormUploadObj);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(getUploadObj());</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><ul><li><em>å®ä½“ä¹¦:</em> <code>JavaScriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µ(æ›¾æ¢)</code></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexo3ä¸­hexo gç”Ÿæˆé€Ÿåº¦è¿‡æ…¢</title>
      <link href="/2015/06/29/hexo3%E4%B8%ADhexo-g%E7%94%9F%E6%88%90%E9%80%9F%E5%BA%A6%E8%BF%87%E6%85%A2/"/>
      <url>/2015/06/29/hexo3%E4%B8%ADhexo-g%E7%94%9F%E6%88%90%E9%80%9F%E5%BA%A6%E8%BF%87%E6%85%A2/</url>
      
        <content type="html"><![CDATA[<p>hexo g æ—¶é—´è¿‡é•¿<br><a id="more"></a></p><h2 id="åŸå› "><a href="#åŸå› " class="headerlink" title="åŸå› "></a>åŸå› </h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Hexo 3 ä¸­çš„ highlight.js ä¼šè¯•å›¾åˆ†æ `` ` ä¸­çš„ä»£ç å†…å®¹å¯èƒ½å±äºå“ªç§è¯­è¨€,å†…å®¹è¶Šé•¿,åˆ†ææ—¶é—´å°±è¶Šé•¿</span><br><span class="line"></span><br><span class="line">åœ¨Hexo 2 è‡ªå¸¦çš„è¯­æ³•é«˜äº®æ’ä»¶ highlight.js åœ¨é‡åˆ°æ²¡æœ‰è¯­è¨€è¯´æ˜çš„ä»£ç æ—¶æ˜¯ç»Ÿä¸€å½“æˆçº¯æ–‡æœ¬</span><br></pre></td></tr></table></figure><h2 id="è§£å†³åŠæ³•"><a href="#è§£å†³åŠæ³•" class="headerlink" title="è§£å†³åŠæ³•:"></a>è§£å†³åŠæ³•:</h2><p>åœ¨æ²¡æœ‰è¯­è¨€è¯´æ˜ç¬¦çš„ä»£ç æ®µåé¢åŠ ä¸Š ç±»ä¼¼<code>js</code> çš„è¯´æ˜ç¬¦;</p><p>è€ƒè™‘åˆ°æœ‰å¾ˆå¤šmdæ–‡ä»¶,æ‰€ä»¥æ‹¿node.jså†™äº†è‡ªåŠ¨ä¿®æ”¹ <a href="https://gist.github.com/xinshangshangxin/2fa9cecf2423185bcb3a" target="_blank" rel="noopener">hexo3_speed_up</a></p><h2 id="ä½¿ç”¨è¯´æ˜"><a href="#ä½¿ç”¨è¯´æ˜" class="headerlink" title="ä½¿ç”¨è¯´æ˜"></a>ä½¿ç”¨è¯´æ˜</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node speed_up.js [mdæ–‡ä»¶å¤¹(source/_posts)æˆ–æ–‡ä»¶è·¯å¾„(é»˜è®¤ä¸ºå½“å‰æ–‡ä»¶å¤¹)] [è¯´æ˜ç¬¦(é»˜è®¤ä¸ºjs)]</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> userPath = path.resolve(process.argv[<span class="number">2</span>] || <span class="string">'./'</span>);</span><br><span class="line"><span class="keyword">var</span> codeStyle = process.argv[<span class="number">3</span>] || <span class="string">'js'</span>;</span><br><span class="line"></span><br><span class="line">explorer(userPath);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">explorer</span>(<span class="params">path</span>) </span>&#123;</span><br><span class="line">    fs.stat(path, <span class="function"><span class="keyword">function</span>(<span class="params">err, stat</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(err);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (stat.isDirectory()) &#123;</span><br><span class="line">            fs.readdir(path, <span class="function"><span class="keyword">function</span>(<span class="params">err, files</span>) </span>&#123;</span><br><span class="line">                <span class="comment">//err ä¸ºé”™è¯¯ , files æ–‡ä»¶ååˆ—è¡¨åŒ…å«æ–‡ä»¶å¤¹ä¸æ–‡ä»¶</span></span><br><span class="line">                <span class="keyword">if</span> (err) &#123;</span><br><span class="line">                    <span class="built_in">console</span>.log(<span class="string">'error:\n'</span> + err);</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                files.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">file</span>) </span>&#123;</span><br><span class="line">                    fs.stat(path + <span class="string">'/'</span> + file, <span class="function"><span class="keyword">function</span>(<span class="params">err, stat</span>) </span>&#123;</span><br><span class="line">                        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">                            <span class="built_in">console</span>.log(err);</span><br><span class="line">                            <span class="keyword">return</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">if</span> (stat.isDirectory()) &#123;</span><br><span class="line">                            <span class="comment">// å¦‚æœæ˜¯æ–‡ä»¶å¤¹éå†</span></span><br><span class="line">                            explorer(path + <span class="string">'/'</span> + file);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> &#123;</span><br><span class="line">                            <span class="comment">// è¯»å‡ºæ‰€æœ‰çš„æ–‡ä»¶</span></span><br><span class="line">                            <span class="keyword">var</span> fileName = path + <span class="string">'/'</span> + file;</span><br><span class="line">                            <span class="keyword">if</span> (<span class="regexp">/.*\.md$/</span>.test(fileName) &amp;&amp; !<span class="regexp">/node_modules/</span>.test(fileName)) &#123;</span><br><span class="line">                                <span class="comment">//console.log(fileName);</span></span><br><span class="line">                                changeContext(fileName);</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            changeContext(userPath);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">changeContext</span>(<span class="params">filename</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> index = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> arr = [];</span><br><span class="line">    eachLine(filename, <span class="function"><span class="keyword">function</span>(<span class="params">line</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="regexp">/```.*/</span>.test(line)) &#123;</span><br><span class="line">            index++;</span><br><span class="line">            <span class="keyword">if</span> (<span class="regexp">/```\s*$/</span>.test(line)) &#123;</span><br><span class="line">                <span class="keyword">if</span> (index % <span class="number">2</span> === <span class="number">1</span>) &#123;</span><br><span class="line">                    line = <span class="string">'```'</span> + codeStyle;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        arr.push(line);</span><br><span class="line">    &#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        fs.writeFile(filename, arr.join(<span class="string">'\n'</span>) + <span class="string">'\n'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (err) &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(err);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">'ä¿®æ”¹ '</span> + filename + <span class="string">' æˆåŠŸ~'</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*****ä»¥ä¸‹ä»£ç æ¥è‡ª https://github.com/nickewing/line-reader/blob/master/lib/line_reader.js*****/</span></span><br><span class="line"><span class="comment">// è¿™æ · å°±ä¸éœ€è¦ å®‰è£… node_modulesäº†</span></span><br><span class="line"><span class="keyword">var</span> StringDecoder = <span class="built_in">require</span>(<span class="string">'string_decoder'</span>).StringDecoder;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">LineReader</span>(<span class="params">fd, cb, separator, encoding, bufferSize</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> filePosition = <span class="number">0</span>,</span><br><span class="line">        encoding = encoding || <span class="string">'utf8'</span>,</span><br><span class="line">        separator = separator || <span class="string">'\n'</span>,</span><br><span class="line">        bufferSize = bufferSize || <span class="number">1024</span>,</span><br><span class="line">        buffer = <span class="keyword">new</span> Buffer(bufferSize),</span><br><span class="line">        bufferStr = <span class="string">''</span>,</span><br><span class="line">        decoder = <span class="keyword">new</span> StringDecoder(encoding),</span><br><span class="line">        closed = <span class="literal">false</span>,</span><br><span class="line">        eof = <span class="literal">false</span>,</span><br><span class="line">        separatorIndex = <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">close</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!closed) &#123;</span><br><span class="line">            fs.close(fd, <span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (err) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> err;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            closed = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">readToSeparator</span>(<span class="params">cb</span>) </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">readChunk</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            fs.read(fd, buffer, <span class="number">0</span>, bufferSize, filePosition, <span class="function"><span class="keyword">function</span>(<span class="params">err, bytesRead</span>) </span>&#123;</span><br><span class="line">                <span class="keyword">var</span> separatorAtEnd;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (err) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> err;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (bytesRead &lt; bufferSize) &#123;</span><br><span class="line">                    eof = <span class="literal">true</span>;</span><br><span class="line">                    close();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                filePosition += bytesRead;</span><br><span class="line"></span><br><span class="line">                bufferStr += decoder.write(buffer.slice(<span class="number">0</span>, bytesRead));</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (separatorIndex &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                    separatorIndex = bufferStr.indexOf(separator);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                separatorAtEnd = separatorIndex === bufferStr.length - <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span> (bytesRead &amp;&amp; (separatorIndex === <span class="number">-1</span> || separatorAtEnd) &amp;&amp; !eof) &#123;</span><br><span class="line">                    readChunk();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    cb();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        readChunk();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">hasNextLine</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> bufferStr.length &gt; <span class="number">0</span> || !eof;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">nextLine</span>(<span class="params">cb</span>) </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">getLine</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> ret = bufferStr.substring(<span class="number">0</span>, separatorIndex);</span><br><span class="line"></span><br><span class="line">            bufferStr = bufferStr.substring(separatorIndex + separator.length);</span><br><span class="line">            separatorIndex = <span class="number">-1</span>;</span><br><span class="line">            cb(ret);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (separatorIndex &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            separatorIndex = bufferStr.indexOf(separator);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (separatorIndex &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (eof) &#123;</span><br><span class="line">                <span class="keyword">if</span> (hasNextLine()) &#123;</span><br><span class="line">                    separatorIndex = bufferStr.length;</span><br><span class="line">                    getLine();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'No more lines to read.'</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                readToSeparator(getLine);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            getLine();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.hasNextLine = hasNextLine;</span><br><span class="line">    <span class="keyword">this</span>.nextLine = nextLine;</span><br><span class="line">    <span class="keyword">this</span>.close = close;</span><br><span class="line"></span><br><span class="line">    readToSeparator(cb);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">open</span>(<span class="params">filename, cb, separator, encoding, bufferSize</span>) </span>&#123;</span><br><span class="line">    fs.open(filename, <span class="string">'r'</span>, <span class="built_in">parseInt</span>(<span class="string">'666'</span>, <span class="number">8</span>), <span class="function"><span class="keyword">function</span>(<span class="params">err, fd</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> reader;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">            <span class="keyword">throw</span> err;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        reader = <span class="keyword">new</span> LineReader(fd, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            cb(reader);</span><br><span class="line">        &#125;, separator, encoding, bufferSize);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">eachLine</span>(<span class="params">filename, cb, separator, encoding, bufferSize</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> finalFn,</span><br><span class="line">        asyncCb = cb.length == <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">finish</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (finalFn &amp;&amp; <span class="keyword">typeof</span> finalFn === <span class="string">'function'</span>) &#123;</span><br><span class="line">            finalFn();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    open(filename, <span class="function"><span class="keyword">function</span>(<span class="params">reader</span>) </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">newRead</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (reader.hasNextLine()) &#123;</span><br><span class="line">                setImmediate(readNext);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                finish();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">continueCb</span>(<span class="params">continueReading</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (continueReading !== <span class="literal">false</span>) &#123;</span><br><span class="line">                newRead();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                finish();</span><br><span class="line">                reader.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">readNext</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            reader.nextLine(<span class="function"><span class="keyword">function</span>(<span class="params">line</span>) </span>&#123;</span><br><span class="line">                <span class="keyword">var</span> last = !reader.hasNextLine();</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (asyncCb) &#123;</span><br><span class="line">                    cb(line, last, continueCb);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (cb(line, last) !== <span class="literal">false</span>) &#123;</span><br><span class="line">                        newRead();</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span> &#123;</span><br><span class="line">                        finish();</span><br><span class="line">                        reader.close();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        newRead();</span><br><span class="line">    &#125;, separator, encoding, bufferSize);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        then: <span class="function"><span class="keyword">function</span>(<span class="params">cb</span>) </span>&#123;</span><br><span class="line">            finalFn = cb;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><ul><li><a href="http://hahack.com/codes/hexo-3-speed-up/" target="_blank" rel="noopener">http://hahack.com/codes/hexo-3-speed-up/</a></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JSè®¾è®¡æ¨¡å¼ç¬”è®°(äº«å…ƒæ¨¡å¼)</title>
      <link href="/2015/06/29/JS%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0-%E4%BA%AB%E5%85%83%E6%A8%A1%E5%BC%8F/"/>
      <url>/2015/06/29/JS%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0-%E4%BA%AB%E5%85%83%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<p>JSè®¾è®¡æ¨¡å¼ç¬”è®°(äº«å…ƒæ¨¡å¼)<br><a id="more"></a></p><h1 id="äº«å…ƒæ¨¡å¼"><a href="#äº«å…ƒæ¨¡å¼" class="headerlink" title="äº«å…ƒæ¨¡å¼"></a>äº«å…ƒæ¨¡å¼</h1><p><strong>äº«å…ƒæ¨¡å¼æ˜¯ä¸€ç§ç”¨äºæ€§èƒ½ä¼˜åŒ–çš„æ¨¡å¼</strong></p><h2 id="å†…éƒ¨çŠ¶æ€ä¸å¤–éƒ¨çŠ¶æ€"><a href="#å†…éƒ¨çŠ¶æ€ä¸å¤–éƒ¨çŠ¶æ€" class="headerlink" title="å†…éƒ¨çŠ¶æ€ä¸å¤–éƒ¨çŠ¶æ€"></a>å†…éƒ¨çŠ¶æ€ä¸å¤–éƒ¨çŠ¶æ€</h2><blockquote><p>äº«å…ƒæ¨¡å¼è¦æ±‚å°†å¯¹è±¡çš„å±æ€§åˆ’åˆ†ä¸ºå†…éƒ¨çŠ¶æ€å’Œå¤–éƒ¨çŠ¶æ€(çŠ¶æ€åœ¨è¿™é‡Œé€šå¸¸æŒ‡å±æ€§);</p><blockquote><ul><li>å†…éƒ¨çŠ¶æ€å­˜å‚¨äºå¯¹è±¡å†…éƒ¨</li><li>å†…éƒ¨çŠ¶æ€å¯ä»¥è¢«ä¸€äº›å¯¹è±¡å…±äº«</li><li>å†…éƒ¨çŠ¶æ€ç‹¬ç«‹äºå…·ä½“çš„åœºæ™¯,é€šå¸¸ä¸ä¼šæ”¹å˜</li><li>å¤–éƒ¨çŠ¶æ€å–å†³äºå…·ä½“çš„åœºæ™¯,å¹¶æ ¹æ®åœºæ™¯è€Œå˜åŒ–,å¤–éƒ¨çŠ¶æ€ä¸èƒ½è¢«å…±äº«</li></ul></blockquote></blockquote><h2 id="æ–‡ä»¶ä¸Šä¼ "><a href="#æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="æ–‡ä»¶ä¸Šä¼ "></a>æ–‡ä»¶ä¸Šä¼ </h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*******å‰¥ç¦»å¤–éƒ¨çŠ¶æ€***********/</span></span><br><span class="line"><span class="keyword">var</span> Upload = <span class="function"><span class="keyword">function</span>(<span class="params">uploadType</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.uploadType = uploadType;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Upload.prototype.delFile = <span class="function"><span class="keyword">function</span>(<span class="params">id</span>) </span>&#123;</span><br><span class="line">    uploadManager.setExternalState(id, <span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.fileSize &lt; <span class="number">3000</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.dom.parentNode.removeChild(<span class="keyword">this</span>.dom);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">window</span>.confirm(<span class="string">'ç¡®å®šåˆ é™¤æ–‡ä»¶å—? '</span> + <span class="keyword">this</span>.fileName)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.dom.parentNode.removeChild(<span class="keyword">this</span>.dom);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*******å·¥å‚è¿›è¡Œå¯¹è±¡å®ä¾‹åŒ–***********/</span></span><br><span class="line"><span class="keyword">var</span> UploadFactory = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> createdFlyWeightObjs = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        create: <span class="function"><span class="keyword">function</span>(<span class="params">uploadType</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (createdFlyWeightObjs[uploadType]) &#123;</span><br><span class="line">                <span class="keyword">return</span> createdFlyWeightObjs[uploadType];</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> createdFlyWeightObjs[uploadType] = <span class="keyword">new</span> Upload(uploadType);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;());</span><br><span class="line"></span><br><span class="line"><span class="comment">/*******ç®¡ç†å™¨å°è£…å¤–éƒ¨çŠ¶æ€***********/</span></span><br><span class="line"><span class="keyword">var</span> uploadManager = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> uploadDatabase = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        add: <span class="function"><span class="keyword">function</span>(<span class="params">id, uploadType, fileName, fileSize</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> flyWeightObj = UploadFactory.create(uploadType);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> dom = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>);</span><br><span class="line">            dom.innerHTML = <span class="string">'&lt;span&gt;æ–‡ä»¶å: '</span> + fileName + <span class="string">'  æ–‡ä»¶å¤§å°:  '</span> + fileSize + <span class="string">'&lt;/span&gt;'</span></span><br><span class="line">                + <span class="string">'&lt;button class="delFile"&gt;åˆ é™¤&lt;/button&gt;'</span>;</span><br><span class="line"></span><br><span class="line">            dom.querySelector(<span class="string">'.delFile'</span>).onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                flyWeightObj.delFile(id);</span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">            <span class="built_in">document</span>.body.appendChild(dom);</span><br><span class="line"></span><br><span class="line">            uploadDatabase[id] = &#123;</span><br><span class="line">                fileName: fileName,</span><br><span class="line">                fileSize: fileSize,</span><br><span class="line">                dom: dom</span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> flyWeightObj;</span><br><span class="line">        &#125;,</span><br><span class="line">        setExternalState: <span class="function"><span class="keyword">function</span>(<span class="params">id, flyWeightObj</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> uploadData = uploadDatabase[id];</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i  <span class="keyword">in</span> uploadData) &#123;</span><br><span class="line">                flyWeightObj[i] = uploadData[i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;());</span><br><span class="line"></span><br><span class="line"><span class="comment">/*******è§¦å‘ä¸Šä¼ åŠ¨ä½œå‡½æ•°***********/</span></span><br><span class="line"><span class="keyword">var</span> id = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">window</span>.startUpload = <span class="function"><span class="keyword">function</span>(<span class="params">uploadType, files</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, file; file = files[i++]; ) &#123;</span><br><span class="line">        <span class="keyword">var</span> uploadObj = uploadManager.add(++id, uploadType, file.fileName, file.fileSize);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">startUpload(<span class="string">'plugin'</span>, [&#123;</span><br><span class="line">    fileName: <span class="string">'1.txt'</span>,</span><br><span class="line">    fileSize: <span class="number">1000</span></span><br><span class="line">&#125;,&#123;</span><br><span class="line">    fileName: <span class="string">'2.html'</span>,</span><br><span class="line">    fileSize: <span class="number">3000</span></span><br><span class="line">&#125;]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">startUpload(<span class="string">'flash'</span>, [&#123;</span><br><span class="line">    fileName: <span class="string">'4.txt'</span>,</span><br><span class="line">    fileSize: <span class="number">1000</span></span><br><span class="line">&#125;, &#123;</span><br><span class="line">    fileName: <span class="string">'5.html'</span>,</span><br><span class="line">    fileSize: <span class="number">3000</span></span><br><span class="line">&#125;]);</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="/img/design/fileupload.png" alt="æ•ˆæœ" title="" class="">                <p>æ•ˆæœ</p>            </figure><h2 id="äº«å…ƒæ¨¡å¼çš„é€‚ç”¨æ€§"><a href="#äº«å…ƒæ¨¡å¼çš„é€‚ç”¨æ€§" class="headerlink" title="äº«å…ƒæ¨¡å¼çš„é€‚ç”¨æ€§"></a>äº«å…ƒæ¨¡å¼çš„é€‚ç”¨æ€§</h2><ol><li>ä¸€ä¸ªç¨‹åºä¸­ä½¿ç”¨äº†å¤§é‡ç›¸ä¼¼çš„å¯¹è±¡</li><li>ç”±äºä½¿ç”¨äº†å¤§é‡å¯¹è±¡,é€ æˆäº†å¾ˆå¤§çš„å†…å­˜å¼€é”€</li><li>å¯¹è±¡çš„å¤§å¤šæ•°çŠ¶æ€éƒ½å¯ä»¥å˜æˆå¤–éƒ¨çŠ¶æ€</li><li>å‰¥ç¦»å¯¹è±¡çš„å¤–éƒ¨çŠ¶æ€ä¹‹å,å¯ä»¥ä½¿ç”¨ç›¸å¯¹è¾ƒå°‘çš„å…±äº«å¯¹è±¡å–ä»£å¤§é‡å¯¹è±¡</li><li>æœ‰å¤šå°‘ç§å†…éƒ¨çŠ¶æ€çš„ç»„åˆ,ç³»ç»Ÿä¸­å›½ä¾¿å­˜åœ¨å¤šå°‘ä¸ªå…±äº«å¯¹è±¡</li></ol><h2 id="å¯¹è±¡æ± "><a href="#å¯¹è±¡æ± " class="headerlink" title="å¯¹è±¡æ± "></a>å¯¹è±¡æ± </h2><p><strong>äº«å…ƒæ¨¡å¼çš„è¿‡ç¨‹æ˜¯å‰¥ç¦»å¤–éƒ¨çŠ¶æ€,å¹¶æŠŠå¤–éƒ¨çŠ¶æ€ä¿å­˜åˆ°å…¶å®ƒåœ°æ–¹,åœ¨åˆé€‚çš„æ—¶åˆ»å†æŠŠå¤–éƒ¨çŠ¶æ€ç»„è£…è¿›å…±äº«å¯¹è±¡</strong><br><strong>å¯¹è±¡æ± ç»´æŠ¤ä¸€ä¸ªè£…è½½ç©ºé—²å¯¹è±¡çš„æ± å­,å¦‚æœéœ€è¦å¯¹è±¡æ—¶,ä¸æ˜¯ç›´æ¥new,è€Œæ˜¯è½¬ä»å¯¹è±¡æ± é‡Œè·å–;å¯¹è±¡æ± æ²¡æœ‰åˆ†ç¦»å¤–éƒ¨çŠ¶æ€å’Œå†…éƒ¨çŠ¶æ€è¿™ä¸ªè¿‡ç¨‹</strong></p><h2 id="iframeåŠ è½½-å¯¹è±¡æ± å®ä¾‹"><a href="#iframeåŠ è½½-å¯¹è±¡æ± å®ä¾‹" class="headerlink" title="iframeåŠ è½½-å¯¹è±¡æ± å®ä¾‹"></a>iframeåŠ è½½-å¯¹è±¡æ± å®ä¾‹</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> objectPoolFactory = <span class="function"><span class="keyword">function</span>(<span class="params">createObjFn</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> objPool = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        create: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(objPool.length);</span><br><span class="line">            <span class="keyword">return</span> (objPool.length === <span class="number">0</span></span><br><span class="line">                ? createObjFn.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>)</span><br><span class="line">                : objPool.shift());</span><br><span class="line">        &#125;,</span><br><span class="line">        revover: <span class="function"><span class="keyword">function</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">            objPool.push(obj);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> iframeFactory = objectPoolFactory(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> iframe = <span class="built_in">document</span>.createElement(<span class="string">'iframe'</span>);</span><br><span class="line">    <span class="built_in">document</span>.body.appendChild(iframe);</span><br><span class="line"></span><br><span class="line">    iframe.onload= <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        iframe.onload = <span class="literal">null</span>; <span class="comment">//é˜²æ­¢iframeé‡å¤åŠ è½½çš„bug</span></span><br><span class="line">        iframeFactory.revover(iframe);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> iframe;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> iframe1 = iframeFactory.create();</span><br><span class="line">iframe1.src=<span class="string">'http://je.ishang.club/'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> iframe2 = iframeFactory.create();</span><br><span class="line">iframe2.src=<span class="string">'http://blog.xinshangshangxin.com/'</span>;</span><br><span class="line"></span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> iframe3 = iframeFactory.create();</span><br><span class="line">    iframe3.src=<span class="string">'http://nggather.coding.io/'</span>;</span><br><span class="line">&#125;, <span class="number">3000</span>);</span><br></pre></td></tr></table></figure><blockquote><p>ç»“æœåªæœ‰2ä¸ªiframe</p></blockquote><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><ul><li><em>å®ä½“ä¹¦:</em> <code>JavaScriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µ(æ›¾æ¢)</code></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>dockerä½¿ç”¨æ€»ç»“(è½¬)</title>
      <link href="/2015/06/28/docker%E4%BD%BF%E7%94%A8%E6%80%BB%E7%BB%93-%E8%BD%AC/"/>
      <url>/2015/06/28/docker%E4%BD%BF%E7%94%A8%E6%80%BB%E7%BB%93-%E8%BD%AC/</url>
      
        <content type="html"><![CDATA[<p>dockerä½¿ç”¨æ€»ç»“(è½¬)<br><a id="more"></a></p><p><strong><a href="http://weibo.com/p/1001603855970483702516" target="_blank" rel="noopener">è½¬è½½è‡ªhttp://weibo.com/p/1001603855970483702516</a></strong></p><h2 id="å®‰è£…æ³¨æ„"><a href="#å®‰è£…æ³¨æ„" class="headerlink" title="å®‰è£…æ³¨æ„"></a>å®‰è£…æ³¨æ„</h2><ol><li>ä¸è¦ç›´æ¥ç”¨apt-getå®‰è£…docker,apt-getå®‰è£…çš„ç‰ˆæœ¬æœ‰äº›ä½.<br>å®‰è£…ç”¨<code>curl -sSL https://get.docker.com/ubuntu/ | sudo sh</code> å¯ä»¥å®‰è£…æœ€æ–°ç‰ˆ</li><li><p>dockerå¯¹linuxå†…æ ¸ç‰ˆæœ¬æœ‰è¦æ±‚,å†…æ ¸ç‰ˆæœ¬ä¸èƒ½å¤ªä½, å¦‚æœå¤ªä½ä¼šå¯¼è‡´dockerçš„ä¸€äº›åŠŸèƒ½ä¸èƒ½ä½¿ç”¨, æ¯”å¦‚docker exec å‘½ä»¤åœ¨ä½ç‰ˆæœ¬çš„linuxå†…æ ¸ä¸‹ä¸èƒ½ç”¨.</p><blockquote><p>è¿è¡Œlinuxå‘½ä»¤uname -r å¯ä»¥æŸ¥çœ‹linuxå†…æ ¸ç‰ˆæœ¬, dockerå®˜æ–¹æ–‡æ¡£è¯´linuxå†…æ ¸ç‰ˆæœ¬ä¸èƒ½ä½äº3.13<br>å‡çº§linuxå†…æ ¸ : <code>sudo apt-get install linux-image-generic-lts-trusty</code>   </p></blockquote></li><li><p>é«˜ç‰ˆæœ¬çš„linuxå†…æ ¸ä¸æ”¯æŒaufsçš„å­˜å‚¨ç±»å‹,å»ºè®®ç”¨devicemapperå­˜å‚¨ç±»å‹</p></li></ol><h2 id="å°è£…åŸåˆ™"><a href="#å°è£…åŸåˆ™" class="headerlink" title="å°è£…åŸåˆ™"></a>å°è£…åŸåˆ™</h2><ol><li>å®¹å™¨è¦æœ‰ä¸“èŒ, å°½é‡ä¸€ä¸ªå®¹å™¨åªæœ‰ä¸€ä¸ªæœåŠ¡,åŸåˆ™ä¸Šè¯´ä¸€ä¸ªè¿›ç¨‹å°±ä¸€ä¸ªå®¹å™¨,ä¸è¦è®©ä¸€ä¸ªå®¹å™¨é‡Œé¢æœ‰å¤šä¸ªè¿›ç¨‹,è¿›ç¨‹è¶Šå¤§,è€¦åˆæ€§è¶Šå¤§.</li><li>å®¹å™¨å†…å¯ä»¥ç”¨supervisiodç®¡ç†è¿›ç¨‹,é˜²æ­¢è¿›ç¨‹å¼‚å¸¸é€€å‡º.</li><li>ç¯å¢ƒå˜é‡ä½œä¸ºå®¹å™¨é…ç½®é¡¹, <code>Dockerfile</code>ä¸­å¯ä»¥ç”¨ <code>ENV</code> è®¾ç½®ç¯å¢ƒå˜é‡, <code>docker run</code> å‘½ä»¤å¯ä»¥ç”¨ <code>-e</code> è®¾ç½®ç¯å¢ƒå˜é‡.<br><strong>æ³¨æ„:è®¾ç½®çš„ç¯å¢ƒå‘½ä»¤éƒ½æ˜¯rootç”¨æˆ·çš„</strong>. å¦‚æœæƒ³è®©Apache ç”¨æˆ·ä¹Ÿä½¿ç”¨è¿™äº›ç¯å¢ƒå˜é‡, æ‰§è¡Œä¸‹é¢shellå‘½ä»¤ <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">env | grep JD_  | sed  <span class="string">"s/^/export /g"</span> &gt;&gt; <span class="regexp">/etc/</span>apache2/envvars</span><br></pre></td></tr></table></figure></li></ol><p>è¡¨ç¤ºä»¥<code>JD_</code>å¼€å¤´çš„ç¯å¢ƒå˜é‡éƒ½è®¾ç½®ä¸ºApacheçš„ç¯å¢ƒå˜é‡.<br>å¦‚æœæ˜¯ä¸€ä¸ªçº¯å‰ç«¯çš„ç½‘ç«™é¡¹ç›®,ä½ å¯ä»¥è·å¾—ç¯å¢ƒå˜é‡, å¯ä»¥åœ¨index.html ä¸­åŠ è½½ä¸€ä¸ªphpæ–‡ä»¶: åœ¨json.php ä¸­è·å¾—ç¯å¢ƒå˜é‡è¾“å‡º.   </p><h2 id="dockerçš„å‘"><a href="#dockerçš„å‘" class="headerlink" title="dockerçš„å‘"></a>dockerçš„å‘</h2><ul><li><p><code>--link</code> é“¾æ¥å®¹å™¨. </p><blockquote><p>ç”¨dockerè‡ªå¸¦çš„<code>--link</code>æŠŠå¤šä¸ªå®¹å™¨é“¾æ¥åœ¨ä»¥å‰, æœ‰é‡å¯æˆ–å‡çº§çš„é—®é¢˜,<br>æ¯”å¦‚å¾ˆå¤šå®¹å™¨éƒ½ä¾èµ–äº db è¿™ä¸ªå®¹å™¨, ç„¶ådbå®¹å™¨é‡å¯äº†, é‡å¯æ—¶dockeråˆ†é…çš„ipä¼šå˜, å¯¼è‡´å…¶ä»–ä¾èµ–äºdbçš„å®¹å™¨éƒ½è¦é‡å¯.<code>--link</code> é“¾æ¥çš„å®¹å™¨è¿˜æœ‰å¯åŠ¨é¡ºåºçš„é—®é¢˜, éœ€è¦å…ˆå¯åŠ¨dbå®¹å™¨å†å¯åŠ¨å…¶ä»–ä¾èµ–äºdbçš„å®¹å™¨, è¿™æ ·å¯¼è‡´ <code>--link</code>å’Œ<code>--restart=always</code>ä¸èƒ½ä¸€èµ·ç”¨<br>å¦‚æœä¸€èµ·ç”¨ä¼šå‘ç°å®¿ä¸»æœºé‡å¯äº†, dockerå®¹å™¨å¹¶æ²¡æœ‰å…¨éƒ¨é‡å¯,å› ä¸ºè¿™æ—¶å€™dockerå®¹å™¨æ˜¯åŒæ—¶è¢«å¯åŠ¨çš„,å¹¶ä¸çŸ¥é“å¯åŠ¨é¡ºåº. æœ€åå†³å®šä¸ç”¨ <code>--link</code> é“¾æ¥å®¹å™¨äº†.<br>å¦å¤–æœ‰ä¸¤ç§é“¾æ¥å®¹å™¨çš„æ–¹æ³•,ä¸€ç§æ˜¯ç»™å®¹å™¨è®¾ç½®å›ºå®šip , è¿™ä¸ªæ–¹æ³•æ¯”è¾ƒå¤æ‚:<br>å¦å¤–è¿˜æœ‰ä¸€ç§ç®€å•çš„é“¾æ¥æ–¹å¼, å¯ä»¥ç”¨å®¿ä¸»æœºçš„ç«¯å£é“¾æ¥, æ¯”å¦‚ä¸€ä¸ªmysqlå®¹å™¨,å…ˆè®¾ç½®å®¿ä¸»æœºçš„3306ç«¯å£æ˜ å°„åˆ°mysqlå®¹å™¨ä¸­.<br>ç„¶åæŸ¥å®¿ä¸»æœºçš„å†…ç½‘ip , ç”¨ifconfig æŸ¥,eth0çš„ç½‘å¡å¯ä»¥çœ‹è§å†…ç½‘ip, å‡è®¾å†…ç½‘ipä¸º10.128.130.175 , dockerå®¹å™¨æ˜¯å¯ä»¥è®¿é—®è¿™ä¸ªå®¿ä¸»æœºå†…ç½‘ipçš„, è¿™æ ·å…¶ä»–å®¹å™¨è¦é“¾æ¥mysqlå®¹å™¨,é“¾æ¥æ•°æ®åº“æ—¶ é“¾æ¥ 10.128.130.175:3306 å³å¯.<br>æˆ‘ä»¬å¯ä»¥åœ¨docker runå¯åŠ¨å®¹å™¨æ—¶ç”¨ â€“add-host å‚æ•°ä¸ºå®¹å™¨è®¾ç½®ä¸€ä¸ªhosts .è¿™æ ·å®¹å™¨å†…ä»£ç å¯ä»¥ç”¨æŒ‡å®šçš„åŸŸåå»è®¿é—®æ•°æ®åº“, ä¸ç”¨å…³å¿ƒå†…ç½‘ipçš„å˜åŒ–.</p></blockquote></li><li><p>pidçš„é—®é¢˜(1)</p><blockquote><p>dockerå®¹å™¨ä¸­çš„è¿›ç¨‹æœ‰æ—¶ä¼šç”Ÿæˆpidæ–‡ä»¶, æ¯”å¦‚Apacheè¿›ç¨‹ä¼šç”Ÿæˆçš„pidæ–‡ä»¶ä¸º <code>/var/run/apache2/apache2.pid</code>, å½“è¿›ç¨‹å¯åŠ¨æ—¶,è¿™ä¸ªpidæ–‡ä»¶å°±å­˜åœ¨,å½“è¿›ç¨‹é€€å‡ºæ—¶,è¿™ä¸ªpidæ–‡ä»¶ä¹Ÿä¼šè¢«åˆ é™¤, æˆ‘ä»¬æŠŠæ­£åœ¨è¿è¡Œçš„å®¹å™¨ç”¨docker commit æäº¤ä¸ºé•œåƒæ—¶ä¼šæŠŠpidæ–‡ä»¶ä¹Ÿæäº¤åˆ°é•œåƒä¸­,è¿™æ ·ä»æ–°é•œåƒè¿è¡Œå®¹å™¨æ—¶,å®¹å™¨å¯èƒ½å› ä¸ºå·²ç»å­˜åœ¨pidæ–‡ä»¶è€Œæ— æ³•å¯åŠ¨.<br>ä»¥Apacheä¸ºä¾‹,å¯èƒ½å°±ä¼šæŠ¥ <code>httpd(pid 1) ready runing</code> ä¹‹ç±»çš„é”™è¯¯ , æŠ¥é”™å‘Šè¯‰ä½ httpdæ­£åœ¨è¿è¡Œ,ä½†å…¶å®å¹¶æ²¡æœ‰è¿è¡Œåªæ˜¯å­˜åœ¨pidæ–‡ä»¶è€Œå·².<br>æ‰€ä»¥æœ€å¥½æ˜¯ç”¨docker stop æŠŠå®¹å™¨åœæ‰, å†ç”¨docker commit åˆ›å»ºé•œåƒ.</p></blockquote></li><li><p>pidçš„é—®é¢˜(2)</p><blockquote><p>è¿˜å¯èƒ½ä¼šå‡ºç°åœ¨docker runæ—¶è®¾ç½®<code>--restart=always</code> å‚æ•°çš„æ—¶å€™, è®¾ç½®äº†æ­¤å‚æ•°å®¹å™¨é€€å‡ºäº†ä¼šè‡ªåŠ¨é‡å¯, å®¿ä¸»æœºé‡å¯äº†å®¹å™¨ä¹Ÿèƒ½è‡ªåŠ¨é‡å¯. ä½†æ˜¯å®¹å™¨åœ¨é‡å¯çš„æ—¶å€™å¾ˆå®¹æ˜“pidæ–‡ä»¶å­˜åœ¨.pidæ–‡ä»¶å­˜åœ¨æ—¶è¿›ç¨‹ä¼šè‡ªåŠ¨é€€å‡º, ä½†åˆå› ä¸ºè®¾ç½®äº†<code>--restart=always</code> è¿›ç¨‹é€€å‡ºçš„é‚£ä¸€ç¬é—´ å®¹å™¨åˆè‡ªåŠ¨é‡å¯, æ‰€ä»¥å®¹å™¨å°±åœ¨é‚£é‡Œä¸æ–­çš„é€€å‡ºå†è‡ªåŠ¨é‡å¯é€€å‡ºå†è‡ªåŠ¨é‡å¯. æ­¤æ—¶ è¿è¡Œå‘½ä»¤ docker ps æ˜¯èƒ½çœ‹è§å®¹å™¨æ˜¯è¿è¡Œä¸­çš„çŠ¶æ€.<br>ä½†æ˜¯ç”¨ <code>docker exec -it container_name bash</code> å§‹ç»ˆè¿›ä¸äº†å®¹å™¨, ä¼šæŠ¥å¦‚ä¸‹é”™è¯¯:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Cannot run exec command <span class="number">0</span>eb8e17609dd78c9137c62d94cfaa62795de161d643fc3cb00387b60f11090be <span class="keyword">in</span> container <span class="number">8837</span>b983fe2f08f5f3b9999259d5f255a83774b19282b6f9c21a9d688f7f7f2a: No active container exists <span class="keyword">with</span> ID <span class="number">8837</span>b983fe2f08f5f3b9999259d5f255a83774b19282b6f9c21a9d688f7f7f2a</span><br><span class="line">No active container exists <span class="keyword">with</span> ID</span><br></pre></td></tr></table></figure></blockquote></li></ul><p>è¿™å¥çš„æ„æ€æ˜¯è¯´ æ‰¾ä¸åˆ°æœ‰æ•ˆçš„å®¹å™¨. ä½†æ˜¯docker psåˆçœ‹è§å®¹å™¨æ˜¯åœ¨è¿è¡Œä¸­, ä¸ºä»€ä¹ˆä¼šæ‰¾ä¸åˆ°æœ‰æ•ˆçš„å®¹å™¨ï¼Ÿ è¿™æ˜¯å› ä¸ºè¿™ä¸ªå®¹å™¨ç°åœ¨å…¶å®ä¸€ç›´åœ¨ä¸æ–­é‡å¯ä¸­, æ‰€ä»¥è¿›ä¸å».</p><blockquote><p>è§£å†³æ–¹æ³•, å¯ä»¥åœ¨å®¹å™¨å¯åŠ¨å‘½ä»¤è„šæœ¬ï¼ˆå¦‚ /run.shï¼‰ ä¸­ åŠ ä¸Šä¸€å¥åˆ é™¤pidæ–‡ä»¶çš„ä»£ç , å¦‚ rm /var/run/apache2/apache2.pid è¿™æ ·åœ¨å¯åŠ¨è¿›ç¨‹ä¹‹å‰å¼ºåˆ¶åˆ é™¤äº†pidæ–‡ä»¶,å°±ä¸ä¼šé‡å¤é‡å¯äº†.</p></blockquote><ul><li>dockerå®¹å™¨çš„hostsæ–‡ä»¶.</li></ul><blockquote><p>åœ¨æ­£åœ¨è¿è¡Œçš„å®¹å™¨ ç”¨docker exec è¿›å…¥ä¿®æ”¹ /etc/hosts æ–‡ä»¶ ,è¿™ä¸ªå®¹å™¨è¢«é‡å¯åä¼šå‘ç° hostsæ–‡ä»¶ä¼šè¢«è¿˜åŸ. æ‰€ä»¥ä¸è¦ç›´æ¥ä¿®æ”¹hostsæ–‡ä»¶, éœ€è¦å¢åŠ hosts ,åœ¨docker runæ—¶ ç”¨ â€“add-host å‚æ•°.</p></blockquote><ul><li><p>è™šæ‹Ÿç›®å½•ä¸ä¼šæäº¤åˆ°é•œåƒ</p><blockquote><p>Dockerfile ä¸­ VOLUME æŒ‡å®šçš„ç›®å½• æˆ– docker run æ—¶ -v å‚æ•°æŒ‡å®šçš„ç›®å½•, åœ¨docker commit æ—¶ä¸ä¼šæäº¤åˆ°é•œåƒä¸­. å¦‚æœ-v å‚æ•°æŒ‡å®šçš„å®¹å™¨å†…çš„ç›®å½•åŸæœ¬æœ‰æ–‡ä»¶, åŸæœ¬çš„æ–‡ä»¶éƒ½ä¼šè¢«åˆ é™¤, åªå­˜åœ¨å®¿ä¸»æœºç›®å½•çš„æ–‡ä»¶. </p></blockquote></li><li><p>dockerå®¹å™¨çš„é‡å¯.</p><blockquote><p>å®¹å™¨ä¸€ä¸ªå®¹å™¨è¿è¡Œä¸­apache æˆ‘ä»¬è¦é‡å¯Apache , åº”è¯¥æ€ä¹ˆé‡å¯ï¼Ÿ å¯èƒ½æ–°æ‰‹ä¼š docker exec -it container_name bash è¿›å…¥å®¹å™¨, ç„¶åè¿è¡Œ service apache2 restart å¯åŠ¨Apache , è¿™æ ·æ˜¯ä¸èƒ½å¯åŠ¨apacheçš„, åªä¼šæŠŠå®¹å™¨åœæ­¢æ‰. å› ä¸ºå®¹å™¨çš„ä¸»è¿›ç¨‹å°±æ˜¯Apache , ä¸»è¿›ç¨‹é€€å‡ºæ—¶ä¼šé€€å‡ºå®¹å™¨, åœ¨é‡å¯apacheçš„æ—¶å€™ ä¸»è¿›ç¨‹å…ˆé€€å‡ºäº†, è¿™æ—¶å€™dockerå®¹å™¨ä¹Ÿè·Ÿç€é€€å‡ºäº†,æ‰€ä»¥Apacheä¸ä¼šé‡å¯. è¦é‡å¯Apache ç”¨dockerå‘½ä»¤: docker restart container_name </p></blockquote></li><li><p>é€€å‡ºå®¹å™¨çš„æ–¹æ³•</p></li></ul><blockquote><p>å¦‚æœæ˜¯docker run è¿è¡Œä¸€ä¸ªå®¹å™¨, æ²¡æœ‰åŠ  -d å‚æ•°è®©å®ƒåå°è¿è¡Œ, è¿™æ—¶å€™ ctrl+c é€€å‡ºè¿›ç¨‹ä¹Ÿä¼šè®©å®¹å™¨åœæ­¢, å¦‚æœå…ˆé€€å‡ºä½†ä¸åœæ­¢å®¹å™¨å¯ä»¥ctrl+p ç„¶å ctrl+q</p></blockquote><h2 id="Dockerfileç¼–å†™æŠ€å·§"><a href="#Dockerfileç¼–å†™æŠ€å·§" class="headerlink" title="Dockerfileç¼–å†™æŠ€å·§"></a>Dockerfileç¼–å†™æŠ€å·§</h2><ul><li>å°†Ubuntuçš„æºè®¾ç½®ä¸ºå›½å†…çš„æº,è¿™æ ·å®‰è£…è½¯ä»¶ä¼šå¿«å¾ˆå¤š RUN sed -i â€œs/archive.ubuntu.com/mirrors.163.com/gâ€ /etc/apt/sources.list</li><li><p>RUN</p><blockquote><p>Dockerfile ä¸­å¯ä»¥RUNæ‰§è¡Œç³»ç»Ÿå‘½ä»¤åˆ›å»ºé•œåƒ.ä¸èƒ½ç”¨RUNå‘½ä»¤æ¥å¸¸é©»è¿›ç¨‹. æ¯”å¦‚ä¸èƒ½è¿è¡Œ RUN gearmand -d .</p></blockquote></li><li><p>ONBUILD</p><blockquote><p>ONBUILDä¿®é¥°çš„å‘½ä»¤åœ¨å­Dockerfileæ–‡ä»¶ä¸­ä¹Ÿä¼šè¢«æ‰§è¡Œ,ä¸¾ä¾‹è¯´æ˜:<br>ä¸€ä¸ªDockerfileä¸­æœ‰ONBUILDå‘½ä»¤, å¦‚ ONBUILD ADD . /app/src , è¿è¡Œ docker build -t Image_name . åˆ›å»ºä¸€ä¸ªåä¸ºImage_nameçš„é•œåƒ. å¦å¤–åœ¨åˆ›å»ºä¸€ä¸ªDockerfile , ç¬¬ä¸€ä¸ªè¡Œæ˜¯ FROM Image_name ç°åœ¨è¿™ä¸ªDockerfileæ˜¯ç»§æ‰¿äºå‰ä¸€ä¸ªDockerfileçš„,ç°åœ¨è¿™ä¸ªDockerfileåœ¨buildæ—¶ä¼šæ‰§è¡Œä»–çˆ¶Dockerfileçš„ONBUILDå‘½ä»¤, æ‰€ä»¥ç°åœ¨è¿™ä¸ªDockerfileåœ¨buildæ—¶ä¹Ÿä¼šæ‰§è¡Œ ADD . /app/src è¿™ä¸ªå‘½ä»¤.</p></blockquote></li><li><p>ENTRYPOINT</p><blockquote><p>æ„Ÿè§‰ ENTRYPOINT ä¼šæ¯” CMD æ›´çœèµ„æº, ENTRYPOINT ä½¿ç”¨æ—¶ç”¨æ•°ç»„å½¢å¼.å¦‚:<br>entrypoint [â€œ/init.shâ€, â€œ/usr/bin/supervisordâ€, â€œ-nâ€, â€œ-câ€, â€œ/etc/supervisord.confâ€]<br>/init.sh æ˜¯ä¸€ä¸ªåˆå§‹åŒ–è„šæœ¬,åˆå§‹åŒ–è„šæœ¬å†…å®¹å¤§æ¦‚ä¸º: </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">!<span class="regexp">/bin/</span>bash</span><br><span class="line">set -e</span><br><span class="line">æ‰§è¡Œä¸€äº›åˆå§‹åŒ–ä»£ç </span><br><span class="line">exec <span class="string">"$@"</span></span><br></pre></td></tr></table></figure></blockquote></li></ul><blockquote><p>æœ€åè¦è·Ÿä¸Šexec â€œ$@â€ ,è¿™æ ·æ‰èƒ½è®©init.sh è„šæœ¬åçš„ supervisordè¢«æ‰§è¡Œ.</p></blockquote><ul><li>.dockerignore<br>.dockerignoreæ–‡ä»¶ä¸­åˆ—çš„æ–‡ä»¶ä¸ä¼šè¢« ADDæˆ–COPY æŒ‡ä»¤æ·»åŠ åˆ°å®¹å™¨ä¸­.</li></ul><h2 id="å¥½ç”¨çš„dockeré•œåƒ"><a href="#å¥½ç”¨çš„dockeré•œåƒ" class="headerlink" title="å¥½ç”¨çš„dockeré•œåƒ"></a>å¥½ç”¨çš„dockeré•œåƒ</h2><ul><li>jwilder/nginx-proxy è¿™æ˜¯ä¸€ä¸ªnginxåå‘ä»£ç†.<blockquote><p>å¯åŠ¨nginxåå‘ä»£ç†:</p></blockquote></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --name nginx -d -p <span class="number">80</span>:<span class="number">80</span> -v /<span class="keyword">var</span>/run/docker.sock:<span class="regexp">/tmp/</span>docker.sock -t --restart=always jwilder/nginx-proxy</span><br></pre></td></tr></table></figure><blockquote><p>å†å¯åŠ¨å…¶ä»–å®¹å™¨, å¦‚: </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -e VIRTUAL_HOST=yourdomain.com -d tutum/apache-php</span><br></pre></td></tr></table></figure><blockquote><p>nginxçš„å®¹å™¨ä¼šç›‘å¬å…¶ä»–å®¹å™¨çš„å¯åŠ¨, å¹¶æ ¹æ®VIRTUAL_HOSTè®¾ç½®åŸŸå.è¿™æ ·å¯ä»¥é€šè¿‡ yourdomain.com è®¿é—®åˆšæ‰å¯åŠ¨çš„å®¹å™¨ä¸­çš„ç½‘ç«™äº†.<br>tutum/apache-php è¿™ä¸ªé•œåƒæ˜¯ä¸€ä¸ªå¥½ç”¨çš„apacheç¯å¢ƒ.</p></blockquote><ul><li><p>æ¸…ç†docker</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker info  <span class="comment">// å¯ä»¥æŸ¥çœ‹dockerçš„ä¿¡æ¯, /var/lib/docker/devicemapper/devicemapper ç›®å½•ä¸‹å­˜æ”¾äº†dockerçš„æ–‡ä»¶, å¯ä»¥ç”¨du -h --max-depth=1 çœ‹æ–‡ä»¶çš„å¤§å°.</span></span><br></pre></td></tr></table></figure></li><li><p>åˆ é™¤ä¸ºnoneçš„é•œåƒ,å¯ä»¥ç«‹é©¬å›æ”¶ç©ºé—´:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker images --no-trunc| grep none | awk <span class="string">'&#123;print $3&#125;'</span> | xargs -r docker rmi</span><br></pre></td></tr></table></figure></li><li><p>åˆ é™¤é€€å‡ºäº†çš„å®¹å™¨:</p></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rm <span class="string">`docker ps -a | grep Exited | awk '&#123;print $1 &#125;â€™</span></span><br></pre></td></tr></table></figure><ul><li>åˆ é™¤æ²¡æœ‰ç”¨çš„é•œåƒ. ï¼ˆæœ‰å®¹å™¨è¿è¡Œçš„é•œåƒä¸ä¼šè¢«åˆ é™¤ï¼‰:</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rmi <span class="string">`docker images -aq`</span></span><br></pre></td></tr></table></figure><hr><blockquote><h3 id="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢"><a href="#æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢" class="headerlink" title="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~"></a>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</h3><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JSè®¾è®¡æ¨¡å¼ç¬”è®°(æ¨¡æ¿æ–¹æ³•æ¨¡å¼)</title>
      <link href="/2015/06/27/JS%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0-%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F/"/>
      <url>/2015/06/27/JS%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0-%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<p>JSè®¾è®¡æ¨¡å¼ç¬”è®°(æ¨¡æ¿æ–¹æ³•æ¨¡å¼)<br><a id="more"></a></p><h1 id="æ¨¡æ¿æ–¹æ³•æ¨¡å¼"><a href="#æ¨¡æ¿æ–¹æ³•æ¨¡å¼" class="headerlink" title="æ¨¡æ¿æ–¹æ³•æ¨¡å¼"></a>æ¨¡æ¿æ–¹æ³•æ¨¡å¼</h1><blockquote><ul><li>æ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼æ˜¯ä¸€ç§åªéœ€è¦é›†æˆå°±å¯ä»¥å®ç°çš„éå¸¸ç®€å•çš„æ¨¡å¼</li><li>æ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼æ˜¯ç”±ä¸¤éƒ¨åˆ†ç»„æˆ, ç¬¬ä¸€éƒ¨åˆ†æ˜¯æŠ½è±¡çˆ¶ç±»,ç¬¬äºŒéƒ¨åˆ†æ˜¯å…·ä½“çš„å®ç°å­ç±»</li></ul></blockquote><h2 id="é’©å­æ–¹æ³•"><a href="#é’©å­æ–¹æ³•" class="headerlink" title="é’©å­æ–¹æ³•"></a>é’©å­æ–¹æ³•</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> Beverrage = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Beverrage.prototype.boilWater = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'æŠŠæ°´ç…®æ²¸'</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Beverrage.prototype.brew = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'å­ç±»å¿…é¡»é‡å†™brewæ–¹æ³•'</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Beverrage.prototype.pourInCup = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'å­ç±»å¿…é¡»é‡å†™pourIncupæ–¹æ³•'</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Beverrage.prototype.addCondiments = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'å­ç±»å¿…é¡»é‡å†™addCpndimentsæ–¹æ³•'</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Beverrage.prototype.customerWantsCondiments = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>; <span class="comment">//é»˜è®¤éœ€è¦è°ƒæ–™</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Beverrage.prototype.init = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.boilWater();</span><br><span class="line">    <span class="keyword">this</span>.brew();</span><br><span class="line">    <span class="keyword">this</span>.pourInCup();</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.customerWantsCondiments()) &#123;</span><br><span class="line">        <span class="keyword">this</span>.addCondiments();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> CoffeeWithHook = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">CoffeeWithHook.prototype = <span class="keyword">new</span> Beverrage();</span><br><span class="line"></span><br><span class="line">CoffeeWithHook.prototype.brew = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'ç”¨æ²¸æ°´å†²å’–å•¡'</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">CoffeeWithHook.prototype.pourInCup = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'æŠŠå’–å•¡å€’è¿›æ¯å­é‡Œé¢'</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">CoffeeWithHook.prototype.addCondiments = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'åŠ ç³–å’Œç‰›å¥¶'</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CoffeeWithHook.prototype.customerWantsCondiments = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">window</span>.confirm(<span class="string">'è¯·é—®éœ€è¦æ·»åŠ è°ƒæ–™å—?'</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> coffeeWithHook = <span class="keyword">new</span> CoffeeWithHook();</span><br><span class="line">coffeeWithHook.init();</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> æŠŠæ°´ç…®æ²¸</span></span><br><span class="line"><span class="comment"> ç”¨æ²¸æ°´å†²å’–å•¡</span></span><br><span class="line"><span class="comment"> æŠŠå’–å•¡å€’è¿›æ¯å­é‡Œé¢</span></span><br><span class="line"><span class="comment"> åŠ ç³–å’Œç‰›å¥¶</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure><blockquote><ul><li><code>Beverrage.prototype.init</code> æ˜¯æ¨¡ç‰ˆæ–¹æ³•,å› ä¸ºè¯¥æ–¹æ³•ä¸­å°è£…äº†å­ç±»çš„ç®—æ³•æ¡†æ¶,å®ƒä½œä¸ºä¸€ä¸ªç®—æ³•çš„æ¨¡æ¿,æŒ‡å¯¼å­ç±»ä»¥ä½•ç§é¡ºåºå»æ‰§è¡Œå“ªäº›ç®—æ³•</li><li><code>Beverrage.prototype.brew</code> ç­‰æ–¹æ³•,å¦‚æœç²—å¿ƒå¿˜è®°ç¼–å†™<code>CoffeeWithHook.prototype.brew</code>æ–¹æ³•,åœ¨ç¨‹åºè¿è¡Œæ—¶ç›´æ¥æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸</li><li>é’©å­æ–¹æ³•çš„è¿”å›ç»“æœå†³å®šäº†æ¨¡æ¿æ–¹æ³•åé¢éƒ¨åˆ†çš„æ‰§è¡Œæ­¥éª¤(<code>customerWantsCondiments</code>),è¿™æ ·ä¸€æ¥,ç¨‹åºå°±æ‹¥æœ‰äº†å˜åŒ–çš„å¯èƒ½</li></ul></blockquote><h2 id="éç»§æ‰¿æ¨¡æ¿æ–¹æ³•"><a href="#éç»§æ‰¿æ¨¡æ¿æ–¹æ³•" class="headerlink" title="éç»§æ‰¿æ¨¡æ¿æ–¹æ³•"></a>éç»§æ‰¿æ¨¡æ¿æ–¹æ³•</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Beverage = <span class="function"><span class="keyword">function</span>(<span class="params">param</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> boilWater = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'æŠŠæ°´ç…®æ²¸'</span>);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> brew = param.brew || <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'å­ç±»å¿…é¡»é‡å†™brewæ–¹æ³•'</span>);</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> pourInCup = param.pourInCup || <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'å­ç±»å¿…é¡»é‡å†™pourIncupæ–¹æ³•'</span>);</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> addCondiments = param.addCondiments || <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'å­ç±»å¿…é¡»é‡å†™addCpndimentsæ–¹æ³•'</span>);</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> F = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    F.prototype.init = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        boilWater();</span><br><span class="line">        brew();</span><br><span class="line">        pourInCup();</span><br><span class="line">        addCondiments();</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> F;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> Coffee = Beverage(&#123;</span><br><span class="line">    brew: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'ç”¨æ²¸æ°´å†²å’–å•¡'</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    pourInCup: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'æŠŠå’–å•¡å€’è¿›æ¯å­é‡Œé¢'</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    addCondiments: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'åŠ ç³–å’Œç‰›å¥¶'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> Tea = Beverage(&#123;</span><br><span class="line">    brew: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'ç”¨æ²¸æ°´æ³¡èŒ¶æ°´'</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    pourInCup: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'æŠŠèŒ¶å€’è¿›æ¯å­é‡Œé¢'</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    addCondiments: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'åŠ æŸ æª¬'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> coffee = <span class="keyword">new</span> Coffee();</span><br><span class="line">coffee.init();</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> æŠŠæ°´ç…®æ²¸</span></span><br><span class="line"><span class="comment"> ç”¨æ²¸æ°´å†²å’–å•¡</span></span><br><span class="line"><span class="comment"> æŠŠå’–å•¡å€’è¿›æ¯å­é‡Œé¢</span></span><br><span class="line"><span class="comment"> åŠ ç³–å’Œç‰›å¥¶</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">var</span> tea = <span class="keyword">new</span> Tea();</span><br><span class="line">tea.init();</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> æŠŠæ°´ç…®æ²¸</span></span><br><span class="line"><span class="comment"> ç”¨æ²¸æ°´æ³¡èŒ¶æ°´</span></span><br><span class="line"><span class="comment"> æŠŠèŒ¶å€’è¿›æ¯å­é‡Œé¢</span></span><br><span class="line"><span class="comment"> åŠ æŸ æª¬</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure><p><strong>æ¨¡æ¿æ–¹æ³•æ¨¡å¼æ˜¯ä¸€ç§å…¸å‹çš„é€šè¿‡å°è£…å˜åŒ–æé«˜ç³»ç»Ÿæ‰©å±•æ€§çš„è®¾è®¡æ¨¡å¼</strong></p><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><ul><li><em>å®ä½“ä¹¦:</em> <code>JavaScriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µ(æ›¾æ¢)</code></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JSè®¾è®¡æ¨¡å¼ç¬”è®°(ç»„åˆæ¨¡å¼)</title>
      <link href="/2015/06/26/JS%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0-%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F/"/>
      <url>/2015/06/26/JS%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0-%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<p>JSè®¾è®¡æ¨¡å¼ç¬”è®°(ç»„åˆæ¨¡å¼)<br><a id="more"></a></p><h1 id="ç»„åˆæ¨¡å¼"><a href="#ç»„åˆæ¨¡å¼" class="headerlink" title="ç»„åˆæ¨¡å¼"></a>ç»„åˆæ¨¡å¼</h1><blockquote><ul><li>å‘½ä»¤æ¨¡å¼åªè´Ÿè´£ä¼ é€’è¯·æ±‚ç»™å¶å¯¹è±¡,å®ƒçš„ç›®çš„ä¸åœ¨äºæ§åˆ¶å¯¹å¶å¯¹è±¡çš„è®¿é—®</li><li>ç»„åˆæ¨¡å¼å°†å¯¹è±¡,ä»¥è¡¨ç¤ºâ€éƒ¨åˆ†-æ•´ä½“â€çš„å±‚æ¬¡ç»“æ„.</li><li>ç»„åˆæ¨¡å¼é€šè¿‡å¯¹è±¡çš„å¤šæ€æ€§è¡¨ç°,ä½¿å¾—ç”¨æˆ·å¯¹å•ä¸ªå¯¹è±¡å’Œç»„åˆå¯¹è±¡çš„ä½¿ç”¨å…·æœ‰ä¸€è‡´æ€§</li></ul></blockquote><h2 id="å®ä¾‹-æ‰«ææ–‡ä»¶å¤¹"><a href="#å®ä¾‹-æ‰«ææ–‡ä»¶å¤¹" class="headerlink" title="å®ä¾‹-æ‰«ææ–‡ä»¶å¤¹"></a>å®ä¾‹-æ‰«ææ–‡ä»¶å¤¹</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Folder = <span class="function"><span class="keyword">function</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">    <span class="keyword">this</span>.files = [];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Folder.prototype.add = <span class="function"><span class="keyword">function</span>(<span class="params">file</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.files.push(file);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Folder.prototype.scan = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'å¼€å§‹æ‰«ææ–‡ä»¶å¤¹: '</span> + <span class="keyword">this</span>.name);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, file, files = <span class="keyword">this</span>.files; file = files[i++];) &#123;</span><br><span class="line">        file.scan();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/************File*************/</span></span><br><span class="line"><span class="keyword">var</span> File = <span class="function"><span class="keyword">function</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">File.prototype.add = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'æ–‡ä»¶ä¸‹é¢ä¸èƒ½æ·»åŠ æ–‡ä»¶'</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">File.prototype.scan = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'å¼€å§‹æ‰«ææ–‡ä»¶:  '</span> + <span class="keyword">this</span>.name);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> folder = <span class="keyword">new</span> Folder(<span class="string">'study'</span>);</span><br><span class="line"><span class="keyword">var</span> folder1 = <span class="keyword">new</span> Folder(<span class="string">'JavaScript'</span>);</span><br><span class="line"><span class="keyword">var</span> folder2 = <span class="keyword">new</span> Folder(<span class="string">'angular'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> file1 = <span class="keyword">new</span> File(<span class="string">'js'</span>);</span><br><span class="line"><span class="keyword">var</span> file2 = <span class="keyword">new</span> File(<span class="string">'ng'</span>);</span><br><span class="line"><span class="keyword">var</span> file3 = <span class="keyword">new</span> File(<span class="string">'è®¾è®¡æ¨¡å¼'</span>);</span><br><span class="line"></span><br><span class="line">folder1.add(file1);</span><br><span class="line">folder2.add(file2);</span><br><span class="line"></span><br><span class="line">folder.add(folder1);</span><br><span class="line">folder.add(folder2);</span><br><span class="line">folder.add(file3);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> folder3 = <span class="keyword">new</span> Folder(<span class="string">'Nodejs'</span>);</span><br><span class="line"><span class="keyword">var</span> file4 = <span class="keyword">new</span> File(<span class="string">'æ·±å…¥æµ…å‡ºNode.js'</span>);</span><br><span class="line">folder3.add(file4);</span><br><span class="line"></span><br><span class="line">folder.add(folder3);</span><br><span class="line"></span><br><span class="line">folder.scan();</span><br></pre></td></tr></table></figure><p><strong>åŒç­‰å¯¹å¾…ç»„åˆå¯¹è±¡å’Œå¶å¯¹è±¡,ç»™å¶å¯¹è±¡å¢åŠ æ–¹æ³•add,å¹¶ä¸”åœ¨è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ—¶æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸æ¥æé†’å®¢æˆ·</strong></p><h2 id="note"><a href="#note" class="headerlink" title="note"></a>note</h2><blockquote><ul><li>ç»„åˆæ¨¡å¼æ˜¯ä¸€ç§èšåˆ(HAS-A)æ¨¡å¼,è€Œä¸æ˜¯çˆ¶å­å…³ç³»(IS-A);</li><li>ç»„åˆæ¨¡å¼å¯¹ä¸€ç»„å¶å¯¹è±¡çš„æ“ä½œå¿…é¡»å…·æœ‰ä¸€è‡´æ€§</li></ul></blockquote><h2 id="å¼•ç”¨çˆ¶å¯¹è±¡"><a href="#å¼•ç”¨çˆ¶å¯¹è±¡" class="headerlink" title="å¼•ç”¨çˆ¶å¯¹è±¡"></a>å¼•ç”¨çˆ¶å¯¹è±¡</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Folder = <span class="function"><span class="keyword">function</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">    <span class="keyword">this</span>.parent = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">this</span>.files = [];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Folder.prototype.add = <span class="function"><span class="keyword">function</span>(<span class="params">file</span>) </span>&#123;</span><br><span class="line">    file.parent = <span class="keyword">this</span>; <span class="comment">// è®¾ç½®çˆ¶å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">this</span>.files.push(file);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Folder.prototype.scan = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'å¼€å§‹æ‰«ææ–‡ä»¶å¤¹: '</span> + <span class="keyword">this</span>.name);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, file, files = <span class="keyword">this</span>.files; file = files[i++];) &#123;</span><br><span class="line">        file.scan();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Folder.prototype.remove = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">this</span>.parent) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> files = <span class="keyword">this</span>.parent.files, l = files.length - <span class="number">1</span>; l &gt;= <span class="number">0</span>; l--) &#123;</span><br><span class="line">        <span class="keyword">var</span> file = files[l];</span><br><span class="line">        <span class="keyword">if</span> (file === <span class="keyword">this</span>) &#123;</span><br><span class="line">            files.splice(l, <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/************File*************/</span></span><br><span class="line"><span class="keyword">var</span> File = <span class="function"><span class="keyword">function</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">    <span class="keyword">this</span>.parent = <span class="literal">null</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">File.prototype.add = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'æ–‡ä»¶ä¸‹é¢ä¸èƒ½æ·»åŠ æ–‡ä»¶'</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">File.prototype.scan = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'å¼€å§‹æ‰«ææ–‡ä»¶:  '</span> + <span class="keyword">this</span>.name);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">File.prototype.remove = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">this</span>.parent) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> files = <span class="keyword">this</span>.parent.files, l = files.length - <span class="number">1</span>; l &gt;= <span class="number">0</span>; l--) &#123;</span><br><span class="line">        <span class="keyword">var</span> file = files[l];</span><br><span class="line">        <span class="keyword">if</span> (file === <span class="keyword">this</span>) &#123;</span><br><span class="line">            files.splice(l, <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> folder = <span class="keyword">new</span> Folder(<span class="string">'study'</span>);</span><br><span class="line"><span class="keyword">var</span> folder1 = <span class="keyword">new</span> Folder(<span class="string">'JavaScript'</span>);</span><br><span class="line"><span class="keyword">var</span> folder2 = <span class="keyword">new</span> Folder(<span class="string">'angular'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> file1 = <span class="keyword">new</span> File(<span class="string">'js'</span>);</span><br><span class="line"><span class="keyword">var</span> file2 = <span class="keyword">new</span> File(<span class="string">'ng'</span>);</span><br><span class="line"><span class="keyword">var</span> file3 = <span class="keyword">new</span> File(<span class="string">'è®¾è®¡æ¨¡å¼'</span>);</span><br><span class="line"></span><br><span class="line">folder1.add(file1);</span><br><span class="line">folder2.add(file2);</span><br><span class="line"></span><br><span class="line">folder.add(folder1);</span><br><span class="line">folder.add(folder2);</span><br><span class="line">folder.add(file3);</span><br><span class="line"></span><br><span class="line">folder1.remove();</span><br><span class="line"></span><br><span class="line">folder.scan();</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> å¼€å§‹æ‰«ææ–‡ä»¶å¤¹: study</span></span><br><span class="line"><span class="comment"> å¼€å§‹æ‰«ææ–‡ä»¶å¤¹: angular</span></span><br><span class="line"><span class="comment"> å¼€å§‹æ‰«ææ–‡ä»¶:  ng</span></span><br><span class="line"><span class="comment"> å¼€å§‹æ‰«ææ–‡ä»¶:  è®¾è®¡æ¨¡å¼</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure><h2 id="ä½•æ—¶ä½¿ç”¨ç»„åˆæ¨¡å¼"><a href="#ä½•æ—¶ä½¿ç”¨ç»„åˆæ¨¡å¼" class="headerlink" title="ä½•æ—¶ä½¿ç”¨ç»„åˆæ¨¡å¼"></a>ä½•æ—¶ä½¿ç”¨ç»„åˆæ¨¡å¼</h2><blockquote><ol><li>è¡¨ç¤ºå¯¹è±¡çš„éƒ¨åˆ†-æ•´ä½“å±‚æ¬¡ç»“æ„</li><li>å®¢æˆ·å¸Œæœ›ç»Ÿä¸€å¯¹å¾…æ ‘ä¸­çš„æ‰€æœ‰å¯¹è±¡</li></ol></blockquote><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><ul><li><em>å®ä½“ä¹¦:</em> <code>JavaScriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µ(æ›¾æ¢)</code></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JSè®¾è®¡æ¨¡å¼ç¬”è®°(å‘½ä»¤æ¨¡å¼)</title>
      <link href="/2015/06/25/JS%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0-%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F/"/>
      <url>/2015/06/25/JS%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0-%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<p>JSè®¾è®¡æ¨¡å¼ç¬”è®°(å‘½ä»¤æ¨¡å¼)<br><a id="more"></a></p><h1 id="å‘½ä»¤æ¨¡å¼"><a href="#å‘½ä»¤æ¨¡å¼" class="headerlink" title="å‘½ä»¤æ¨¡å¼"></a>å‘½ä»¤æ¨¡å¼</h1><blockquote><ul><li>å‘½ä»¤æ¨¡å¼ä¸­çš„å‘½ä»¤(command)æŒ‡çš„æ˜¯ä¸€ä¸ªæ‰§è¡ŒæŸäº›ç‰¹å®šäº‹æƒ…çš„æŒ‡ä»¤</li><li>å‘½ä»¤æ¨¡å¼å¸¸è§çš„åº”ç”¨åœºæ™¯æ˜¯:æœ‰æ—¶å€™éœ€è¦å‘æŸäº›å¯¹è±¡å‘é€è¯·æ±‚,ä½†æ˜¯ä¸çŸ¥é“è¯·æ±‚çš„æ¥æ”¶è€…æ˜¯è°,ä¹Ÿä¸çŸ¥é“è¢«è¯·æ±‚çš„æ“ä½œæ˜¯æ˜¯é‚£ä¹ˆ.æ­¤æ—¶å¸Œæœ›ç”¨ä¸€ç§æ¾è€¦åˆçš„æ–¹å¼æ¥è®¾è®¡ç¨‹åº,ä½¿å¾—è¯·æ±‚å‘é€è€…å’Œè¯·æ±‚æ¥æ”¶è€…èƒ½å¤Ÿæ¶ˆé™¤å½¼æ­¤é—´çš„è€¦åˆå…³ç³»</li><li>commandå¯¹è±¡æ‹¥æœ‰æ›´é•¿çš„ç”Ÿå‘½å‘¨æœŸ.å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸæ˜¯è·Ÿåˆå§‹è¯·æ±‚æ— å…³çš„,å› ä¸ºè¯·æ±‚å·²ç»è¢«å°è£…åœ¨commandå¯¹è±¡çš„æ–¹æ³•ä¸­,æˆä¸ºäº†è¿™ä¸ªå¯¹è±¡çš„è¡Œä¸º</li><li>å‘½ä»¤æ¨¡å¼è¿˜æ”¯æŒæ’¤é”€,æ’é˜Ÿç­‰æ“ä½œ</li></ul></blockquote><h2 id="èœå•ç¨‹åºå®ä¾‹"><a href="#èœå•ç¨‹åºå®ä¾‹" class="headerlink" title="èœå•ç¨‹åºå®ä¾‹"></a>èœå•ç¨‹åºå®ä¾‹</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> setCommand = <span class="function"><span class="keyword">function</span>(<span class="params">btn, command</span>) </span>&#123;</span><br><span class="line">    btn.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        command.execute();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> MenuBar = &#123;</span><br><span class="line">    refresh: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'åˆ·æ–°'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> RefreshMenuBarCommand = <span class="function"><span class="keyword">function</span>(<span class="params">receiver</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        execute: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            receiver.refresh();</span><br><span class="line">        &#125;,</span><br><span class="line">        undo: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> refreshMenuBarCommand =RefreshMenuBarCommand(MenuBar);</span><br><span class="line">setCommand(<span class="built_in">document</span>.getElementById(<span class="string">'btn'</span>), refreshMenuBarCommand);</span><br></pre></td></tr></table></figure><p><strong>é™¤äº†æ‰§è¡Œå‘½ä»¤å¤–,è¿˜æä¾›æ’¤é”€ç­‰å‘½ä»¤æ“ä½œ,æ‰€ä»¥æŠŠæ‰§è¡Œå‡½æ•°å†™æˆexecuteæ–¹æ³•</strong></p><h2 id="å®å‘½ä»¤"><a href="#å®å‘½ä»¤" class="headerlink" title="å®å‘½ä»¤"></a>å®å‘½ä»¤</h2><p><strong>å®å‘½ä»¤æ˜¯ä¸€ç»„å‡ ä½•,é€šè¿‡æ‰§è¡Œå®å‘½ä»¤çš„æ–¹å¼,å¯ä»¥ä¸€æ¬¡æ‰§è¡Œä¸€æ‰¹å‘½ä»¤</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> closeDoorCommand = &#123;</span><br><span class="line">    execute: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'å…³é—¨'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> openPcCommand = &#123;</span><br><span class="line">    execute: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'å¼€ç”µè„‘'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> openQQCommand = &#123;</span><br><span class="line">    execute: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'ç™»å½•QQ'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰å®å‘½ä»¤ MacroCommand</span></span><br><span class="line"><span class="keyword">var</span> MacroCommand = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        commandsList:[],</span><br><span class="line">        add: <span class="function"><span class="keyword">function</span>(<span class="params">command</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.commandsList.push(command);</span><br><span class="line">        &#125;,</span><br><span class="line">        execute: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, command; command= <span class="keyword">this</span>.commandsList[i++]; ) &#123;</span><br><span class="line">                command.execute();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> macroCommand = MacroCommand();</span><br><span class="line">macroCommand.add(closeDoorCommand);</span><br><span class="line">macroCommand.add(openPcCommand);</span><br><span class="line">macroCommand.add(openQQCommand);</span><br><span class="line"></span><br><span class="line">macroCommand.execute();</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> å…³é—¨</span></span><br><span class="line"><span class="comment"> å¼€ç”µè„‘</span></span><br><span class="line"><span class="comment"> ç™»å½•QQ</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure></p><h2 id="æ™ºèƒ½å‘½ä»¤å’Œå‚»ç“œå‘½ä»¤"><a href="#æ™ºèƒ½å‘½ä»¤å’Œå‚»ç“œå‘½ä»¤" class="headerlink" title="æ™ºèƒ½å‘½ä»¤å’Œå‚»ç“œå‘½ä»¤"></a>æ™ºèƒ½å‘½ä»¤å’Œå‚»ç“œå‘½ä»¤</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> closeDoorCommand = &#123;</span><br><span class="line">    execute: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'å…³é—¨'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><blockquote><ol><li>ä¸€èˆ¬æ¥è¯´,å‘½ä»¤æ¨¡å¼éƒ½ä¼šåœ¨commandå¯¹è±¡ä¸­ä¿å­˜ä¸€ä¸ªæ¥æ”¶è€…æ¥è´Ÿè´£çœŸæ­£æ‰§è¡Œå®¢æˆ·çš„è¯·æ±‚,è¿™ç§æƒ…å†µä¸‹çš„å‘½ä»¤æ˜¯â€å‚»ç“œå¼â€çš„</li><li><code>closeDoorCommand</code>ä¸­æ²¡æœ‰åŒ…å«ä»»ä½• <code>receiver</code>çš„ä¿¡æ¯,å®ƒæœ¬èº«å°±åŒ…æ½äº†æ‰§è¡Œè¯·æ±‚çš„è¡Œä¸º(å‘½ä»¤å¯¹è±¡å¯ä»¥ç›´æ¥å®ç°è¯·æ±‚çš„å®šä¹‰),å«åšæ™ºèƒ½å‘½ä»¤</li></ol></blockquote><h2 id="æ™ºèƒ½å‘½ä»¤å’Œç­–ç•¥æ¨¡å¼"><a href="#æ™ºèƒ½å‘½ä»¤å’Œç­–ç•¥æ¨¡å¼" class="headerlink" title="æ™ºèƒ½å‘½ä»¤å’Œç­–ç•¥æ¨¡å¼"></a>æ™ºèƒ½å‘½ä»¤å’Œç­–ç•¥æ¨¡å¼</h2><blockquote><ul><li>ç­–ç•¥æ¨¡å¼æŒ‡å‘çš„é—®é¢˜åŸŸæ›´å°,æ‰€æœ‰ç­–ç•¥å¯¹è±¡çš„ç›®æ ‡æ€»æ˜¯ä¸€è‡´çš„,å®ƒä»¬åªæ˜¯è¾¾åˆ°è¿™ä¸ªç›®æ ‡çš„ä¸åŒæ‰‹æ®µ,å®ƒä»¬çš„å†…éƒ¨å®ç°æ˜¯é’ˆå¯¹ç®—æ³•è€Œè¨€çš„</li><li>æ™ºèƒ½å‘½ä»¤æ¨¡å¼æŒ‡å‘çš„é—®é¢˜åŸŸæ›´å¹¿,commandå¯¹è±¡è§£å†³çš„ç›®æ ‡æ›´å…·æœ‰å‘æ•£æ€§.å‘½ä»¤æ¨¡å¼è¿˜å¯ä»¥å®Œæˆæ’¤é”€,æ’é˜Ÿç­‰åŠŸèƒ½</li></ul></blockquote><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><ul><li><em>å®ä½“ä¹¦:</em> <code>JavaScriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µ(æ›¾æ¢)</code></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JSè®¾è®¡æ¨¡å¼ç¬”è®°(å‘å¸ƒ-è®¢é˜…æ¨¡å¼)</title>
      <link href="/2015/06/24/JS%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0-%E5%8F%91%E5%B8%83-%E8%AE%A2%E9%98%85%E6%A8%A1%E5%BC%8F/"/>
      <url>/2015/06/24/JS%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0-%E5%8F%91%E5%B8%83-%E8%AE%A2%E9%98%85%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<p>JSè®¾è®¡æ¨¡å¼ç¬”è®°(å‘å¸ƒ-è®¢é˜…æ¨¡å¼)<br><a id="more"></a></p><h1 id="å‘å¸ƒ-è®¢é˜…æ¨¡å¼"><a href="#å‘å¸ƒ-è®¢é˜…æ¨¡å¼" class="headerlink" title="å‘å¸ƒ-è®¢é˜…æ¨¡å¼"></a>å‘å¸ƒ-è®¢é˜…æ¨¡å¼</h1><p><strong>å®šä¹‰å¯¹è±¡é—´ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»,å½“ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶,æ‰€æœ‰ä¾èµ–å®ƒçš„å¯¹è±¡éƒ½å°†å¾—åˆ°é€šçŸ¥.åœ¨jsä¸­,ç”¨äº‹ä»¶æ¨¡å‹ä»£æ›¿ä¼ ç»Ÿçš„å‘å¸ƒ-è®¢é˜…æ¨¡å¼</strong></p><h2 id="å‘å¸ƒ-è®¢é˜…æ¨¡å¼çš„é€šç”¨å®ç°"><a href="#å‘å¸ƒ-è®¢é˜…æ¨¡å¼çš„é€šç”¨å®ç°" class="headerlink" title="å‘å¸ƒ-è®¢é˜…æ¨¡å¼çš„é€šç”¨å®ç°"></a>å‘å¸ƒ-è®¢é˜…æ¨¡å¼çš„é€šç”¨å®ç°</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> event = &#123;</span><br><span class="line">    clientList: [],</span><br><span class="line">    listen: <span class="function"><span class="keyword">function</span>(<span class="params">key, fn</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">this</span>.clientList[key]) &#123;</span><br><span class="line">            <span class="keyword">this</span>.clientList[key] = [];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.clientList[key].push(fn);</span><br><span class="line">    &#125;,</span><br><span class="line">    trigger: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> key = [].shift.call(<span class="built_in">arguments</span>);</span><br><span class="line">        <span class="keyword">var</span> fns = <span class="keyword">this</span>.clientList[key];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¦‚æœæ²¡æœ‰å¯¹åº”çš„ç»‘å®šæ¶ˆæ¯</span></span><br><span class="line">        <span class="keyword">if</span> (!fns || fns.length === <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, fn; fn = fns[i++];) &#123;</span><br><span class="line">            <span class="comment">// arguments æ˜¯ triggerå¸¦ä¸Šçš„å‚æ•°</span></span><br><span class="line">            fn.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    remove: <span class="function"><span class="keyword">function</span>(<span class="params">key, fn</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> fns = <span class="keyword">this</span>.clientList[key];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// keyå¯¹åº”çš„æ¶ˆæ¯ä¹ˆæœ‰è¢«äººè®¢é˜…</span></span><br><span class="line">        <span class="keyword">if</span> (!fns) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ²¡æœ‰ä¼ å…¥fn(å…·ä½“çš„å›è°ƒå‡½æ•°), è¡¨ç¤ºå–æ¶ˆkeyå¯¹åº”çš„æ‰€æœ‰è®¢é˜…</span></span><br><span class="line">        <span class="keyword">if</span> (!fn) &#123;</span><br><span class="line">            fns &amp;&amp; (fns.length = <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// åå‘éå†</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = fns.length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">                <span class="keyword">var</span> _fn = fns[i];</span><br><span class="line">                <span class="keyword">if</span> (_fn === fn) &#123;</span><br><span class="line">                    <span class="comment">// åˆ é™¤è®¢é˜…å›è°ƒå‡½æ•°</span></span><br><span class="line">                    fns.splice(i, <span class="number">1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> installEvent = <span class="function"><span class="keyword">function</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i  <span class="keyword">in</span> event) &#123;</span><br><span class="line">        obj[i] = event[i];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®ä¾‹</span></span><br><span class="line"><span class="keyword">var</span> salesOffices = &#123;&#125;;</span><br><span class="line">installEvent(salesOffices);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> fn1 = <span class="function"><span class="keyword">function</span>(<span class="params">price</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'squareMeter88 fn1: '</span> + price);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">salesOffices.listen(<span class="string">'squareMeter88'</span>, fn1);</span><br><span class="line"></span><br><span class="line">salesOffices.listen(<span class="string">'squareMeter88'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">price</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'squareMeter88 fn2: '</span> + price);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">salesOffices.listen(<span class="string">'squareMeter100'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">price</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(price);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">salesOffices.remove(<span class="string">'squareMeter88'</span>, fn1);</span><br><span class="line">salesOffices.trigger(<span class="string">'squareMeter88'</span>, <span class="number">20000</span>);</span><br><span class="line">salesOffices.trigger(<span class="string">'squareMeter100'</span>, <span class="number">30000</span>);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> squareMeter88 fn2: 20000</span></span><br><span class="line"><span class="comment"> 30000</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure><h2 id="ç½‘ç«™ç™»å½•å®ä¾‹"><a href="#ç½‘ç«™ç™»å½•å®ä¾‹" class="headerlink" title="ç½‘ç«™ç™»å½•å®ä¾‹"></a>ç½‘ç«™ç™»å½•å®ä¾‹</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç™»å½•</span></span><br><span class="line">$.ajax(<span class="string">'http://XXXXXX?login'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">    login.trigger(<span class="string">'loginSucc'</span>, data);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> header = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    login.listen(<span class="string">'loginSucc'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">        header.setAvatar(data.avatar);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        setAvatar: <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'è®¾ç½®headeræ¨¡å—çš„å¤´åƒ'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> nav = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    login.listen(<span class="string">'loginSucc'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">        header.setAvatar(data.avatar);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        setAvatar: <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'è®¾ç½®navæ¨¡å—çš„å¤´åƒ'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// æœ‰ä¸€å¤©, åˆå¢åŠ äº†ä¸€ä¸ªæ–°çš„è¡Œä¸º</span></span><br><span class="line"><span class="keyword">var</span> address = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    login.listen(<span class="string">'loginSucc'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">        address.refresh(obj);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        refresh: <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'åˆ·æ–°åœ°å€åˆ—è¡¨'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;());</span><br></pre></td></tr></table></figure><h2 id="å…¨å±€çš„å‘å¸ƒ-è®¢é˜…å¯¹è±¡"><a href="#å…¨å±€çš„å‘å¸ƒ-è®¢é˜…å¯¹è±¡" class="headerlink" title="å…¨å±€çš„å‘å¸ƒ-è®¢é˜…å¯¹è±¡"></a>å…¨å±€çš„å‘å¸ƒ-è®¢é˜…å¯¹è±¡</h2><blockquote><p>è®¢é˜…è€…ä¸éœ€è¦äº†è§£æ¶ˆæ¯æ¥è‡ªå“ªä¸ªå‘å¸ƒè€…,å‘å¸ƒè€…ä¹Ÿä¸çŸ¥é“æ¶ˆæ¯ä¼šæ¨é€ç»™å“ªäº›è®¢é˜…è€…,Eventä½œä¸ºä¸€ä¸ªç±»ä¼¼â€ä¸­ä»‹è€…â€çš„è§’è‰²,æŠŠè®¢é˜…è€…å’Œå‘å¸ƒè€…è”ç³»èµ·æ¥</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Event = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> clientList = &#123;&#125;;</span><br><span class="line">    <span class="keyword">var</span> listen,</span><br><span class="line">        trigger,</span><br><span class="line">        remove;</span><br><span class="line">    listen = <span class="function"><span class="keyword">function</span>(<span class="params">key, fn</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!clientList[key]) &#123;</span><br><span class="line">            clientList[key] = [];</span><br><span class="line">        &#125;</span><br><span class="line">        clientList[key].push(fn);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    trigger = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> key = [].shift.call(<span class="built_in">arguments</span>);</span><br><span class="line">        <span class="keyword">var</span> fns = clientList[key];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!fns || fns.length === <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, fn; fn = fns[i++];) &#123;</span><br><span class="line">            fn.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    remove = <span class="function"><span class="keyword">function</span>(<span class="params">key, fn</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> fns = clientList[key];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// keyå¯¹åº”çš„æ¶ˆæ¯ä¹ˆæœ‰è¢«äººè®¢é˜…</span></span><br><span class="line">        <span class="keyword">if</span> (!fns) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ²¡æœ‰ä¼ å…¥fn(å…·ä½“çš„å›è°ƒå‡½æ•°), è¡¨ç¤ºå–æ¶ˆkeyå¯¹åº”çš„æ‰€æœ‰è®¢é˜…</span></span><br><span class="line">        <span class="keyword">if</span> (!fn) &#123;</span><br><span class="line">            fns &amp;&amp; (fns.length = <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// åå‘éå†</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = fns.length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">                <span class="keyword">var</span> _fn = fns[i];</span><br><span class="line">                <span class="keyword">if</span> (_fn === fn) &#123;</span><br><span class="line">                    <span class="comment">// åˆ é™¤è®¢é˜…å›è°ƒå‡½æ•°</span></span><br><span class="line">                    fns.splice(i, <span class="number">1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        listen: listen,</span><br><span class="line">        trigger: trigger,</span><br><span class="line">        remove: remove</span><br><span class="line">    &#125;</span><br><span class="line">&#125;());</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®ä¾‹</span></span><br><span class="line">Event.listen(<span class="string">'squareMeter88'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">price</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(price);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">Event.trigger(<span class="string">'squareMeter88'</span>, <span class="number">20000</span>);   <span class="comment">// 20000</span></span><br></pre></td></tr></table></figure><h2 id="å…¨å±€äº‹ä»¶å‘½åå†²çª"><a href="#å…¨å±€äº‹ä»¶å‘½åå†²çª" class="headerlink" title="å…¨å±€äº‹ä»¶å‘½åå†²çª"></a>å…¨å±€äº‹ä»¶å‘½åå†²çª</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Event = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> Event,</span><br><span class="line">        _default = <span class="string">'default'</span>;</span><br><span class="line"></span><br><span class="line">    Event = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> _listen,</span><br><span class="line">            _trigger,</span><br><span class="line">            _remove,</span><br><span class="line">            _shift = [].shift,</span><br><span class="line">            _unshift = [].unshift,</span><br><span class="line">            namespaceCache = &#123;&#125;,</span><br><span class="line">            _create,</span><br><span class="line">            each = <span class="function"><span class="keyword">function</span>(<span class="params">arr, fn</span>) </span>&#123;</span><br><span class="line">                <span class="keyword">var</span> ret;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, l = arr.length; i &lt; l; i++) &#123;</span><br><span class="line">                    <span class="keyword">var</span> n = arr[i];</span><br><span class="line">                    ret = fn.call(n, i, n);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> ret;</span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">        _listen = <span class="function"><span class="keyword">function</span>(<span class="params">key, fn, cache</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (!cache[key]) &#123;</span><br><span class="line">                cache[key] = [];</span><br><span class="line">            &#125;</span><br><span class="line">            cache[key].push(fn);</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        _remove = <span class="function"><span class="keyword">function</span>(<span class="params">key, cache, fn</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (cache[key]) &#123;</span><br><span class="line">                <span class="keyword">if</span> (fn) &#123;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">var</span> i = cache[key].length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (cache[key][i] === fn) &#123;  <span class="comment">// åŸä¹¦ä¸º cache[key] === fn, é”™è¯¯!</span></span><br><span class="line">                            <span class="comment">// åˆ é™¤è®¢é˜…å›è°ƒå‡½æ•°</span></span><br><span class="line">                            cache[key].splice(i, <span class="number">1</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    cache[key] = [];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        _trigger = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> cache = _shift.call(<span class="built_in">arguments</span>);</span><br><span class="line">            <span class="keyword">var</span> key = _shift.call(<span class="built_in">arguments</span>);</span><br><span class="line">            <span class="keyword">var</span> args = <span class="built_in">arguments</span>;</span><br><span class="line">            <span class="keyword">var</span> _this = <span class="keyword">this</span>;</span><br><span class="line">            <span class="keyword">var</span> stack = cache[key];</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (!stack || !stack.length) &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> each(stack, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">this</span>.apply(_this, args);</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        _create = <span class="function"><span class="keyword">function</span>(<span class="params">namespace</span>) </span>&#123;</span><br><span class="line">            namespace = namespace || _default;</span><br><span class="line">            <span class="keyword">var</span> cache = &#123;&#125;;</span><br><span class="line">            <span class="keyword">var</span> offlineStack = []; <span class="comment">//ç¦»çº¿äº‹ä»¶</span></span><br><span class="line">            <span class="keyword">var</span> ret = &#123;</span><br><span class="line">                listen: <span class="function"><span class="keyword">function</span>(<span class="params">key, fn, last</span>) </span>&#123;</span><br><span class="line">                    _listen(key, fn, cache);</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (offlineStack === <span class="literal">null</span>) &#123;</span><br><span class="line">                        <span class="keyword">return</span>;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (last === <span class="string">'last'</span>) &#123;</span><br><span class="line">                        offlineStack.length &amp;&amp; offlineStack.pop()();</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span> &#123;</span><br><span class="line">                        each(offlineStack, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                            <span class="keyword">this</span>();</span><br><span class="line">                        &#125;);</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    offlineStack = <span class="literal">null</span>;</span><br><span class="line">                &#125;,</span><br><span class="line">                one: <span class="function"><span class="keyword">function</span>(<span class="params">key, fn, last</span>) </span>&#123;</span><br><span class="line">                    _remove(key, cache);</span><br><span class="line">                    <span class="keyword">this</span>.listen(key, fn, last);</span><br><span class="line">                &#125;,</span><br><span class="line">                remove: <span class="function"><span class="keyword">function</span>(<span class="params">key, fn</span>) </span>&#123;</span><br><span class="line">                    _remove(key, cache, fn);</span><br><span class="line">                &#125;,</span><br><span class="line">                trigger: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                    <span class="keyword">var</span> fn,</span><br><span class="line">                        args,</span><br><span class="line">                        _this = <span class="keyword">this</span>;</span><br><span class="line"></span><br><span class="line">                    _unshift.call(<span class="built_in">arguments</span>, cache);</span><br><span class="line">                    args = <span class="built_in">arguments</span>;</span><br><span class="line"></span><br><span class="line">                    fn = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                        <span class="keyword">return</span> _trigger.apply(_this, args);</span><br><span class="line">                    &#125;;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (offlineStack) &#123;</span><br><span class="line">                        <span class="keyword">return</span> offlineStack.push(fn);</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">return</span> fn();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> namespace ?</span><br><span class="line">                (namespaceCache[namespace] ?</span><br><span class="line">                    namespaceCache[namespace] : namespaceCache[namespace] = ret)</span><br><span class="line">                : ret;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            create: _create,</span><br><span class="line">            one: <span class="function"><span class="keyword">function</span>(<span class="params">key, fn, last</span>) </span>&#123;</span><br><span class="line">                <span class="keyword">var</span> event = <span class="keyword">this</span>.create();</span><br><span class="line">                event.one(key, fn, last);</span><br><span class="line">            &#125;,</span><br><span class="line">            remove: <span class="function"><span class="keyword">function</span>(<span class="params">key, fn</span>) </span>&#123;</span><br><span class="line">                <span class="keyword">var</span> event = <span class="keyword">this</span>.create();</span><br><span class="line">                event.remove(key, fn);</span><br><span class="line">            &#125;,</span><br><span class="line">            listen: <span class="function"><span class="keyword">function</span>(<span class="params">key, fn, last</span>) </span>&#123;</span><br><span class="line">                <span class="keyword">var</span> event = <span class="keyword">this</span>.create();</span><br><span class="line">                event.listen(key, fn, last);</span><br><span class="line">            &#125;,</span><br><span class="line">            trigger: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="keyword">var</span> event = <span class="keyword">this</span>.create();</span><br><span class="line">                event.trigger.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Event;</span><br><span class="line">&#125;());</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> fn1 = <span class="function"><span class="keyword">function</span>(<span class="params">price</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(price);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®ä¾‹</span></span><br><span class="line">Event.listen(<span class="string">'squareMeter88'</span>, fn1);</span><br><span class="line">Event.remove(<span class="string">'squareMeter88'</span>, fn1);</span><br><span class="line"></span><br><span class="line">Event.listen(<span class="string">'squareMeter88'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">price</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'fn2: '</span> + price);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Event.trigger(<span class="string">'squareMeter88'</span>, <span class="number">20000</span>);   <span class="comment">// fn2: 20000</span></span><br></pre></td></tr></table></figure><h2 id="å‘å¸ƒ-è®¢é˜…æ¨¡å¼-è§‚å¯Ÿè€…æ¨¡å¼-ä¼˜ç‚¹"><a href="#å‘å¸ƒ-è®¢é˜…æ¨¡å¼-è§‚å¯Ÿè€…æ¨¡å¼-ä¼˜ç‚¹" class="headerlink" title="å‘å¸ƒ-è®¢é˜…æ¨¡å¼(è§‚å¯Ÿè€…æ¨¡å¼)ä¼˜ç‚¹:"></a>å‘å¸ƒ-è®¢é˜…æ¨¡å¼(è§‚å¯Ÿè€…æ¨¡å¼)ä¼˜ç‚¹:</h2><ol><li>æ—¶é—´ä¸Šè§£è€¦</li><li>å¯¹è±¡ä¹‹é—´çš„è§£è€¦</li></ol><h2 id="å‘å¸ƒ-è®¢é˜…æ¨¡å¼-è§‚å¯Ÿè€…æ¨¡å¼-ç¼ºç‚¹"><a href="#å‘å¸ƒ-è®¢é˜…æ¨¡å¼-è§‚å¯Ÿè€…æ¨¡å¼-ç¼ºç‚¹" class="headerlink" title="å‘å¸ƒ-è®¢é˜…æ¨¡å¼(è§‚å¯Ÿè€…æ¨¡å¼)ç¼ºç‚¹:"></a>å‘å¸ƒ-è®¢é˜…æ¨¡å¼(è§‚å¯Ÿè€…æ¨¡å¼)ç¼ºç‚¹:</h2><ol><li>åˆ›å»ºè®¢é˜…è€…æœ¬èº«è¦æ¶ˆè€—ä¸€å®šçš„æ—¶é—´ä¸ªå†…å­˜</li><li>è®¢é˜…ä¸€ä¸ªæ¶ˆæ¯å,ä¹Ÿè®¸æ­¤æ¶ˆæ¯æœ€åéƒ½æœªå‘ç”Ÿ,ä½†è¿™ä¸ªè®¢é˜…è€…å§‹ç»ˆä¼šå­˜åœ¨å†…å­˜ä¸­</li><li>å‘å¸ƒ-è®¢é˜…æ¨¡å¼è™½ç„¶å¯ä»¥å¼±åŒ–å¯¹è±¡ä¹‹é—´çš„è”ç³»,ä½†æ˜¯å¦‚æœè¿‡åº¦ä½¿ç”¨çš„è¯,å¯¹è±¡å’Œå¯¹è±¡ä¹‹é—´çš„å¿…è¦è”ç³»ä¹Ÿå°†æ·±åŸ‹åœ¨èƒŒå,ä¼šå¯¼è‡´ç¨‹åºéš¾ä»¥æ›´é‡ç»´æŠ¤å’Œç†è§£</li></ol><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><ul><li><em>å®ä½“ä¹¦:</em> <code>JavaScriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µ(æ›¾æ¢)</code></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JSè®¾è®¡æ¨¡å¼ç¬”è®°(ä»£ç†æ¨¡å¼,è¿­ä»£å™¨æ¨¡å¼)</title>
      <link href="/2015/06/23/JS%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0-%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F-%E8%BF%AD%E4%BB%A3%E5%99%A8%E6%A8%A1%E5%BC%8F/"/>
      <url>/2015/06/23/JS%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0-%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F-%E8%BF%AD%E4%BB%A3%E5%99%A8%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<p>JSè®¾è®¡æ¨¡å¼ç¬”è®°(ä»£ç†æ¨¡å¼,è¿­ä»£å™¨æ¨¡å¼)<br><a id="more"></a></p><h1 id="ä»£ç†æ¨¡å¼"><a href="#ä»£ç†æ¨¡å¼" class="headerlink" title="ä»£ç†æ¨¡å¼"></a>ä»£ç†æ¨¡å¼</h1><p><strong>ä»£ç†æ¨¡å¼æ˜¯ä¸ºä¸€ä¸ªå¯¹è±¡æä¾›ä¸€ä¸ªä»£æ›¿å“æˆ–å ä½ç¬¦,ä»¥ä¾¿æ§åˆ¶å¯¹å®ƒçš„è®¿é—®</strong></p><blockquote><p>å¾€å¾€ä¸éœ€è¦çŒœæµ‹æ˜¯å¦éœ€è¦ä»£ç†æ¨¡å¼,å½“æ­£çœŸå‘ç°ä¸æ–¹ä¾¿ç›´æ¥è®¿é—®æŸä¸ªå¯¹è±¡çš„æ—¶å€™,å†ç¼–å†™ä»£ç†ä¹Ÿä¸è¿Ÿ</p></blockquote><h3 id="è™šæ‹Ÿä»£ç†å®ç°å›¾ç‰‡åŠ è½½"><a href="#è™šæ‹Ÿä»£ç†å®ç°å›¾ç‰‡åŠ è½½" class="headerlink" title="è™šæ‹Ÿä»£ç†å®ç°å›¾ç‰‡åŠ è½½"></a>è™šæ‹Ÿä»£ç†å®ç°å›¾ç‰‡åŠ è½½</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myImage = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> imgNode = <span class="built_in">document</span>.createElement(<span class="string">'img'</span>);</span><br><span class="line">    <span class="built_in">document</span>.body.appendChild(imgNode);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        setSrc: <span class="function"><span class="keyword">function</span>(<span class="params">src</span>) </span>&#123;</span><br><span class="line">            imgNode.src = src;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;());</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> proxyImage = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> img = <span class="keyword">new</span> Image;</span><br><span class="line">    img.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        myImage.setSrc(<span class="keyword">this</span>.src);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        setSrc: <span class="function"><span class="keyword">function</span>(<span class="params">src</span>) </span>&#123;</span><br><span class="line">            myImage.setSrc(<span class="string">'http://upload.xinshangshangxin.com/o_19n9lj3a480nl2l1ie7up31ckc9.png'</span>);</span><br><span class="line">            img.src = src;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;());</span><br><span class="line"></span><br><span class="line">proxyImage.setSrc(<span class="string">'http://upload.xinshangshangxin.com/o_19n9ljafs96hpif1o401mci1r7c18.jpg'</span>);</span><br></pre></td></tr></table></figure><ul><li><strong>ç¬¦åˆå•ä¸€èŒè´£åŸåˆ™;MyImageå¯¹è±¡è´Ÿè´£ç»™imgå¯¹è±¡è®¾ç½®src, proxyImageè´Ÿè´£é¢„åŠ è½½å›¾ç‰‡</strong></li><li><strong>ç¬¦åˆå¼€æ”¾å°é—­åŸåˆ™;æ²¡æœ‰æ”¹å˜æˆ–è€…å¢åŠ myImageçš„æ¥å£,ä½†æ˜¯é€šè¿‡ä»£ç†å¯¹è±¡,å®é™…ä¸Šç»™ç³»ç»Ÿæ·»åŠ äº†æ–°çš„è¡Œä¸º</strong></li><li><strong>ä»£ç†å’Œæœ¬ä½“æ¥å£çš„ä¸€è‡´æ€§. å¦‚æœä»£ç†å¯¹è±¡å’Œæœ¬ä½“å¯¹è±¡éƒ½ä¸ºä¸€ä¸ªå‡½æ•°(å‡½æ•°ä¹Ÿæ˜¯å¯¹è±¡),å‡½æ•°å¿…ç„¶éƒ½èƒ½æ‰§è¡Œ,åˆ™å¯ä»¥è®¤ä¸ºå®ƒä»¬ä¹Ÿå…·æœ‰ä¸€è‡´çš„æ¥å£</strong></li></ul><h3 id="è™šæ‹Ÿä»£ç†åˆå¹¶HTTPè¯·æ±‚"><a href="#è™šæ‹Ÿä»£ç†åˆå¹¶HTTPè¯·æ±‚" class="headerlink" title="è™šæ‹Ÿä»£ç†åˆå¹¶HTTPè¯·æ±‚"></a>è™šæ‹Ÿä»£ç†åˆå¹¶HTTPè¯·æ±‚</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> synchronousFile = <span class="function"><span class="keyword">function</span>(<span class="params">id</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'å¼€å§‹åŒæ­¥æ–‡ä»¶,idä¸º: '</span> + id);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> proxySynchronousFile = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> cache = [];</span><br><span class="line">    <span class="keyword">var</span> timer;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">id</span>) </span>&#123;</span><br><span class="line">        cache.push(id);</span><br><span class="line">        <span class="keyword">if</span> (timer) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        timer = setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            synchronousFile(cache.join(<span class="string">','</span>));</span><br><span class="line">            clearTimeout(timer);</span><br><span class="line">            cache.length = <span class="number">0</span>;</span><br><span class="line">            timer = <span class="literal">null</span>;</span><br><span class="line">        &#125;, <span class="number">2000</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;());</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> checkbox = <span class="built_in">document</span>.getElementsByTagName(<span class="string">'input'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; c=checkbox[i++]; ) &#123;</span><br><span class="line">    c.onclick= <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>.checked === <span class="literal">true</span>) &#123;</span><br><span class="line">            proxySynchronousFile(<span class="keyword">this</span>.id);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* html</span></span><br><span class="line"><span class="comment"> &lt;input type="checkbox" id="1"&gt;1</span></span><br><span class="line"><span class="comment"> &lt;input type="checkbox" id="2"&gt;2</span></span><br><span class="line"><span class="comment"> &lt;input type="checkbox" id="3"&gt;3</span></span><br><span class="line"><span class="comment"> &lt;input type="checkbox" id="4"&gt;4</span></span><br><span class="line"><span class="comment"> &lt;input type="checkbox" id="5"&gt;5</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure><h3 id="ç¼“å­˜ä»£ç†â€“è®¡ç®—ä¹˜ç§¯"><a href="#ç¼“å­˜ä»£ç†â€“è®¡ç®—ä¹˜ç§¯" class="headerlink" title="ç¼“å­˜ä»£ç†â€“è®¡ç®—ä¹˜ç§¯"></a>ç¼“å­˜ä»£ç†â€“è®¡ç®—ä¹˜ç§¯</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> mult = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'å¼€å§‹è®¡ç®—ä¹˜ç§¯'</span>);</span><br><span class="line">    <span class="keyword">var</span> a = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, l = <span class="built_in">arguments</span>.length; i &lt; l; i++) &#123;</span><br><span class="line">        a = a * <span class="built_in">arguments</span>[i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">mult(<span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line">mult(<span class="number">2</span>, <span class="number">3</span>); <span class="comment">// ä¾ç„¶é‡æ–°è®¡ç®—</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> proxyMult = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> cache = &#123;&#125;;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> args = [].join.call(<span class="built_in">arguments</span>, <span class="string">','</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (args <span class="keyword">in</span> cache) &#123;</span><br><span class="line">            <span class="keyword">return</span> cache[args];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> cache[args] = mult.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">proxyMult(<span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line">proxyMult(<span class="number">2</span>, <span class="number">3</span>);       <span class="comment">// åªè®¡ç®—ç¬¬ä¸€æ¬¡,ç¬¬äºŒæ¬¡ä½¿ç”¨ç¼“å­˜</span></span><br></pre></td></tr></table></figure><p><strong>å¢åŠ ç¼“å­˜ä»£ç†, multå‡½æ•°å¯ä»¥ç»§ç»­ä¸“æ³¨äºè‡ªèº«çš„èŒè´£(è®¡ç®—æˆç»©), ç¼“å­˜çš„åŠŸèƒ½èƒ½å¤Ÿæœ‰ä»£ç†å¯¹è±¡å®ç°</strong></p><h3 id="ç”¨é«˜é˜¶å‡½æ•°åŠ¨æ€åˆ›å»ºä»£ç†"><a href="#ç”¨é«˜é˜¶å‡½æ•°åŠ¨æ€åˆ›å»ºä»£ç†" class="headerlink" title="ç”¨é«˜é˜¶å‡½æ•°åŠ¨æ€åˆ›å»ºä»£ç†"></a>ç”¨é«˜é˜¶å‡½æ•°åŠ¨æ€åˆ›å»ºä»£ç†</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*****è®¡ç®—æˆç»©*******/</span></span><br><span class="line"><span class="keyword">var</span> mult = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, l = <span class="built_in">arguments</span>.length; i &lt; l; i++) &#123;</span><br><span class="line">        a = a * <span class="built_in">arguments</span>[i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/********è®¡ç®—åŠ å’Œ************/</span></span><br><span class="line"><span class="keyword">var</span> plus = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, l = <span class="built_in">arguments</span>.length; i &lt; l; i++) &#123;</span><br><span class="line">        a = a + <span class="built_in">arguments</span>[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*****åˆ›å»ºç¼“å­˜ä»£ç†å·¥å‚*****/</span></span><br><span class="line"><span class="keyword">var</span> createProxyFactory = <span class="function"><span class="keyword">function</span>(<span class="params">fn</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> cache = &#123;&#125;;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> args = [].join.call(<span class="built_in">arguments</span>, <span class="string">','</span>);</span><br><span class="line">        <span class="keyword">if</span> (args <span class="keyword">in</span> cache) &#123;</span><br><span class="line">            <span class="keyword">return</span> cache[args];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> cache[args] = fn.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> proxyMult = createProxyFactory(mult);</span><br><span class="line"><span class="keyword">var</span> proxyPlus = createProxyFactory(plus);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(proxyMult(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>));</span><br><span class="line"><span class="built_in">console</span>.log(proxyMult(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>));</span><br><span class="line"><span class="built_in">console</span>.log(proxyPlus(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>));</span><br><span class="line"><span class="built_in">console</span>.log(proxyPlus(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>));</span><br></pre></td></tr></table></figure><h1 id="è¿­ä»£å™¨æ¨¡å¼"><a href="#è¿­ä»£å™¨æ¨¡å¼" class="headerlink" title="è¿­ä»£å™¨æ¨¡å¼"></a>è¿­ä»£å™¨æ¨¡å¼</h1><blockquote><p>è¿­ä»£å™¨æ¨¡å¼æ˜¯æŒ‡æä¾›ä¸€ç§æ–¹æ³•é¡ºåºè®¿é—®ä¸€ä¸ªèšåˆå¯¹è±¡ä¸­çš„å„ä¸ªå…ƒç´ ,è€Œåˆä¸éœ€è¦æš´éœ²è¯¥å¯¹è±¡çš„å†…éƒ¨è¡¨ç¤º.è¿­ä»£å™¨æ¨¡å¼å¯ä»¥æŠŠè¿­ä»£çš„è¿‡ç¨‹ä»ä¸šåŠ¡é€»è¾‘ä¸­åˆ†ç¦»å‡ºæ¥,åœ¨ä½¿ç”¨è¿­ä»£å™¨æ¨¡å¼ä¹‹å,å³ä½¿ä¸å…³å¿ƒå¯¹è±¡çš„å†…éƒ¨æ„é€ ,ä¹Ÿå¯ä»¥æŒ‰é¡ºåºè®¿é—®å…¶ä¸­çš„æ¯ä¸ªå…ƒç´ </p></blockquote><h2 id="å®ç°è‡ªå·±çš„è¿­ä»£å™¨"><a href="#å®ç°è‡ªå·±çš„è¿­ä»£å™¨" class="headerlink" title="å®ç°è‡ªå·±çš„è¿­ä»£å™¨"></a>å®ç°è‡ªå·±çš„è¿­ä»£å™¨</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> each = <span class="function"><span class="keyword">function</span>(<span class="params">arr, cb</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, l = arr.length; i &lt; l; i++) &#123;</span><br><span class="line">        cb.call(arr[i], i, arr[i]); <span class="comment">// æŠŠä¸‹æ ‡  å’Œ å…ƒç´  å½“ä½œå‚æ•°ä¼ ç»™ cb</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¾‹å­</span></span><br><span class="line">each([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>], <span class="function"><span class="keyword">function</span>(<span class="params">i, n</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(i, n);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="å†…éƒ¨è¿­ä»£å™¨"><a href="#å†…éƒ¨è¿­ä»£å™¨" class="headerlink" title="å†…éƒ¨è¿­ä»£å™¨"></a>å†…éƒ¨è¿­ä»£å™¨</h2><blockquote><p>å†…éƒ¨è¿­ä»£å™¨åœ¨è°ƒç”¨çš„æ—¶å€™éå¸¸æ–¹ä¾¿,å¤–ç•Œä¸ç”¨å…³å¿ƒè¿­ä»£å™¨å†…éƒ¨çš„å®ç°,è·Ÿè¿­ä»£å™¨çš„äº¤äº’ä¹Ÿä»…ä»…æ˜¯ä¸€æ¬¡åˆå§‹è°ƒç”¨(ä¼˜ç‚¹ä¹Ÿæ˜¯ç¼ºç‚¹)</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> compare = <span class="function"><span class="keyword">function</span>(<span class="params">arr1, arr2</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (arr1.length !== arr2.length) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'arr1 å’Œ arr2 ä¸ç›¸ç­‰'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    each(arr1, <span class="function"><span class="keyword">function</span>(<span class="params">i, n</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (n !== arr2[i]) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'arr1 å’Œ arr2 ä¸ç›¸ç­‰'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'arr1 å’Œ arr2 ç›¸ç­‰'</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">compare([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>]); <span class="comment">// throw new Error('arr1 å’Œ arr2 ä¸ç›¸ç­‰');</span></span><br></pre></td></tr></table></figure><h2 id="å¤–éƒ¨è¿­ä»£å™¨"><a href="#å¤–éƒ¨è¿­ä»£å™¨" class="headerlink" title="å¤–éƒ¨è¿­ä»£å™¨"></a>å¤–éƒ¨è¿­ä»£å™¨</h2><blockquote><p>å¤–éƒ¨è¿­ä»£å™¨å¿…é¡»æ˜¾ç¤ºçš„è¯·æ±‚è¿­ä»£ä¸‹ä¸€ä¸ªå…ƒç´ <br>å¤–éƒ¨è¿­ä»£å™¨å¢åŠ äº†ä¸€äº›è°ƒç”¨çš„å¤æ‚åº¦,ä½†ç›¸å¯¹ä¹Ÿå¢å¼ºäº†è¿­ä»£å™¨çš„çµæ´»æ€§,æˆ‘ä»¬å¯ä»¥æ‰‹å·¥æ§åˆ¶è¿­ä»£çš„å·¥ç¨‹æˆ–è€…é¡ºåº</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Iterator = <span class="function"><span class="keyword">function</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> current = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> next = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        current += <span class="number">1</span>;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> isDone = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> current &gt;= arr.length;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> getCurrItem = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> arr[current];</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        next: next,</span><br><span class="line">        isDone: isDone,</span><br><span class="line">        getCurrItem: getCurrItem</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> compare = <span class="function"><span class="keyword">function</span>(<span class="params">iterator1, iterator2</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(!iterator1.isDone() &amp;&amp; !iterator2.isDone()) &#123;</span><br><span class="line">        <span class="keyword">if</span> (iterator1.getCurrItem() !== iterator2.getCurrItem()) &#123;</span><br><span class="line">            <span class="keyword">throw</span>  <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'iterator1 å’Œ iterator2 ä¸ç›¸ç­‰'</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        iterator1.next();</span><br><span class="line">        iterator2.next();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (iterator1.isDone() &amp;&amp; iterator2.isDone()) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'iterator1 å’Œ iterator2 ç›¸ç­‰'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span>  <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'iterator1 å’Œ iterator2 ä¸ç›¸ç­‰'</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> iterator1 = <span class="keyword">new</span> Iterator([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]);</span><br><span class="line"><span class="keyword">var</span> iterator2 = <span class="keyword">new</span> Iterator([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]);</span><br><span class="line"></span><br><span class="line">compare(iterator1, iterator2); <span class="comment">// iterator1 å’Œ iterator2 ç›¸ç­‰;</span></span><br></pre></td></tr></table></figure><h2 id="ä¸­æ­¢è¿­ä»£å™¨"><a href="#ä¸­æ­¢è¿­ä»£å™¨" class="headerlink" title="ä¸­æ­¢è¿­ä»£å™¨"></a>ä¸­æ­¢è¿­ä»£å™¨</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> each = <span class="function"><span class="keyword">function</span>(<span class="params">arr, cb</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, l = arr.length; i &lt; l; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (cb(i, arr[i]) === <span class="literal">false</span>) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¾‹å­</span></span><br><span class="line">each([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>], <span class="function"><span class="keyword">function</span>(<span class="params">i, n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">3</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(n);  <span class="comment">// 1  2  3</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="åº”ç”¨ä¸¾ä¾‹"><a href="#åº”ç”¨ä¸¾ä¾‹" class="headerlink" title="åº”ç”¨ä¸¾ä¾‹"></a>åº”ç”¨ä¸¾ä¾‹</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> supportFlash = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// æœªå®ç°</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> getActiveUploadObj = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ActiveXObject(<span class="string">'TXFTNActivex.FTMUpload'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> getFlashUploadObj = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (supportFlash()) &#123;</span><br><span class="line">        <span class="keyword">var</span> str = <span class="string">'&lt;object type="application/x-shockwave-flash"&gt;&lt;/object&gt;'</span>;</span><br><span class="line">        <span class="keyword">return</span> $(str).appendTo($(<span class="string">'body'</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> getFormUploadObj = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> str = <span class="string">'&lt;input name="file" type="file"&gt;'</span>;</span><br><span class="line">    <span class="keyword">return</span> $(str).appendTo($(<span class="string">'body'</span>));</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> iteratorUploadObj = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, fn; fn = <span class="built_in">arguments</span>[i++]; ) &#123;</span><br><span class="line">        <span class="keyword">var</span> uploadObj = fn();</span><br><span class="line">        <span class="keyword">if</span> (uploadObj !== <span class="literal">false</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> uploadObj;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> uploadObj = iteratorUploadObj(getActiveUploadObj, getFlashUploadObj, getFormUploadObj);</span><br></pre></td></tr></table></figure><p><strong>è¿­ä»£å™¨æ¨¡å¼æ˜¯ä¸€ç§ç›¸å¯¹ç®€å•çš„æ¨¡å¼,ç®€å•åˆ°å¾ˆå¤šæ—¶å€™ä¸è®¤ä¸ºå®ƒæ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼</strong></p><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><ul><li><em>å®ä½“ä¹¦:</em> <code>JavaScriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µ(æ›¾æ¢)</code></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JSè®¾è®¡æ¨¡å¼ç¬”è®°(é«˜é˜¶å‡½æ•°)</title>
      <link href="/2015/06/22/JS%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0-%E9%AB%98%E9%98%B6%E5%87%BD%E6%95%B0/"/>
      <url>/2015/06/22/JS%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0-%E9%AB%98%E9%98%B6%E5%87%BD%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<p>curry,uncurry,throttle,time_chunk,lazy_load,<br><a id="more"></a></p><h2 id="curry"><a href="#curry" class="headerlink" title="curry"></a>curry</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">currying</span>(<span class="params">fn</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> args = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">arguments</span>.length === <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> fn.apply(<span class="keyword">this</span>, args);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            [].push.apply(args, <span class="built_in">arguments</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">arguments</span>.callee;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> add = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="built_in">arguments</span>.length; i++) &#123;</span><br><span class="line">            sum += <span class="built_in">arguments</span>[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sum;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;());</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> curryAdd = currying(add);</span><br><span class="line">curryAdd(<span class="number">1</span>)(<span class="number">2</span>);</span><br><span class="line"><span class="built_in">console</span>.log(curryAdd());</span><br></pre></td></tr></table></figure><h2 id="uncurry"><a href="#uncurry" class="headerlink" title="uncurry"></a>uncurry</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Function</span>.prototype.uncurrying = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> _this = <span class="keyword">this</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> obj = [].shift.call(<span class="built_in">arguments</span>);</span><br><span class="line">        <span class="keyword">return</span> _this.apply(obj, <span class="built_in">arguments</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æˆ–è€…</span></span><br><span class="line"><span class="built_in">Function</span>.prototype.uncurrying = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> _this = <span class="keyword">this</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Function</span>.prototype.call.apply(_this, <span class="built_in">arguments</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> push = [].push.uncurrying();</span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    length: <span class="number">1</span>,</span><br><span class="line">    <span class="number">0</span>: <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line">push(obj, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(obj); <span class="comment">// &#123; '0': 0, '1': 2, length: 2 &#125;</span></span><br></pre></td></tr></table></figure><h2 id="throttle"><a href="#throttle" class="headerlink" title="throttle"></a>throttle</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> throttle = <span class="function"><span class="keyword">function</span>(<span class="params">fn, interval</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> _fn = fn;           <span class="comment">// æ˜¯ä¸æ˜¯å¤šä½™äº†å‘¢?</span></span><br><span class="line">    <span class="keyword">var</span> isFirst = <span class="literal">true</span>; <span class="comment">//ç¬¬ä¸€æ¬¡è°ƒç”¨ä¸éœ€è¦å»¶è¿Ÿ</span></span><br><span class="line">    <span class="keyword">var</span> timer = <span class="literal">null</span>; <span class="comment">// å®šæ—¶å™¨</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> args = <span class="built_in">arguments</span>;</span><br><span class="line">        <span class="keyword">var</span> _this = <span class="keyword">this</span>;      <span class="comment">// æ˜¯ä¸æ˜¯å¤šäºäº†å‘¢?  this ==== window</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (isFirst) &#123;</span><br><span class="line">            _fn.apply(_this, args);</span><br><span class="line">            <span class="keyword">return</span> isFirst = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (timer) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        timer = setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            clearTimeout(timer);</span><br><span class="line">            timer = <span class="literal">null</span>;</span><br><span class="line">            _fn.apply(_this, args);</span><br><span class="line">        &#125;, interval || <span class="number">500</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// å®ä¾‹</span></span><br><span class="line"><span class="built_in">window</span>.onresize = throttle(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">1</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="time-chunk"><a href="#time-chunk" class="headerlink" title="time_chunk"></a>time_chunk</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * @param arr éœ€è¦çš„æ•°æ®</span></span><br><span class="line"><span class="comment"> * @param fn  å‡½æ•°</span></span><br><span class="line"><span class="comment"> * @param [count] æ¯æ¬¡åˆ›å»ºå¤šå°‘ä¸ªæ•°æ®,é»˜è®¤ä¸€ä¸ª</span></span><br><span class="line"><span class="comment"> * @param [interval] å•ä½æ—¶é—´,é»˜è®¤200ms</span></span><br><span class="line"><span class="comment"> * @returns &#123;Function&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">var</span> timeChunk = <span class="function"><span class="keyword">function</span>(<span class="params">arr, fn, count, interval</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> t;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> start = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> obj;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="built_in">Math</span>.min(count || <span class="number">1</span>, arr.length); i++) &#123;</span><br><span class="line">            obj = arr.shift();</span><br><span class="line">            fn(obj);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        t = setInterval(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (arr.length === <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> clearInterval(t);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            start();</span><br><span class="line">        &#125;, interval || <span class="number">200</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// æµ‹è¯•</span></span><br><span class="line"><span class="keyword">var</span> arr =[];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++) &#123;</span><br><span class="line">    arr.push(i);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> renderFrindsList = timeChunk(arr, <span class="function"><span class="keyword">function</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> div = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>);</span><br><span class="line">    div.innerHTML = n;</span><br><span class="line">    <span class="built_in">document</span>.body.appendChild(div);</span><br><span class="line">&#125;, <span class="number">8</span>);</span><br><span class="line"></span><br><span class="line">renderFrindsList();</span><br></pre></td></tr></table></figure><h2 id="lazy-load"><a href="#lazy-load" class="headerlink" title="lazy_load"></a>lazy_load</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> addEven = <span class="function"><span class="keyword">function</span>(<span class="params">ele, type, handler</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">window</span>.addEventListener) &#123;</span><br><span class="line">        addEven = <span class="function"><span class="keyword">function</span>(<span class="params">ele, type, handler</span>) </span>&#123;</span><br><span class="line">            ele.addEventListener(type, handler, <span class="literal">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">window</span>.attachEvent) &#123;</span><br><span class="line">        addEven = <span class="function"><span class="keyword">function</span>(<span class="params">ele, type, handler</span>) </span>&#123;</span><br><span class="line">            ele.attachEvent(<span class="string">'on'</span> + type, handler);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    addEven(ele, type, handler);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><ul><li><em>å®ä½“ä¹¦:</em> <code>JavaScriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µ(æ›¾æ¢)</code></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JSè®¾è®¡æ¨¡å¼ç¬”è®°(å•ä¾‹å’Œç­–ç•¥)</title>
      <link href="/2015/06/22/JS%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0-%E5%8D%95%E4%BE%8B%E5%92%8C%E7%AD%96%E7%95%A5/"/>
      <url>/2015/06/22/JS%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AC%94%E8%AE%B0-%E5%8D%95%E4%BE%8B%E5%92%8C%E7%AD%96%E7%95%A5/</url>
      
        <content type="html"><![CDATA[<p>JSè®¾è®¡æ¨¡å¼ç¬”è®°(å•ä¾‹å’Œç­–ç•¥)<br><a id="more"></a></p><h2 id="å•ä¾‹æ¨¡å¼"><a href="#å•ä¾‹æ¨¡å¼" class="headerlink" title="å•ä¾‹æ¨¡å¼"></a>å•ä¾‹æ¨¡å¼</h2><blockquote><p>å•ä¾‹æ¨¡å¼çš„æ ¸å¿ƒæ˜¯ç¡®ä¿åªæœ‰ä¸€ä¸ªå®ä¾‹,å¹¶æä¾›å…¨å±€è®¿é—®</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> getSingle = <span class="function"><span class="keyword">function</span>(<span class="params">fn</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> result;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> result || (result = fn.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®ä¾‹</span></span><br><span class="line"><span class="keyword">var</span> createLoginLayer = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> div = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>);</span><br><span class="line">    div.innerHTML=<span class="string">'æˆ‘æ˜¯ç™»å½•æ¡†'</span>;</span><br><span class="line">    div.style.display = <span class="string">'none'</span>;</span><br><span class="line">    <span class="built_in">document</span>.body.appendChild(div);</span><br><span class="line">    <span class="keyword">return</span> div;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> createSingleLoginLayer = getSingle(createLoginLayer);</span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">'test'</span>).onlick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> loginLayer = createSingleLoginLayer();</span><br><span class="line">    loginLayer.style.display = <span class="string">'block'</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><strong>åˆ›å»ºå®ä¾‹å¯¹è±¡çš„èŒè´£å’Œç®¡ç†å•ä¾‹çš„èŒè´£åˆ†åˆ«æ”¾ç½®åœ¨2ä¸ªæ–¹æ³•é‡Œ,è¿™ä¸¤ä¸ªæ–¹æ³•å¯ä»¥ç‹¬ç«‹å˜åŒ–è€Œäº’ä¸å½±å“</strong></p><h2 id="ç­–ç•¥æ¨¡å¼"><a href="#ç­–ç•¥æ¨¡å¼" class="headerlink" title="ç­–ç•¥æ¨¡å¼"></a>ç­–ç•¥æ¨¡å¼</h2><blockquote><p>ç­–ç•¥æ¨¡å¼çš„ç›®çš„æ˜¯å°†ç®—æ³•çš„ä½¿ç”¨å’Œç®—æ³•çš„å®ç°åˆ†ç¦»</p></blockquote><blockquote><p>ä¸€ä¸ªåŸºäºç­–ç•¥æ¨¡å¼çš„ç¨‹åºè‡³å°‘æœ‰ä¸¤éƒ¨åˆ†ç»„æˆ.</p><ol><li>ä¸€ç»„ç­–ç•¥ç±»,ç­–ç•¥ç±»å°è£…äº†å…·ä½“çš„ç®—æ³•,å¹¶è´Ÿè´£å…·ä½“çš„è®¡ç®—è¿‡ç¨‹</li><li>ç¯å¢ƒç±»Context, Contextæ¥å—å®¢æˆ·è¯·æ±‚,éšåæŠŠè¯·æ±‚å§”æ‰˜ç»™æŸä¸€ç­–ç•¥ç±»</li></ol></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ----------å®ä¾‹ä¸€ è®¡ç®—å¥–é‡‘----------</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> strategies = &#123;</span><br><span class="line">    <span class="string">'S'</span>: <span class="function"><span class="keyword">function</span>(<span class="params">salary</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> salary * <span class="number">4</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">'A'</span>: <span class="function"><span class="keyword">function</span>(<span class="params">salary</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> salary * <span class="number">3</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">'B'</span>: <span class="function"><span class="keyword">function</span>(<span class="params">salary</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> salary * <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> calculateBonus = <span class="function"><span class="keyword">function</span>(<span class="params">level, salary</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> strategies[level](salary);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(calculateBonus(<span class="string">'S'</span>, <span class="number">20000</span>));</span><br></pre></td></tr></table></figure><p><strong>calculateBonuså¹¶æ²¡æœ‰è®¡ç®—å¥–é‡‘çš„èƒ½åŠ›,è€Œæ˜¯æŠŠè¿™ä¸ªèŒè´£å§”æ‰˜ç»™äº†æŸä¸ªç­–ç•¥å¯¹è±¡,æ¯ä¸ªç­–ç•¥å¯¹è±¡è´Ÿè´£çš„ç®—æ³•å·²ç»è¢«å„è‡ªå°è£…åœ¨å¯¹è±¡å†…éƒ¨äº†</strong></p><hr><blockquote><p>ç­–ç•¥æ¨¡å¼ä¹Ÿå¯ä»¥ç”¨æ¥å°è£…ä¸€ç³»åˆ—â€ä¸šåŠ¡è§„åˆ™â€.åªè¦è¿™äº›ä¸šåŠ¡è§„åˆ™æŒ‡å‘çš„ç›®æ ‡ä¸€è‡´,å¹¶ä¸”å¯ä»¥è¢«æ›¿æ¢ä½¿ç”¨,å°±å¯ä»¥ä½¿ç”¨ç­–ç•¥æ¨¡å¼å°è£…å®ƒä»¬;</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®ä¾‹äºŒ è¡¨å•æ ¡éªŒ</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> strategies = &#123;</span><br><span class="line">    isNonEmpty: <span class="function"><span class="keyword">function</span>(<span class="params">value, errMsg</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (value === <span class="string">''</span> || value === <span class="literal">undefined</span> || value === <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> errMsg;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    minLen: <span class="function"><span class="keyword">function</span>(<span class="params">value, len, errMsg</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (value.length &lt; len) &#123;</span><br><span class="line">            <span class="keyword">return</span> errMsg;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> Validator = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.cache = [];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Validator.prototype.add = <span class="function"><span class="keyword">function</span>(<span class="params">value, rules</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> _this = <span class="keyword">this</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, rule; rule = rules[i]; i++) &#123;</span><br><span class="line">        (<span class="function"><span class="keyword">function</span>(<span class="params">rule</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> strategyArr = rule.strategy.split(<span class="string">':'</span>);</span><br><span class="line">            <span class="keyword">var</span> ruleName = strategyArr.shift();</span><br><span class="line">            strategyArr.unshift(value);</span><br><span class="line">            strategyArr.push(rule.errMsg || (rule + <span class="string">'é”™è¯¯'</span>));</span><br><span class="line">            _this.cache.push(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> strategies[ruleName].apply(<span class="literal">null</span>, strategyArr);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;)(rule);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Validator.prototype.start = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, validatorFun; validatorFun = <span class="keyword">this</span>.cache[i]; i++) &#123;</span><br><span class="line">        <span class="keyword">var</span> errMsg = validatorFun();</span><br><span class="line">        <span class="keyword">if</span> (errMsg) &#123;</span><br><span class="line">            <span class="keyword">return</span> errMsg;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkreg</span>(<span class="params">userName</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> validator = <span class="keyword">new</span> Validator();</span><br><span class="line">    validator.add(userName, [&#123;</span><br><span class="line">        strategy: <span class="string">'isNonEmpty'</span>,</span><br><span class="line">        errMsg: <span class="string">'ç”¨æˆ·åä¸èƒ½ä¸ºç©º'</span></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">        strategy: <span class="string">'minLen:3'</span>,</span><br><span class="line">        errMsg: <span class="string">'æœ€å°é•¿åº¦ä¸º3'</span></span><br><span class="line">    &#125;]);</span><br><span class="line">    <span class="keyword">var</span> errMsg = validator.start();</span><br><span class="line">    <span class="built_in">console</span>.log(errMsg);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">checkreg(<span class="string">''</span>);       <span class="comment">// ç”¨æˆ·åä¸èƒ½ä¸ºç©º</span></span><br><span class="line">checkreg(<span class="string">'aa'</span>);     <span class="comment">// æœ€å°é•¿åº¦ä¸º3</span></span><br></pre></td></tr></table></figure><h3 id="ç­–ç•¥æ¨¡å¼çš„ä¼˜ç‚¹"><a href="#ç­–ç•¥æ¨¡å¼çš„ä¼˜ç‚¹" class="headerlink" title="ç­–ç•¥æ¨¡å¼çš„ä¼˜ç‚¹"></a>ç­–ç•¥æ¨¡å¼çš„ä¼˜ç‚¹</h3><ol><li>ç­–ç•¥æ¨¡å¼åˆ©ç”¨ ç»„åˆ,å§”æ‰˜å’Œå¤šæ€ç­‰æŠ€æœ¯å’Œæ€æƒ³,å¯ä»¥æœ‰æ•ˆçš„é¿å…å¤šé‡æ¡ä»¶é€‰æ‹©è¯­å¥</li><li>ç­–ç•¥æ¨¡å¼æä¾›äº†å¯¹å¼€æ–¹-å°é—­åŸåˆ™çš„å®Œç¾æ”¯æŒ,å°†ç®—æ³•å°è£…åœ¨ç‹¬ç«‹çš„strategyä¸­,ä½¿å¾—ä»–ä»¬æ˜“äºåˆ‡æ¢,æ˜“äºç†è§£,æ˜“äºæ‰©å±•</li><li>ç­–ç•¥æ¨¡å¼çš„ç®—æ³•ä¹Ÿå¯ä»¥å¤ç”¨åœ¨ç³»ç»Ÿçš„å…¶ä»–åœ°æ–¹,ä»è€Œå¿…é€‰è®¸å¤šé‡å¤çš„å¤åˆ¶ç²˜è´´å·¥ä½œ</li><li>åœ¨ç­–ç•¥æ¨¡å¼ä¸­åˆ©ç”¨ç»„åˆå’Œå§”æ‰˜æ¥è®©Contextæ‹¥æœ‰ç®—æ³•çš„æ‰§è¡Œèƒ½åŠ›,è¿™ä¹Ÿæ˜¯ç»§æ‰¿çš„ä¸€ç§æ›´è½»ä¾¿çš„æ›¿ä»£æ–¹æ¡ˆ</li></ol><h3 id="ç­–ç•¥æ¨¡å¼çš„ç¼ºç‚¹"><a href="#ç­–ç•¥æ¨¡å¼çš„ç¼ºç‚¹" class="headerlink" title="ç­–ç•¥æ¨¡å¼çš„ç¼ºç‚¹"></a>ç­–ç•¥æ¨¡å¼çš„ç¼ºç‚¹</h3><ol><li>å¢åŠ äº†è®¸å¤šç­–ç•¥ç±»/ç­–ç•¥å¯¹è±¡</li><li>å¿…é¡»äº†è§£æ‰€æœ‰çš„strategy,çŸ¥é“å…¶ä¸åŒç‚¹</li></ol><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><ul><li><em>å®ä½“ä¹¦:</em> <code>JavaScriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µ(æ›¾æ¢)</code></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linuxç»ˆç«¯ç¿»å¢™</title>
      <link href="/2015/06/21/linux%E7%BB%88%E7%AB%AF%E7%BF%BB%E5%A2%99/"/>
      <url>/2015/06/21/linux%E7%BB%88%E7%AB%AF%E7%BF%BB%E5%A2%99/</url>
      
        <content type="html"><![CDATA[<p>linuxç»ˆç«¯ç¿»å¢™<br><a id="more"></a></p><h2 id="shadowsocksæœ¬åœ°ç‰ˆ"><a href="#shadowsocksæœ¬åœ°ç‰ˆ" class="headerlink" title="shadowsocksæœ¬åœ°ç‰ˆ"></a>shadowsocksæœ¬åœ°ç‰ˆ</h2><p><a href="http://dl.chenyufei.info/shadowsocks/latest/" target="_blank" rel="noopener">http://dl.chenyufei.info/shadowsocks/latest/</a><br>ä¸‹è½½ä½ æœåŠ¡å™¨å¯¹åº”çš„ç‰ˆæœ¬<code>shadowsocks-local-linux64-1.1.4.gz</code><br><strong>è§£å‹</strong></p><blockquote><p><code>gunzip shadowsocks-local-linux64-1.1.4.gz</code></p></blockquote><p><strong>æ·»åŠ æƒé™</strong></p><blockquote><p><code>chmod a+x shadowsocks-local-linux64-1.1.4</code></p></blockquote><p><strong>è¿è¡Œ</strong></p><blockquote><p><code>./shadowsocks-local-linux64-1.1.4 -d=true -k=&quot;æœåŠ¡å™¨çš„å¯†ç &quot; -m=&quot;aes-256-cfb&quot; -l=1080 -p=æœåŠ¡å™¨çš„ç«¯å£ -s=&quot;æœåŠ¡å™¨çš„ip&quot;</code></p></blockquote><h2 id="å®‰è£…ä»£ç†-äºŒé€‰ä¸€"><a href="#å®‰è£…ä»£ç†-äºŒé€‰ä¸€" class="headerlink" title="å®‰è£…ä»£ç†(äºŒé€‰ä¸€)"></a>å®‰è£…ä»£ç†(äºŒé€‰ä¸€)</h2><h3 id="å®‰è£…proxychains"><a href="#å®‰è£…proxychains" class="headerlink" title="å®‰è£…proxychains."></a>å®‰è£…proxychains.</h3><p><a href="https://github.com/shadowsocks/shadowsocks/wiki/Using-Shadowsocks-with-Command-Line-Tools" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p><p>å®‰è£…:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install proxychains</span><br></pre></td></tr></table></figure></p><p>æ–°å»ºæ–‡ä»¶ <code>~/.proxychains/proxychains.conf</code>,<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">strict_chain</span><br><span class="line">proxy_dns </span><br><span class="line">remote_dns_subnet <span class="number">224</span></span><br><span class="line">tcp_read_time_out <span class="number">15000</span></span><br><span class="line">tcp_connect_time_out <span class="number">8000</span></span><br><span class="line">localnet <span class="number">127.0</span><span class="number">.0</span><span class="number">.0</span>/<span class="number">255.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">quiet_mode</span><br><span class="line"></span><br><span class="line">[ProxyList]</span><br><span class="line">socks5  <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> <span class="number">1080</span></span><br></pre></td></tr></table></figure></p><p>ä½¿ç”¨æ–¹æ³•<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">proxychains4 curl https:<span class="comment">//www.twitter.com/</span></span><br><span class="line">proxychains4 git push origin master</span><br></pre></td></tr></table></figure></p><h3 id="å®‰è£…tsocks"><a href="#å®‰è£…tsocks" class="headerlink" title="å®‰è£…tsocks"></a>å®‰è£…tsocks</h3><blockquote><p><code>apt-get install tsocks</code><br><code>vi /etc/tsocks.conf</code></p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">local = 192.168.1.0/255.255.255.0  #localè¡¨ç¤ºæœ¬åœ°çš„ç½‘ç»œï¼Œä¹Ÿå°±æ˜¯ä¸ä½¿ç”¨socksä»£ç†çš„ç½‘ç»œ</span><br><span class="line">local = <span class="number">127.0</span><span class="number">.0</span><span class="number">.0</span>/<span class="number">255.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">server = 127.0.0.1   #socksæœåŠ¡å™¨çš„IP</span><br><span class="line">server_type = 5  #socksæœåŠ¡ç‰ˆæœ¬</span><br><span class="line">server_port = <span class="number">1080</span>  ï¼ƒsocksæœåŠ¡ä½¿ç”¨çš„ç«¯å£</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨è¦ä½¿ç”¨çš„å‘½ä»¤å‰åŠ ä¸Š <code>tsocks</code> å³å¯<br>ä¾‹å¦‚: <code>tsocks apt-get update</code></p></blockquote><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><ul><li><a href="http://www.joecen.com/2008/02/17/config-apt-get-use-socks-proxy/" target="_blank" rel="noopener">é…ç½®apt-getä½¿ç”¨socksä»£ç†</a></li><li><a href="http://www.ahlinux.com/start/base/21679.html" target="_blank" rel="noopener">Linuxä¸‹é…ç½®ShadowSocks(Server&amp;Client)</a></li><li><a href="http://www.51testing.com/html/38/225738-246084.html" target="_blank" rel="noopener">tsocksç®€ä»‹ã€å®‰è£…ã€é…ç½®åŠé‡åˆ°çš„é—®é¢˜</a></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> shadowsocks </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Dockerå­¦ä¹ ç¬”è®°(2)</title>
      <link href="/2015/06/19/Docker%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-2/"/>
      <url>/2015/06/19/Docker%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-2/</url>
      
        <content type="html"><![CDATA[<p>Dockerå­¦ä¹ ç¬”è®°[ç§æœ‰registry, é…ç½®å¤šå°å®¹å™¨, Jenkins]<br><a id="more"></a></p><h2 id="docker-ç§æœ‰registry"><a href="#docker-ç§æœ‰registry" class="headerlink" title="docker ç§æœ‰registry"></a>docker ç§æœ‰registry</h2><ul><li><p>å¯åŠ¨ registry</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p <span class="number">5000</span>:<span class="number">5000</span> --name registry registry:<span class="number">0.9</span><span class="number">.1</span></span><br></pre></td></tr></table></figure></li><li><p>é•œåƒæ‰“tag<br><strong>docker tag IMAGE[:TAG] [REGISTRY:HOST/][USERNAME/]NAME[:TAG]</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker tag ubuntu/ubuntu:<span class="number">14.04</span> <span class="number">10.221</span><span class="number">.238</span><span class="number">.100</span>:<span class="number">5000</span>/ubuntu/ubuntu:<span class="number">14.04</span></span><br></pre></td></tr></table></figure></li><li><p>pushåˆ°Registryï¼š</p></li></ul><p><strong>å¯èƒ½é‡åˆ° æ— æ³•push imageåˆ°ç§æœ‰ä»“åº“</strong></p><blockquote><p>ç¼–è¾‘ /etc/default/docker<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DOCKER_OPTS=<span class="string">"--insecure-registry ipåœ°å€:ç«¯å£å·"</span></span><br></pre></td></tr></table></figure></p></blockquote><blockquote><p>service docker restart</p></blockquote><h2 id="é…ç½®å¤šå°å®¹å™¨"><a href="#é…ç½®å¤šå°å®¹å™¨" class="headerlink" title="é…ç½®å¤šå°å®¹å™¨"></a>é…ç½®å¤šå°å®¹å™¨</h2><ul><li><code>docker-compose.yml</code></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">mysql:</span><br><span class="line">   image: mysql:<span class="number">5.5</span></span><br><span class="line">   ports:</span><br><span class="line">     - <span class="string">"3306:3306"</span></span><br><span class="line">   volumes:</span><br><span class="line">     - <span class="regexp">/var/</span>lib/docker/vfs/dir/dataxc:<span class="regexp">/var/</span>lib/mysql</span><br><span class="line">   hostname: mydb.server.com</span><br><span class="line"></span><br><span class="line">tomcat:</span><br><span class="line">   image: tomcat:<span class="number">7.0</span><span class="number">.55</span></span><br><span class="line">   ports:</span><br><span class="line">      - <span class="string">"8080:8080"</span></span><br><span class="line">   links:</span><br><span class="line">      - mysql:db</span><br><span class="line">   environment:</span><br><span class="line">      - TOMCAT_USER=admin</span><br><span class="line">      - TOMCAT_PASS=admin</span><br><span class="line">   hostname: tomcat.server.com</span><br></pre></td></tr></table></figure><ul><li><p>å¯åŠ¨å¤šä¸ªå®¹å™¨<br><code>docker-compose up -d</code></p></li><li><p>åœæ­¢å¤šä¸ªå®¹å™¨<br><code>docker-compose stop</code></p></li><li><p>æŸ¥çœ‹å®¹å™¨<br><code>docker-compose ps</code></p></li><li><p>åˆ é™¤å¤šä¸ªå®¹å™¨<br><code>docker-compose rm</code></p></li></ul><h2 id="Jenkins"><a href="#Jenkins" class="headerlink" title="Jenkins"></a>Jenkins</h2><p><code>docker create</code> åªåˆ›å»ºå®¹å™¨ï¼Œä¸å¯åŠ¨</p><blockquote><p>å®‰è£…<a href="http://pkg.jenkins-ci.org/debian/" target="_blank" rel="noopener">http://pkg.jenkins-ci.org/debian/</a></p></blockquote><blockquote><p>å¯åŠ¨</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p <span class="number">8080</span>:<span class="number">8080</span> --name jenkins -v /usr/bin/docker:<span class="regexp">/usr/</span>bin/docker -v /<span class="keyword">var</span>/run/docker.sock:<span class="regexp">/var/</span>run/docker.sock jenkins</span><br></pre></td></tr></table></figure><p><strong>é‡åˆ°<code>dial unix /var/run/docker.sock: permission denied.</code>è§£å†³åŠæ³•:</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo service docker stop</span><br><span class="line">sudo rm -rf /<span class="keyword">var</span>/run/docker.sock/</span><br><span class="line">(docker.sock had somehow been created <span class="keyword">as</span> a directory - not sure how)</span><br><span class="line">sudo service docker start</span><br><span class="line">sudo chmod <span class="number">777</span> /<span class="keyword">var</span>/run/docker.sock</span><br><span class="line"></span><br><span class="line">ç„¶åå†å¯åŠ¨</span><br></pre></td></tr></table></figure></p><h3 id="é»˜è®¤jenkinsä¸å®‰è£…git"><a href="#é»˜è®¤jenkinsä¸å®‰è£…git" class="headerlink" title="é»˜è®¤jenkinsä¸å®‰è£…git"></a>é»˜è®¤jenkinsä¸å®‰è£…git</h3><h4 id="ç›´æ¥å®‰è£…"><a href="#ç›´æ¥å®‰è£…" class="headerlink" title="ç›´æ¥å®‰è£…"></a>ç›´æ¥å®‰è£…</h4><blockquote><p>ç³»ç»Ÿç®¡ç†â€-&gt;â€ç®¡ç†æ’ä»¶â€ä¸­æ‰¾åˆ°â€å¯é€‰æ’ä»¶â€é€‰é¡¹å¡,å·¦ä¸Šè§’çš„è¿‡æ»¤æœç´¢çª—å£ä¸­å¯ä»¥ç”¨è¾“å…¥Gitæ¥æŸ¥æ‰¾ã€‚<br>é€‰æ‹©git pluginï¼Œjenkinsä¼šè‡ªåŠ¨ä¸ºæˆ‘ä»¬æ·»åŠ å…¶ä¾èµ–çš„æ’ä»¶</p></blockquote><h4 id="æ‰‹åŠ¨å®‰è£…"><a href="#æ‰‹åŠ¨å®‰è£…" class="headerlink" title="æ‰‹åŠ¨å®‰è£…"></a>æ‰‹åŠ¨å®‰è£…</h4><blockquote><p>ç³»ç»Ÿç®¡ç†â€-&gt;â€ç®¡ç†æ’ä»¶â€ä¸­æ‰¾åˆ°â€é«˜çº§â€, ç„¶åå» <a href="http://updates.jenkins-ci.org/download/plugins" target="_blank" rel="noopener">http://updates.jenkins-ci.org/download/plugins</a> ä¸‹è½½ <code>credentials.hpi</code> <code>git-client.hpi</code> <code>scm-api.hpi</code> <code>git.hpi</code>, å¹¶ä¾æ¬¡å®‰è£…,æœ€åè®°å¾—é‡å¯jenkins</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">REGISTRY_URL=<span class="number">10.221</span><span class="number">.238</span><span class="number">.100</span>:<span class="number">5000</span></span><br><span class="line">cp /root/apache-maven<span class="number">-3.3</span><span class="number">.3</span>-bin.tar.gz $WORKSPACE/maven</span><br><span class="line">docker build -t csphere/maven:<span class="number">3.3</span><span class="number">.3</span> $WORKSPACE/maven</span><br><span class="line"><span class="keyword">if</span> docker ps -a | grep -i maven ; then</span><br><span class="line">   docker rm -f maven</span><br><span class="line">fi</span><br><span class="line">docker create --name maven csphere/maven3<span class="number">.3</span><span class="number">.3</span></span><br><span class="line">docker cp maven:<span class="regexp">/hello/</span>target/hello.war $WORKSPACE/hello</span><br><span class="line">docker build -t $REGSITRY_URL/csphere/hello:<span class="number">1.0</span> $WORKSPACE/hello</span><br><span class="line">docker push $REGSITRY_URL/csphere/hello:<span class="number">1.0</span></span><br><span class="line"><span class="keyword">if</span> docker ps -a | gerp -i hello; then</span><br><span class="line">   docker rm -f hello</span><br><span class="line">fi</span><br><span class="line">docker run -d -p <span class="number">80</span>:<span class="number">8080</span> --name hello $REGSITRY_URL/csphere/hello:<span class="number">1.0</span></span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><ul><li><a href="http://stackoverflow.com/questions/26710153/remote-access-to-a-private-docker-registry" target="_blank" rel="noopener">http://stackoverflow.com/questions/26710153/remote-access-to-a-private-docker-registry</a></li><li><a href="https://discuss.csphere.cn/" target="_blank" rel="noopener">https://discuss.csphere.cn/</a></li><li><a href="http://blog.csdn.net/disappearedgod/article/details/43406019" target="_blank" rel="noopener">http://blog.csdn.net/disappearedgod/article/details/43406019</a></li><li><a href="http://updates.jenkins-ci.org/download/plugins" target="_blank" rel="noopener">gitæ’ä»¶ä¸‹è½½åœ°å€</a></li><li><a href="http://blog.csdn.net/csfreebird/article/details/7899629" target="_blank" rel="noopener">http://blog.csdn.net/csfreebird/article/details/7899629</a></li><li><a href="https://github.com/gliderlabs/registrator/issues/35#issuecomment-101493655" target="_blank" rel="noopener">dial unix /var/run/docker.sock: permission deniedè§£å†³åŠæ³•</a></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AngularJS $httpè¸©å‘(2)</title>
      <link href="/2015/06/17/AngularJS%E8%B8%A9%E5%9D%91-2/"/>
      <url>/2015/06/17/AngularJS%E8%B8%A9%E5%9D%91-2/</url>
      
        <content type="html"><![CDATA[<p>AngularJSä½¿ç”¨$httpå‡ºç°optionsè¯·æ±‚<br><a id="more"></a></p><h1 id="AngularJSä¸­çš„-httpè‡ªå®šä¹‰headersä¹‹åçš„é…ç½®"><a href="#AngularJSä¸­çš„-httpè‡ªå®šä¹‰headersä¹‹åçš„é…ç½®" class="headerlink" title="AngularJSä¸­çš„$httpè‡ªå®šä¹‰headersä¹‹åçš„é…ç½®"></a>AngularJSä¸­çš„$httpè‡ªå®šä¹‰headersä¹‹åçš„é…ç½®</h1><h2 id="å®¢æˆ·ç«¯éœ€è¦è®¾ç½®-withCredentials"><a href="#å®¢æˆ·ç«¯éœ€è¦è®¾ç½®-withCredentials" class="headerlink" title="å®¢æˆ·ç«¯éœ€è¦è®¾ç½® withCredentials"></a>å®¢æˆ·ç«¯éœ€è¦è®¾ç½® <code>withCredentials</code></h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$http(&#123;</span><br><span class="line">    url: SERVERURL + <span class="string">'/'</span>,</span><br><span class="line">    method: <span class="string">'GET'</span>,</span><br><span class="line">    <span class="comment">// æ­¤å¤„æ˜¯è‡ªå®šä¹‰çš„å¤´</span></span><br><span class="line">    headers: &#123;</span><br><span class="line">        <span class="string">'x-access-token'</span>: localStorage.getItem(<span class="string">'token'</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// éœ€è¦è®¾ç½® withCredentials: true</span></span><br><span class="line">    withCredentials: <span class="literal">true</span></span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure><h2 id="æœåŠ¡å™¨é…ç½®-expressä¸ºä¾‹"><a href="#æœåŠ¡å™¨é…ç½®-expressä¸ºä¾‹" class="headerlink" title="æœåŠ¡å™¨é…ç½®(expressä¸ºä¾‹)"></a>æœåŠ¡å™¨é…ç½®(expressä¸ºä¾‹)</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">router</span><br><span class="line">    <span class="comment">// angularä¸ºé¦–å…ˆå‘é€ç”¨OPTIONSæ–¹æ³•(åšæ˜¯çš„æ˜¯é¢„æ£€æŸ¥ï¼Œä»æœåŠ¡å™¨ç¡®è®¤æ˜¯å¦å¯ä»¥ç»§ç»­)</span></span><br><span class="line">    .options(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">           <span class="comment">// è®¾ç½® Credentials ä¸ºå…è®¸</span></span><br><span class="line">            res.setHeader(<span class="string">'Access-Control-Allow-Credentials'</span>, <span class="literal">true</span>);</span><br><span class="line">            <span class="comment">// è®¾ç½® Methods</span></span><br><span class="line">            res.setHeader(<span class="string">'Access-Control-Allow-Methods'</span>, <span class="string">'POST, GET, PUT, DELETE, OPTIONS'</span>);</span><br><span class="line">            <span class="comment">// æ·»åŠ å…è®¸çš„è¯·æ±‚å¤´ç±»å‹!!</span></span><br><span class="line">            res.setHeader(<span class="string">"Access-Control-Allow-Headers"</span>, <span class="string">'x-access-token, Content-Type'</span>); </span><br><span class="line">            res.send(<span class="number">200</span>);</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="comment">// ä½¿ä¸‹é¢çš„getè¯·æ±‚å¯ä»¥è¿”å›(é…ç½®å’Œä¸Šé¢ä¸€æ ·)</span></span><br><span class="line">    .use(<span class="function"><span class="keyword">function</span>(<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">        res.setHeader(<span class="string">'Access-Control-Allow-Credentials'</span>, <span class="literal">true</span>);</span><br><span class="line">        res.setHeader(<span class="string">'Access-Control-Allow-Methods'</span>, <span class="string">'POST, GET, PUT, DELETE, OPTIONS'</span>);</span><br><span class="line">        res.setHeader(<span class="string">"Access-Control-Allow-Headers"</span>, <span class="string">'x-access-token'</span>); </span><br><span class="line">        next();</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// çœŸæ­£çš„è¯·æ±‚  </span></span><br><span class="line">    .get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// doSomething</span></span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="/img/angularjs/http1.png" alt="optionsè¯·æ±‚" title="" class="">                <p>optionsè¯·æ±‚</p>            </figure><figure class="image-box">                <img src="/img/angularjs/http2.png" alt="getè¯·æ±‚" title="" class="">                <p>getè¯·æ±‚</p>            </figure><h1 id="è·¨åŸŸé…ç½®"><a href="#è·¨åŸŸé…ç½®" class="headerlink" title="è·¨åŸŸé…ç½®"></a>è·¨åŸŸé…ç½®</h1><h2 id="å®¢æˆ·ç«¯ä¸å˜"><a href="#å®¢æˆ·ç«¯ä¸å˜" class="headerlink" title="å®¢æˆ·ç«¯ä¸å˜"></a>å®¢æˆ·ç«¯ä¸å˜</h2><h2 id="æœåŠ¡å™¨ç«¯"><a href="#æœåŠ¡å™¨ç«¯" class="headerlink" title="æœåŠ¡å™¨ç«¯"></a>æœåŠ¡å™¨ç«¯</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">.options(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// æ·»åŠ   Access-Control-Allow-Origin, å…¶å®ƒä¸å˜</span></span><br><span class="line">        <span class="comment">// æ³¨æ„è¿™é‡Œä¸èƒ½ä½¿ç”¨ *</span></span><br><span class="line">        res.setHeader(<span class="string">'Access-Control-Allow-Origin'</span>, req.headers.origin);</span><br><span class="line">        res.setHeader(<span class="string">'Access-Control-Allow-Credentials'</span>, <span class="literal">true</span>);</span><br><span class="line">        res.setHeader(<span class="string">'Access-Control-Allow-Methods'</span>, <span class="string">'POST, GET, PUT, DELETE, OPTIONS'</span>);</span><br><span class="line">        res.setHeader(<span class="string">"Access-Control-Allow-Headers"</span>, <span class="string">'x-access-token, Content-Type'</span>); </span><br><span class="line">        res.send(<span class="number">200</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">    .use(<span class="function"><span class="keyword">function</span>(<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">        res.setHeader(<span class="string">'Access-Control-Allow-Origin'</span>, req.headers.origin);</span><br><span class="line">        res.setHeader(<span class="string">'Access-Control-Allow-Credentials'</span>, <span class="literal">true</span>);</span><br><span class="line">        res.setHeader(<span class="string">'Access-Control-Allow-Methods'</span>, <span class="string">'POST, GET, PUT, DELETE, OPTIONS'</span>);</span><br><span class="line">        res.setHeader(<span class="string">"Access-Control-Allow-Headers"</span>, <span class="string">'x-access-token'</span>);</span><br><span class="line">        next();</span><br><span class="line">   &#125;)</span><br><span class="line">   .get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// doSomething</span></span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure><p><strong>è¯·æ±‚çš„æ—¶å€™ä¸èƒ½ä½¿ç”¨localhost,è¯·ä¸Šä¼ æœåŠ¡å™¨åœ¨å°è¯•è·¨åŸŸ</strong></p><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><ul><li><a href="http://camnpr.com/server/2007.html" target="_blank" rel="noopener">http://camnpr.com/server/2007.html</a></li><li><a href="http://blog.csdn.net/ligang2585116/article/details/44806853" target="_blank" rel="noopener">http://blog.csdn.net/ligang2585116/article/details/44806853</a></li></ul><hr><blockquote><h3 id="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢"><a href="#æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢" class="headerlink" title="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~"></a>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</h3><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> AngularJS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AngularJS $httpè¸©å‘(1)</title>
      <link href="/2015/06/16/AngularJS%E8%B8%A9%E5%9D%91-1/"/>
      <url>/2015/06/16/AngularJS%E8%B8%A9%E5%9D%91-1/</url>
      
        <content type="html"><![CDATA[<p>AngularJSä½¿ç”¨$http.postä¹‹ååå°æ— æ³•æ”¶åˆ°æ•°æ®<br><a id="more"></a></p><p><strong>AngularJSä¸­çš„postä¸jQueryä¸­postçš„åŒºåˆ«</strong></p><h1 id="å¯¹æ¯”"><a href="#å¯¹æ¯”" class="headerlink" title="å¯¹æ¯”:"></a>å¯¹æ¯”:</h1><blockquote><p>AngularJSï¼š</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$http.post(<span class="string">'/myserver'</span>, &#123;<span class="attr">username</span>: <span class="string">'shang'</span>&#125;)</span><br><span class="line">.success(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">// some code</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><blockquote><p>jQuery</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$.post(<span class="string">'/myserver'</span>, &#123;<span class="attr">username</span>: <span class="string">'shang'</span>&#125;, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// some code</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><blockquote><p>åå°Expressæ¥å—</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">req.body.username <span class="comment">// jq: 'shang'; ng: undefined</span></span><br></pre></td></tr></table></figure><p><strong>jqä¼šæŠŠä½œä¸ºJSONå¯¹è±¡çš„åºåˆ—åŒ–, è€ŒAngularä¸ä¼š</strong></p><h1 id="è§£å†³åŠæ³•"><a href="#è§£å†³åŠæ³•" class="headerlink" title="è§£å†³åŠæ³•:"></a>è§£å†³åŠæ³•:</h1><ul><li>å¼•å…¥jquery (ä¸æ¨è)</li><li><p>æŒ‡å®šheader</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myobject = &#123;<span class="attr">username</span>: <span class="string">'shang'</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ObjecttoParams</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> p = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> obj) &#123;</span><br><span class="line">        p.push(key + <span class="string">'='</span> + <span class="built_in">encodeURIComponent</span>(obj[key]));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p.join(<span class="string">'&amp;'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$http(&#123;</span><br><span class="line">    method: <span class="string">'POST'</span>,</span><br><span class="line">    url: url,</span><br><span class="line">    data: ObjecttoParams(myobject),</span><br><span class="line">    headers: &#123;<span class="string">'Content-Type'</span>:<span class="string">'application/x-www-form-urlencoded'</span>&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li><li><p>ä½¿ç”¨ <code>angular-post-fix</code></p></li></ul><blockquote><p><a href="https://gist.github.com/JensRantil/5713606" target="_blank" rel="noopener">https://gist.github.com/JensRantil/5713606</a></p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Modifies $httpProvider for correct server communication (POST variable format)</span></span><br><span class="line">angular.module(<span class="string">'http-post-fix'</span>, [], <span class="function"><span class="keyword">function</span>(<span class="params">$httpProvider</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// This code is taken from http://victorblog.com/2012/12/20/make-angularjs-http-service-behave-like-jquery-ajax/</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Use x-www-form-urlencoded Content-Type</span></span><br><span class="line">  $httpProvider.defaults.headers.post[<span class="string">'Content-Type'</span>] = <span class="string">'application/x-www-form-urlencoded;charset=utf-8'</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Override $http service's default transformRequest</span></span><br><span class="line">  $httpProvider.defaults.transformRequest = [<span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The workhorse; converts an object to x-www-form-urlencoded serialization.</span></span><br><span class="line"><span class="comment">     * @param &#123;Object&#125; obj</span></span><br><span class="line"><span class="comment">     * @return &#123;String&#125;</span></span><br><span class="line"><span class="comment">     */</span> </span><br><span class="line">    <span class="keyword">var</span> param = <span class="function"><span class="keyword">function</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> query = <span class="string">''</span>;</span><br><span class="line">      <span class="keyword">var</span> name, value, fullSubName, subValue, innerObj, i;</span><br><span class="line">      </span><br><span class="line">      <span class="keyword">for</span>(name <span class="keyword">in</span> obj) &#123;</span><br><span class="line">        value = obj[name];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(value <span class="keyword">instanceof</span> <span class="built_in">Array</span>) &#123;</span><br><span class="line">          <span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;value.length; ++i) &#123;</span><br><span class="line">            subValue = value[i];</span><br><span class="line">            fullSubName = name + <span class="string">'['</span> + i + <span class="string">']'</span>;</span><br><span class="line">            innerObj = &#123;&#125;;</span><br><span class="line">            innerObj[fullSubName] = subValue;</span><br><span class="line">            query += param(innerObj) + <span class="string">'&amp;'</span>;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(value <span class="keyword">instanceof</span> <span class="built_in">Object</span>) &#123;</span><br><span class="line">          <span class="keyword">for</span>(subName <span class="keyword">in</span> value) &#123;</span><br><span class="line">            subValue = value[subName];</span><br><span class="line">            fullSubName = name + <span class="string">'['</span> + subName + <span class="string">']'</span>;</span><br><span class="line">            innerObj = &#123;&#125;;</span><br><span class="line">            innerObj[fullSubName] = subValue;</span><br><span class="line">            query += param(innerObj) + <span class="string">'&amp;'</span>;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(value !== <span class="literal">undefined</span> &amp;&amp; value !== <span class="literal">null</span>) &#123;</span><br><span class="line">          query += <span class="built_in">encodeURIComponent</span>(name) + <span class="string">'='</span> + <span class="built_in">encodeURIComponent</span>(value) + <span class="string">'&amp;'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">      <span class="keyword">return</span> query.length ? query.substr(<span class="number">0</span>, query.length - <span class="number">1</span>) : query;</span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> angular.isObject(data) &amp;&amp; <span class="built_in">String</span>(data) !== <span class="string">'[object File]'</span> ? param(data) : data;</span><br><span class="line">  &#125;];</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><ul><li><a href="http://stackoverflow.com/questions/19254029/angularjs-http-post-does-not-send-data" target="_blank" rel="noopener">http://stackoverflow.com/questions/19254029/angularjs-http-post-does-not-send-data</a></li><li><a href="http://my.oschina.net/tommyfok/blog/287748" target="_blank" rel="noopener">http://my.oschina.net/tommyfok/blog/287748</a></li></ul><hr><blockquote><h3 id="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢"><a href="#æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢" class="headerlink" title="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~"></a>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</h3><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> AngularJS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åœ¨dockerä¸­ä½¿ç”¨pm2æˆ–forever</title>
      <link href="/2015/06/13/%E5%9C%A8docker%E4%B8%AD%E4%BD%BF%E7%94%A8pm2%E6%88%96forever/"/>
      <url>/2015/06/13/%E5%9C%A8docker%E4%B8%AD%E4%BD%BF%E7%94%A8pm2%E6%88%96forever/</url>
      
        <content type="html"><![CDATA[<p>å¹³å¸¸ä½¿ç”¨pm2æ²¡æœ‰é—®é¢˜,ä½†æ˜¯åœ¨dockerä¸­éœ€è¦å‚æ•°â€“no-daemon<br><a id="more"></a></p><blockquote><p>ä½¿ç”¨å‘½ä»¤ <code>pm2 start app.js</code> ä¹‹å, <code>pm2</code> é»˜è®¤åœ¨åå°è¿è¡Œ,<br>å¦‚æœä½¿ç”¨äº†dockerå,å®¹å™¨è¿è¡Œå¹¶ç«‹å³é€€å‡º,éœ€è¦æ‰‹åŠ¨æŒ‡å®šå‚æ•°<code>--no-daemon</code></p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">--no-daemon                          </span><br><span class="line"><span class="comment">// run pm2 daemon in the foreground if it doesn't exist already</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pm2 start app.js --no-daemon <span class="comment">// è®¾ç½®å¯åŠ¨æ–¹å¼</span></span><br></pre></td></tr></table></figure><blockquote><p>åŒç†foreverä¹Ÿæ˜¯<br>Forever start script.js runs in the background. To run forever in the foreground, try forever script.js.</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">forever -c <span class="string">'node --harmony'</span> app.js <span class="comment">// è®¾ç½®å¯åŠ¨æ–¹å¼</span></span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><ul><li><a href="https://github.com/Unitech/PM2/blob/master/ADVANCED_README.md" target="_blank" rel="noopener">https://github.com/Unitech/PM2/blob/master/ADVANCED_README.md</a></li><li><a href="http://stackoverflow.com/questions/26237044/error-starting-node-with-forever-in-docker-container" target="_blank" rel="noopener">http://stackoverflow.com/questions/26237044/error-starting-node-with-forever-in-docker-container</a></li></ul><hr><blockquote><h3 id="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢"><a href="#æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢" class="headerlink" title="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~"></a>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</h3><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> docker </tag>
            
            <tag> node </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DaoCloudä½“éªŒï¼ä½¿ç”¨nodeæ„å»ºåº”ç”¨ç¨‹åº</title>
      <link href="/2015/06/11/DaoCloud%E4%BD%93%E9%AA%8C%EF%BC%8D%E4%BD%BF%E7%94%A8node%E6%9E%84%E5%BB%BA%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F/"/>
      <url>/2015/06/11/DaoCloud%E4%BD%93%E9%AA%8C%EF%BC%8D%E4%BD%BF%E7%94%A8node%E6%9E%84%E5%BB%BA%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F/</url>
      
        <content type="html"><![CDATA[<p>DaoCloudä½“éªŒï¼ä½¿ç”¨nodeæ„å»ºåº”ç”¨ç¨‹åº<br><a id="more"></a></p><blockquote><p>é¦–å‘äº<a href="http://open.daocloud.io/using-node-to-build-applications/" target="_blank" rel="noopener">http://open.daocloud.io/using-node-to-build-applications/</a></p></blockquote><h1 id="DaoCloudä½“éªŒï¼ä½¿ç”¨nodeæ„å»ºåº”ç”¨ç¨‹åº"><a href="#DaoCloudä½“éªŒï¼ä½¿ç”¨nodeæ„å»ºåº”ç”¨ç¨‹åº" class="headerlink" title="DaoCloudä½“éªŒï¼ä½¿ç”¨nodeæ„å»ºåº”ç”¨ç¨‹åº"></a>DaoCloudä½“éªŒï¼ä½¿ç”¨nodeæ„å»ºåº”ç”¨ç¨‹åº</h1><h2 id="nodeåº”ç”¨ç¨‹åºdemo"><a href="#nodeåº”ç”¨ç¨‹åºdemo" class="headerlink" title="nodeåº”ç”¨ç¨‹åºdemo"></a>nodeåº”ç”¨ç¨‹åºdemo</h2><ul><li>é¦–å…ˆ é€‰æ‹©ä¸€ä¸ªå¹³å° <code>clone</code> ä»£ç åˆ°ä½ çš„gitå¹³å°ä¸Š <a href="https://coding.net/u/xinshangshangxin/p/DaoCloudNodeDemo/git" target="_blank" rel="noopener">coding</a> / <a href="https://github.com/xinshangshangxin/DaoCloudNodeDemo" target="_blank" rel="noopener">github</a> / <a href="https://gitcafe.com/xinshangshangxin/DaoCloudNodeDemo" target="_blank" rel="noopener">gitcafe</a> </li><li>åœ¨æ§åˆ¶å°ç‚¹å‡» <code>æœåŠ¡é›†æˆ</code><br><figure class="image-box">                <img src="https://gitcafe.com/xinshangshangxin/hexo-blog/raw/gitcafe-pages/img/daocloud/demo4.png" alt="" title="" class="">                <p></p>            </figure>;</li><li>åˆ›å»º <code>mysqlæœåŠ¡</code>å’Œ <code>mongodbæœåŠ¡</code>, åå­—å¯ä»¥éšæ„</li><li>å›åˆ°æ§åˆ¶å°,ç‚¹å‡» <code>ä»£ç æ„å»º</code>, <code>åˆ›å»ºæ–°é¡¹ç›®</code>, ä»£ç æºé€‰æ‹©ä½ åˆšæ‰ clone çš„<br><figure class="image-box">                <img src="https://gitcafe.com/xinshangshangxin/hexo-blog/raw/gitcafe-pages/img/daocloud/demo1.png" alt="" title="" class="">                <p></p>            </figure>;</li><li>å‹¾é€‰ <code>æŒç»­é›†æˆ</code> åç‚¹å‡» <code>å¼€å§‹åˆ›å»º</code></li><li>å½“é•œåƒæ„å»ºå®Œæˆå, ç‚¹å‡» <code>éƒ¨ç½²æœ€æ–°ç‰ˆæœ¬</code>, æ¥ç€ç‚¹å‡» <code>åŸºç¡€è®¾ç½®</code>, ç»‘å®š mysql å’Œ mongodb<br><figure class="image-box">                <img src="https://gitcafe.com/xinshangshangxin/hexo-blog/raw/gitcafe-pages/img/daocloud/demo2.png" alt="" title="" class="">                <p></p>            </figure>;<br><figure class="image-box">                <img src="https://gitcafe.com/xinshangshangxin/hexo-blog/raw/gitcafe-pages/img/daocloud/demo3.png" alt="" title="" class="">                <p></p>            </figure>;</li><li>å®¹å™¨å¯åŠ¨å,è®¿é—®ä¸‹URLçœ‹çœ‹,æ˜¯ä¸æ˜¯è¾“å‡ºäº†<code>mysqlé“¾æ¥æˆåŠŸ~~~    å¹¶ä»mongodbä¸­å–å‡ºäº† xinshangshangxin</code></li><li>æŒç»­é›†æˆ éœ€è¦ <code>push</code> ä¸€æ¬¡ä»£ç åˆ°ä½ çš„git,ç„¶åå›åˆ°<code>ä»£ç æ„å»º</code>, é€‰æ‹©<code>daocloud_node_demo</code>, æŸ¥çœ‹å¦‚å›¾æ‰€ç¤º<br><figure class="image-box">                <img src="https://gitcafe.com/xinshangshangxin/hexo-blog/raw/gitcafe-pages/img/daocloud/demo5.png" alt="" title="" class="">                <p></p>            </figure>;</li></ul><h3 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹:"></a>æ³¨æ„äº‹é¡¹:</h3><blockquote><p>æ„å»ºé•œåƒå¿…é¡»æä¾›Dockerfile<br>æŒç»­é›†æˆå¿…é¡»æä¾›daocloud.yml<br>æ„å»ºé•œåƒå’ŒæŒç»­é›†æˆè¿™ä¸¤é¡¹æœåŠ¡å®Œå…¨æ˜¯ç‹¬ç«‹çš„, ä¸¤è€…ä¹‹é—´æ²¡æœ‰ä»»ä½•ä¾èµ–<br> <code>push</code> ä¸€æ¬¡ä»£ç åˆ°ä½ çš„gitæ‰ä¼šè§¦å‘æŒç»­é›†æˆ</p></blockquote><h2 id="å¦‚ä½•åœ¨appä»£ç ä¸­è¿æ¥mysql-mongodbå®ä¾‹"><a href="#å¦‚ä½•åœ¨appä»£ç ä¸­è¿æ¥mysql-mongodbå®ä¾‹" class="headerlink" title="å¦‚ä½•åœ¨appä»£ç ä¸­è¿æ¥mysql/mongodbå®ä¾‹"></a>å¦‚ä½•åœ¨appä»£ç ä¸­è¿æ¥mysql/mongodbå®ä¾‹</h2><h3 id="å®¹å™¨å¯åŠ¨æ—¶èƒ½è®¿é—®mysql-mongodbçš„æ³¨æ„äº‹é¡¹"><a href="#å®¹å™¨å¯åŠ¨æ—¶èƒ½è®¿é—®mysql-mongodbçš„æ³¨æ„äº‹é¡¹" class="headerlink" title="å®¹å™¨å¯åŠ¨æ—¶èƒ½è®¿é—®mysql/mongodbçš„æ³¨æ„äº‹é¡¹"></a>å®¹å™¨å¯åŠ¨æ—¶èƒ½è®¿é—®mysql/mongodbçš„æ³¨æ„äº‹é¡¹</h3><ul><li><p>å®¹å™¨<strong>å¯åŠ¨ä¹‹å‰</strong>éœ€è¦å…ˆç»‘å®š <code>mysqlæœåŠ¡</code>å’Œ <code>mongodbæœåŠ¡</code></p><blockquote><p>åœ¨æ§åˆ¶å°ç‚¹å‡» <code>æœåŠ¡é›†æˆ</code>; æ¥ç€åˆ›å»º <code>mysqlæœåŠ¡</code>å’Œ <code>mongodbæœåŠ¡</code>, åå­—å¯ä»¥éšæ„<br><figure class="image-box">                <img src="https://gitcafe.com/xinshangshangxin/hexo-blog/raw/gitcafe-pages/img/daocloud/demo4.png" alt="" title="" class="">                <p></p>            </figure>;</p></blockquote></li><li><p>mongodbä½¿ç”¨çš„æ˜¯mongooseè¿æ¥,æ ¼å¼ä¸º:<br><code>mongodb://user:password@addr:port/database</code><br>åœ¨nodeä¸­,ç¯å¢ƒå˜é‡å­˜å‚¨åœ¨ <code>process.env</code>ä¸­,æ‰€ä»¥:<br><code>user</code> =&gt; <code>process.env.MONGODB_USERNAME</code><br><code>password</code> =&gt; <code>process.env.MONGODB_PASSWORD</code><br><code>addr</code> =&gt; <code>process.env.MONGODB_PORT_27017_TCP_ADDR</code><br><code>port</code> =&gt; <code>process.env.MONGODB_PORT_27017_TCP_PORT</code><br><code>database</code> =&gt; <code>process.env.MONGODB_INSTANCE_NAME</code></p></li><li><p>mysqlä½¿ç”¨çš„æ˜¯<code>node-mysql</code>,æ‰€ä»¥å’Œä¸Šé¢ç›¸ä¼¼<br><code>user</code> =&gt; <code>process.env.MYSQL_USERNAME</code><br><code>password</code> =&gt; <code>process.env.MYSQL_PASSWORD</code><br><code>database</code> =&gt; <code>process.env.MYSQL_INSTANCE_NAME</code><br><code>host</code> =&gt; <code>process.env.MYSQL_PORT_3306_TCP_ADDR</code><br><code>port</code> =&gt; <code>process.env.MYSQL_PORT_3306_TCP_PORT</code></p></li></ul><h3 id="æŒç»­é›†æˆä¸­ä½¿ç”¨mysqlï¼ŒmongodbæœåŠ¡æ³¨æ„äº‹é¡¹"><a href="#æŒç»­é›†æˆä¸­ä½¿ç”¨mysqlï¼ŒmongodbæœåŠ¡æ³¨æ„äº‹é¡¹" class="headerlink" title="æŒç»­é›†æˆä¸­ä½¿ç”¨mysqlï¼ŒmongodbæœåŠ¡æ³¨æ„äº‹é¡¹"></a>æŒç»­é›†æˆä¸­ä½¿ç”¨mysqlï¼ŒmongodbæœåŠ¡æ³¨æ„äº‹é¡¹</h3><ul><li><p>æŒç»­é›†æˆ<strong>ä¸éœ€è¦</strong>ç»‘å®šä»»ä½•æœåŠ¡;<strong>daocloud ciåœ¨è¿è¡Œæµ‹è¯•çš„æ—¶å€™ä¼šè‡ªåŠ¨åˆ›å»º</strong>, å…¶ä½¿ç”¨çš„æœåŠ¡æ¥è‡ª<code>daocloud.yml</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">services:</span><br><span class="line">  - mysql</span><br><span class="line">  - mongodb</span><br></pre></td></tr></table></figure></li><li><p>åœ¨æŒç»­é›†æˆä¸­ <code>MONGODB_USERNAME</code> <code>MONGODB_PASSWORD</code>  <code>MYSQL_USERNAME</code> <code>MYSQL_PASSWORD</code> <code>MYSQL_INSTANCE_NAME</code> ä»¥åŠ<code>MONGODB_INSTANCE_NAME</code>æ˜¯ä¸å­˜åœ¨çš„, æ‰€ä»¥ä¸ºäº†å…¼å®¹ å®¹å™¨å’ŒæŒç»­é›†æˆ,ä»£ç ä¸­çš„è¿æ¥éœ€è¦è¿›è¡Œåˆ¤æ–­,ä¿®æ”¹å¦‚ä¸‹:</p></li></ul><blockquote><p>Mongodb</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> mongoose = <span class="built_in">require</span>(<span class="string">'mongoose'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// é“¾æ¥æ ¼å¼:    mongodb://user:pass@localhost:port/database</span></span><br><span class="line"><span class="keyword">var</span> mongodbUri = <span class="string">'mongodb://'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŒç»­é›†æˆæ—¶, MONGODB_USERNAME å’Œ MONGODB_PASSWORD ä¸å­˜åœ¨</span></span><br><span class="line"><span class="comment">// éœ€è¦è¿›è¡Œåˆ¤æ–­</span></span><br><span class="line"><span class="keyword">if</span> (process.env.MONGODB_USERNAME) &#123;</span><br><span class="line">    <span class="comment">// åœ¨å®¹å™¨ä¸­åˆ™å­˜åœ¨,åœ¨æŒç»­é›†æˆä¸­åˆ™ä¸å­˜åœ¨</span></span><br><span class="line">    mongodbUri += process.env.MONGODB_USERNAME;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (process.env.MONGODB_PASSWORD) &#123;</span><br><span class="line">        mongodbUri += <span class="string">":"</span> + process.env.MONGODB_PASSWORD</span><br><span class="line">    &#125;</span><br><span class="line">    mongodbUri += <span class="string">"@"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mongodbUri += (process.env.MONGODB_PORT_27017_TCP_ADDR || <span class="string">'localhost'</span>)</span><br><span class="line">    + <span class="string">":"</span> + (process.env.MONGODB_PORT_27017_TCP_PORT || <span class="number">27017</span>)</span><br><span class="line">    + <span class="string">'/'</span> + (process.env.MONGODB_INSTANCE_NAME || <span class="string">'test'</span>);<span class="comment">// æŒç»­é›†æˆä¸­MONGODB_INSTANCE_NAME ä¹Ÿä¸å­˜åœ¨, ä½¿ç”¨ test ä»£æ›¿</span></span><br></pre></td></tr></table></figure><blockquote><p>Mysql</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// node_modules</span></span><br><span class="line"><span class="keyword">var</span> mysql = <span class="built_in">require</span>(<span class="string">'mysql'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŒç»­é›†æˆä¸­MYSQL_USERNAMEé»˜è®¤ä¸ºroot,å¹¶ä¸”æ²¡æœ‰MYSQL_PASSWORD</span></span><br><span class="line"><span class="comment">// MYSQL_INSTANCE_NAMEé»˜è®¤ä¸ºtest</span></span><br><span class="line"><span class="keyword">var</span> connection = mysql.createConnection(&#123;</span><br><span class="line">    user:  process.env.MYSQL_USERNAME || <span class="string">'root'</span>,</span><br><span class="line">    password:  process.env.MYSQL_PASSWORD || <span class="string">''</span>,</span><br><span class="line">    database: process.env.MYSQL_INSTANCE_NAME || <span class="string">'test'</span>,</span><br><span class="line">    host: process.env.MYSQL_PORT_3306_TCP_ADDR || <span class="string">'localhost'</span>,</span><br><span class="line">    port: process.env.MYSQL_PORT_3306_TCP_PORT || <span class="string">'3306'</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºè¿æ¥</span></span><br><span class="line">connection.connect(<span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">        <span class="built_in">console</span>.error(<span class="string">'error connecting: '</span> + err.stack);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'connected as id '</span> + connection.threadId);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul><li>å®¹å™¨è¿è¡Œæ—¶éœ€è¦ç»‘å®šmysqlï¼ŒmongodbæœåŠ¡</li><li>æŒç»­é›†æˆä¸éœ€è¦ç»‘å®š,ç”± <code>daocloud.yml</code>æŒ‡å®š, daocloud ciåœ¨è¿è¡Œæµ‹è¯•çš„æ—¶å€™ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªmysqlå®ä¾‹</li><li>æŒç»­é›†æˆä¸­çš„mysqlï¼ŒmongodbæœåŠ¡å’Œç”¨æˆ·ç”³è¯·çš„mysqlï¼Œmongodbå®ä¾‹<strong>æ²¡æœ‰ä»»ä½•å…³ç³»</strong></li></ul><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><ul><li><a href="https://github.com/DaoCloud/python-mysql-sample" target="_blank" rel="noopener">https://github.com/DaoCloud/python-mysql-sample</a></li><li><a href="https://github.com/DaoCloud/golang-mongo-sample" target="_blank" rel="noopener">https://github.com/DaoCloud/golang-mongo-sample</a></li></ul><hr><blockquote><h3 id="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢"><a href="#æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢" class="headerlink" title="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~"></a>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</h3><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> docker </tag>
            
            <tag> node </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Dockerå­¦ä¹ ç¬”è®°(1)</title>
      <link href="/2015/06/06/Docker%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-1/"/>
      <url>/2015/06/06/Docker%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-1/</url>
      
        <content type="html"><![CDATA[<p>Dockerå­¦ä¹ ç¬”è®°<br><a id="more"></a></p><p><code>FROM</code> åŸºç¡€é•œåƒ<br><code>MAINTAINER</code> ç»´æŠ¤è€…<br><code>ENV</code> ç¯å¢ƒå˜é‡</p><blockquote><p>docker å¤åˆ¶æ–‡ä»¶ ADD COPY</p></blockquote><p><code>ADD</code> å¯ä»¥è·å–ç½‘ç»œåœ°å€ä»¥åŠè§£å‹åŠŸèƒ½<br><code>COPY</code> æœ¬åœ°æ–‡ä»¶</p><p><code>RUN</code> è¿è¡ŒæŒ‡ä»¤,æ¯è¿è¡Œä¸€æ¡æŒ‡ä»¤å¢åŠ ä¸€å±‚</p><p><code>EXPOSE 22</code>   containeræš´éœ²22ç«¯å£</p><p><code>ENTRYPOINT</code> é•œåƒå¯åŠ¨åè‡ªåŠ¨æ‰§è¡Œçš„å‘½ä»¤</p><p><code>build</code>  ä½¿ç”¨docker fileç”Ÿæˆdockeré•œåƒ<br>// -t èµ·åå­—<br>// dockerfile_pathå¦‚æœä¸ºå½“å‰ç›®å½•ä¸ºåˆ™ ( . )<br><code>docker build -t [registry_url/namespace/csphere/centos:7.1] [dockerfile_path]</code></p><p><code>docker images</code> æŸ¥çœ‹é•œåƒä¿¡æ¯<br><code>docker rmi</code> åˆ é™¤é•œåƒ<br><code>docker images -q</code> æ‰¹é‡åˆ é™¤é•œåƒ<br><code>docker run image_name</code>      ç”¨é•œåƒ è¿è¡Œä¸€ä¸ª container</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">docker run -itï¼šäº¤äº’å¼ </span><br><span class="line">           -dï¼šåç«¯å¯åŠ¨, ç„¶åè¿”å›containerçš„Idå· </span><br><span class="line">           -p <span class="number">2222</span>:<span class="number">22</span> ç«¯å£æ˜ å°„</span><br><span class="line">           -P <span class="number">22</span> éšæœºå–æœªä½¿ç”¨ç«¯å£æ˜ å°„<span class="number">22</span>ç«¯å£</span><br><span class="line">           --name æŒ‡å®šå®¹å™¨åç§°</span><br><span class="line">           -v host_dir:conatiner_dir æ–‡ä»¶æ˜ å°„</span><br><span class="line">           --rm å®¹å™¨é€€å‡ºå°±åˆ é™¤</span><br><span class="line">           -e ä¼ å…¥ç¯å¢ƒå‚æ•°å¯æŒ‡å®šå¤šæ¬¡</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p <span class="number">80</span>:<span class="number">80</span> --name wordpress -e WORDPRESS_DB_HOST=<span class="number">10.51</span><span class="number">.85</span><span class="number">.74</span> -e WORDPRESS_DB_USER=admin</span><br></pre></td></tr></table></figure><p><code>docker ps</code>  æŸ¥çœ‹è¿è¡Œå®¹å™¨<br><code>docker ps -a</code> æŸ¥çœ‹æ‰€æœ‰å®¹å™¨</p><p><code>ONBUILD</code>  åœ¨ä¸‹ä¸€ä¸ªåŸºäºæœ¬é•œåƒæ˜¯æ‰§è¡Œçš„å‘½ä»¤</p><p><code>docker exec -it container_name</code> äº¤äº’å¼æ¨¡å¼è¿›å…¥container<br><code>docker exec -it testNode /bin/bash</code></p><p><code>VOLUME</code> å®¿ä¸»æœºç›®å½•æ˜ å°„containerç›®å½•<br><code>VOLUME [&quot;/var/lib/mysql&quot;]</code></p><p><code>docker rm</code> åˆ é™¤å®¹å™¨<br><code>docker rm -f</code> å¼ºåˆ¶ç§»é™¤å®¹å™¨<br><code>docker ps -a -q</code> æ‰¹é‡åˆ é™¤å®¹å™¨</p><p><code>docker stop container_id</code> åœæ­¢å®¹å™¨</p><p>ä½¿ç”¨åŸæœ‰æ•°æ®åº“ï¼Œé‡æ–°æŒ‚åœ¨åˆ°å®¹å™¨ã€‚æŒ‰ç…§åŸæœ‰å‘½ä»¤å³å¯æŒ‚è½½<br><code>docker run -d -p 3306:3306 --name newdb -v /var/lib/docker/vfs/dir/mydata:/var/lib/mysql mysql:5.5</code></p><p><code>.dockerignore æ–‡ä»¶</code> æ’é™¤æŸäº›æ–‡ä»¶æ‹·è´</p><p><code>ENTRYPOINT [&quot;EXECUTEABLE&quot;, &quot;param1&quot;, &quot;param2&quot;]</code></p><ul><li><code>CMD [&quot;EXECUTEABLE&quot;, &quot;param1&quot;, &quot;param2&quot;]</code></li><li><code>CMD [&quot;param1&quot;, &quot;param2&quot;]</code>  ä¸ºENTRYPOINTæŒ‡å®šå‚æ•°</li><li><code>CMD command param1 param2</code>    ä»¥â€bin/sh -câ€æ–¹æ³•æ‰§è¡Œå‘½ä»¤</li></ul><blockquote><p>CMDæŒ‡ä»¤ å¯è¦†ç›–</p></blockquote><p><code>CMD[&quot;/bin/echo&quot;,&quot;This is test cmd&quot;]</code>           æ‰§è¡Œ/bin/echo<br><code>docker run -it sphere/cmd:0.1 /bin/bash</code>       /bin/bash è¦†ç›– /bin/echo</p><p>ENTRYPOINT è¦†ç›–æŒ‡ä»¤éœ€è¦é€šè¿‡ â€“entrypoint=æ¥æ›¿æ¢ï¼Œæ–¹ä¾¿è°ƒè¯•é”™è¯¯çš„ENTRYPOINTæŒ‡ä»¤</p><hr><blockquote><h3 id="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢"><a href="#æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢" class="headerlink" title="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~"></a>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</h3><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DaoCloudéƒ¨ç½²Node</title>
      <link href="/2015/06/01/DaoCloud%E9%83%A8%E7%BD%B2Node/"/>
      <url>/2015/06/01/DaoCloud%E9%83%A8%E7%BD%B2Node/</url>
      
        <content type="html"><![CDATA[<p>å®˜æ–¹ä¸ºæä¾›nodeçš„example, æŠŠæˆ‘è¸©çš„å‘è®°å½•åˆ†äº«<br><a id="more"></a></p><blockquote><p>DaoCloud æœ‰goå’Œpython çš„ example;<br>å´æ²¡æœ‰Nodeçš„example, æŠŠæˆ‘è¸©çš„å‘è®°å½•åˆ†äº«</p></blockquote><h1 id="æ³¨å†ŒDaoCloud"><a href="#æ³¨å†ŒDaoCloud" class="headerlink" title="æ³¨å†ŒDaoCloud"></a>æ³¨å†ŒDaoCloud</h1><p>æ³¨å†Œåœ°å€: <a href="https://account.daocloud.io/signup" target="_blank" rel="noopener">https://account.daocloud.io/signup</a></p><blockquote><p>æ•´ä¸ªæ„å»ºå’Œéƒ¨ç½²æ‰€éœ€è¦çš„èµ„æºï¼ŒDaoCloudéƒ½å…è´¹æä¾›ï¼Œä¸ºæ‰€æœ‰çš„æ³¨å†Œç”¨æˆ·å…è´¹æä¾›ä»¥ä¸‹èµ„æºï¼š<br>3ä¸ªé¡¹ç›®ï¼ŒåŒæ—¶å¯ä»¥åœ¨DaoCloudå…³è”å’Œæ„å»ºæ‚¨çš„3ä¸ªè½¯ä»¶é¡¹ç›®<br>2ä¸ªå®¹å™¨ï¼Œæ¯ä¸ªå®¹å™¨å†…å­˜ä¸Šé™æ˜¯256Må†…å­˜ç©ºé—´<br>2ä¸ªæœåŠ¡ï¼Œå¯ä»MongoDBã€Redisã€MySQLå’ŒInfluxDBä¸­ä»»æ„é€‰æ‹©</p></blockquote><h1 id="éƒ¨ç½²Node-çš„-Dockerfile-è¯¦è§£"><a href="#éƒ¨ç½²Node-çš„-Dockerfile-è¯¦è§£" class="headerlink" title="éƒ¨ç½²Node çš„ Dockerfile è¯¦è§£"></a>éƒ¨ç½²Node çš„ Dockerfile è¯¦è§£</h1><blockquote><p>æ€»çš„</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">FROM node</span><br><span class="line"></span><br><span class="line"># Build app</span><br><span class="line">RUN mkdir -p /usr/src/app</span><br><span class="line">WORKDIR /usr/src/app</span><br><span class="line">COPY . /usr/src/app</span><br><span class="line"></span><br><span class="line">RUN npm install --production</span><br><span class="line"></span><br><span class="line">EXPOSE <span class="number">1340</span></span><br><span class="line"></span><br><span class="line">CMD [ <span class="string">"node"</span>,<span class="string">"dist/server.js"</span>]</span><br></pre></td></tr></table></figure><p><code>FROM node</code> æ˜¯æŒ‡åŸºäº <a href="https://registry.hub.docker.com/_/node" target="_blank" rel="noopener">nodeæœ€æ–°ç‰ˆ</a> é•œåƒ </p><p><code>RUN mkdir -p /usr/src/app</code> ä¸­ <code>RUN</code> æ˜¯å®‰è£…ç¯å¢ƒ, æ•´å¥è¯æ˜¯æŒ‡åˆ›å»ºäº†ä¸€ä¸ª<code>app</code>æ–‡ä»¶å¤¹ä¾›åç»­ä½¿ç”¨<br><code>WORKDIR /usr/src/app</code>  ä¸­ <code>WORKDIR</code> æ˜¯åˆ‡æ¢ç›®å½•, æ•´å¥è¯æ˜¯æŒ‡åˆ‡æ¢åˆ° <code>/usr/src/app</code> ç›®å½•ä¸‹<br><code>COPY . /usr/src/app</code> æ•´å¥è¯æ˜¯æŒ‡å°†å½“å‰æ–‡ä»¶å¤¹ä¸‹æ–‡ä»¶å¤åˆ¶åˆ° <code>app</code>ç›®å½•ä¸‹</p><p><code>RUN npm install --production</code> æ‰§è¡Œ <code>npm install</code> å‘½ä»¤,å®‰è£…nodeç¨‹åºçš„ä¾èµ–åŒ…</p><p><code>EXPOSE 1340</code>  ä¸­ <code>EXPOSE</code> æ˜¯ç«¯å£æ˜ å°„; 1340 æ˜¯ä½ çš„ nodeç¨‹åºè·‘çš„ç«¯å£</p><p><code>CMD [&quot;node&quot;,&quot;dist/server.js&quot;]</code> ä¸­ <code>CMD</code>æ˜¯ <code>container</code>(å®¹å™¨)å¯åŠ¨æ—¶æ‰§è¡Œçš„å‘½ä»¤;ä¹Ÿå°±æ˜¯å¹³å¸¸æˆ‘ä»¬ä½¿ç”¨çš„ <code>node dist/server.js</code></p><h1 id="ä¸Šä¼ githubå’Œç»‘å®šgithub"><a href="#ä¸Šä¼ githubå’Œç»‘å®šgithub" class="headerlink" title="ä¸Šä¼ githubå’Œç»‘å®šgithub"></a>ä¸Šä¼ githubå’Œç»‘å®šgithub</h1><ul><li><p>åœ¨ä½ åŸæ¥nodeç¨‹åºçš„åŸºç¡€ä¸Š,æ·»åŠ ä¿®æ”¹ä¸Šé¢çš„Dockfile; ä¸Šä¼ è‡³github;<br><em>å¦‚æœä½ æ²¡æœ‰ç°æˆçš„ç¨‹åº,å¯ä»¥ç›´æ¥ clone æˆ‘çš„é¡¹ç›® <a href="https://github.com/xinshangshangxin/ngMusic.git" target="_blank" rel="noopener">ngMusicé¡¹ç›®åœ°å€</a></em> åˆ°ä½ çš„githubä¸­</p></li><li><p>åœ¨DaoCloudä¸­é€‰æ‹© <em>ä»£ç æ„å»º</em></p><figure class="image-box">                <img src="/img/daocloud/dc1.png" alt="dc" title="" class="">                <p>dc</p>            </figure></li><li><p>æ¥ç€ç‚¹å‡» <em>åˆ›å»ºæ–°é¡¹ç›®</em></p><figure class="image-box">                <img src="/img/daocloud/dc2.png" alt="dc" title="" class="">                <p>dc</p>            </figure></li><li><p>æ¥ç€ <em>è¾“å…¥é¡¹ç›®åç§°</em> å’Œ åŒæ­¥ä»£ç æº,é€‰æ‹©ä½ éƒ¨ç½²çš„é¡¹ç›®, æœ€åç‚¹å‡» <em>å¼€å§‹åˆ›å»º</em><br><em>æ­¤å¤„æˆ‘githubå·²ç»ç»‘å®š,æ‰€ä»¥ä½¿ç”¨ coding åšæ¼”ç¤º</em></p><figure class="image-box">                <img src="/img/daocloud/dc3.png" alt="dc" title="" class="">                <p>dc</p>            </figure><p><em>å¼€å§‹æ„å»º</em></p><figure class="image-box">                <img src="/img/daocloud/dc4.png" alt="dc" title="" class="">                <p>dc</p>            </figure><p><em>æ„å»ºå®Œæˆ</em></p><figure class="image-box">                <img src="/img/daocloud/dc6.png" alt="dc" title="" class="">                <p>dc</p>            </figure></li><li><p>ç‚¹å‡» <em>æŸ¥çœ‹é•œåƒ</em>, æ¥ç€åœ¨ç‚¹å‡» <em>éƒ¨ç½²æœ€æ–°ç‰ˆæœ¬</em> åå¼€å§‹éƒ¨ç½²</p></li></ul><ul><li>éƒ¨ç½²æˆåŠŸ, å¯ä»¥è®¿é—®çœ‹çœ‹ä½ çš„ç¨‹åº; å¦‚æœå¤±è´¥,å›å¤´çœ‹çœ‹é‚£é‡Œå‡ºé”™äº†~~<figure class="image-box">                <img src="/img/daocloud/dc5.png" alt="dc" title="" class="">                <p>dc</p>            </figure></li></ul><h2 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h2><ul><li><a href="https://github.com/DaoCloud/python-redis-sample/blob/master/application.py" target="_blank" rel="noopener">https://github.com/DaoCloud/python-redis-sample/blob/master/application.py</a></li><li><a href="http://blog.csdn.net/wsscy2004/article/details/25878223" target="_blank" rel="noopener">http://blog.csdn.net/wsscy2004/article/details/25878223</a></li></ul><hr><blockquote><h3 id="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢"><a href="#æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢" class="headerlink" title="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~"></a>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</h3><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> docker </tag>
            
            <tag> node </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>QQäº’è”è¸©å‘è®°å½•</title>
      <link href="/2015/05/24/QQ%E4%BA%92%E8%81%94%E8%B8%A9%E5%9D%91%E8%AE%B0%E5%BD%95/"/>
      <url>/2015/05/24/QQ%E4%BA%92%E8%81%94%E8%B8%A9%E5%9D%91%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<p>QQäº’è”å‡ºç°redirect uri is illegal(100010)çš„è¸©å‘è®°å½•<br><a id="more"></a></p><h2 id="é¡µé¢è¿›å…¥åœ°å€ä¸æ­£ç¡®â€¦"><a href="#é¡µé¢è¿›å…¥åœ°å€ä¸æ­£ç¡®â€¦" class="headerlink" title="é¡µé¢è¿›å…¥åœ°å€ä¸æ­£ç¡®â€¦."></a>é¡µé¢è¿›å…¥åœ°å€ä¸æ­£ç¡®â€¦.</h2><ul><li><a href="http://op.open.qq.com/index.php" target="_blank" rel="noopener">é”™è¯¯é¡µé¢open.qq.com</a><figure class="image-box">                <img src="/img/qqlogin/qqlogin.png" alt="é”™è¯¯åœ°å€" title="" class="">                <p>é”™è¯¯åœ°å€</p>            </figure><h3 id="æ­£ç¡®é¡µé¢connect-qq-com"><a href="#æ­£ç¡®é¡µé¢connect-qq-com" class="headerlink" title="æ­£ç¡®é¡µé¢connect.qq.com"></a><a href="http://connect.qq.com/manage/index" target="_blank" rel="noopener">æ­£ç¡®é¡µé¢connect.qq.com</a></h3></li></ul><h2 id="å‡ºç°-redirect-uri-is-illegal-100010-å›è°ƒåœ°å€æ–‡æ¡£æœªæ›´æ–°â€¦"><a href="#å‡ºç°-redirect-uri-is-illegal-100010-å›è°ƒåœ°å€æ–‡æ¡£æœªæ›´æ–°â€¦" class="headerlink" title="å‡ºç° redirect uri is illegal(100010) å›è°ƒåœ°å€æ–‡æ¡£æœªæ›´æ–°â€¦."></a>å‡ºç° <code>redirect uri is illegal(100010)</code> å›è°ƒåœ°å€æ–‡æ¡£æœªæ›´æ–°â€¦.</h2><figure class="image-box">                <img src="/img/qqlogin/qqlogin4.png" alt="ç™»å½•å¤±è´¥" title="" class="">                <p>ç™»å½•å¤±è´¥</p>            </figure><blockquote><p>å®˜æ–¹æ–‡æ¡£<a href="http://wiki.open.qq.com/wiki/faq/website/%E5%9B%9E%E8%B0%83%E5%9C%B0%E5%9D%80%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E5%8F%8A%E4%BF%AE%E6%94%B9%E6%96%B9%E6%B3%95" target="_blank" rel="noopener">website/å›è°ƒåœ°å€å¸¸è§é—®é¢˜åŠä¿®æ”¹æ–¹æ³•</a>ä¸­</p></blockquote><figure class="image-box">                <img src="/img/qqlogin/qqlogin2.png" alt="é”™è¯¯è¯´æ˜" title="" class="">                <p>é”™è¯¯è¯´æ˜</p>            </figure><blockquote><p>å…¨éƒ¨æ˜¯é”™è¯¯çš„,åº”å½“å‚è€ƒå¦‚ä¸‹å›¾ç‰‡,å›è°ƒåœ°å€å¡«å†™ <strong>å®Œæ•´çš„å›è°ƒåœ°å€</strong></p></blockquote><figure class="image-box">                <img src="/img/qqlogin/qqlogin3.png" alt="æ­£ç¡®è®¾ç½®" title="" class="">                <p>æ­£ç¡®è®¾ç½®</p>            </figure><hr><blockquote><h3 id="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢"><a href="#æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢" class="headerlink" title="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~"></a>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</h3></blockquote><blockquote><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cygwiné…ç½®è®°å½•</title>
      <link href="/2015/05/10/cygwin%E9%85%8D%E7%BD%AE%E8%AE%B0%E5%BD%95/"/>
      <url>/2015/05/10/cygwin%E9%85%8D%E7%BD%AE%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<p>cygwin setting<br><a id="more"></a></p><h2 id="ls-grep-dirè¾“å‡ºå½©è‰²æ˜¾ç¤º"><a href="#ls-grep-dirè¾“å‡ºå½©è‰²æ˜¾ç¤º" class="headerlink" title="ls/grep/dirè¾“å‡ºå½©è‰²æ˜¾ç¤º"></a>ls/grep/dirè¾“å‡ºå½©è‰²æ˜¾ç¤º</h2><p>è°ƒæ•´ <code>${HOME}/.bashrc</code>æ–‡ä»¶(<code>å®‰è£…ä½ç½®:\cygwin64\home\ä½ çš„ç”¨æˆ·å\.bashrc</code>)ï¼ŒæŠŠæ³¨é‡Šæ‰åˆ«åæ‰“å¼€ï¼š</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"># ç¬¬98è¡Œå·¦å³å¼€å§‹</span><br><span class="line"># Default to human readable figures</span><br><span class="line"> alias df=<span class="string">'df -h'</span></span><br><span class="line"> alias du=<span class="string">'du -h'</span></span><br><span class="line">#</span><br><span class="line"># Misc :)</span><br><span class="line"># alias less='less -r'                          # raw control characters</span><br><span class="line"> alias whence='type -a'                        # where, of a sort</span><br><span class="line"> alias grep='grep --color'                     # show differences in colour</span><br><span class="line"> alias egrep='egrep --color=auto'              # show differences in colour</span><br><span class="line"> alias fgrep='fgrep --color=auto'              # show differences in colour</span><br><span class="line">#</span><br><span class="line"># Some shortcuts for different directory listings</span><br><span class="line"> alias ls='ls -hF --color=tty'                 # classify files in colour</span><br><span class="line"> alias dir=<span class="string">'ls --color=auto --format=vertical'</span></span><br><span class="line"> alias vdir=<span class="string">'ls --color=auto --format=long'</span></span><br><span class="line"> alias ll='ls -l'                              # long list</span><br><span class="line"> alias la='ls -A'                              # all but . and ..</span><br><span class="line"> alias l='ls -CF'                              #</span><br></pre></td></tr></table></figure><h3 id="gitè¾“å‡ºï¼ˆæ¯”å¦‚logã€statusï¼‰å½©è‰²æ˜¾ç¤º"><a href="#gitè¾“å‡ºï¼ˆæ¯”å¦‚logã€statusï¼‰å½©è‰²æ˜¾ç¤º" class="headerlink" title="gitè¾“å‡ºï¼ˆæ¯”å¦‚logã€statusï¼‰å½©è‰²æ˜¾ç¤º"></a>gitè¾“å‡ºï¼ˆæ¯”å¦‚logã€statusï¼‰å½©è‰²æ˜¾ç¤º</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global color.ui auto</span><br></pre></td></tr></table></figure><h2 id="é…ç½®ç›˜ç¬¦çš„é“¾æ¥"><a href="#é…ç½®ç›˜ç¬¦çš„é“¾æ¥" class="headerlink" title="é…ç½®ç›˜ç¬¦çš„é“¾æ¥"></a>é…ç½®ç›˜ç¬¦çš„é“¾æ¥</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ln -s /cygdrive/c /c</span><br><span class="line">ln -s /cygdrive/d /d</span><br><span class="line">ln -s /cygdrive/e /e</span><br></pre></td></tr></table></figure><h2 id="è‡ªåŠ¨è¡¥å…¨ä¸åŒºåˆ†å¤§å°å†™"><a href="#è‡ªåŠ¨è¡¥å…¨ä¸åŒºåˆ†å¤§å°å†™" class="headerlink" title="è‡ªåŠ¨è¡¥å…¨ä¸åŒºåˆ†å¤§å°å†™"></a>è‡ªåŠ¨è¡¥å…¨ä¸åŒºåˆ†å¤§å°å†™</h2><blockquote><p>~/.bashrcæ–‡ä»¶(<code>å®‰è£…ä½ç½®:\cygwin64\home\ä½ çš„ç”¨æˆ·å\.bashrc</code>)ä¸­æ·»åŠ ï¼š<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shopt -s nocaseglob</span><br></pre></td></tr></table></figure></p></blockquote><blockquote><p>~/.inputrcæ–‡ä»¶ä¸­æ·»åŠ ï¼š<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set completion-ignore-<span class="keyword">case</span> on</span><br></pre></td></tr></table></figure></p></blockquote><h2 id="åœ¨cygwinçš„æ‰“å¼€æŒ‡å®šæ–‡ä»¶æˆ–æ–‡ä»¶å¤¹åˆ°æ–‡ä»¶æµè§ˆå™¨"><a href="#åœ¨cygwinçš„æ‰“å¼€æŒ‡å®šæ–‡ä»¶æˆ–æ–‡ä»¶å¤¹åˆ°æ–‡ä»¶æµè§ˆå™¨" class="headerlink" title="åœ¨cygwinçš„æ‰“å¼€æŒ‡å®šæ–‡ä»¶æˆ–æ–‡ä»¶å¤¹åˆ°æ–‡ä»¶æµè§ˆå™¨"></a>åœ¨cygwinçš„æ‰“å¼€æŒ‡å®šæ–‡ä»¶æˆ–æ–‡ä»¶å¤¹åˆ°æ–‡ä»¶æµè§ˆå™¨</h2><blockquote><p>~/.bashrcæ–‡ä»¶ æœ€ååŠ ä¸Š<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">xpl</span> </span>&#123;</span><br><span class="line">     <span class="keyword">if</span> [ <span class="string">"$1"</span> = <span class="string">""</span> ]; then</span><br><span class="line">         XPATH=.   # ç¼ºçœæ˜¯å½“å‰ç›®å½•</span><br><span class="line">     <span class="keyword">else</span></span><br><span class="line">         XPATH=$<span class="number">1</span></span><br><span class="line">         XPATH=<span class="string">"$(cygpath -C ANSI -w "</span>$XPATH<span class="string">")"</span>;</span><br><span class="line">     fi</span><br><span class="line">     explorer $XPATH</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></blockquote><blockquote><p>ä½¿ç”¨è¯´æ˜<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">xpl                 # exploreræ‰“å¼€å½“å‰ç›®å½•</span><br><span class="line">xpl /usr/bin/       # exploreræ‰“å¼€æŒ‡å®šç›®å½•</span><br><span class="line">xpl video.avi       # ä½¿ç”¨ Windows é»˜è®¤ç¨‹åºæ‰“å¼€æ–‡ä»¶</span><br></pre></td></tr></table></figure></p></blockquote><hr><h2 id="sub-ä½¿ç”¨sublime-æ‰“å¼€"><a href="#sub-ä½¿ç”¨sublime-æ‰“å¼€" class="headerlink" title="sub ä½¿ç”¨sublime æ‰“å¼€"></a>sub ä½¿ç”¨sublime æ‰“å¼€</h2><blockquote><p>è·¯å¾„ <code>D:\cygwin64\usr\local\bin</code>ä¸‹æ·»åŠ  sub æ–‡ä»¶<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/cygdrive/c/Program\ Files/Sublime\ Text\ <span class="number">3</span>/sublime_text.exe $<span class="number">1</span> &amp;</span><br></pre></td></tr></table></figure></p></blockquote><blockquote><p>å…¶ä»–å¿«æ·å‘½ä»¤ä¹Ÿå¯ä»¥è‡ªè¡Œé…ç½®</p></blockquote><h1 id="å’ŒconMenué…åˆä½¿ç”¨"><a href="#å’ŒconMenué…åˆä½¿ç”¨" class="headerlink" title="å’ŒconMenué…åˆä½¿ç”¨"></a>å’ŒconMenué…åˆä½¿ç”¨</h1><h2 id="å½“å‰ç›®å½•æ‰“å¼€å³é”®èœå•"><a href="#å½“å‰ç›®å½•æ‰“å¼€å³é”®èœå•" class="headerlink" title="å½“å‰ç›®å½•æ‰“å¼€å³é”®èœå•"></a>å½“å‰ç›®å½•æ‰“å¼€å³é”®èœå•</h2><ol><li><a href="http://blog.xinshangshangxin.com/2015/02/22/ConEmu%E8%AE%BE%E7%BD%AE%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95%E6%89%93%E5%BC%80/">é¦–å…ˆè¯·æ‰“å¼€é“¾æ¥è®¾ç½®ConEmuè®¾ç½®å½“å‰ç›®å½•æ‰“å¼€å³é”®èœå•</a></li><li>è®¾ç½®cygwinåœ¨conEmuä½œä¸ºé»˜è®¤æ‰“å¼€<blockquote><p>  setting -&gt; Startup -&gt; Tasks</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SET CHERE_INVOKING=<span class="number">1</span> &amp; <span class="string">"D:\cygwin64\bin\bash --login -ii"</span> -cur_console:t:<span class="string">"cygwin terminal"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ›¿æ¢ D:\cygwin64\bin\bash ä¸ºä½ çš„å®‰è£…è·¯å¾„</span></span><br></pre></td></tr></table></figure></blockquote></li></ol><figure class="image-box">                <img src="/img/conemu/cc.png" alt="é…ç½®å›¾ç‰‡~~" title="" class="">                <p>é…ç½®å›¾ç‰‡~~</p>            </figure><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul><li><a href="http://oldratlee.com/post/2012-12-22/stunning-cygwin" target="_blank" rel="noopener">æƒŠè‰³çš„cygwinâ€”â€”Windowsä¸‹çš„Linuxå‘½ä»¤è¡Œç¯å¢ƒçš„é…ç½®å’Œä½¿ç”¨</a></li><li><a href="http://www.joshuazhang.net/posts/2014/cygwin-cfg-note.html#_3" target="_blank" rel="noopener">Cygwin å®‰è£…é…ç½®ç¬”è®°</a></li><li><a href="https://superuser.com/questions/591206/how-do-i-configure-conemu-to-run-cygwin-bash" target="_blank" rel="noopener">How do I configure ConEmu to run Cygwin Bash?</a></li></ul><hr><blockquote><h3 id="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢"><a href="#æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢" class="headerlink" title="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~"></a>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</h3><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> ConEmu </tag>
            
            <tag> cygwin </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScript-replace</title>
      <link href="/2015/05/09/JavaScript-replace/"/>
      <url>/2015/05/09/JavaScript-replace/</url>
      
        <content type="html"><![CDATA[<p>æˆ‘å¯¹JavaScript-replaceç†è§£è§è§£<br><a id="more"></a></p><p><code>String.replace(searchValue,replaceValue)</code></p><ol><li>String:å­—ç¬¦ä¸²</li><li>searchValueï¼šå­—ç¬¦ä¸²æˆ–æ­£åˆ™è¡¨è¾¾å¼</li><li>replaceValue:å­—ç¬¦ä¸²æˆ–è€…å‡½æ•°</li></ol><h2 id="å­—ç¬¦ä¸²æ›¿æ¢å­—ç¬¦ä¸²"><a href="#å­—ç¬¦ä¸²æ›¿æ¢å­—ç¬¦ä¸²" class="headerlink" title="å­—ç¬¦ä¸²æ›¿æ¢å­—ç¬¦ä¸²"></a>å­—ç¬¦ä¸²æ›¿æ¢å­—ç¬¦ä¸²</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'I am loser!'</span>.replace(<span class="string">'loser'</span>,<span class="string">'hero'</span>)</span><br><span class="line"><span class="comment">//I am hero!</span></span><br></pre></td></tr></table></figure><p>ç›´æ¥ä½¿ç”¨å­—ç¬¦ä¸²èƒ½è®©è‡ªå·±ä»loserå˜æˆhero,ä½†æ˜¯å¦‚æœæœ‰2ä¸ªloserå°±ä¸èƒ½ä¸€èµ·å˜æˆheroäº†.</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'I am loser,You are loser'</span>.replace(<span class="string">'loser'</span>,<span class="string">'hero'</span>);</span><br><span class="line"><span class="comment">//I am hero,You are loser</span></span><br></pre></td></tr></table></figure><h2 id="æ­£åˆ™è¡¨è¾¾å¼æ›¿æ¢ä¸ºå­—ç¬¦ä¸²"><a href="#æ­£åˆ™è¡¨è¾¾å¼æ›¿æ¢ä¸ºå­—ç¬¦ä¸²" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼æ›¿æ¢ä¸ºå­—ç¬¦ä¸²"></a>æ­£åˆ™è¡¨è¾¾å¼æ›¿æ¢ä¸ºå­—ç¬¦ä¸²</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'I am loser,You are loser'</span>.replace(<span class="regexp">/loser/g</span>,<span class="string">'hero'</span>)</span><br><span class="line"><span class="comment">//I am hero,You are hero</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼,å¹¶å°†æ­£åˆ™çš„globalå±æ€§æ”¹ä¸ºtrueåˆ™å¯ä»¥è®©æ‰€æœ‰loseréƒ½å˜ä¸ºhero</p><h2 id="æœ‰è¶£çš„æ›¿æ¢å­—ç¬¦"><a href="#æœ‰è¶£çš„æ›¿æ¢å­—ç¬¦" class="headerlink" title="æœ‰è¶£çš„æ›¿æ¢å­—ç¬¦"></a>æœ‰è¶£çš„æ›¿æ¢å­—ç¬¦</h2><p><code>replaceValue</code> å¯ä»¥æ˜¯å­—ç¬¦ä¸².å¦‚æœå­—ç¬¦ä¸²ä¸­æœ‰å‡ ä¸ªç‰¹å®šå­—ç¬¦çš„è¯,ä¼šè¢«è½¬æ¢ä¸ºç‰¹å®šå­—ç¬¦ä¸².</p><table><thead><tr><th style="text-align:center">å­—ç¬¦</th><th style="text-align:center">æ›¿æ¢æ–‡æœ¬</th></tr></thead><tbody><tr><td style="text-align:center">$$</td><td style="text-align:center">æ’å…¥å­—ç¬¦ä¸² â€œ$â€</td></tr><tr><td style="text-align:center"> $&amp;</td><td style="text-align:center">ç¬¬ä¸€ä¸ªå‚æ•°æ‰€åŒ¹é…çš„å­ä¸² </td></tr><tr><td style="text-align:center"> $`</td><td style="text-align:center">åŒ¹é…å­—ç¬¦ä¸²å·¦è¾¹çš„å­—ç¬¦ </td></tr><tr><td style="text-align:center"> $â€™</td><td style="text-align:center">åŒ¹é…å­—ç¬¦ä¸²å³è¾¹çš„å­—ç¬¦ </td></tr><tr><td style="text-align:center">$n æˆ– $nn</td><td style="text-align:center">å¦‚æœnæˆ–nnæ˜¯ä¸ªåè¿›åˆ¶çš„æ•°å­—,å¹¶ä¸”replaceæ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸ªæ­£åˆ™è¡¨è¾¾å¼,é‚£ä¹ˆ$nè¡¨ç¤ºæ­£åˆ™è¡¨è¾¾å¼ä¸­çš„ç¬¬nä¸ªå­åŒ¹é…å­—ç¬¦ä¸². </td></tr></tbody></table><h3 id="ä½¿ç”¨-amp-å­—ç¬¦ç»™åŒ¹é…å­—ç¬¦åŠ å¤§æ‹¬å·"><a href="#ä½¿ç”¨-amp-å­—ç¬¦ç»™åŒ¹é…å­—ç¬¦åŠ å¤§æ‹¬å·" class="headerlink" title="ä½¿ç”¨$&amp;å­—ç¬¦ç»™åŒ¹é…å­—ç¬¦åŠ å¤§æ‹¬å·"></a>ä½¿ç”¨$&amp;å­—ç¬¦ç»™åŒ¹é…å­—ç¬¦åŠ å¤§æ‹¬å·</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> sStr=<span class="string">'è®¨è®ºä¸€ä¸‹æ­£åˆ™è¡¨è¾¾å¼ä¸­çš„replaceçš„ç”¨æ³•'</span>;</span><br><span class="line">sStr.replace(<span class="regexp">/æ­£åˆ™è¡¨è¾¾å¼/</span>,<span class="string">'&#123;$&amp;&#125;'</span>);</span><br><span class="line"><span class="comment">//è®¨è®ºä¸€ä¸‹&#123;æ­£åˆ™è¡¨è¾¾å¼&#125;ä¸­çš„replaceçš„ç”¨æ³•</span></span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨-å’Œ-â€™å­—ç¬¦æ›¿æ¢å†…å®¹"><a href="#ä½¿ç”¨-å’Œ-â€™å­—ç¬¦æ›¿æ¢å†…å®¹" class="headerlink" title="ä½¿ç”¨$`å’Œ$â€™å­—ç¬¦æ›¿æ¢å†…å®¹"></a>ä½¿ç”¨$`å’Œ$â€™å­—ç¬¦æ›¿æ¢å†…å®¹</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'abc'</span>.replace(<span class="regexp">/b/</span>,<span class="string">"$`"</span>);<span class="comment">//aac</span></span><br><span class="line"><span class="string">'abc'</span>.replace(<span class="regexp">/b/</span>,<span class="string">"$'"</span>);<span class="comment">//acc</span></span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨åˆ†ç»„åŒ¹é…ç»„åˆæ–°çš„å­—ç¬¦ä¸²"><a href="#ä½¿ç”¨åˆ†ç»„åŒ¹é…ç»„åˆæ–°çš„å­—ç¬¦ä¸²" class="headerlink" title="ä½¿ç”¨åˆ†ç»„åŒ¹é…ç»„åˆæ–°çš„å­—ç¬¦ä¸²"></a>ä½¿ç”¨åˆ†ç»„åŒ¹é…ç»„åˆæ–°çš„å­—ç¬¦ä¸²</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'nimojs@126.com'</span>.replace(<span class="regexp">/(.+)(@)(.*)/</span>,<span class="string">"$2$1"</span>)<span class="comment">//@nimojs</span></span><br></pre></td></tr></table></figure><h2 id="replaceValueå‚æ•°å¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•°"><a href="#replaceValueå‚æ•°å¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•°" class="headerlink" title="replaceValueå‚æ•°å¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•°"></a>replaceValueå‚æ•°å¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•°</h2><p><code>String.replace(searchValue,replaceValue)</code> ä¸­çš„<strong>replaceValue</strong>å¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•°.</p><p>å¦‚æœæŒ‡å®šä¸€ä¸ªå‡½æ•°ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°. å½“åŒ¹é…æ‰§è¡Œå,è¯¥å‡½æ•°å°±ä¼šæ‰§è¡Œ. å‡½æ•°çš„è¿”å›å€¼ä½œä¸ºæ›¿æ¢å­—ç¬¦ä¸²è¢«ä½¿ç”¨. <strong>(æ³¨æ„:  ä¸Šé¢æåˆ°çš„ç‰¹æ®Šæ›¿æ¢å‚æ•°åœ¨è¿™é‡Œä¸èƒ½è¢«ä½¿ç”¨.)</strong> å¦å¤–è¦æ³¨æ„çš„æ˜¯, å¦‚æœç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ­£åˆ™è¡¨è¾¾å¼, å¹¶ä¸”å…¶ä¸ºå…¨å±€åŒ¹é…æ¨¡å¼, é‚£ä¹ˆè¿™ä¸ªæ–¹æ³•å°†è¢«å¤šæ¬¡è°ƒç”¨, æ¯æ¬¡åŒ¹é…éƒ½ä¼šè¢«è°ƒç”¨.</p><table><thead><tr><th style="text-align:center">å˜é‡å</th><th style="text-align:center">ä»£è¡¨çš„å€¼</th></tr></thead><tbody><tr><td style="text-align:center">str</td><td style="text-align:center">åŒ¹é…çš„å­ä¸².(å¯¹åº”äºä¸Šé¢çš„ <code>$&amp;</code> )</td></tr><tr><td style="text-align:center">p1, p2, â€¦</td><td style="text-align:center">ç¬¬nä¸ªæ‹¬å·ä¸­åŒ¹é…çš„å­å­—ç¬¦ä¸²</td></tr><tr><td style="text-align:center">offset</td><td style="text-align:center">è¯¥å­—ç¬¦ä¸²åŒ¹é…çš„åç§»é‡</td></tr><tr><td style="text-align:center">s</td><td style="text-align:center">æ•´ä¸ªå­—ç¬¦ä¸²</td></tr></tbody></table><blockquote><p>æˆ‘çš„ç†è§£:</p><blockquote><p>å‡½æ•°çš„å‚æ•° å’Œstr.match(reg) å¾—åˆ°çš„å†…å®¹ä¸€æ ·</p></blockquote></blockquote><h1 id="ä¾‹å­æ›´æ¸…æ™°"><a href="#ä¾‹å­æ›´æ¸…æ™°" class="headerlink" title="ä¾‹å­æ›´æ¸…æ™°~~"></a>ä¾‹å­æ›´æ¸…æ™°~~</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">'my love hebe'</span>.match(<span class="regexp">/(\w+)\s\w+\s(\w+)/</span> ));</span><br><span class="line"><span class="comment">// [ 'my love hebe', </span></span><br><span class="line"><span class="comment">// 'my', </span></span><br><span class="line"><span class="comment">// 'hebe', </span></span><br><span class="line"><span class="comment">// index: 0, </span></span><br><span class="line"><span class="comment">// input: 'my love hebe' ]</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">logArguments</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">arguments</span>);</span><br><span class="line"><span class="comment">// &#123; '0': 'my love hebe',</span></span><br><span class="line"><span class="comment">//  '1': 'my',</span></span><br><span class="line"><span class="comment">//  '2': 'hebe',</span></span><br><span class="line"><span class="comment">//  '3': 0,</span></span><br><span class="line"><span class="comment">//  '4': 'my love hebe' &#125;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(</span><br><span class="line">    <span class="string">'my love hebe'</span>.replace(<span class="regexp">/(\w+)\s\w+\s(\w+)/</span>, logArguments)</span><br><span class="line">);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'my love hebe'</span>.match(<span class="regexp">/(\w+)\s\w+\s(\w+)/</span> ));</span><br></pre></td></tr></table></figure><hr><h2 id="ä¿®æ”¹å‚è€ƒäº†"><a href="#ä¿®æ”¹å‚è€ƒäº†" class="headerlink" title="ä¿®æ”¹å‚è€ƒäº†:"></a>ä¿®æ”¹å‚è€ƒäº†:</h2><ul><li><a href="http://nimojs.com/blog/posts/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JavaScript-replace.html" target="_blank" rel="noopener">æ·±å…¥ç†è§£JavaScript-replace</a></li></ul><hr><blockquote><h3 id="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢"><a href="#æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢" class="headerlink" title="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~"></a>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</h3><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScriptæƒå¨æŒ‡å—ç¬”è®°9_å®¢æˆ·ç«¯å­˜å‚¨</title>
      <link href="/2015/05/06/JavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E7%AC%94%E8%AE%B09-%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%AD%98%E5%82%A8/"/>
      <url>/2015/05/06/JavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E7%AC%94%E8%AE%B09-%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%AD%98%E5%82%A8/</url>
      
        <content type="html"><![CDATA[<p>JavaScriptæƒå¨æŒ‡å—ç¬”è®°9_å®¢æˆ·ç«¯å­˜å‚¨<br><a id="more"></a></p><h2 id="localStorage-å’Œ-sessionStorage"><a href="#localStorage-å’Œ-sessionStorage" class="headerlink" title="localStorage å’Œ sessionStorage"></a>localStorage å’Œ sessionStorage</h2><blockquote><p><code>localStorage</code> ä»…æ”¯æŒå­˜å‚¨å­—ç¬¦ä¸²<br><code>localStorage</code> å­˜å‚¨æ˜¯æ°¸ä¹…çš„;é™¤éwebå¼•ç”¨åˆ»æ„åˆ é™¤,æˆ–è€…ç”¨æˆ·é€šè¿‡æµè§ˆå™¨é…ç½®åˆ é™¤<br><code>localStorage</code> ä½œç”¨åŸŸé™å®šåœ¨æ–‡æ¡£æºçº§åˆ«(åè®®;ä¸»æœºå;ç«¯å£)</p></blockquote><blockquote><p><code>sessionStorage</code> å­˜å‚¨æ•°æ®çš„è„šæœ¬æ‰€åœ¨çš„ æœ€é¡¶å±‚çš„çª—å£/æµè§ˆå™¨æ ‡ç­¾é¡µ çš„æœ‰æ•ˆæœŸ<br><code>sessionStorage</code> ä½œç”¨åŸŸé™å®šåœ¨æ–‡æ¡£æºçº§åˆ«(åè®®;ä¸»æœºå;ç«¯å£)<br>å¦‚æœä¸€ä¸ªæµè§ˆå™¨æ ‡ç­¾é¡µåŒ…å«2ä¸ª <code>&lt;iframe&gt;</code> å…ƒç´ , å®ƒä»¬å¯ä»¥å…±äº« <code>sessionStorage</code></p></blockquote><h2 id="å­˜å‚¨API"><a href="#å­˜å‚¨API" class="headerlink" title="å­˜å‚¨API"></a>å­˜å‚¨API</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">setItem()</span><br><span class="line">getItem()</span><br><span class="line">removeItem()</span><br><span class="line">clear()</span><br></pre></td></tr></table></figure><h2 id="å­˜å‚¨äº‹ä»¶"><a href="#å­˜å‚¨äº‹ä»¶" class="headerlink" title="å­˜å‚¨äº‹ä»¶"></a>å­˜å‚¨äº‹ä»¶</h2><blockquote><p>åœ¨ <code>localStorage</code> æˆ– <code>sessionStorage</code> çš„æ•°æ®å‘ç”Ÿæ”¹å˜,æµè§ˆå™¨éƒ½ä¼šåœ¨å…¶ä»–å¯¹è¯¥æ•°æ®å¯è§çš„çª—å£å¯¹è±¡ä¸Šå‡ºå‘å­˜å‚¨äº‹ä»¶(ä¸ä¼šåœ¨å¯¹æ•°æ®è¿›è¡Œæ”¹å˜çš„çª—å£å¯¹è±¡ä¸Šè§¦å‘)<br>å¦‚æœ2ä¸ªæ ‡ç­¾é¡µæ‰“å¼€äº†æ¥è‡ªåŒæºçš„é¡µé¢,å…¶ä¸­ä¸€ä¸ªé¡µé¢åœ¨ <code>localStorage</code> ä¸Šå­˜å‚¨äº†æ•°æ®,é‚£ä¹ˆå¦å¤–ä¸€ä¸ªæ ‡ç­¾é¡µä¼šæ¥å—åˆ°ä¸€ä¸ªå­˜å‚¨äº‹ä»¶<br>å¯¹ <code>sessionStorage</code> é™åˆ¶åœ¨é¡¶å±‚çª—å£,æ‰€ä»¥å¯¹ <code>sessionStorage</code> çš„æ”¹å˜åªæœ‰å½“æœ‰ç‰µè¿çš„çª—å£è§¦å‘æ˜¯æ‰ä¼šè§¦å‘å­˜å‚¨äº‹ä»¶<br>å¯¹å·²ç»å­˜åœ¨çš„å­˜å‚¨é¡¹è®¾ç½®ä¸€ä¸ªä¸€æ¨¡ä¸€æ ·çš„å€¼,æŠ‘æˆ–æ˜¯åˆ é™¤ä¸€ä¸ªæœ¬æ¥å°±ä¸å­˜åœ¨çš„å­˜å‚¨é¡¹æ˜¯ä¸ä¼šè§¦å‘äº‹ä»¶çš„</p></blockquote><h2 id="cookie"><a href="#cookie" class="headerlink" title="cookie"></a>cookie</h2><blockquote><p><code>cookie</code> çš„ä½œç”¨åŸŸæ˜¯é€šè¿‡ æ–‡æ¡£æºå’Œæ–‡æ¡£è·¯å¾„ æ¥ç¡®å®šçš„<br><code>cookie</code> çš„å€¼ä¸å¯ä»¥åŒ…å«åˆ†å·,é€—å·,ç©ºç™½ç¬¦, å› æ­¤éœ€è¦ <code>encodeURIComponent</code> è¿›è¡Œç¼–ç </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åŸºäºcookieçš„å­˜å‚¨API</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">CookieStorage</span>(<span class="params">maxage, path</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// è·å–ä¸€ä¸ªå­˜å‚¨å…¨éƒ¨cookieçš„å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">var</span> cookies = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> cookies = &#123;&#125;;</span><br><span class="line">        <span class="keyword">var</span> all = <span class="built_in">document</span>.cookie;</span><br><span class="line">        <span class="keyword">if</span> (all === <span class="string">""</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> cookies;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// åˆ†ç¦»å‡ºå/å€¼å¯¹</span></span><br><span class="line">        <span class="keyword">var</span> list = all.split(<span class="string">"; "</span>);</span><br><span class="line">        <span class="comment">// éå†æ¯ä¸ªcookie</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; list.length; i++) &#123;</span><br><span class="line">            <span class="keyword">var</span> cookie = list[i];</span><br><span class="line">            <span class="keyword">var</span> p = cookie.indexOf(<span class="string">"="</span>);</span><br><span class="line">            <span class="comment">// è·å–cookieçš„åå­—</span></span><br><span class="line">            <span class="keyword">var</span> name = cookie.substring(<span class="number">0</span>, p);</span><br><span class="line">            <span class="comment">// è·å–cookieå¯¹åº”çš„å€¼</span></span><br><span class="line">            <span class="keyword">var</span> value = cookie.substring(p + <span class="number">1</span>);</span><br><span class="line">            <span class="comment">// è§£ç </span></span><br><span class="line">            value = <span class="built_in">decodeURIComponent</span>(value);</span><br><span class="line">            cookies[name] = value;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> cookies;</span><br><span class="line">    &#125;());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†æ‰€æœ‰çš„cookieå­˜å‚¨åˆ°ä¸€ä¸ªæ•°ç»„ä¸­</span></span><br><span class="line">    <span class="keyword">var</span> keys = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> cookies) &#123;</span><br><span class="line">        keys.push(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å®šä¹‰å­˜å‚¨APIçš„å…¬å…±æ–¹æ³•å’Œå±æ€§</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å­˜å‚¨cookie çš„ä¸ªæ•°</span></span><br><span class="line">    <span class="keyword">this</span>.length = keys.length;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¿”å›ç¬¬Nä¸ªcookieçš„åå­—, Nè¶Šç•Œè¿”å›null</span></span><br><span class="line">    <span class="keyword">this</span>.key = <span class="function"><span class="keyword">function</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (n &lt; <span class="number">0</span> || n &gt;= keys.length) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> keys[n];</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¿”å›æŒ‡å®šcookieçš„åå­—,å¦‚æœä¸å­˜åœ¨è¿”å›NULL</span></span><br><span class="line">    <span class="keyword">this</span>.getItem = <span class="function"><span class="keyword">function</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> cookies[name] || <span class="literal">null</span>;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å­˜å‚¨cookie</span></span><br><span class="line">    <span class="keyword">this</span>.setItem = <span class="function"><span class="keyword">function</span>(<span class="params">key, value</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// å¦‚æœè¦å­˜å‚¨çš„cookieè¿˜ä¸å­˜åœ¨</span></span><br><span class="line">        <span class="keyword">if</span> (!(key <span class="keyword">in</span> cookies)) &#123;</span><br><span class="line">            <span class="comment">// åŠ å…¥æ•°ç»„</span></span><br><span class="line">            keys.push(key);</span><br><span class="line">            <span class="comment">// é•¿åº¦åŠ ä¸€</span></span><br><span class="line">            <span class="keyword">this</span>.length++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å°†å/å€¼å­˜å‚¨åˆ°cookieså¯¹è±¡ä¸­</span></span><br><span class="line">        cookies[key] = value;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è®¾ç½®cookie</span></span><br><span class="line">        <span class="keyword">var</span> cookie = key + <span class="string">"="</span> + <span class="built_in">encodeURIComponent</span>(value);</span><br><span class="line">        <span class="comment">// æ·»åŠ  maxage</span></span><br><span class="line">        <span class="keyword">if</span> (maxage) &#123;</span><br><span class="line">            cookie += <span class="string">"; max-age="</span> + maxage;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ·»åŠ path</span></span><br><span class="line">        <span class="keyword">if</span> (path) &#123;</span><br><span class="line">            cookie += <span class="string">"; path="</span> + path;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è®¾ç½®document.cookie</span></span><br><span class="line">        <span class="built_in">document</span>.cookie = cookie;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ é™¤æŒ‡å®šçš„cookie</span></span><br><span class="line">    <span class="keyword">this</span>.removeItem = <span class="function"><span class="keyword">function</span>(<span class="params">key</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!(key <span class="keyword">in</span> cookies)) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆ é™¤å†…éƒ¨cookiesçš„æŒ‡å®šcookie</span></span><br><span class="line">        <span class="keyword">delete</span> cookies[key];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä»æ•°ç»„ä¸­åˆ é™¤</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; keys.length; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (keys[i] === key) &#123;</span><br><span class="line">                keys.splice(i, <span class="number">1</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.length--;</span><br><span class="line">        <span class="comment">// é€šè¿‡è®¾ç½®æœ‰æ•ˆæœŸä¸º0æ¥åˆ é™¤cookie</span></span><br><span class="line">        <span class="built_in">document</span>.cookie = key + <span class="string">"=; max-age=0"</span>;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ é™¤æ‰€æœ‰cookie</span></span><br><span class="line">    <span class="keyword">this</span>.clear = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; keys.length; i++) &#123;</span><br><span class="line">            <span class="built_in">document</span>.cookie = keys[i] + <span class="string">"=; max-age=0"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cookies = &#123;&#125;;</span><br><span class="line">        keys = [];</span><br><span class="line">        <span class="keyword">this</span>.length = <span class="number">0</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="åº”ç”¨ç¨‹åºç¼“å­˜æ¸…å•"><a href="#åº”ç”¨ç¨‹åºç¼“å­˜æ¸…å•" class="headerlink" title="åº”ç”¨ç¨‹åºç¼“å­˜æ¸…å•"></a>åº”ç”¨ç¨‹åºç¼“å­˜æ¸…å•</h2><blockquote><p>æ³¨é‡Š ä»¥ <code>#</code> å¼€å¤´,åé¢è·Ÿä¸€ä¸ªç©ºå­—ç¬¦<br>åº”ç”¨ç¨‹åºç¼“å­˜æ¸…å•æ–‡ä»¶çº¦å®šä¸€.appcaheä½œä¸ºæ–‡ä»¶æ‰©å±•å.ä½†æ˜¯webæœåŠ¡å™¨æ€”æ€”è¯†åˆ«æ¸…å•æ–‡ä»¶çš„æ–¹å¼æ˜¯é€šè¿‡ <code>text/cache-mainfest</code> è¿™ä¸ª <code>MIME</code>ç±»å‹<br>æµè§ˆå™¨åœ¨æ›´æ–°ç¼“å­˜è¿‡ç¨‹ä¸­ä¼šè§¦å‘ä¸€ç³»åˆ—äº‹ä»¶</p><blockquote><ol><li>æ²¡æœ‰å¯ç”¨çš„æ›´æ–°,è§¦å‘ <code>noupdate</code> </li><li>æœ‰å¯ç”¨çš„æ›´æ–°è§¦å‘ <code>downloading</code>, ä¸‹è½½è¿‡ç¨‹è§¦å‘ <code>progress</code> å’Œ ä¸‹è½½å®Œæˆè§¦å‘ <code>updateready</code></li><li>é¦–æ¬¡è½½å…¥æ–°çš„åº”ç”¨ç¨‹åº <code>downloading</code>, ä¸‹è½½è¿‡ç¨‹è§¦å‘ <code>progress</code>, ä¸‹è½½å®Œæˆåè§¦å‘ <code>cached</code></li><li>æµè§ˆå™¨å¤„äºç¦»çº¿çŠ¶æ€è§¦å‘ <code>error</code></li><li>æ¸…å•æ–‡ä»¶ä¸å­˜åœ¨:<blockquote><ul><li>æœªç¼“å­˜çš„åº”ç”¨ç¨‹åºè§¦å‘ <code>error</code></li><li>åº”ç”¨ç¨‹åºå·²ç»ç¼“å­˜å¹¶ä¸”æµè§ˆå™¨å¤„äºåœ¨çº¿çŠ¶æ€è§¦å‘ <code>obsolete</code>, å¹¶ä¸”å°†è¯¥åº”ç”¨ä»ç¼“å­˜ä¸­ç§»é™¤</li></ul></blockquote></li></ol></blockquote></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¤„ç†åº”ç”¨ç¼“å­˜çš„ç›¸å…³äº‹ä»¶</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">status</span>(<span class="params">msg</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">document</span>.getElementById(<span class="string">"statusline"</span>).innerHTML = msg;</span><br><span class="line">    <span class="built_in">console</span>.log(msg);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">window</span>.applicationCache.onchecking = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    status(<span class="string">"Checking for a new version."</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">window</span>.applicationCache.onnoupdate = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    status(<span class="string">"This version is up-to-date."</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">window</span>.applicationCache.ondownloading = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    status(<span class="string">"Downloading new version"</span>);</span><br><span class="line">    <span class="built_in">window</span>.progresscount = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">window</span>.applicationCache.onprogress = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> progress = <span class="string">""</span>;</span><br><span class="line">    <span class="keyword">if</span> (e &amp;&amp; e.lengthComputable) &#123;</span><br><span class="line">        progress = <span class="string">" "</span> + <span class="built_in">Math</span>.round(<span class="number">100</span> * e.loaded / e.total) + <span class="string">"%"</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        progress = <span class="string">" ("</span> + ++progresscount + <span class="string">")"</span></span><br><span class="line">    &#125;</span><br><span class="line">    status(<span class="string">"Downloading new version"</span> + progress);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">window</span>.applicationCache.oncached = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    status(<span class="string">"This application is now cached locally"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">window</span>.applicationCache.onupdateready = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    status(<span class="string">"A new version has been downloaded.  Reload to run it"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">window</span>.applicationCache.onerror = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    status(<span class="string">"Couldn't load manifest or cache application"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">window</span>.applicationCache.onobsolete = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    status(<span class="string">"This application is no longer cached. "</span> +</span><br><span class="line">        <span class="string">"Reload to get the latest version from the network."</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="ç¦»çº¿webåº”ç”¨"><a href="#ç¦»çº¿webåº”ç”¨" class="headerlink" title="ç¦»çº¿webåº”ç”¨"></a>ç¦»çº¿webåº”ç”¨</h2><blockquote><p>é€šè¿‡ <code>navigator.onLine</code> æ¥æ£€æµ‹æµè§ˆå™¨æ˜¯å¦åœ¨çº¿</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// permanote.js</span></span><br><span class="line"><span class="keyword">var</span> editor, statusline, savebutton, idletimer;</span><br><span class="line"><span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (localStorage.note == <span class="literal">null</span>) &#123;</span><br><span class="line">        localStorage.note = <span class="string">""</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (localStorage.lastModified == <span class="literal">null</span>) &#123;</span><br><span class="line">        localStorage.lastModified = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (localStorage.lastSaved == <span class="literal">null</span>) &#123;</span><br><span class="line">        localStorage.lastSaved = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    editor = <span class="built_in">document</span>.getElementById(<span class="string">"editor"</span>);</span><br><span class="line">    statusline = <span class="built_in">document</span>.getElementById(<span class="string">"statusline"</span>);</span><br><span class="line">    savebutton = <span class="built_in">document</span>.getElementById(<span class="string">"savebutton"</span>);</span><br><span class="line">    editor.value = localStorage.note;</span><br><span class="line">    editor.disabled = <span class="literal">true</span>;</span><br><span class="line">    editor.addEventListener(<span class="string">"input"</span>,</span><br><span class="line">        <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">            localStorage.note = editor.value;</span><br><span class="line">            localStorage.lastModified = <span class="built_in">Date</span>.now();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (idletimer) &#123;</span><br><span class="line">                clearTimeout(idletimer);</span><br><span class="line">            &#125;</span><br><span class="line">            idletimer = setTimeout(save, <span class="number">5000</span>);</span><br><span class="line"></span><br><span class="line">            savebutton.disabled = <span class="literal">false</span>;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="literal">false</span>);</span><br><span class="line">    sync();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">window</span>.onbeforeunload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (localStorage.lastModified &gt; localStorage.lastSaved) &#123;</span><br><span class="line">        save();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">window</span>.onoffline = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    status(<span class="string">"Offline"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">window</span>.ononline = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    sync();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">window</span>.applicationCache.onupdateready = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    status(<span class="string">"A new version of this application is available. Reload to run it"</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">window</span>.applicationCache.onnoupdate = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    status(<span class="string">"You are running the latest version of the application."</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">status</span>(<span class="params">msg</span>) </span>&#123;</span><br><span class="line">    statusline.innerHTML = msg;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">save</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (idletimer) &#123;</span><br><span class="line">        clearTimeout(idletimer);</span><br><span class="line">    &#125;</span><br><span class="line">    idletimer = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">if</span> (navigator.onLine) &#123;</span><br><span class="line">        <span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">        xhr.open(<span class="string">"PUT"</span>, <span class="string">"/note"</span>);</span><br><span class="line">        xhr.send(editor.value);</span><br><span class="line">        xhr.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            localStorage.lastSaved = <span class="built_in">Date</span>.now();</span><br><span class="line">            savebutton.disabled = <span class="literal">true</span>;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sync</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (navigator.onLine) &#123;</span><br><span class="line">        <span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">        xhr.open(<span class="string">"GET"</span>, <span class="string">"/note"</span>);</span><br><span class="line">        xhr.send();</span><br><span class="line">        xhr.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> remoteModTime = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span> (xhr.status == <span class="number">200</span>) &#123;</span><br><span class="line">                <span class="keyword">var</span> remoteModTime = xhr.getResponseHeader(<span class="string">"Last-Modified"</span>);</span><br><span class="line">                remoteModTime = <span class="keyword">new</span> <span class="built_in">Date</span>(remoteModTime).getTime();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (remoteModTime &gt; localStorage.lastModified) &#123;</span><br><span class="line">                status(<span class="string">"Newer note found on server."</span>);</span><br><span class="line">                <span class="keyword">var</span> useit =</span><br><span class="line">                    confirm(<span class="string">"There is a newer version of the note\n"</span> +</span><br><span class="line">                        <span class="string">"on the server. Click Ok to use that version\n"</span> +</span><br><span class="line">                        <span class="string">"or click Cancel to continue editing this\n"</span> +</span><br><span class="line">                        <span class="string">"version and overwrite the server"</span>);</span><br><span class="line">                <span class="keyword">var</span> now = <span class="built_in">Date</span>.now();</span><br><span class="line">                <span class="keyword">if</span> (useit) &#123;</span><br><span class="line">                    editor.value = localStorage.note = xhr.responseText;</span><br><span class="line">                    localStorage.lastSaved = now;</span><br><span class="line">                    status(<span class="string">"Newest version downloaded."</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    status(<span class="string">"Ignoring newer version of the note."</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                localStorage.lastModified = now;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                status(<span class="string">"You are editing the current version of the note."</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (localStorage.lastModified &gt; localStorage.lastSaved) &#123;</span><br><span class="line">                save();</span><br><span class="line">            &#125;</span><br><span class="line">            editor.disabled = <span class="literal">false</span>;</span><br><span class="line">            editor.focus();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        status(<span class="string">"Can't sync while offline"</span>);</span><br><span class="line">        editor.disabled = <span class="literal">false</span>;</span><br><span class="line">        editor.focus();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><blockquote><h3 id="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢"><a href="#æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢" class="headerlink" title="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~"></a>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</h3><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScriptæƒå¨æŒ‡å—ç¬”è®°8_è„šæœ¬åŒ–HTTP</title>
      <link href="/2015/05/05/JavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E7%AC%94%E8%AE%B08-%E8%84%9A%E6%9C%AC%E5%8C%96HTTP/"/>
      <url>/2015/05/05/JavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E7%AC%94%E8%AE%B08-%E8%84%9A%E6%9C%AC%E5%8C%96HTTP/</url>
      
        <content type="html"><![CDATA[<p>JavaScriptæƒå¨æŒ‡å—ç¬”è®°8_è„šæœ¬åŒ–HTTP<br><a id="more"></a></p><h2 id="open"><a href="#open" class="headerlink" title="open()"></a>open()</h2><blockquote><p>open() çš„ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šHTTPçš„ æ–¹æ³•/åŠ¨ä½œ; ä¸åŒºåˆ†å¤§å°å†™;ä½†é€šå¸¸ä½¿ç”¨å¤§å†™å­—å¹•  </p></blockquote><blockquote><p>open() çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ URL; ç›¸å¯¹äºæ–‡æ¡£çš„URLæˆ–è€…ç»å¯¹URL</p><blockquote><p>ç»å¯¹URLå¦‚æœè·¨åŸŸ,é€šå¸¸ä¼šæŠ¥é”™;é™¤éæœåŠ¡å™¨å…è®¸å¹¶ä¸”XHR2è§„èŒƒ</p></blockquote></blockquote><blockquote><p>ä½¿ç”¨setRequestsHeader() å¤šæ¬¡è®¾ç½®<br>POSTè¯·æ±‚é€šå¸¸æ‹¥æœ‰ä¸»ä½“,åŒæ—¶åº”è¯¥ä½¿ç”¨ <code>setRequestsHeader</code> æŒ‡å®š <code>Content-Type</code> å¤´<br><code>xhr.setRequestHeader(&#39;Content-Type&#39;, &#39;text/plain&#39;)</code>  </p><blockquote><p>æ— æ³•ä¼ é€’ä»¥ä¸‹å¤´</p></blockquote></blockquote><table><thead><tr><th style="text-align:center">_</th><th style="text-align:center">_</th><th style="text-align:center">_</th></tr></thead><tbody><tr><td style="text-align:center">Accept-Charset</td><td style="text-align:center">Content-Transfer-Encoding</td><td style="text-align:center">TE</td></tr><tr><td style="text-align:center">Accept-Encoding</td><td style="text-align:center">Date</td><td style="text-align:center">Trailer</td></tr><tr><td style="text-align:center">Connection</td><td style="text-align:center">Expect</td><td style="text-align:center">Transfer-Encoding</td></tr><tr><td style="text-align:center">Content-Length</td><td style="text-align:center">Host</td><td style="text-align:center">Upgrade</td></tr><tr><td style="text-align:center">Cookie</td><td style="text-align:center">Keep-Alive</td><td style="text-align:center">User-Agent</td></tr><tr><td style="text-align:center">Cookie2</td><td style="text-align:center">Referer</td><td style="text-align:center">Via</td></tr></tbody></table><blockquote><p>open() ä¼ é€’ç¬¬3ä¸ªå‚æ•° ä¸º false, send()æ–¹æ³•é˜»å¡,ä»¥åŒæ­¥å“åº”</p></blockquote><blockquote><p>open() çš„ç¬¬4ä¸ªå’Œç¬¬5ä¸ªå‚æ•°ä¸ºç”¨æˆ·åå’Œå¯†ç , è¯·æ±‚ä¸€ä¸ªå—å¯†ç ä¿æŠ¤çš„URL  </p></blockquote><h2 id="send"><a href="#send" class="headerlink" title="send()"></a>send()</h2><blockquote><p>GETè¯·æ±‚æ²¡æœ‰ä¸»ä½“, è®¾ç½®ä¸ºnullä¼šçœç•¥è¿™ä¸ªå‚æ•°<br>request.send(null)</p></blockquote><h2 id="é¡ºåº"><a href="#é¡ºåº" class="headerlink" title="é¡ºåº:"></a>é¡ºåº:</h2><ol><li>è¯·æ±‚æ–¹æ³•å’ŒURL</li><li>è¯·æ±‚å¤´</li><li>è¯·æ±‚ä¸»ä½“  </li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">postMessage</span>(<span class="params">msg</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> request = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">    <span class="comment">// è¯·æ±‚æ–¹æ³•å’ŒURL</span></span><br><span class="line">    request.open(<span class="string">"POST"</span>, <span class="string">"/log.php"</span>);</span><br><span class="line">    <span class="comment">// è¯·æ±‚å¤´</span></span><br><span class="line">    request.setRequestHeader(<span class="string">"Content-Type"</span>, <span class="string">"text/plain;charset=UTF-8"</span>);</span><br><span class="line">    <span class="comment">// è¯·æ±‚ä¸»ä½“</span></span><br><span class="line">    request.send(msg);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å“åº”"><a href="#å“åº”" class="headerlink" title="å“åº”"></a>å“åº”</h2><blockquote><p>statuså’ŒstatusTextä»¥æ•°å­—å’Œæ–‡æœ¬çš„å½¢å¼è¿”å›HTTPçŠ¶æ€ç </p></blockquote><blockquote><p>getResponseHeader() å’Œ getAllResponseHeaders() èƒ½æŸ¥è¯¢å“åº”å¤´</p><blockquote><p>getAllResponseHeaders() ä¼šè¿‡æ»¤æ‰cookieå¤´<br>getResponseHeader() ä¼ é€’ Set-Cookie æˆ– Set-Cookie2 è¿”å›null</p></blockquote></blockquote><blockquote><p>responseText ä»¥æ–‡æœ¬å½¢å¼è¿”å›å“åº”ä¸»ä½“</p></blockquote><h3 id="readyState"><a href="#readyState" class="headerlink" title="readyState"></a>readyState</h3><table><thead><tr><th style="text-align:center">å¸¸é‡(IE9+)</th><th style="text-align:center">å€¼</th><th style="text-align:center">å«ä¹‰</th></tr></thead><tbody><tr><td style="text-align:center">UNSENT</td><td style="text-align:center">0</td><td style="text-align:center">open() å°šæœªè°ƒç”¨</td></tr><tr><td style="text-align:center">OPENED</td><td style="text-align:center">1</td><td style="text-align:center">open() å·²è°ƒç”¨</td></tr><tr><td style="text-align:center">HEADERS_RECEIVED</td><td style="text-align:center">2</td><td style="text-align:center">æ¥æ”¶åˆ°å¤´ä¿¡æ¯</td></tr><tr><td style="text-align:center">LOADING</td><td style="text-align:center">3</td><td style="text-align:center">æ¥æ”¶åˆ°å“åº”ä¸»ä½“</td></tr><tr><td style="text-align:center">DONE</td><td style="text-align:center">4</td><td style="text-align:center">å“åº”å®Œæˆ</td></tr></tbody></table><h3 id="onreadystatechange"><a href="#onreadystatechange" class="headerlink" title="onreadystatechange"></a>onreadystatechange</h3><blockquote><p>readystatechangeäº‹ä»¶åœ¨å®é™…ä¸­æ”¹å˜ä¸º0æˆ–1æ—¶å¯èƒ½æ²¡æœ‰è§¦å‘è¿™ä¸ªäº‹ä»¶;<br>å½“è°ƒç”¨send()äº‹ä»¶æ—¶,å³ä½¿å¤„äºOPENEDçŠ¶æ€ä¹Ÿè§¦å‘</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¼‚æ­¥getè¯·æ±‚è·å–text</span></span><br><span class="line"><span class="comment"> * @param url</span></span><br><span class="line"><span class="comment"> * @param callback å›è°ƒå‡½æ•°</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getText</span>(<span class="params">url, callback</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> request = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">    request.open(<span class="string">"GET"</span>, url);</span><br><span class="line">    request.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// è¯·æ±‚å®Œæˆ                     çŠ¶æ€ç ä¸º200</span></span><br><span class="line">        <span class="keyword">if</span> (request.readyState === <span class="number">4</span> &amp;&amp; request.status === <span class="number">200</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> type = request.getResponseHeader(<span class="string">"Content-Type"</span>);</span><br><span class="line">            <span class="keyword">if</span> (type.match(<span class="regexp">/^text/</span>)) &#123;</span><br><span class="line">                callback(request.responseText);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    request.send(<span class="literal">null</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åŒæ­¥å“åº”</span></span><br><span class="line"><span class="comment"> * @param url</span></span><br><span class="line"><span class="comment"> * @returns &#123;string&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getTextSync</span>(<span class="params">url</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> request = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">    <span class="comment">// ç¬¬3ä¸ªå‚æ•°ä¸ºfalseå®ç°åŒæ­¥</span></span><br><span class="line">    request.open(<span class="string">"GET"</span>, url, <span class="literal">false</span>);</span><br><span class="line">    <span class="comment">// å‘é€è¯·æ±‚</span></span><br><span class="line">    request.send(<span class="literal">null</span>);</span><br><span class="line">    <span class="comment">// é˜»å¡çº¿ç¨‹è¿è¡Œ; ä¸éœ€è¦readystatechangeäº‹ä»¶</span></span><br><span class="line">    <span class="keyword">if</span> (request.status !== <span class="number">200</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(request.statusText);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> type = request.getResponseHeader(<span class="string">"Content-Type"</span>);</span><br><span class="line">    <span class="keyword">if</span> (!type.match(<span class="regexp">/^text/</span>)) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"Expected textual response; got: "</span> + type);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> request.responseText;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç¼–ç è¯·æ±‚ä¸»ä½“"><a href="#ç¼–ç è¯·æ±‚ä¸»ä½“" class="headerlink" title="ç¼–ç è¯·æ±‚ä¸»ä½“"></a>ç¼–ç è¯·æ±‚ä¸»ä½“</h2><h3 id="è¡¨å•ç¼–ç è¯·æ±‚"><a href="#è¡¨å•ç¼–ç è¯·æ±‚" class="headerlink" title="è¡¨å•ç¼–ç è¯·æ±‚"></a>è¡¨å•ç¼–ç è¯·æ±‚</h3><blockquote><p>è¡¨å•æ•°æ®POSTæ˜¯å¿…é¡»è®¾ç½® <code>Content-type</code><br>è¡¨å•æ•°æ®ç¼–ç æ ¼å¼MIMEç±»å‹:<br><code>appliaction/x-www-form-urlencoded</code></p></blockquote><h3 id="JSONç¼–ç è¯·æ±‚"><a href="#JSONç¼–ç è¯·æ±‚" class="headerlink" title="JSONç¼–ç è¯·æ±‚"></a>JSONç¼–ç è¯·æ±‚</h3><blockquote><p><code>application/json</code></p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">postJSON</span>(<span class="params">url, data, callback</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> request = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">    request.open(<span class="string">"POST"</span>, url);</span><br><span class="line">    request.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (request.readyState === <span class="number">4</span> &amp;&amp; callback)</span><br><span class="line">            callback(request);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// è®¾ç½®è¯·æ±‚å¤´</span></span><br><span class="line">    request.setRequestHeader(<span class="string">"Content-Type"</span>, <span class="string">"application/json"</span>);</span><br><span class="line">    request.send(<span class="built_in">JSON</span>.stringify(data));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è‡ªåŠ¨è®¾ç½®"><a href="#è‡ªåŠ¨è®¾ç½®" class="headerlink" title="è‡ªåŠ¨è®¾ç½®"></a>è‡ªåŠ¨è®¾ç½®</h3><blockquote><p>ç»™send()ä¼ å…¥XMLæ–‡æ¡£,è‡ªåŠ¨è®¾ç½®ä¸€ä¸ªåˆé€‚çš„å¤´<br>ç»™send()ä¼ å…¥å­—ç¬¦ä¸²å¹¶ä¸”æ²¡æœ‰æŒ‡å®š <code>Content-Type</code> å¤´, è‡ªåŠ¨æ·»åŠ  <code>text/plain; charset=UTF-8</code></p></blockquote><h2 id="ä¸Šä¼ æ–‡ä»¶"><a href="#ä¸Šä¼ æ–‡ä»¶" class="headerlink" title="ä¸Šä¼ æ–‡ä»¶"></a>ä¸Šä¼ æ–‡ä»¶</h2><blockquote><p>XHR2å…è®¸å‘send()æ–¹æ³•ä¼ å…¥ä»»ä½•Blobå¯¹è±¡</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä½¿ç”¨POSTè¯·æ±‚ä¸Šä¼ æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">var</span> whenReady = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> funcs = [];</span><br><span class="line">    <span class="keyword">var</span> ready = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">handler</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (ready) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (e.type === <span class="string">"readystatechange"</span> &amp;&amp; <span class="built_in">document</span>.readyState !== <span class="string">"complete"</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; funcs.length; i++) &#123;</span><br><span class="line">            funcs[i].call(<span class="built_in">document</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        ready = <span class="literal">true</span>;</span><br><span class="line">        funcs = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">document</span>.addEventListener) &#123;</span><br><span class="line">        <span class="built_in">document</span>.addEventListener(<span class="string">"DOMContentLoaded"</span>, handler, <span class="literal">false</span>);</span><br><span class="line">        <span class="built_in">document</span>.addEventListener(<span class="string">"readystatechange"</span>, handler, <span class="literal">false</span>);</span><br><span class="line">        <span class="built_in">window</span>.addEventListener(<span class="string">"load"</span>, handler, <span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">document</span>.attachEvent) &#123;</span><br><span class="line">        <span class="built_in">document</span>.attachEvent(<span class="string">"onreadystatechange"</span>, handler);</span><br><span class="line">        <span class="built_in">window</span>.attachEvent(<span class="string">"onload"</span>, handler);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">whenReady</span>(<span class="params">f</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (ready) &#123;</span><br><span class="line">            f.call(<span class="built_in">document</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            funcs.push(f);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">whenReady(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> elts = <span class="built_in">document</span>.getElementsByTagName(<span class="string">"input"</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; elts.length; i++) &#123;</span><br><span class="line">        <span class="keyword">var</span> input = elts[i];</span><br><span class="line">        <span class="keyword">if</span> (input.type !== <span class="string">"file"</span>) &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> url = input.getAttribute(<span class="string">"data-uploadto"</span>);</span><br><span class="line">        <span class="keyword">if</span> (!url) &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        input.addEventListener(<span class="string">"change"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> file = <span class="keyword">this</span>.files[<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">if</span> (!file) &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">            xhr.open(<span class="string">"POST"</span>, url);</span><br><span class="line">            xhr.send(file);</span><br><span class="line">        &#125;, <span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="multipart-form-data"><a href="#multipart-form-data" class="headerlink" title="multipart/form-data"></a>multipart/form-data</h2><blockquote><p>å½“HTMLè¡¨å•åŒæ—¶åŒ…å«æ–‡ä»¶ä¸Šä¼ å…ƒç´ å’Œå…¶ä»–å…ƒç´ æ˜¯, ä½¿ç”¨ <code>multipart/form-data</code> çš„ <code>Content-Type</code><br>XHR2å®šä¹‰äº†æ–°çš„ <code>FormData API</code>; ä½¿ç”¨FormData()æ„é€ å‡½æ•°åˆ›å»ºFormDataå¯¹è±¡, append()æ–¹æ³•å¯ä»¥å¤šæ¬¡åŠ å…¥File, å­—ç¬¦ä¸², æˆ–è€… Blobå¯¹è±¡, æŠŠFormDataå¯¹è±¡ä¼ é€’ä¸ªsend()æ–¹æ³•</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">postFormData</span>(<span class="params">url, data, callback</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> FormData === <span class="string">"undefined"</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"FormData is not implemented"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> request = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">    request.open(<span class="string">"POST"</span>, url);</span><br><span class="line">    request.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (request.readyState === <span class="number">4</span> &amp;&amp; callback) &#123;</span><br><span class="line">            callback(request);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> formdata = <span class="keyword">new</span> FormData();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> name <span class="keyword">in</span> data) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!data.hasOwnProperty(name)) &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> value = data[name];</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> value === <span class="string">"function"</span>) &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        formdata.append(name, value);       <span class="comment">// ä½œä¸ºä¸€éƒ¨åˆ†æ·»åŠ å/å€¼å¯¹</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// sendå¯¹è±¡è‡ªåŠ¨è®¾ç½®Content-Typeå¯¹è±¡</span></span><br><span class="line">    request.send(formdata);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="HTTPè¿›åº¦äº‹ä»¶"><a href="#HTTPè¿›åº¦äº‹ä»¶" class="headerlink" title="HTTPè¿›åº¦äº‹ä»¶"></a>HTTPè¿›åº¦äº‹ä»¶</h2><blockquote><p>å®Œæˆè¯·æ±‚è§¦å‘loadäº‹ä»¶<br>è¯·æ±‚è¶…æ—¶è§¦å‘timeoutäº‹ä»¶<br>è¯·æ±‚ä¸­å€¼è§¦å‘abortäº‹ä»¶<br>å¤ªå¤šé‡å®šè¿™æ ·çš„ç½‘ç»œé”™è¯¯å‡ºå•Šå‘erroräº‹ä»¶<br>å¯¹äºå…·ä½“çš„è¯·æ±‚,æµè§ˆå™¨åªå‡ºå‘load/abort/timeout/erroräº‹ä»¶ä¸­çš„ä¸€ä¸ª</p></blockquote><blockquote><p>onprogressäº‹ä»¶æœ‰3ä¸ªæœ‰ç”¨çš„å±æ€§</p><blockquote><p>loaded: ç›®å‰ä¼ è¾“çš„å­—èŠ‚æ•°<br>total: è‡ªâ€™Content-Lengthâ€™å¤´ä¼ è¾“çš„æ•°æ®çš„æ•´ä½“é•¿åº¦,ä¸çŸ¥é“å†…å®¹é•¿åº¦åˆ™ä¸º0<br>lengthComputable: æ˜¯å¦çŸ¥é“å†…å®¹å†…å®¹é•¿åº¦</p></blockquote></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç›‘æ§HTTPä¸Šä¼ è¿›åº¦</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// æŸ¥æ‰¾æ‰€é‡å«æœ‰ fileDropTarget ç±»çš„å…ƒç´ </span></span><br><span class="line"><span class="comment">// å¹¶æ³¨å†ŒDnDäº‹ä»¶å¤„ç†ç¨‹åºæ˜¯çš„å®ƒä»¬èƒ½å“åº”æ–‡ä»¶çš„æ‹–æ”¾</span></span><br><span class="line"><span class="comment">// å½“æ–‡ä»¶æ”¾ä¸‹æ—¶,ä¸ŠåºŠå®ƒä»¬åˆ°data-uploadtoå±æ€§æŒ‡å®šçš„url</span></span><br><span class="line">whenReady(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> elts = <span class="built_in">document</span>.getElementsByClassName(<span class="string">"fileDropTarget"</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; elts.length; i++) &#123;</span><br><span class="line">        <span class="keyword">var</span> target = elts[i];</span><br><span class="line">        <span class="keyword">var</span> url = target.getAttribute(<span class="string">"data-uploadto"</span>);</span><br><span class="line">        <span class="keyword">if</span> (!url) &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        createFileUploadDropTarget(target, url);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">createFileUploadDropTarget</span>(<span class="params">target, url</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// æ˜¯å¦æ­£åœ¨ä¸Šä¼ , å› æ­¤æˆ‘ä»¬èƒ½æ‹’ç»æ”¾ä¸‹</span></span><br><span class="line">        <span class="comment">// æˆ‘ä»¬å¯ä»¥å¤„ç†å¤šä¸ªå¹¶å‘ä¸Šä¼ </span></span><br><span class="line">        <span class="comment">// ä½†å¯¹è¿™ä¸ªä¾‹å­ä½¿ç”¨è¿›åº¦é€šçŸ¥å¤ªéš¾äº†</span></span><br><span class="line">        <span class="keyword">var</span> uploading = <span class="literal">false</span>;</span><br><span class="line">        <span class="built_in">console</span>.log(target, url);</span><br><span class="line">        target.ondragenter = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"dragenter"</span>);</span><br><span class="line">            <span class="keyword">if</span> (uploading) &#123;                <span class="comment">// å¦‚æœæ­£åœ¨å¿™, å¿½ç•¥æ‹–æ”¾</span></span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">var</span> types = e.dataTransfer.types;</span><br><span class="line">            <span class="keyword">if</span> (types &amp;&amp;</span><br><span class="line">                ((types.contains &amp;&amp; types.contains(<span class="string">"Files"</span>)) ||</span><br><span class="line">                (types.indexOf &amp;&amp; types.indexOf(<span class="string">"Files"</span>) !== <span class="number">-1</span>))) &#123;</span><br><span class="line">                target.classList.add(<span class="string">"wantdrop"</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        target.ondragover = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (!uploading) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        target.ondragleave = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (!uploading) &#123;</span><br><span class="line">                target.classList.remove(<span class="string">"wantdrop"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        target.ondrop = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (uploading) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">var</span> files = e.dataTransfer.files;</span><br><span class="line">            <span class="keyword">if</span> (files &amp;&amp; files.length) &#123;</span><br><span class="line">                uploading = <span class="literal">true</span>;</span><br><span class="line">                <span class="keyword">var</span> message = <span class="string">"Uploading files:&lt;ul&gt;"</span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; files.length; i++)</span><br><span class="line">                    message += <span class="string">"&lt;li&gt;"</span> + files[i].name + <span class="string">"&lt;/li&gt;"</span>;</span><br><span class="line">                message += <span class="string">"&lt;/ul&gt;"</span>;</span><br><span class="line"></span><br><span class="line">                target.innerHTML = message;</span><br><span class="line">                target.classList.remove(<span class="string">"wantdrop"</span>);</span><br><span class="line">                target.classList.add(<span class="string">"uploading"</span>);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">                xhr.open(<span class="string">"POST"</span>, url);</span><br><span class="line">                <span class="keyword">var</span> body = <span class="keyword">new</span> FormData();</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; files.length; i++) body.append(i, files[i]);</span><br><span class="line">                xhr.upload.onprogress = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">                    <span class="keyword">if</span> (e.lengthComputable) &#123;</span><br><span class="line">                        target.innerHTML = message +</span><br><span class="line">                            <span class="built_in">Math</span>.round(e.loaded / e.total * <span class="number">100</span>) +</span><br><span class="line">                            <span class="string">"% Complete"</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;;</span><br><span class="line">                xhr.upload.onload = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">                    uploading = <span class="literal">false</span>;</span><br><span class="line">                    target.classList.remove(<span class="string">"uploading"</span>);</span><br><span class="line">                    target.innerHTML = <span class="string">"Drop files to upload"</span>;</span><br><span class="line">                &#125;;</span><br><span class="line">                xhr.send(body);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            target.classList.remove(<span class="string">"wantdrop"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="è¶…æ—¶"><a href="#è¶…æ—¶" class="headerlink" title="è¶…æ—¶"></a>è¶…æ—¶</h2><blockquote><p>XHR2å®šä¹‰äº†timeoutå±æ€§æ¥æŒ‡å®šè¯·æ±‚è‡ªåŠ¨ç»ˆæ­¢åçš„æ¯«ç§’æ•°</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">timedGetText</span>(<span class="params">url, timeout, callback</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> request = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">    <span class="keyword">var</span> timedout = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> timer = setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;                     <span class="comment">//è®¾ç½®è¶…æ—¶</span></span><br><span class="line">            timedout = <span class="literal">true</span>;</span><br><span class="line">            request.abort();</span><br><span class="line">        &#125;,</span><br><span class="line">        timeout);</span><br><span class="line">    request.open(<span class="string">"GET"</span>, url);</span><br><span class="line">    request.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (request.readyState !== <span class="number">4</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (timedout) &#123;             <span class="comment">// å¿½ç•¥ç»ˆæ­¢çš„è¯·æ±‚</span></span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        clearTimeout(timer);</span><br><span class="line">        <span class="keyword">if</span> (request.status === <span class="number">200</span>) &#123;</span><br><span class="line">            callback(request.responseText);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    request.send(<span class="literal">null</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="è·¨åŸŸè¯·æ±‚"><a href="#è·¨åŸŸè¯·æ±‚" class="headerlink" title="è·¨åŸŸè¯·æ±‚"></a>è·¨åŸŸè¯·æ±‚</h2><blockquote><p>XHR2é€šè¿‡åœ¨ HTTPå“åº”ä¸­é€‰æ‹©å‘é€åˆé€‚çš„CORSå…è®¸è·¨åŸŸè®¿é—®ç½‘ç«™<br>å¦‚æœç»™open()æ–¹æ³•ä¼ å…¥ ç”¨æˆ·åå’Œå¯†ç , é‚£ä¹ˆå®ƒä»¬ç»ä¸ä¼šé€šè¿‡è·¨åŸŸè¯·æ±‚å‘é€<br>è·¨åŸŸè¯·æ±‚é€šå¸¸ä¸åŒ…æ‹¬ä»»ä½•å…¶å®ƒç”¨æˆ·è¯ä¹¦: cookieå’ŒHTTPèº«ä»½ä»¤ç‰Œ(token)<br>è®¾ç½® <code>withCredentials</code> å±æ€§ä¸º <code>true</code> æ‰èƒ½å‘é€ç”¨æˆ·è¯ä¹¦(ä¸å¸¸è§)</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä½¿ç”¨ HEAD å’Œ CORS è¯·æ±‚é“¾æ¥çš„è¯¦ç»†ä¿¡æ¯</span></span><br><span class="line">whenReady(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// åˆ¤æ–­æ˜¯å¦æ”¯æŒè·¨åŸŸ</span></span><br><span class="line">    <span class="keyword">var</span> supportsCORS = (<span class="keyword">new</span> XMLHttpRequest()).withCredentials !== <span class="literal">undefined</span>;</span><br><span class="line">    <span class="comment">// éå†æ–‡æ¡£ä¸­é“¾æ¥</span></span><br><span class="line">    <span class="keyword">var</span> links = <span class="built_in">document</span>.getElementsByTagName(<span class="string">'a'</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; links.length; i++) &#123;</span><br><span class="line">        <span class="keyword">var</span> link = links[i];</span><br><span class="line">        <span class="keyword">if</span> (!link.href) &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// è·³è¿‡å·²ç»æœ‰å·¥å…·æç¤ºçš„é“¾æ¥</span></span><br><span class="line">        <span class="keyword">if</span> (link.title) &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å¦‚æœæ˜¯è·¨åŸŸé“¾æ¥</span></span><br><span class="line">        <span class="keyword">if</span> (link.host !== location.host || link.protocol !== location.protocol) &#123;</span><br><span class="line">            link.title = <span class="string">"Off-site link"</span>;</span><br><span class="line">            <span class="keyword">if</span> (!supportsCORS) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ³¨å†Œäº‹ä»¶å¤„ç†, å½“é¼ æ ‡æ‚¬åœæ˜¯ä¸‹è½½é“¾æ¥çš„è¯¦ç»†ä¿¡æ¯</span></span><br><span class="line">        <span class="keyword">if</span> (link.addEventListener) &#123;</span><br><span class="line">            link.addEventListener(<span class="string">"mouseover"</span>, mouseoverHandler, <span class="literal">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            link.attachEvent(<span class="string">"onmouseover"</span>, mouseoverHandler);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">mouseoverHandler</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> link = e.target || e.srcElement;</span><br><span class="line">        <span class="keyword">var</span> url = link.href;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> req = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">        <span class="comment">// ä»…ä»…è¯¢é—®å¤´ä¿¡æ¯</span></span><br><span class="line">        req.open(<span class="string">"HEAD"</span>, url);</span><br><span class="line">        req.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (req.readyState !== <span class="number">4</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (req.status === <span class="number">200</span>) &#123;</span><br><span class="line">                <span class="keyword">var</span> type = req.getResponseHeader(<span class="string">"Content-Type"</span>);</span><br><span class="line">                <span class="keyword">var</span> size = req.getResponseHeader(<span class="string">"Content-Length"</span>);</span><br><span class="line">                <span class="keyword">var</span> date = req.getResponseHeader(<span class="string">"Last-Modified"</span>);</span><br><span class="line"></span><br><span class="line">                link.title = <span class="string">"Type: "</span> + type + <span class="string">"   \n"</span> +</span><br><span class="line">                    <span class="string">"Size: "</span> + size + <span class="string">"   \n"</span> + <span class="string">"Date: "</span> + date;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (!link.title) &#123;</span><br><span class="line">                    link.title = <span class="string">"Couldn't fetch details: \n"</span> +</span><br><span class="line">                        req.status + <span class="string">" "</span> + req.statusText;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        req.send(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç§»é™¤å¤„ç†ç¨‹åº: ä»…æƒ³ä¸€æ¬¡è·å–è¿™äº›å¤´ä¿¡æ¯</span></span><br><span class="line">        <span class="keyword">if</span> (link.removeEventListener) &#123;</span><br><span class="line">            link.removeEventListener(<span class="string">"mouseover"</span>, mouseoverHandler, <span class="literal">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            link.detachEvent(<span class="string">"onmouseover"</span>, mouseoverHandler);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><hr><blockquote><h3 id="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢"><a href="#æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢" class="headerlink" title="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~"></a>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</h3><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScriptæƒå¨æŒ‡å—ç¬”è®°7_è„šæœ¬åŒ–æ–‡æ¡£</title>
      <link href="/2015/04/23/JavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E7%AC%94%E8%AE%B07-%E8%84%9A%E6%9C%AC%E5%8C%96%E6%96%87%E6%A1%A3/"/>
      <url>/2015/04/23/JavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E7%AC%94%E8%AE%B07-%E8%84%9A%E6%9C%AC%E5%8C%96%E6%96%87%E6%A1%A3/</url>
      
        <content type="html"><![CDATA[<p>JavaScriptæƒå¨æŒ‡å—ç¬”è®°7_è„šæœ¬åŒ–æ–‡æ¡£150423<br><a id="more"></a></p><p><code>document.getElementById()</code> åœ¨IE7- ä¸‹åŒ¹é…ID ä¸åŒºåˆ†å¤§å°å†™</p><p><code>document.getElementsByName();</code> å’Œ <code>document.getElementsByTagName();</code> è¿”å› NodeListå¯¹è±¡<br><code>document.images</code>å’Œ <code>document.forms</code> è¿”å› HTMLCollection å¯¹è±¡<br>å®ƒä»¬éƒ½æ˜¯å®æ—¶çš„, ç”Ÿæˆé™æ€å‰¯æœ¬å¦‚ä¸‹:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> snapshot = <span class="built_in">Array</span>.prototype.slice.call(nodelist, <span class="number">0</span>);</span><br></pre></td></tr></table></figure></p><p><code>document.getElementsByClassName()</code> IE9+ æ”¯æŒ<br><code>document.querySelectorAll()</code>       IE8+</p><h1 id="æ–‡æ¡£ç»“æ„"><a href="#æ–‡æ¡£ç»“æ„" class="headerlink" title="æ–‡æ¡£ç»“æ„"></a>æ–‡æ¡£ç»“æ„</h1><h2 id="ä½œä¸ºèŠ‚ç‚¹æ ‘çš„æ–‡æ¡£"><a href="#ä½œä¸ºèŠ‚ç‚¹æ ‘çš„æ–‡æ¡£" class="headerlink" title="ä½œä¸ºèŠ‚ç‚¹æ ‘çš„æ–‡æ¡£"></a>ä½œä¸ºèŠ‚ç‚¹æ ‘çš„æ–‡æ¡£</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">parentNode</span><br><span class="line">childeNodes   <span class="comment">// å®æ—¶</span></span><br><span class="line">firstChild, lastChild</span><br><span class="line">nextSibling previousChild   <span class="comment">// å…„å¼ŸèŠ‚ç‚¹çš„å‰/åä¸€ä¸ª</span></span><br><span class="line">nodeType   <span class="comment">// èŠ‚ç‚¹ç±»å‹</span></span><br><span class="line">    <span class="number">9</span> DocumentèŠ‚ç‚¹</span><br><span class="line">    <span class="number">1</span> ElementèŠ‚ç‚¹</span><br><span class="line">    <span class="number">3</span> Text èŠ‚ç‚¹</span><br><span class="line">    <span class="number">8</span> CommentèŠ‚ç‚¹</span><br><span class="line">    <span class="number">11</span> DocumentFragmentèŠ‚ç‚¹</span><br><span class="line"></span><br><span class="line">nodeValue  Text/Comment èŠ‚ç‚¹çš„æ–‡æœ¬å†…å®¹</span><br><span class="line">nodeName    å…ƒç´ æ ‡ç­¾å(å¤§å†™)</span><br></pre></td></tr></table></figure><h2 id="ä½œä¸ºå…ƒç´ æ ‘çš„èŠ‚ç‚¹"><a href="#ä½œä¸ºå…ƒç´ æ ‘çš„èŠ‚ç‚¹" class="headerlink" title="ä½œä¸ºå…ƒç´ æ ‘çš„èŠ‚ç‚¹"></a>ä½œä¸ºå…ƒç´ æ ‘çš„èŠ‚ç‚¹</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// IEä¸å¯ç”¨</span></span><br><span class="line">firstElementChild lastElementChild</span><br><span class="line">nextElementSibling previousElementChild </span><br><span class="line">childElementCout <span class="comment">// å­å…ƒç´ çš„æ•°é‡</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯ç§»æ¤çš„æ–‡æ¡£éå†å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">parent</span>(<span class="params">e, n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n === <span class="literal">undefined</span>) &#123;</span><br><span class="line">        n = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (n-- &amp;&amp; e) &#123;</span><br><span class="line">        e = e.parentNode;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!e || e.nodeType !== <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> e;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sibling</span>(<span class="params">e, n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (e &amp;&amp; n !== <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (n &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (e.nextElementSibling) &#123;</span><br><span class="line">                e = e.nextElementSibling;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">for</span> (e = e.nextSibling; e &amp;&amp; e.nodeType !== <span class="number">1</span>; e = e.nextSibling) &#123;</span><br><span class="line">                    <span class="comment">/* empty loop */</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            n--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (e.previousElementSibing) &#123;</span><br><span class="line">                e = e.previousElementSibling;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">for</span> (e = e.previousSibling; e &amp;&amp; e.nodeType !== <span class="number">1</span>; e = e.previousSibling) &#123;</span><br><span class="line">                    <span class="comment">/* empty loop */</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            n++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> e;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">child</span>(<span class="params">e, n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (e.children) &#123;</span><br><span class="line">        <span class="keyword">if</span> (n &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            n += e.children.length;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (n &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> e.children[n];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (n &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (e.firstElementChild) &#123;</span><br><span class="line">            e = e.firstElementChild;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (e = e.firstChild; e &amp;&amp; e.nodeType !== <span class="number">1</span>; e = e.nextSibling) &#123;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sibling(e, n);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (e.lastElementChild) &#123;</span><br><span class="line">            e = e.lastElementChild;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (e = e.lastChild; e &amp;&amp; e.nodeType !== <span class="number">1</span>; e = e.previousSibling) &#123;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sibling(e, n + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å±æ€§"><a href="#å±æ€§" class="headerlink" title="å±æ€§"></a>å±æ€§</h1><blockquote><p>HTMLå±æ€§åä¸åŒºåˆ†å¤§å°å†™; è½¬æ¢æˆjsæ—¶éœ€è¦å°å†™; 2ä¸ªä»¥ä¸Šå•è¯çš„å±æ€§åé™¤ç¬¬ä¸€ä¸ªå•è¯ä»¥å¤–çš„å•è¯é¦–å­—æ¯å¤§å†™<br>HTMLå±æ€§ååœ¨jsä¸­ä¸ºä¿ç•™å­—çš„,å±æ€§ååŠ ä¸Šå‰ç¼€â€™htmlâ€™; å¦‚ for å±æ€§,jsä¸­è¡¨ç¤ºä¸º htmlfor<br>classå±æ€§åœ¨jsä¸­ ä¸º className</p></blockquote><h2 id="è·å–è®¾ç½®éæ ‡å‡†HTMLå±æ€§"><a href="#è·å–è®¾ç½®éæ ‡å‡†HTMLå±æ€§" class="headerlink" title="è·å–è®¾ç½®éæ ‡å‡†HTMLå±æ€§"></a>è·å–è®¾ç½®éæ ‡å‡†HTMLå±æ€§</h2><blockquote><p>å±æ€§å€¼éƒ½è¢«çœ‹æˆå­—ç¬¦ä¸²,æ‰€ä»¥getAttribute()å€¼è¿”å›å­—ç¬¦ä¸²<br>æ£€æµ‹å±æ€§hasAttribute; å®Œå…¨åˆ é™¤å±æ€§removeAttribute</p></blockquote><h2 id="æ•°æ®é›†å±æ€§"><a href="#æ•°æ®é›†å±æ€§" class="headerlink" title="æ•°æ®é›†å±æ€§"></a>æ•°æ®é›†å±æ€§</h2><blockquote><p>H5ä¸­,ä»»æ„ä»¥ â€˜data-â€˜ ä¸ºå‰ç¼€çš„å°å†™çš„å±æ€§éƒ½æ˜¯åˆæ³•çš„<br>dataset-xä¿å­˜datat-xçš„å€¼; data-jqueryTestä¿å­˜data-jquery-testçš„å€¼</p></blockquote><h2 id="ä½œä¸ºAttrèŠ‚ç‚¹çš„å±æ€§"><a href="#ä½œä¸ºAttrèŠ‚ç‚¹çš„å±æ€§" class="headerlink" title="ä½œä¸ºAttrèŠ‚ç‚¹çš„å±æ€§"></a>ä½œä¸ºAttrèŠ‚ç‚¹çš„å±æ€§</h2><blockquote><p>Nodeç±»å‹å®šä¹‰äº†attributeså±æ€§<br>é’ˆå¯¹éElementå¯¹è±¡çš„ä»»ä½•èŠ‚ç‚¹,è¯¥å±æ€§ä¸ºnull<br>å¯¹äºElementå¯¹è±¡,attributeså±æ€§æ˜¯åªè¯»çš„,å®æ—¶çš„ç±»æ•°ç»„å¯¹è±¡</p></blockquote><h1 id="å…ƒç´ å†…å®¹"><a href="#å…ƒç´ å†…å®¹" class="headerlink" title="å…ƒç´ å†…å®¹"></a>å…ƒç´ å†…å®¹</h1><h2 id="ä½œä¸ºHTMLçš„å…ƒç´ å†…å®¹"><a href="#ä½œä¸ºHTMLçš„å…ƒç´ å†…å®¹" class="headerlink" title="ä½œä¸ºHTMLçš„å…ƒç´ å†…å®¹"></a>ä½œä¸ºHTMLçš„å…ƒç´ å†…å®¹</h2><blockquote><p>innerHTML ä½¿ç”¨â€™+=â€™ æ“ä½œæ•ˆç‡ä½ä¸‹<br>åªæœ‰ElementèŠ‚ç‚¹å®šä¹‰äº†outerHTMLå±æ€§</p></blockquote><h2 id="ä½œä¸ºçº¯æ–‡æœ¬å…ƒç´ çš„å†…å®¹"><a href="#ä½œä¸ºçº¯æ–‡æœ¬å…ƒç´ çš„å†…å®¹" class="headerlink" title="ä½œä¸ºçº¯æ–‡æœ¬å…ƒç´ çš„å†…å®¹"></a>ä½œä¸ºçº¯æ–‡æœ¬å…ƒç´ çš„å†…å®¹</h2><blockquote><p>æŸ¥è¯¢çº¯æ–‡æœ¬å…ƒç´ å†…å®¹ä½¿ç”¨ Nodeçš„textContent; IEä¸­ä½¿ç”¨innerText<br>innerTextä¸è¿”å›<script> å…ƒç´ å†…å®¹,é’ˆå¯¹ <table> <tr> <td> ä¸ºåªè¯»å±æ€§</p></blockquote><h2 id="ä½œä¸ºTextèŠ‚ç‚¹çš„å…ƒç´ å†…å®¹"><a href="#ä½œä¸ºTextèŠ‚ç‚¹çš„å…ƒç´ å†…å®¹" class="headerlink" title="ä½œä¸ºTextèŠ‚ç‚¹çš„å…ƒç´ å†…å®¹"></a>ä½œä¸ºTextèŠ‚ç‚¹çš„å…ƒç´ å†…å®¹</h2><blockquote><p>nodeValue å±æ€§å¯ä»¥è¯»/å†™, å¯ä»¥æ”¹å˜TextèŠ‚ç‚¹æ‰€æ˜¾ç¤ºçš„å†…å®¹</p></blockquote><h1 id="åˆ›å»º-æ’å…¥-åˆ é™¤èŠ‚ç‚¹"><a href="#åˆ›å»º-æ’å…¥-åˆ é™¤èŠ‚ç‚¹" class="headerlink" title="åˆ›å»º/æ’å…¥/åˆ é™¤èŠ‚ç‚¹"></a>åˆ›å»º/æ’å…¥/åˆ é™¤èŠ‚ç‚¹</h1><h2 id="åˆ›å»ºèŠ‚ç‚¹"><a href="#åˆ›å»ºèŠ‚ç‚¹" class="headerlink" title="åˆ›å»ºèŠ‚ç‚¹"></a>åˆ›å»ºèŠ‚ç‚¹</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">///TextèŠ‚ç‚¹</span></span><br><span class="line"><span class="built_in">document</span>.createTextNode(<span class="string">'text node content'</span>);</span><br></pre></td></tr></table></figure><blockquote><p>æ¯ä¸€ä¸ªå‡ ç‚¹éƒ½æœ‰ cloneNode()æ–¹æ³•, è¿”å›è¯¥èŠ‚ç‚¹çš„ä¸€ä¸ªå…¨æ–°å‰¯æœ¬<br>ä¼ é€’å‚æ•° true èƒ½åœ°é¬¼å¤åˆ¶æ‰€æœ‰åä»£èŠ‚ç‚¹</p></blockquote><h2 id="æ’å…¥èŠ‚ç‚¹"><a href="#æ’å…¥èŠ‚ç‚¹" class="headerlink" title="æ’å…¥èŠ‚ç‚¹"></a>æ’å…¥èŠ‚ç‚¹</h2><blockquote><p>Nodeçš„æ–¹æ³• appendChild() å’Œ insertBefore()<br>åœ¨å·²å­˜åœ¨çš„æ–‡æ¡£ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹å†æ¬¡æ’å…¥,é‚£ä¸ªèŠ‚ç‚¹å°†è‡ªåŠ¨ä»å®ƒå½“å‰çš„ä½ç½®åˆ é™¤å¹¶åœ¨æ–°çš„ä½ç½®é‡æ–°æ’å…¥</p></blockquote><h2 id="åˆ é™¤æ›¿æ¢èŠ‚ç‚¹"><a href="#åˆ é™¤æ›¿æ¢èŠ‚ç‚¹" class="headerlink" title="åˆ é™¤æ›¿æ¢èŠ‚ç‚¹"></a>åˆ é™¤æ›¿æ¢èŠ‚ç‚¹</h2><blockquote><p>removeChild() ä»æ–‡æ¡£ä¸­åˆ é™¤ä¸€ä¸ªèŠ‚ç‚¹<br>replaceChild() åˆ é™¤ ä¸€ä¸ªå­èŠ‚ç‚¹å¹¶ç”¨æ–°èŠ‚ç‚¹æ›¿ä»£<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node.parentNode.replaceChild(<span class="built_in">document</span>.createTextNode(<span class="string">'new TextNode'</span>), node)</span><br></pre></td></tr></table></figure></p></blockquote><h1 id="åæ ‡"><a href="#åæ ‡" class="headerlink" title="åæ ‡"></a>åæ ‡</h1><blockquote><p>æ–‡æ¡£åæ ‡,ç›¸å¯¹äºæ–‡æ¡£å·¦ä¸Šè§’<br>è§†å£åæ ‡, ç›¸å¯¹äºæµè§ˆå™¨å»é™¤å¤–å£³çš„å·¦ä¸Šè§’</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æŸ¥è¯¢çª—å£æ»šåŠ¨æ¡ä½ç½®</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getScrollOffsets</span>(<span class="params">w</span>) </span>&#123;</span><br><span class="line">    w = w || <span class="built_in">window</span>;</span><br><span class="line">    <span class="comment">// ç°ä»£æµè§ˆå™¨ IE9+</span></span><br><span class="line">    <span class="keyword">if</span> (w.pageXOffset != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="attr">x</span>: w.pageXOffset, <span class="attr">y</span>: w.pageYOffset&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// IE8-</span></span><br><span class="line">    <span class="keyword">var</span> d = w.document;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">document</span>.compatMode == <span class="string">"CSS1Compat"</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            x: d.documentElement.scrollLeft,</span><br><span class="line">            y: d.documentElement.scrollTop</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ€ªå¼‚æ¨¡å¼ä¸‹</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        x: d.body.scrollLeft,</span><br><span class="line">        y: d.body.scrollTop</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æŸ¥è¯¢çª—å£è§†å£å°ºå¯¸</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getViewportSize</span>(<span class="params">w</span>) </span>&#123;</span><br><span class="line">    w = w || <span class="built_in">window</span>;</span><br><span class="line">    <span class="comment">// ç°ä»£æµè§ˆå™¨ IE9+</span></span><br><span class="line">    <span class="keyword">if</span> (w.innerWidth != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="attr">w</span>: w.innerWidth, <span class="attr">h</span>: w.innerHeight&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// IE8-</span></span><br><span class="line">    <span class="keyword">var</span> d = w.document;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">document</span>.compatMode == <span class="string">"CSS1Compat"</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            w: d.documentElement.clientWidth,</span><br><span class="line">            h: d.documentElement.clientHeight</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ€ªå¼‚æ¨¡å¼ä¸‹</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        w: d.body.clientWidth,</span><br><span class="line">        h: d.body.clientWidth</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æŸ¥è¯¢å…ƒç´ çš„å‡ ä½•å°ºå¯¸"><a href="#æŸ¥è¯¢å…ƒç´ çš„å‡ ä½•å°ºå¯¸" class="headerlink" title="æŸ¥è¯¢å…ƒç´ çš„å‡ ä½•å°ºå¯¸"></a>æŸ¥è¯¢å…ƒç´ çš„å‡ ä½•å°ºå¯¸</h2><blockquote><p>getBoundingClientRect() è¿”å›å…ƒç´   left right top å’Œ bottomçš„å¯¹è±¡; ç°ä»£æµè§ˆå™¨è¿˜åŒ…æ‹¬widthå’Œheight<br>æŸ¥è¯¢å†…è”å…ƒç´ æ¯ä¸ªç‹¬ç«‹ä¸¾è¡Œ: getClientRects()</p></blockquote><h2 id="æ»šåŠ¨"><a href="#æ»šåŠ¨" class="headerlink" title="æ»šåŠ¨"></a>æ»šåŠ¨</h2><blockquote><p>scrollTo() / scrollBy()</p></blockquote><h2 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è·å– e çš„ä½ç½®  </span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getElePosition</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> x = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> y = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (e != <span class="literal">null</span>) &#123;</span><br><span class="line">        x += e.offsetLeft;</span><br><span class="line">        y += e.offsetTop;</span><br><span class="line">        e = e.offsetParent;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        x: x,</span><br><span class="line">        y: y</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è·å–æ–‡æ¡£é€‰å–å†…å®¹</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getSelection</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">window</span>.getSelection ? <span class="built_in">window</span>.getSelection().toString() : <span class="built_in">document</span>.selection.createRange().text;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¹äº æ–‡æœ¬è¾“å…¥åŸŸå’Œ textarea  // IE9+</span></span><br><span class="line">el.value.substring(el.selectionStart, el.selectionEnd);</span><br></pre></td></tr></table></figure><hr><blockquote><h3 id="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢"><a href="#æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢" class="headerlink" title="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~"></a>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</h3><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote></script></p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨nodejs è¸©å‘å¾®ä¿¡JS-SDKè®°å½•</title>
      <link href="/2015/04/22/%E4%BD%BF%E7%94%A8nodejs-%E8%B8%A9%E5%9D%91%E5%BE%AE%E4%BF%A1JS-SDK%E8%AE%B0%E5%BD%95/"/>
      <url>/2015/04/22/%E4%BD%BF%E7%94%A8nodejs-%E8%B8%A9%E5%9D%91%E5%BE%AE%E4%BF%A1JS-SDK%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<p>ä½¿ç”¨nodejs è¸©å‘å¾®ä¿¡JS-SDKè®°å½•<br><a id="more"></a></p><h1 id="JS-SDK-è¦ç‚¹"><a href="#JS-SDK-è¦ç‚¹" class="headerlink" title="JS-SDK è¦ç‚¹"></a>JS-SDK è¦ç‚¹</h1><ol><li><p>å¾®ä¿¡æµ‹è¯•å·; æ‰«ç ç™»å½•;æ— éœ€è®¤è¯(åªæ˜¯åç§°ç»Ÿä¸€ä¸ºå¾®ä¿¡æµ‹è¯•å·)<br><a href="http://mp.weixin.qq.com/debug/cgi-bin/sandbox?t=sandbox/login" target="_blank" rel="noopener">http://mp.weixin.qq.com/debug/cgi-bin/sandbox?t=sandbox/login</a></p></li><li><p>JS-SDK è¯´æ˜æ–‡æ¡£<br><a href="http://mp.weixin.qq.com/wiki/7/aaa137b55fb2e0456bf8dd9148dd613f.html#JSSDK.E4.BD.BF.E7.94.A8.E6.AD.A5.E9.AA.A4" target="_blank" rel="noopener">http://mp.weixin.qq.com/wiki/7/aaa137b55fb2e0456bf8dd9148dd613f.html#JSSDK.E4.BD.BF.E7.94.A8.E6.AD.A5.E9.AA.A4</a></p></li><li><p>ç­¾åéªŒè¯</p><blockquote><p>è·å–token</p></blockquote></li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getToken</span>(<span class="params">config, cb</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> tokenUrl = <span class="string">'https://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential&amp;appId='</span> + config.appId + <span class="string">'&amp;secret='</span> + config.appSecret;</span><br><span class="line">    request.get(tokenUrl, <span class="function"><span class="keyword">function</span>(<span class="params">error, response, body</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (error) &#123;</span><br><span class="line">            cb(<span class="string">'getToken error'</span>, error);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">var</span> token = <span class="built_in">JSON</span>.parse(body).access_token;</span><br><span class="line">                cb(<span class="literal">null</span>, token);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">                cb(<span class="string">'getToken error'</span>, e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è·å–ticket</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getNewTicket</span>(<span class="params">token, cb</span>) </span>&#123;</span><br><span class="line">    request.get(<span class="string">'https://api.weixin.qq.com/cgi-bin/ticket/getticket?access_token='</span> + token + <span class="string">'&amp;type=jsapi'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">error, res, body</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (error) &#123;</span><br><span class="line">            cb(<span class="string">'getNewTicket error'</span>, error);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">var</span> ticket = <span class="built_in">JSON</span>.parse(body).ticket;</span><br><span class="line">                cb(<span class="literal">null</span>, ticket);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">                cb(<span class="string">'getNewTicket error'</span>, e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ç”ŸæˆJS-SDKæƒé™éªŒè¯çš„ç­¾åäº†</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getTimesTamp</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">parseInt</span>(<span class="keyword">new</span> <span class="built_in">Date</span>().getTime() / <span class="number">1000</span>) + <span class="string">''</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getNonceStr</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Math</span>.random().toString(<span class="number">36</span>).substr(<span class="number">2</span>, <span class="number">15</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> timestamp = getTimesTamp();</span><br><span class="line"><span class="keyword">var</span> noncestr = getNonceStr();</span><br><span class="line"><span class="keyword">var</span> str = <span class="string">'jsapi_ticket='</span> + result + <span class="string">'&amp;noncestr='</span>+ noncestr+<span class="string">'&amp;timestamp='</span> + timestamp + <span class="string">'&amp;url='</span> + u;</span><br><span class="line"><span class="built_in">console</span>.log(str);</span><br><span class="line"><span class="keyword">var</span> signature = crypto.createHash(<span class="string">'sha1'</span>).update(str).digest(<span class="string">'hex'</span>);</span><br><span class="line">cb(<span class="literal">null</span>, &#123;</span><br><span class="line">    appId: config.appId,</span><br><span class="line">    timestamp: timestamp,</span><br><span class="line">    nonceStr: noncestr,</span><br><span class="line">    signature: signature</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h1 id="è¸©è¿‡çš„å‘"><a href="#è¸©è¿‡çš„å‘" class="headerlink" title="è¸©è¿‡çš„å‘"></a>è¸©è¿‡çš„å‘</h1><ol><li>å®˜æ–¹æä¾›çš„  å¾®ä¿¡ JS æ¥å£ç­¾åæ ¡éªŒå·¥å…·<a href="http://mp.weixin.qq.com/debug/cgi-bin/sandbox?t=jsapisign" target="_blank" rel="noopener">http://mp.weixin.qq.com/debug/cgi-bin/sandbox?t=jsapisign</a>ä¸­æœ‰ä¸€å¥è¯ <code>å¯¹äºæ²¡æœ‰åªæœ‰åŸŸåæ²¡æœ‰ path çš„ URL ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨åŠ ä¸Š / ä½œä¸º pathï¼Œå¦‚æ‰“å¼€ http://qq.com åˆ™è·å–åˆ°çš„ URL ä¸º http://qq.com/ï¼‰</code>æˆ‘å¾ˆ2çš„åœ¨æ‰€æœ‰URLæœ€ååŠ å…¥ <code>/</code>   (â”¬ï¼¿â”¬);</li><li><code>timesTamp</code> ä¸º  <code>parseInt(new Date().getTime() / 1000) + &#39;&#39;;</code></li><li><a href="http://mp.weixin.qq.com/debug/cgi-bin/sandboxinfo?action=showinfo&amp;t=sandbox/index" target="_blank" rel="noopener">JSæ¥å£å®‰å…¨åŸŸå</a>é…ç½®ä¸­,æ˜¯é…ç½®åŸŸå+ç«¯å£,ä¸æ˜¯ç½‘å€!!<br>æ‰€ä»¥ <code>416973.dowei8.com:21119/tt</code> ç±»ä¼¼çš„ç½‘å€åªèƒ½é…ç½®ä¸º<code>dowei8.com:21119</code></li><li>å¾®ä¿¡æœ‰ç¼“å­˜â€¦. æœ‰æ—¶æ˜¯ç¼“å­˜é—®é¢˜â€¦â€¦â€¦</li></ol><h1 id="å®Œæ•´ä»£ç "><a href="#å®Œæ•´ä»£ç " class="headerlink" title="å®Œæ•´ä»£ç "></a>å®Œæ•´ä»£ç </h1><h2 id="ä¸‹è½½åœ°å€-http-git-oschina-net-xinshangshangxin-node-JS-SDK-signature"><a href="#ä¸‹è½½åœ°å€-http-git-oschina-net-xinshangshangxin-node-JS-SDK-signature" class="headerlink" title="ä¸‹è½½åœ°å€: http://git.oschina.net/xinshangshangxin/node_JS-SDK_signature"></a>ä¸‹è½½åœ°å€: <a href="http://git.oschina.net/xinshangshangxin/node_JS-SDK_signature" target="_blank" rel="noopener">http://git.oschina.net/xinshangshangxin/node_JS-SDK_signature</a></h2><blockquote><p>æ˜ å°„å¤–ç½‘/ä¸Šä¼ æœåŠ¡å™¨<br><code>npm install</code> å®‰è£…ä¾èµ–åŒ…<br><code>node index.js</code> è¿è¡Œä¸»ç¨‹åº<br>é…ç½® <a href="http://mp.weixin.qq.com/debug/cgi-bin/sandboxinfo?action=showinfo&amp;t=sandbox/index" target="_blank" rel="noopener">JSæ¥å£å®‰å…¨åŸŸå</a><br>å¾®ä¿¡è®¿é—®</p></blockquote><h2 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h2><ul><li><a href="https://github.com/willian12345/wechat-JS-SDK-demo" target="_blank" rel="noopener">https://github.com/willian12345/wechat-JS-SDK-demo</a></li></ul><hr><blockquote><h3 id="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢"><a href="#æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢" class="headerlink" title="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~"></a>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</h3><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
            <tag> node </tag>
            
            <tag> wechat </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è§£å†³provisional headers are shownçš„è¿‡ç¨‹</title>
      <link href="/2015/04/20/%E8%A7%A3%E5%86%B3provisional-headers-are-shown%E7%9A%84%E8%BF%87%E7%A8%8B/"/>
      <url>/2015/04/20/%E8%A7%A3%E5%86%B3provisional-headers-are-shown%E7%9A%84%E8%BF%87%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<p>è§£å†³provisional headers are shownçš„è¿‡ç¨‹<br><a id="more"></a></p><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>å­¦ä¹ Angularæ—¶å†™äº†ä¸€ä¸ªéŸ³ä¹æ’­æ”¾å™¨<br><a href="http://git.oschina.net/xinshangshangxin/ngMusic" target="_blank" rel="noopener">oschinaåœ°å€</a><br><a href="https://github.com/xinshangshangxin/ngMusic" target="_blank" rel="noopener">githubåœ°å€</a><br>ä¸ºäº†å…¼å®¹android chrome,<a href="http://hi.baidu.com/hf_zd/item/f65a68b8868a377e254b09a5" target="_blank" rel="noopener">å‚è€ƒäº†è¿™ç¯‡æ–‡ç« </a>;</p><blockquote><p>åœ¨æ•°æ®è¯»å–ä¸­è¦ä¸­æ–­çš„æ—¶å€™ï¼Œå¯ä»¥æŠŠaudio.srcè®¾ä¸ºnullï¼Œå¹¶æ˜¾å¼è°ƒç”¨audio.load()ï¼Œ<br>æ­¤æ—¶å¯¹äºAndroidä¼šä¸­æ–­æ•°æ®è¯»å–ï¼Œå¹¶ä¸”canplayä¹Ÿä¸ä¼šå‘ç”Ÿ</p></blockquote><p>æ‰€ä»¥åœ¨æˆ‘çš„ä»£ç ä¸­ä¹Ÿå¦‚æ­¤ä½¿ç”¨äº†</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">_audio.src = <span class="literal">null</span>;</span><br><span class="line">_audio.load();</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯ç”±äºç™¾åº¦æœ‰äº›éŸ³ä¹æ— æ³•ç›´æ¥æ’­æ”¾;éœ€è¦æœåŠ¡å™¨è½¬å‘,æ‰€ä»¥éŸ³ä¹é“¾æ¥å¸¦ä¸Šäº†æœåŠ¡å™¨è½¬å‘åœ°å€</p><h1 id="é—®é¢˜å‡ºç°"><a href="#é—®é¢˜å‡ºç°" class="headerlink" title="é—®é¢˜å‡ºç°"></a>é—®é¢˜å‡ºç°</h1><p>åœ¨å‰é¢å‡ é¦–æ­Œä¸Šå¸¦ä¸Šè½¬å‘æ²¡æœ‰é—®é¢˜;ä½†æ˜¯å½“åˆ—è¡¨å¾ªç¯å;å°±å‡ºç°äº†æ— æ³•ä»æœåŠ¡å™¨ä¸Šè·å–éŸ³ä¹å†…å®¹äº†;<br>æŸ¥çœ‹chromeæ§åˆ¶å°,é“¾æ¥ä¸Šæ˜¾ç¤º <code>Provisional headers are shown</code></p><figure class="image-box">                <img src="/img/chrome/error.png" alt="error" title="" class="">                <p>error</p>            </figure><p>å…³é—­æ ‡ç­¾;é‡æ–°æ‰“å¼€ç½‘å€;éŸ³ä¹æœ‰åˆå¯ä»¥åŠ è½½äº†!!!</p><h1 id="å°è¯•è¿‡ç¨‹"><a href="#å°è¯•è¿‡ç¨‹" class="headerlink" title="å°è¯•è¿‡ç¨‹"></a>å°è¯•è¿‡ç¨‹</h1><p>åˆšå¼€å§‹ä»¥ä¸ºæ˜¯å› ä¸ºæœ¬åœ°ç¯å¢ƒçš„é—®é¢˜;å°†ä»£ç æŒ‚åœ¨åˆ°æœåŠ¡å™¨ä¸Š,ä¾ç„¶æœ‰é—®é¢˜<br>å¼€å§‹è°·æ­Œæœç´¢ <code>Provisional headers are shown</code>, åœ¨è¿™ç¯‡æ–‡ç« ä¸­<a href="http://segmentfault.com/q/1010000000364871" target="_blank" rel="noopener">http://segmentfault.com/q/1010000000364871</a>  </p><blockquote><p>ä¹‹æ‰€ä»¥ä¼šå‡ºç°è¿™ä¸ªè­¦å‘Šï¼Œæ˜¯å› ä¸ºå»è·å–è¯¥èµ„æºçš„è¯·æ±‚å…¶å®å¹¶ï¼ˆè¿˜ï¼‰æ²¡æœ‰çœŸçš„å‘ç”Ÿï¼Œæ‰€ä»¥ Header é‡Œæ˜¾ç¤ºçš„æ˜¯ä¼ªä¿¡æ¯ï¼Œç›´åˆ°æœåŠ¡å™¨çœŸçš„æœ‰å“åº”è¿”å›ï¼Œè¿™é‡Œçš„ Header ä¿¡æ¯æ‰ä¼šè¢«æ›´æ–°ä¸ºçœŸå®çš„ã€‚ä¸è¿‡è¿™ä¸€åˆ‡ä¹Ÿå¯èƒ½ä¸ä¼šå‘ç”Ÿï¼Œå› ä¸ºè¯¥è¯·æ±‚å¯èƒ½ä¼šè¢«å±è”½ã€‚æ¯”å¦‚è¯´ AdBlock ä»€ä¹ˆçš„ï¼Œå½“ç„¶äº†ä¸å…¨æ˜¯æµè§ˆå™¨æ‰©å±•ï¼Œå…·ä½“æƒ…å†µå…·ä½“åˆ†æäº†</p></blockquote><p>ä½†æ˜¯æˆ‘æµ‹è¯•çš„æµè§ˆå™¨åªæœ‰å¼€å‘å·¥å…·,æ²¡æœ‰ AdBlockä¹‹ç±»çš„;æ‰€ä»¥pass</p><p>æ¥ç€ æœ‰æ‰¾åˆ°è¿™ç¯‡æ–‡ç« <a href="https://code.google.com/p/chromium/issues/detail?id=327581" target="_blank" rel="noopener">https://code.google.com/p/chromium/issues/detail?id=327581</a></p><blockquote><p>That is because websockets never report their requestHeadersText.<br>Fixed for the new implementation.</p></blockquote><p>åœ¨æ–°ç‰ˆæœ¬ä¸­ä¿®å¤â€¦ æˆ‘çš„chromeæ˜¯42;æ‰€ä»¥ pass</p><p>æ¥ç€åœ¨<a href="http://stackoverflow.com/questions/21177387/caution-provisional-headers-are-shown-in-chrome-debugger" target="_blank" rel="noopener">http://stackoverflow.com/questions/21177387/caution-provisional-headers-are-shown-in-chrome-debugger</a><br>å‘ç°æ¨èç­”æ¡ˆä¾ç„¶æ˜¯ AdBlockç­‰ä¹‹ç±»çš„æ‹¦æˆª, ç»§ç»­çœ‹å›ç­”, è¯´ä½¿ç”¨ <code>chrome://net-internals</code>; ç©äº†ä¸‹,æ ¹æœ¬å°±ä¸çŸ¥é“æ€ä¹ˆç©,pass</p><h1 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h1><p>æ¥ç€å¾€ä¸‹æŸ¥çœ‹ å‘ç°æœ‰ä¸ªå›ç­”</p><blockquote><p>I believe it happens when the actual request is not sent. Usually happens when you are loading a cached resource.</p></blockquote><p>å›ç­”å†…å®¹æ˜¯è¯´è¯·æ±‚æ²¡æœ‰è¢«å‘é€,å› ä¸ºæ˜¯è½½å…¥ç¼“å­˜èµ„æº.<br>ä¸€æƒ³å¾ˆå¯¹å•Š,éŸ³ä¹èµ„æºé»˜è®¤æ˜¯ç¼“å­˜çš„,ä½†æ˜¯è®¾ç½®ä¸ç¼“å­˜ä¼šè®©éŸ³ä¹åŠ è½½é€Ÿåº¦å¤ªæ…¢;ç»§ç»­å¾€ä¸‹æŸ¥çœ‹</p><blockquote><p>Another possible scenario Iâ€™ve seen - the exact same request is being sent again just after few milliseconds (most likely due to a bug in the client side).<br>In that case youâ€™ll also see that the status of the first request is â€œcanceledâ€ and that the latency is only several milliseconds.</p></blockquote><p>å¤§æ¦‚æ˜¯è¯´ å®Œå…¨ç›¸åŒçš„è¯·æ±‚é—´éš”æ•°æ¯«ç§’(å¤ªçŸ­),å¯¼è‡´åŠ è½½å¤±è´¥,æŸ¥çœ‹äº†chromeæ§åˆ¶å°å‘ç°<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://ngmusic.coding.io/null</span><br><span class="line">http://ngmusic.coding.io/serverget?url=http%3A%2F%2Ffile.qianqian.com.....</span><br><span class="line">éƒ½æœ‰ Provisional headers are shown</span><br></pre></td></tr></table></figure></p><figure class="image-box">                <img src="/img/chrome/3.png" alt="error" title="" class="">                <p>error</p>            </figure><figure class="image-box">                <img src="/img/chrome/4.png" alt="error" title="" class="">                <p>error</p>            </figure><p>çŒœæƒ³æ˜¯å› ä¸º <code>http://...../null</code> åŠ è½½å¤±è´¥ å¯¼è‡´ <code>http://..../serverget?url=http%3A%2F%2Ffile.qianqian.com.....</code>çš„ç¼“å­˜è¯·æ±‚ä¹Ÿå¤±è´¥(é˜»å¡)</p><p>æ•…å°†ä¸Šé¢ <code>null</code> åŠ è½½å»æ‰<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// _audio.src = null;</span></span><br><span class="line"><span class="comment">// _audio.load();</span></span><br></pre></td></tr></table></figure></p><p>ç»è¿‡æµ‹è¯•,å‘ç°çš„ç¡®ä»ç¼“å­˜ä¸­è·å–äº†~~~<br><figure class="image-box">                <img src="/img/chrome/2.png" alt="error" title="" class="">                <p>error</p>            </figure></p><h1 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h1><p><code>Provisional headers are shown</code><br>å‡ºç°åœ¨ è½½å…¥ç¼“å­˜èµ„æº,è¯·æ±‚æ²¡æœ‰è¢«å‘é€, è€Œå¦‚æœä¸Šä¸€ä¸ªèµ„æºåŠ è½½å¤±è´¥,å¯èƒ½å¯¼è‡´ä»ç¼“å­˜åŠ è½½çš„èµ„æºå¤±è´¥,<br>å³ç¼“å­˜èµ„æºè¯·æ±‚ä¹‹å‰çš„è¯·æ±‚ä¸èƒ½å¤±è´¥,ä¸ç„¶å°±æœ‰å¯èƒ½å‡ºç°é—®é¢˜</p><p>è‡³æ­¤,ç»ˆäºæå®šäº†è¿™ä¸ªæ¸£é—®é¢˜!!!!!!!!!!!!!!!!!!!!!!</p><h2 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h2><ul><li><a href="http://stackoverflow.com/questions/21177387/caution-provisional-headers-are-shown-in-chrome-debugger" target="_blank" rel="noopener">http://stackoverflow.com/questions/21177387/caution-provisional-headers-are-shown-in-chrome-debugger</a></li><li><a href="https://code.google.com/p/chromium/issues/detail?id=327581" target="_blank" rel="noopener">https://code.google.com/p/chromium/issues/detail?id=327581</a></li><li><a href="http://stackoverflow.com/questions/21177387/caution-provisional-headers-are-shown-in-chrome-debugger" target="_blank" rel="noopener">http://stackoverflow.com/questions/21177387/caution-provisional-headers-are-shown-in-chrome-debugger</a>  </li><li><a href="http://segmentfault.com/q/1010000000364871" target="_blank" rel="noopener">http://segmentfault.com/q/1010000000364871</a>  </li></ul><hr><blockquote><h3 id="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢"><a href="#æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢" class="headerlink" title="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~"></a>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</h3><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nginxé…ç½®proxy_passè·¯å¾„é—®é¢˜</title>
      <link href="/2015/04/16/Nginx%E9%85%8D%E7%BD%AEproxy-pass%E8%B7%AF%E5%BE%84%E9%97%AE%E9%A2%98/"/>
      <url>/2015/04/16/Nginx%E9%85%8D%E7%BD%AEproxy-pass%E8%B7%AF%E5%BE%84%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<p>åˆæ¬¡å°è¯•nginxé‡åˆ°çš„é—®é¢˜<br><a id="more"></a></p><blockquote><p>proxy_passåçš„urlæœ€åçš„/<br>å½“åŠ ä¸Šäº†/ï¼Œç›¸å½“äºæ˜¯ç»å¯¹æ ¹è·¯å¾„ï¼Œåˆ™nginxä¸ä¼šæŠŠlocationä¸­åŒ¹é…çš„è·¯å¾„éƒ¨åˆ†ä»£ç†èµ°<br>å¦‚æœæ²¡æœ‰/ï¼Œåˆ™ä¼šæŠŠåŒ¹é…çš„è·¯å¾„éƒ¨åˆ†ä¹Ÿç»™ä»£ç†èµ°</p></blockquote><blockquote><p>å‡è®¾è¯·æ±‚url: <code>http://servername/node/index.html</code></p></blockquote><blockquote><p>é…ç½®:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">location /node/  &#123;</span><br><span class="line">    proxy_pass http:<span class="comment">//127.0.0.1:1339/;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></blockquote><blockquote><p>ä»£ç†url(å®é™…url)<code>http://servername/node/index.html</code></p></blockquote><blockquote><p>é…ç½®:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">location /node  &#123;</span><br><span class="line">    proxy_pass http:<span class="comment">//127.0.0.1:1339/;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></blockquote><blockquote><p>ä»£ç†url(å®é™…url)<code>http://servername/index.html</code></p></blockquote><p>å¯ä»¥é€šè¿‡rewriteæ¥å®ç°/çš„åŠŸèƒ½</p><blockquote><p>é…ç½®:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">location /node  &#123;</span><br><span class="line">    rewrite /node/(.+)$ /$<span class="number">1</span> <span class="keyword">break</span>;</span><br><span class="line">    proxy_pass http:<span class="comment">//127.0.0.1:1339/;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></blockquote><blockquote><p>ä»£ç†url(å®é™…url)<code>http://servername/node/index.html</code></p></blockquote><p>æ­¤å¤– <code>http://127.0.0.1:1339/</code> çš„æœ€åä¸€ä¸ª <code>/</code> å¦‚æœä¸å†™;ä¼šå¯¼è‡´ <code>404 Not Found</code></p><h2 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h2><p><a href="http://www.tech126.com/nginx-proxy-pass/" target="_blank" rel="noopener">http://www.tech126.com/nginx-proxy-pass/</a></p><p><a href="http://cssor.com/nginx-location-configuration.html" target="_blank" rel="noopener">http://cssor.com/nginx-location-configuration.html</a></p><hr><blockquote><h3 id="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢"><a href="#æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢" class="headerlink" title="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~"></a>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</h3><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScriptæƒå¨æŒ‡å—ç¬”è®°6_æ­£åˆ™è¡¨è¾¾å¼</title>
      <link href="/2015/04/12/JavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E7%AC%94%E8%AE%B06-%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
      <url>/2015/04/12/JavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E7%AC%94%E8%AE%B06-%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<p>æ­£åˆ™è¡¨è¾¾å¼150412<br><a id="more"></a></p><blockquote><p>å…·æœ‰ç‰¹æ®Šå«ä¹‰çš„æ ‡ç‚¹ç¬¦å·</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">^ $ . * + ? = ! : | \ / ( ) [ ] &#123; &#125;</span><br></pre></td></tr></table></figure><blockquote><p>é€‰æ‹©é¡¹å°è¯•åŒ¹é…æ¬¡åºæ˜¯ä»å·¦åˆ°å³,ç›´åˆ°å‘ç°åŒ¹é…é¡¹</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">'ab'</span>.match(<span class="regexp">/a|ab/g</span>));  <span class="comment">// [ 'a' ]</span></span><br></pre></td></tr></table></figure><blockquote><p>å¼•ç”¨ \n, nç”±å‚ä¸è®¡æ•°çš„å·¦æ‹¬å·ä½ç½®å†³å®š</p></blockquote><blockquote><p>\b å­—ç¬¦è¾¹ç•Œ  [\b] é€€æ ¼ç¬¦</p></blockquote><blockquote><p>m å¤šè¡ŒåŒ¹é…æ¨¡å¼, ^å’Œ$ åŒ¹é…è¡Œçš„å¼€å§‹å¤„å’Œç»“æŸå¤„</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">'str\nstr'</span>;</span><br><span class="line"><span class="built_in">console</span>.log(str.match(<span class="regexp">/^\w+$/m</span>));   <span class="comment">// [ 'str', index: 0, input: 'str\nstr' ]</span></span><br><span class="line"><span class="built_in">console</span>.log(str.match(<span class="regexp">/^\w+$/</span>));    <span class="comment">// null</span></span><br></pre></td></tr></table></figure><blockquote><p>search(regexp)  </p><blockquote><p>å¦‚æœå‚æ•°ä¸æ˜¯æ­£åˆ™è¡¨è¾¾å¼,åˆ™é¦–å…ˆé€šè¿‡RegExpæ„é€ å‡½æ•°å°†å®ƒè½¬æ¢ä¸ºæ­£åˆ™è¡¨è¾¾å¼<br>search å¿½ç•¥æ­£åˆ™è¡¨è¾¾å¼å‚æ•°ä¸­çš„ä¿®é¥°ç¬¦ g</p></blockquote></blockquote><blockquote><p>replace (searchValue, replaceValue)</p><blockquote><p>å¦‚æœ searchValue ä¸æ˜¯æ­£åˆ™è¡¨è¾¾å¼, replaceå°†ç›´æ¥æœç´¢è¿™ä¸ªå­—ç¬¦ä¸²<br>replaceValue å¦‚æœå‡ºç° $åŠ æ•°å­—, åˆ™ä½¿ç”¨åˆ¶å®šçš„å­è¡¨è¾¾å¼ç›¸åŒ¹é…çš„æ–‡æœ¬æ¥æ›¿æ¢è¿™ä¸ªå­—ç¬¦ä¸²<br>replaceValue å¯ä»¥ä¸ºå‡½æ•°â€¦â€¦â€¦â€¦</p></blockquote></blockquote><blockquote><p>match</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> reg = <span class="regexp">/(a(\w))/</span>;</span><br><span class="line"><span class="keyword">var</span> reg2 = <span class="regexp">/(a(\w))/g</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'abac'</span>.match(reg));     <span class="comment">// [ 'ab', 'ab', 'b', index: 0, input: 'abac' ]</span></span><br><span class="line">                        <span class="comment">//[ æ²¡æœ‰æ‹¬å·çš„åŒ¹é…, ç¬¬ä¸€ä¸ªå·¦æ‹¬å·çš„åŒ¹é…, ç¬¬äºŒä¸ªå·¦æ‹¬å·çš„åŒ¹é… , index: 0, input: 'abac']</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'abae'</span>.match(reg2));    <span class="comment">//[ 'ab', 'ae' ]</span></span><br><span class="line">                                    <span class="comment">// [ç¬¬ä¸€æ¬¡åŒ¹é…,  ç¬¬äºŒæ¬¡åŒ¹é…]</span></span><br></pre></td></tr></table></figure><blockquote><p>ç»™RegExp()ä¼ å…¥ä¸€ä¸ªå­—ç¬¦ä¸²è¡¨è¿°çš„æ­£åˆ™è¡¨è¾¾å¼,å¿…é¡»å°†â€™\â€™ æ›¿æ¢ä¸º â€˜\\â€˜</p></blockquote><blockquote><p>Regexp.exec() æ€»æ˜¯è¿”å›ä¸€ä¸ªåŒ¹é…ç»“æœ,å¹¶æä¾›å…³äºæœ¬æ¬¡åŒ¹é…çš„å®Œæ•´ä¿¡æ¯</p></blockquote><hr><blockquote><h3 id="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢"><a href="#æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢" class="headerlink" title="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~"></a>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</h3><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScriptæƒå¨æŒ‡å—ç¬”è®°5_ç±»å’Œæ¨¡å—</title>
      <link href="/2015/04/12/JavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E7%AC%94%E8%AE%B05-%E7%B1%BB%E5%92%8C%E6%A8%A1%E5%9D%97/"/>
      <url>/2015/04/12/JavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E7%AC%94%E8%AE%B05-%E7%B1%BB%E5%92%8C%E6%A8%A1%E5%9D%97/</url>
      
        <content type="html"><![CDATA[<p>ç±»å’Œæ¨¡å—150412<br><a id="more"></a></p><h1 id="ç±»å’ŒåŸå‹"><a href="#ç±»å’ŒåŸå‹" class="headerlink" title="ç±»å’ŒåŸå‹"></a>ç±»å’ŒåŸå‹</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">inherit</span>(<span class="params">p</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (p === <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="built_in">TypeError</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">Object</span>.create) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Object</span>.create(p);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> t = <span class="keyword">typeof</span> p;</span><br><span class="line">    <span class="keyword">if</span> (t !== <span class="string">'object'</span> &amp;&amp; t !== <span class="string">'function'</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="built_in">TypeError</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">F</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    F.prototype = p;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> F();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®ç°ä¸€ä¸ªèƒ½è¡¨ç¤ºå€¼çš„èŒƒå›´çš„ç±»</span></span><br><span class="line"><span class="comment">// å·¥å‚æ–¹æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">range</span>(<span class="params">from, to</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> r = inherit(range.methods);</span><br><span class="line">    r.from = <span class="keyword">from</span>;</span><br><span class="line">    r.to = to;</span><br><span class="line">    <span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">range.methods = &#123;</span><br><span class="line">    includes: <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.from &lt;= x &amp;&amp; x &lt;= <span class="keyword">this</span>.to;</span><br><span class="line">    &#125;,</span><br><span class="line">    foreach: <span class="function"><span class="keyword">function</span>(<span class="params">f</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> x = <span class="built_in">Math</span>.ceil(<span class="keyword">this</span>.from); x &lt;= <span class="keyword">this</span>.to; x++) &#123;</span><br><span class="line">            f(x);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    toString: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'('</span> + <span class="keyword">this</span>.from + <span class="string">'....'</span> + <span class="keyword">this</span>.to + <span class="string">')'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> r = range(<span class="number">1</span>, <span class="number">3</span>);            </span><br><span class="line"><span class="built_in">console</span>.log(r.includes(<span class="number">2</span>));     <span class="comment">// true</span></span><br><span class="line">r.foreach(<span class="built_in">console</span>.log);         <span class="comment">// 1  2  3</span></span><br><span class="line"><span class="built_in">console</span>.log(r);                 <span class="comment">// &#123; from: 1, to: 3 &#125;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®ç°ä¸€ä¸ªèƒ½è¡¨ç¤ºå€¼çš„èŒƒå›´çš„ç±»</span></span><br><span class="line"><span class="comment">// æ„é€ å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Range</span>(<span class="params">from, to</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.from = <span class="keyword">from</span>;</span><br><span class="line">    <span class="keyword">this</span>.to = to;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Range.prototype = &#123;</span><br><span class="line">    <span class="keyword">constructor</span>: Range,</span><br><span class="line">    includes: function(x) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.from &lt;= x &amp;&amp; x &lt;= <span class="keyword">this</span>.to;</span><br><span class="line">    &#125;,</span><br><span class="line">    foreach: <span class="function"><span class="keyword">function</span>(<span class="params">f</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> x = <span class="built_in">Math</span>.ceil(<span class="keyword">this</span>.from); x &lt;= <span class="keyword">this</span>.to; x++) &#123;</span><br><span class="line">            f(x);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    toString: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'('</span> + <span class="keyword">this</span>.from + <span class="string">'....'</span> + <span class="keyword">this</span>.to + <span class="string">')'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> r = <span class="keyword">new</span> Range(<span class="number">1</span>, <span class="number">3</span>);</span><br><span class="line"><span class="built_in">console</span>.log(r.includes(<span class="number">2</span>));     <span class="comment">// true</span></span><br><span class="line">r.foreach(<span class="built_in">console</span>.log);         <span class="comment">// 1  2  3</span></span><br><span class="line"><span class="built_in">console</span>.log(r);                 <span class="comment">// &#123; from: 1, to: 3 &#125;</span></span><br></pre></td></tr></table></figure><h1 id="javascript-ä¸­-Java-å¼ç»§æ‰¿"><a href="#javascript-ä¸­-Java-å¼ç»§æ‰¿" class="headerlink" title="javascript ä¸­ Java å¼ç»§æ‰¿"></a>javascript ä¸­ Java å¼ç»§æ‰¿</h1><blockquote><p>javascriptå®šä¹‰ç±»çš„æ­¥éª¤:</p><blockquote><ol><li>å®šä¹‰ä¸€ä¸ªæ„é€ å‡½æ•°,å¹¶è®¾ç½®åˆå§‹åŒ–æ–°å¯¹è±¡çš„å®ä¾‹å±æ€§</li><li>ç»™æ„é€ å‡½æ•°çš„prototypeå¯¹è±¡å®šä¹‰å®ä¾‹çš„æ–¹æ³•</li><li>ç»™æ„é€ å‡½æ•°å®šä¹‰ç±»å­—æ®µå’Œç±»å±æ€§</li></ol></blockquote></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// P182ä¸­çš„extend</span></span><br><span class="line"><span class="keyword">var</span> extend = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> p <span class="keyword">in</span> &#123; <span class="attr">toString</span>: <span class="literal">null</span>&#125;) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">extend</span>(<span class="params">o</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt; <span class="built_in">arguments</span>.length; i++) &#123;</span><br><span class="line">                <span class="keyword">var</span> source = <span class="built_in">arguments</span>[i];</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">var</span> prop <span class="keyword">in</span> source) &#123;</span><br><span class="line">                    o[prop] = source[prop];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> o;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">path_extend</span>(<span class="params">o</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt; <span class="built_in">arguments</span>.length; i++) &#123;</span><br><span class="line">            <span class="keyword">var</span> source = <span class="built_in">arguments</span>[i];</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> prop <span class="keyword">in</span> source) &#123;</span><br><span class="line">                o[prop] = source[prop];</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; prototyprops.length; j++) &#123;</span><br><span class="line">                prop = prototyprops[j];</span><br><span class="line">                <span class="keyword">if</span> (source.hasOwnProperty(prop)) &#123;</span><br><span class="line">                    o[prop] = source[prop];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> o;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;());</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> prototyprops = [<span class="string">'toString'</span>, <span class="string">'valueOf'</span>, <span class="string">'constructor'</span>, <span class="string">'hasOwnProperty'</span>, <span class="string">'isPrototypeOf'</span>,</span><br><span class="line">                    <span class="string">'propertyIsEnumerable'</span>, <span class="string">'toLocaleString'</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸€ä¸ªç”¨ä»¥å®šä¹‰ç±»çš„ç®€å•å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">defineClass</span>(<span class="params">constructor,           <span class="regexp">//</span> ç”¨ä»¥è®¾ç½®å®ä¾‹çš„å±æ€§çš„å‡½æ•°</span></span></span><br><span class="line"><span class="function"><span class="params">                    methods,                <span class="regexp">//</span> å®ä¾‹çš„æ–¹æ³•, å¤åˆ¶è‡³åŸå‹ä¸­</span></span></span><br><span class="line"><span class="function"><span class="params">                    statics</span>) </span>&#123;              <span class="comment">// ç±»å±æ€§, å¤åˆ¶è‡³æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="keyword">if</span> (methods) &#123;</span><br><span class="line">        extend(<span class="keyword">constructor</span>.prototype, methods);</span><br><span class="line">    &#125;</span><br><span class="line">    if (statics) &#123;</span><br><span class="line">        extend(<span class="keyword">constructor</span>, statics);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return <span class="keyword">constructor</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Rangeç±»çš„å®ç°</span><br><span class="line">var simpleRange = defineClass(function(from, to) &#123;</span><br><span class="line">    <span class="keyword">this</span>.from = <span class="keyword">from</span>;</span><br><span class="line">    <span class="keyword">this</span>.to = to;</span><br><span class="line">&#125;,&#123;</span><br><span class="line">    includes: <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.from &lt;= x &amp;&amp; x &lt;= <span class="keyword">this</span>.to;</span><br><span class="line">    &#125;,</span><br><span class="line">    toString: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'('</span> + <span class="keyword">this</span>.from + <span class="string">'....'</span> + <span class="keyword">this</span>.to + <span class="string">')'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;, &#123;</span><br><span class="line">    uptp: <span class="function"><span class="keyword">function</span>(<span class="params">to</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> simpleRange(<span class="number">0</span>, to);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> r = <span class="keyword">new</span> simpleRange(<span class="number">1</span>, <span class="number">3</span>);</span><br><span class="line"><span class="built_in">console</span>.log(r.includes(<span class="number">2</span>));     <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(r);                 <span class="comment">// &#123; from: 1, to: 3 &#125;</span></span><br></pre></td></tr></table></figure><h1 id="é›†åˆç±»"><a href="#é›†åˆç±»" class="headerlink" title="é›†åˆç±»"></a>é›†åˆç±»</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Set</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.values = &#123;&#125;;</span><br><span class="line">    <span class="keyword">this</span>.n = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">this</span>.add.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Set</span>.prototype.add = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="built_in">arguments</span>.length; i++) &#123;</span><br><span class="line">        <span class="keyword">var</span> val = <span class="built_in">arguments</span>[i];</span><br><span class="line">        <span class="keyword">var</span> str = <span class="built_in">Set</span>._v2s(val);</span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">this</span>.values.hasOwnProperty(str)) &#123;</span><br><span class="line">            <span class="keyword">this</span>.values[str] = val;</span><br><span class="line">            <span class="keyword">this</span>.n++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Set</span>.prototype.remove = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="built_in">arguments</span>.length; i++) &#123;</span><br><span class="line">        <span class="keyword">var</span> str = <span class="built_in">Set</span>._v2s(<span class="built_in">arguments</span>[i]);</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.values.hasOwnProperty(str)) &#123;</span><br><span class="line">            <span class="keyword">delete</span> <span class="keyword">this</span>.values[str];</span><br><span class="line">            <span class="keyword">this</span>.n--;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Set</span>.prototype.contains = <span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.values.hasOwnProperty(<span class="built_in">Set</span>._v2s(value));</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Set</span>.prototype.size = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.n;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Set</span>.prototype.foreach = <span class="function"><span class="keyword">function</span>(<span class="params">f, context</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> str <span class="keyword">in</span> <span class="keyword">this</span>.values) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.values.hasOwnProperty(str)) &#123;</span><br><span class="line">            f.call(context, <span class="keyword">this</span>.values[str]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Set</span>._v2s = <span class="function"><span class="keyword">function</span>(<span class="params">val</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (val) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="literal">undefined</span>:</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">'u'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">case</span> <span class="literal">null</span>:</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">'n'</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">case</span> <span class="literal">true</span>:</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">'t'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">case</span> <span class="literal">false</span>:</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">'f'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">default</span> :</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">switch</span> (<span class="keyword">typeof</span>(val)) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">'number'</span>:</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="string">'#'</span> + val;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">'string'</span>:</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="string">'"'</span> + val;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">default</span> :</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="string">'@'</span> + objectId(val);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">objectId</span>(<span class="params">o</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> prop = <span class="string">'|**objectid**|'</span>;</span><br><span class="line">            <span class="keyword">if</span> (!o.hasOwnProperty(prop)) &#123;</span><br><span class="line">                <span class="built_in">Object</span>.defineProperty(o, prop, &#123;</span><br><span class="line">                    writable: <span class="literal">true</span>,</span><br><span class="line">                    enumerable: <span class="literal">false</span>, <span class="comment">//ä¸å¯æšä¸¾</span></span><br><span class="line">                    value: <span class="built_in">Set</span>._v2s.next++</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> o[prop];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Set</span>._v2s.next = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> mySet = <span class="keyword">new</span> <span class="built_in">Set</span>();</span><br><span class="line"><span class="keyword">var</span> o = &#123;<span class="string">'name'</span>: <span class="string">'shang'</span>&#125;;</span><br><span class="line">mySet.add(o);</span><br><span class="line">mySet.add(o);</span><br><span class="line"><span class="built_in">console</span>.log(mySet.size());      <span class="comment">// 1</span></span><br><span class="line">mySet.foreach(<span class="function"><span class="keyword">function</span>(<span class="params">o</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(o);             <span class="comment">// &#123; name: 'shang' &#125;</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(mySet.contains(o));     <span class="comment">// true</span></span><br><span class="line">mySet.remove(o);</span><br><span class="line"><span class="built_in">console</span>.log(mySet.size());          <span class="comment">// 0</span></span><br></pre></td></tr></table></figure><blockquote><p>ä½¿ç”¨æšä¸¾ç±»å‹è¡¨ç¤ºä¸€å‰¯æ‰‘å…‹ç‰Œ</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * /**</span></span><br><span class="line"><span class="comment"> * å…¼å®¹ECMAScript 5</span></span><br><span class="line"><span class="comment"> * è¿”å›ä¸€ä¸ªç»§æ‰¿è‡ªåŸå‹å¯¹è±¡pçš„å±æ€§çš„æ–°å¯¹è±¡</span></span><br><span class="line"><span class="comment"> * @param p è¦ç»§æ‰¿åŸå‹å¯¹è±¡</span></span><br><span class="line"><span class="comment"> * @returns &#123;*&#125; æ–°å¯¹è±¡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">inherit</span>(<span class="params">p</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (p == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span>  <span class="built_in">TypeError</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">Object</span>.create) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Object</span>.create(p);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> t = <span class="keyword">typeof</span> p;</span><br><span class="line">    <span class="keyword">if</span> (t !== <span class="string">'object'</span> &amp;&amp; t != <span class="string">'function'</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span>  <span class="built_in">TypeError</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">F</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    F.prototype = p;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> F();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æšä¸¾ç±»å‹</span></span><br><span class="line"><span class="comment"> * @param namesToValues ç±»çš„æ¯ä¸ªå®ä¾‹çš„åå­—å’Œå€¼</span></span><br><span class="line"><span class="comment"> * @returns &#123;Function&#125;  æ„é€ å‡½æ•° åŒ…å« å/å€¼çš„æ˜ å°„è¡¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">enumeration</span>(<span class="params">namesToValues</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> enumeration = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="string">'can\'t'</span>;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> proto = enumeration.prototype = &#123;</span><br><span class="line">        construcetor: enumeration,</span><br><span class="line">        toString: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.name;</span><br><span class="line">        &#125;,</span><br><span class="line">        valueOf: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.value;</span><br><span class="line">        &#125;,</span><br><span class="line">        toJson: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.name;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    enumeration.values = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> name <span class="keyword">in</span> namesToValues) &#123;</span><br><span class="line">        <span class="keyword">var</span> e = inherit(proto);</span><br><span class="line">        e.name = name;</span><br><span class="line">        e.value = namesToValues[name];</span><br><span class="line">        enumeration[name] = e;</span><br><span class="line">        enumeration.values.push(e);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    enumeration.foreach = <span class="function"><span class="keyword">function</span>(<span class="params">fun, context</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="keyword">this</span>.values.length; i++) &#123;</span><br><span class="line">            fun.call(context, <span class="keyword">this</span>.values[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> enumeration;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Card</span>(<span class="params">suit, rank</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.suit = suit;</span><br><span class="line">    <span class="keyword">this</span>.rank = rank;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Card.Suit = enumeration(&#123;</span><br><span class="line">    Clubs: <span class="number">1</span>,</span><br><span class="line">    Diamonds: <span class="number">2</span>,</span><br><span class="line">    Hearts: <span class="number">3</span>,</span><br><span class="line">    Spades: <span class="number">4</span></span><br><span class="line">&#125;);</span><br><span class="line">Card.Rank = enumeration(&#123;</span><br><span class="line">    Two: <span class="number">2</span>,</span><br><span class="line">    Three: <span class="number">3</span>,</span><br><span class="line">    Four: <span class="number">4</span>,</span><br><span class="line">    Five: <span class="number">5</span>,</span><br><span class="line">    Six: <span class="number">6</span>,</span><br><span class="line">    Seven: <span class="number">7</span>,</span><br><span class="line">    Eight: <span class="number">8</span>,</span><br><span class="line">    Nine: <span class="number">9</span>,</span><br><span class="line">    Ten: <span class="number">10</span>,</span><br><span class="line">    Jack: <span class="number">11</span>,</span><br><span class="line">    Queen: <span class="number">12</span>,</span><br><span class="line">    King: <span class="number">13</span>,</span><br><span class="line">    Ace: <span class="number">14</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">Card.prototype.toString = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.rank.toString() + <span class="string">'of'</span> + <span class="keyword">this</span>.suit.toString();</span><br><span class="line">&#125;;</span><br><span class="line">Card.prototype.compareTo = <span class="function"><span class="keyword">function</span>(<span class="params">that</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.rank &lt; that.rank) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.rank &gt; that.rank) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Card.orderByRank = <span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a.compareTo(b);</span><br><span class="line">&#125;;</span><br><span class="line">Card.orderBySuit = <span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (a.suit &lt; b.suit) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (a.suit &gt; b.suit) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (a.rank &lt; b.rank) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (a.rank &gt; b.rank) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç‰Œç»„</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Deck</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> cards = <span class="keyword">this</span>.cards = [];</span><br><span class="line">    Card.Suit.foreach(<span class="function"><span class="keyword">function</span>(<span class="params">s</span>) </span>&#123;</span><br><span class="line">        Card.Rank.foreach(<span class="function"><span class="keyword">function</span>(<span class="params">r</span>) </span>&#123;</span><br><span class="line">            <span class="comment">// æ— æ³•ä½¿ç”¨ this</span></span><br><span class="line">            cards.push(<span class="keyword">new</span> Card(r, s));</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ´—ç‰Œ</span></span><br><span class="line">Deck.prototype.shuffle = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> deck = <span class="keyword">this</span>.cards, len = deck.length;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = len - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        <span class="keyword">var</span> r = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * (i + <span class="number">1</span>));</span><br><span class="line">        <span class="keyword">var</span> temp = deck[i];</span><br><span class="line">        deck[i] = deck[r];</span><br><span class="line">        deck[r] = temp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// å‘ç‰Œ</span></span><br><span class="line">Deck.prototype.deal = <span class="function"><span class="keyword">function</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.cards.length &lt; n) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="string">'out of crads length'</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.cards.splice(<span class="keyword">this</span>.cards.length - n, n);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> deck = (<span class="keyword">new</span> Deck()).shuffle();</span><br><span class="line"><span class="keyword">var</span> hand = deck.deal(<span class="number">13</span>).sort(Card.orderBySuit);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(deck);</span><br><span class="line"><span class="built_in">console</span>.log(hand);</span><br></pre></td></tr></table></figure><hr><blockquote><h3 id="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢"><a href="#æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢" class="headerlink" title="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~"></a>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</h3><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScriptæƒå¨æŒ‡å—ç¬”è®°5_å‡½æ•°</title>
      <link href="/2015/04/08/JavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E7%AC%94%E8%AE%B05-%E5%87%BD%E6%95%B0/"/>
      <url>/2015/04/08/JavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E7%AC%94%E8%AE%B05-%E5%87%BD%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<p>å‡½æ•° 150408<br><a id="more"></a></p><h1 id="æ–¹æ³•è°ƒç”¨"><a href="#æ–¹æ³•è°ƒç”¨" class="headerlink" title="æ–¹æ³•è°ƒç”¨"></a>æ–¹æ³•è°ƒç”¨</h1><blockquote><p><code>this</code> æ˜¯ä¸€ä¸ªå…³é”®å­—; ä¸å…è®¸ç»™ <code>this</code> èµ‹å€¼</p></blockquote><blockquote><p>åµŒå¥—å‡½æ•°ä½œä¸ºæ–¹æ³•è°ƒç”¨,å…¶ <code>this</code> çš„å€¼æŒ‡å‘è°ƒç”¨å®ƒçš„å¯¹è±¡<br>åµŒå¥—å‡½æ•°ä½œä¸ºå‡½æ•°è°ƒç”¨,å…¶ <code>this</code> åœ¨ éä¸¥æ ¼æ¨¡å¼ä¸‹ä¸º å…¨å±€å¯¹è±¡, åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ä¸º undefined</p></blockquote><h1 id="æ„é€ å‡½æ•°è°ƒç”¨"><a href="#æ„é€ å‡½æ•°è°ƒç”¨" class="headerlink" title="æ„é€ å‡½æ•°è°ƒç”¨"></a>æ„é€ å‡½æ•°è°ƒç”¨</h1><blockquote><p>æ„é€ å‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„ç©ºå¯¹è±¡,è¿™ä¸ªå¯¹è±¡ç»§æ‰¿è‡ªæ„é€ å‡½æ•°çš„ <code>prototype</code> å±æ€§,æ„é€ å‡½æ•°å¯ä»¥ç”¨ <code>this</code> å¼•ç”¨è¿™ä¸ªæ–°åˆ›å»ºçš„å¯¹è±¡</p></blockquote><blockquote><p>å¦‚æœæ„é€ å‡½æ•°æ˜¾ç¤ºçš„ä½¿ç”¨ <code>return</code> è¿”å›ä¸€ä¸ªå¯¹è±¡, é‚£ä¹ˆè°ƒç”¨è¡¨è¾¾å¼çš„å€¼å°±æ˜¯è¿™ä¸ªå¯¹è±¡<br>å¦‚æœæ„é€ å‡½æ•°ä½¿ç”¨ <code>return</code> ä½†æ²¡æœ‰è¿”å›å€¼,æˆ–è€…è¿”å›ä¸€ä¸ªåŸå§‹å€¼, é‚£ä¹ˆå¿½ç•¥è¿”å›å€¼, åŒæ—¶è¿™ä¸ªæ–°å¯¹è±¡æœ€ä¸ºè°ƒç”¨ç»“æœ</p></blockquote><h1 id="è‡ªå®šä¹‰å‡½æ•°å±æ€§"><a href="#è‡ªå®šä¹‰å‡½æ•°å±æ€§" class="headerlink" title="è‡ªå®šä¹‰å‡½æ•°å±æ€§"></a>è‡ªå®šä¹‰å‡½æ•°å±æ€§</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è®¡ç®—é˜¶ä¹˜,å¹¶å°†ç»“æœç¼“å­˜å€¼å‡½æ•°çš„å±æ€§å½“ä¸­</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">factorial</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">isFinite</span>(n) &amp;&amp; n &gt; <span class="number">0</span> &amp;&amp; n === <span class="built_in">Math</span>.round(n)) &#123;  <span class="comment">// æœ‰é™æ­£æ•´æ•°</span></span><br><span class="line">        <span class="keyword">if</span> (n === <span class="number">1</span>) &#123;              <span class="comment">// ç‰¹ä¾‹</span></span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (!(n <span class="keyword">in</span> factorial)) &#123;                 <span class="comment">// å¦‚æœæ²¡æœ‰ç¼“å­˜ç»“æœ</span></span><br><span class="line">            factorial[n] = n * factorial(n - <span class="number">1</span>);      <span class="comment">// è®¡ç®—ç»“æœå¹¶ç¼“å­˜</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> factorial[n];                          <span class="comment">// è¿”å›ç»“æœ</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NaN</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(factorial(<span class="number">4</span>));          <span class="comment">// 24</span></span><br></pre></td></tr></table></figure><h1 id="é—­åŒ…"><a href="#é—­åŒ…" class="headerlink" title="é—­åŒ…"></a>é—­åŒ…</h1><blockquote><p>javascriptæ­¤æ³•ä½œç”¨åŸŸçš„åŸºæœ¬è§„åˆ™: å‡½æ•°æ‰§è¡Œåˆ°ä½œç”¨åŸŸé“¾,è¿™ä¸ªä½œç”¨åŸŸé“¾æ˜¯å‡½æ•°å®šä¹‰çš„æ—¶å€™åˆ›å»ºçš„<br>å‡½æ•°å®šä¹‰æ—¶çš„ä½œç”¨åŸŸé“¾ åˆ°å‡½æ•°æ‰§è¡Œæ˜¯ä¾ç„¶æœ‰æ•ˆ</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> scope = <span class="string">'global'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkScope</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> scope = <span class="string">'local'</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> scope;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> f();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(checkScope());   <span class="comment">// local</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> scope = <span class="string">'global'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkScope</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> scope = <span class="string">'local'</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> scope;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> f;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(checkScope()());   <span class="comment">// local</span></span><br></pre></td></tr></table></figure><h1 id="Function-prototype-call-thisArg-arg1-arg2-â€¦-å’Œ-Function-prototype-apply-thisArg-argArray"><a href="#Function-prototype-call-thisArg-arg1-arg2-â€¦-å’Œ-Function-prototype-apply-thisArg-argArray" class="headerlink" title="Function.prototype.call(thisArg [ , arg1 [ , arg2, â€¦ ] ] ) å’Œ Function.prototype.apply(thisArg, argArray)"></a><code>Function.prototype.call(thisArg [ , arg1 [ , arg2, â€¦ ] ] )</code> å’Œ <code>Function.prototype.apply(thisArg, argArray)</code></h1><blockquote><p>ECMAScript 3 å’Œ éä¸¥æ ¼æ¨¡å¼ä¸­,ä¼ å…¥çš„ <code>null</code> å’Œ <code>undefined</code> éƒ½ä¼šè¢«å…¨å±€å¯¹è±¡ä»£æ›¿, è€Œå…¶å®ƒåŸå§‹å€¼åˆ™ä¼šè¢«ç›¸åº”çš„åŒ…è£…å¯¹è±¡ä»£æ›¿<br>ECMAScript 5 ä¸¥æ ¼æ¨¡å¼ä¸‹, å³ä½¿ä¼ å…¥ <code>null</code> <code>undefined</code> æˆ–åŸå§‹å€¼ <code>thisArg</code> ä¼šç¼–ç¼–ç¨‹ <code>this</code> çš„å€¼</p></blockquote><blockquote><p><code>apply()</code> çš„å‚æ•°æ•°ç»„å¯ä»¥æ˜¯ç±»æ•°ç»„å¯¹è±¡ä¹Ÿå¯ä»¥ä½¿çœŸå®æ•°ç»„å¯¹è±¡</p></blockquote><h1 id="Function-prototype-bind-thisArg-arg1-arg2-â€¦"><a href="#Function-prototype-bind-thisArg-arg1-arg2-â€¦" class="headerlink" title="Function.prototype.bind (thisArg [, arg1 [, arg2, â€¦]])"></a><code>Function.prototype.bind (thisArg [, arg1 [, arg2, â€¦]])</code></h1><blockquote><p>ECMAScript 5æ–°å¢æ–¹æ³•, ECMAScript 3å®ç°å¦‚ä¸‹:</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="built_in">Function</span>.prototype.bind) &#123;</span><br><span class="line">    <span class="built_in">Function</span>.prototype.bind = <span class="function"><span class="keyword">function</span>(<span class="params">o</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// this å’Œ arguments ä¿å­˜</span></span><br><span class="line">        <span class="keyword">var</span> self = <span class="keyword">this</span>;</span><br><span class="line">        <span class="keyword">var</span> boundArgs = <span class="built_in">arguments</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="comment">// åˆ›å»ºä¸€ä¸ªå®å‚åˆ—è¡¨;å°†bind()çš„ç¬¬äºŒä¸ªåŠåç»­å®å‚éƒ½ä¼ å…¥è¿™ä¸ªå‡½æ•°</span></span><br><span class="line">            <span class="keyword">var</span> args = [];</span><br><span class="line">            <span class="keyword">var</span> i;</span><br><span class="line">            <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; boundArgs.length; i++) &#123;</span><br><span class="line">                args.push(boundArgs[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="built_in">arguments</span>.length; i++) &#123;</span><br><span class="line">                args.push(<span class="built_in">arguments</span>[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// å°†selfä½œä¸ºoçš„æ–¹æ³•è°ƒç”¨,ä¼ å…¥è¿™äº›å®å‚</span></span><br><span class="line">            <span class="keyword">return</span> self.apply(o, args);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Function-æ„é€ å‡½æ•°"><a href="#Function-æ„é€ å‡½æ•°" class="headerlink" title="Function() æ„é€ å‡½æ•°"></a><code>Function()</code> æ„é€ å‡½æ•°</h1><blockquote><p><code>Function()</code> æ„é€ å‡½æ•°æ‰€åˆ›å»ºçš„å‡½æ•°çš„è¯æ³•ä½œç”¨åŸŸåœ¨å…¨å±€ä½œç”¨åŸŸ</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> scope = <span class="string">'global'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">constructFunction</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> scope = <span class="string">'local'</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Function</span>(<span class="string">'return scope'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(constructFunction()());     <span class="comment">// global</span></span><br></pre></td></tr></table></figure><h1 id="å‡½æ•°å¼ç¼–ç¨‹"><a href="#å‡½æ•°å¼ç¼–ç¨‹" class="headerlink" title="å‡½æ•°å¼ç¼–ç¨‹"></a>å‡½æ•°å¼ç¼–ç¨‹</h1><h2 id="ä½¿ç”¨å‡½æ•°å¤„ç†æ•°ç»„"><a href="#ä½¿ç”¨å‡½æ•°å¤„ç†æ•°ç»„" class="headerlink" title="ä½¿ç”¨å‡½æ•°å¤„ç†æ•°ç»„"></a>ä½¿ç”¨å‡½æ•°å¤„ç†æ•°ç»„</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è®¡ç®— å¹³å‡æ•° å’Œ æ ‡å‡†å·®</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> sum = <span class="function"><span class="keyword">function</span>(<span class="params">x, y</span>) </span>&#123;              <span class="comment">// è®¡ç®—å’Œ</span></span><br><span class="line">    <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> square = <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;              <span class="comment">// è®¡ç®—å¹³æ–¹</span></span><br><span class="line">    <span class="keyword">return</span> x * x;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> data = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"><span class="keyword">var</span> mean = data.reduce(sum) / data.length;      <span class="comment">// å¹³å‡æ•°</span></span><br><span class="line"><span class="keyword">var</span> deviations = data.map(<span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;         </span><br><span class="line">    <span class="keyword">return</span> x - mean;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">var</span> stddev = <span class="built_in">Math</span>.sqrt(deviations.map(square).reduce(sum) / (data.length - <span class="number">1</span>));</span><br><span class="line"><span class="built_in">console</span>.log(mean);          <span class="comment">// 3</span></span><br><span class="line"><span class="built_in">console</span>.log(deviations);    <span class="comment">// [ -2, -1, 0, 1, 2 ]</span></span><br><span class="line"><span class="built_in">console</span>.log(stddev);        <span class="comment">//1.5811388300841898</span></span><br></pre></td></tr></table></figure><blockquote><p>ECMAScript 3  map å’Œ reduce å®ç°:</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> map = <span class="built_in">Array</span>.prototype.map ? <span class="function"><span class="keyword">function</span>(<span class="params">arr, fun</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> arr.map(fun);</span><br><span class="line">&#125; : <span class="function"><span class="keyword">function</span>(<span class="params">arr, fun</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> results = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i <span class="keyword">in</span> arr) &#123;</span><br><span class="line">            results[i] = fun.call(<span class="literal">null</span>, arr[i], i, arr);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> results;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> reduce = <span class="built_in">Array</span>.prototype.reduce ? <span class="function"><span class="keyword">function</span>(<span class="params">arr, fun, initial</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> arr.reduce(fun, initial);</span><br><span class="line">&#125; : <span class="function"><span class="keyword">function</span>(<span class="params">arr, fun, initial</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> i = <span class="number">0</span>, len = arr.length, accumulator;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">arguments</span>.length &gt; <span class="number">2</span>) &#123;</span><br><span class="line">        accumulator = initial;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (len === <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="built_in">TypeError</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span>(i &lt; len) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i <span class="keyword">in</span> arr) &#123;</span><br><span class="line">                accumulator = a[i++];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                i++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (i === len) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="built_in">TypeError</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (i &lt; len) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i <span class="keyword">in</span> arr) &#123;</span><br><span class="line">            accumulator = fun.call(<span class="literal">undefined</span>, accumulator, arr[i], i, arr);</span><br><span class="line">        &#125;</span><br><span class="line">        i++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> accumulator;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="é«˜é˜¶å‡½æ•°"><a href="#é«˜é˜¶å‡½æ•°" class="headerlink" title="é«˜é˜¶å‡½æ•°"></a>é«˜é˜¶å‡½æ•°</h2><blockquote><p>å®šä¹‰: æ“ä½œå‡½æ•°çš„å‡½æ•°, æ¥å—ä¸€ä¸ªæˆ–å¤šä¸ªå‡½æ•°ä¸ºå‚æ•°,å¹¶è¿”å›ä¸€ä¸ªæ–°å‡½æ•°</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¿”å›fun çš„è¿”å›å€¼çš„é€»è¾‘é</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">not</span>(<span class="params">fun</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> result = fun.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">        <span class="keyword">return</span> !result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> even = <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;        <span class="comment">// åˆ¤æ–­xæ˜¯å¦ä¸ºå¶æ•°</span></span><br><span class="line">    <span class="keyword">return</span> x % <span class="number">2</span> === <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> odd = not(even);        <span class="comment">// åˆ¤æ–­æ˜¯å¦ä¸ºå¥‡æ•°</span></span><br><span class="line"><span class="built_in">console</span>.log([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>].map(even)); <span class="comment">// [ false, true, false, true, false ]</span></span><br><span class="line"><span class="built_in">console</span>.log([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>].map(odd)); <span class="comment">//  [ true, false, true, false, true ]</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è®¡ç®—f(g())</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">compose</span>(<span class="params">f, g</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> f.call(<span class="keyword">this</span>, g.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>));</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> square = <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x * x;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> sum = <span class="function"><span class="keyword">function</span>(<span class="params">x, y</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> squareofsum = compose(square, sum);</span><br><span class="line"><span class="built_in">console</span>.log(squareofsum(<span class="number">2</span>, <span class="number">3</span>));   <span class="comment">// 25</span></span><br></pre></td></tr></table></figure><h2 id="ä¸å®Œå…¨å‡½æ•°"><a href="#ä¸å®Œå…¨å‡½æ•°" class="headerlink" title="ä¸å®Œå…¨å‡½æ•°"></a>ä¸å®Œå…¨å‡½æ•°</h2><blockquote><p>f(1, 2, 3, 4, 5, 6) çš„è°ƒç”¨æ”¹ä¸º f(1, 2)(3, 4)(5, 6);åè€…åŒ…å«ä¸Šæ¬¡è°ƒç”¨, å’Œæ¯æ¬¡è°ƒç”¨ç›¸å…³çš„å‡½æ•°å°±æ˜¯ â€˜ä¸å®Œå…¨å‡½æ•°â€™</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å°†ç±»æ•°ç»„å¯¹è±¡è½¬æ¢ä¸ºçœŸæ­£çš„æ•°ç»„</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">array</span>(<span class="params">arr, n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Array</span>.prototype.slice.call(arr, n || <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¿™ä¸ªå‡½æ•°çš„å®å‚ä¼ é€’è‡³å·¦ä¾§</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">partialLeft</span>(<span class="params">f</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> args = <span class="built_in">arguments</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> a = array(args, <span class="number">1</span>);</span><br><span class="line">        a = a.concat(array(<span class="built_in">arguments</span>));</span><br><span class="line">        <span class="keyword">return</span> f.apply(<span class="keyword">this</span>, a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¿™ä¸ªå‡½æ•°çš„å®å‚ä¼ é€’å€¼å³ä¾§</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">partialRight</span>(<span class="params">f</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> args = <span class="built_in">arguments</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> a = array(<span class="built_in">arguments</span>);</span><br><span class="line">        a = a.concat(array(args, <span class="number">1</span>));</span><br><span class="line">        <span class="keyword">return</span> f.apply(<span class="keyword">this</span>, a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¿™ä¸ªå‡½æ•°çš„å®å‚è¢«ç”¨ä½œæ¨¡æ¿</span></span><br><span class="line"><span class="comment">// å®å‚åˆ—è¡¨ä¸­çš„undefinedå€¼éƒ½è¢«å¡«å……</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">partial</span>(<span class="params">f</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> args = <span class="built_in">arguments</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> a = array(args, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">var</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; a.length; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (a[i] === <span class="literal">undefined</span>) &#123;</span><br><span class="line">                a[i] = <span class="built_in">arguments</span>[j++];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        a = a.concat(array(<span class="built_in">arguments</span>, j));</span><br><span class="line">        <span class="keyword">return</span> f.apply(<span class="keyword">this</span>, a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> f = <span class="function"><span class="keyword">function</span>(<span class="params">x, y, z</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x * (y - z);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(partialLeft(f, <span class="number">2</span>)(<span class="number">3</span>, <span class="number">4</span>));       <span class="comment">// -2  2 * (3 - 4)</span></span><br><span class="line"><span class="built_in">console</span>.log(partialRight(f, <span class="number">2</span>)(<span class="number">3</span>, <span class="number">4</span>));      <span class="comment">// 6   3 * (4 - 2)</span></span><br><span class="line"><span class="built_in">console</span>.log(partial(f, <span class="literal">undefined</span>, <span class="number">2</span>)(<span class="number">3</span>, <span class="number">4</span>));<span class="comment">// -6  3 * (2 - 4)</span></span><br></pre></td></tr></table></figure><h1 id="è®°å¿†"><a href="#è®°å¿†" class="headerlink" title="è®°å¿†"></a>è®°å¿†</h1><blockquote><p>å°†ä¸Šæ¬¡è®¡ç®—çš„ç»“æœç¼“å­˜èµ·æ¥,è¿™ç§ç¼“å­˜æŠ€å·§å«åšè®°å¿†</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¿”å› f()çš„å¸¦è®°å¿†åŠŸèƒ½çš„ç‰ˆæœ¬</span></span><br><span class="line"><span class="comment">// åªæœ‰å½“f()çš„å®å‚å­—ç¬¦ä¸²è¡¨ç¤ºéƒ½ä¸ç›¸åŒæ˜¯å®ƒæ‰ä¼šå·¥ä½œ</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">memorize</span>(<span class="params">f</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> cache = &#123;&#125;;     <span class="comment">// ç¼“å­˜ä¿å­˜åœ¨é—­åŒ…å†…</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// å°†å®å‚è½¬æ¢ä¸ºå­—ç¬¦ä¸²å½¢å¼, å¹¶å°†å…¶ç”¨åšç¼“å­˜çš„é”®</span></span><br><span class="line">        <span class="keyword">var</span> key = <span class="built_in">arguments</span>.length + <span class="built_in">Array</span>.prototype.join.call(<span class="built_in">arguments</span>, <span class="string">','</span>);</span><br><span class="line">        <span class="keyword">if</span> (key <span class="keyword">in</span> cache) &#123;</span><br><span class="line">            <span class="keyword">return</span> cache[key];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> cache[key] = f.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿”å›2ä¸ªæ•´æ•°çš„æœ€å¤§å…¬çº¦æ•°</span></span><br><span class="line"><span class="comment">// æ¬§å‡ é‡Œå¾·ç®—æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">gcd</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> t;</span><br><span class="line">    <span class="keyword">if</span> (a &lt; b) &#123;</span><br><span class="line">        t = b;</span><br><span class="line">        b = a;</span><br><span class="line">        a = t;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (b != <span class="number">0</span>) &#123;</span><br><span class="line">        t = b;</span><br><span class="line">        b = a % b;</span><br><span class="line">        a = t;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> gcdmemo = memorize(gcd);</span><br><span class="line"><span class="built_in">console</span>.log(gcdmemo(<span class="number">85</span>, <span class="number">187</span>));   <span class="comment">// 17</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> factorial = memorize(<span class="function"><span class="keyword">function</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (n &lt;= <span class="number">1</span>) ? <span class="number">1</span> : n * factorial(n - <span class="number">1</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(factorial(<span class="number">5</span>));  <span class="comment">// 120   1~4çš„å€¼æœ‰ç¼“å­˜</span></span><br></pre></td></tr></table></figure><hr><blockquote><h3 id="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢"><a href="#æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢" class="headerlink" title="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~"></a>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</h3><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScriptæƒå¨æŒ‡å—ç¬”è®°4_æ•°ç»„</title>
      <link href="/2015/04/07/JavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E7%AC%94%E8%AE%B04-%E6%95%B0%E7%BB%84/"/>
      <url>/2015/04/07/JavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E7%AC%94%E8%AE%B04-%E6%95%B0%E7%BB%84/</url>
      
        <content type="html"><![CDATA[<p>JavaScriptæƒå¨æŒ‡å—ç¬”è®°4_æ•°ç»„150407<br><a id="more"></a></p><blockquote><p>å¦‚æœçœç•¥æ•°ç»„ç›´æ¥é‡çš„æŸä¸ªå€¼,çœç•¥çš„å…ƒç´ è¢«èµ‹äºˆ <code>undefined</code></p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, , <span class="number">5</span>];</span><br><span class="line"><span class="built_in">console</span>.log(a.length + <span class="string">'\n'</span> + a);</span><br><span class="line"><span class="comment">// 5</span></span><br><span class="line"><span class="comment">// 1,2,3,,5</span></span><br></pre></td></tr></table></figure><blockquote><p>æ•°ç»„ç›´æ¥é‡å…è®¸æœ‰å¯é€‰çš„ç»“å°¾é€—å·</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> b = [,,];</span><br><span class="line"><span class="built_in">console</span>.log(b.length); <span class="comment">// 2  ä¸æ˜¯3!</span></span><br></pre></td></tr></table></figure><blockquote><p>å¯ä»¥ä½¿ç”¨è´Ÿæ•°æˆ–éæ•´æ•°,ä½†æ˜¯æ•°å€¼è½¬æ¢ä¸ºå­—ç¬¦ä¸²,ä½œä¸ºå¯¹è±¡å±æ€§</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> b = [];</span><br><span class="line">b[<span class="number">-1.23</span>] = <span class="number">-1</span>;</span><br><span class="line"><span class="built_in">console</span>.log(b[<span class="string">'-1.23'</span>]); <span class="comment">// -1</span></span><br></pre></td></tr></table></figure><blockquote><p>å¦‚æœä½¿ç”¨äº†éè´Ÿæ•´æ•°çš„å­—ç¬¦ä¸²,å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°ç»„ç´¢å¼•,è€Œéå¯¹è±¡å±æ€§</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> b = [];</span><br><span class="line">b[<span class="string">'1'</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="built_in">console</span>.log(b[<span class="number">1</span>]); <span class="comment">// 1</span></span><br></pre></td></tr></table></figure><blockquote><p>for/in å¾ªç¯å¯ä»¥ä»¥ä¸åŒçš„é¡ºåºéå†å¯¹è±¡çš„å±æ€§;å³æ•°ç»„å…ƒç´ éå†ä¸ä¸€å®šæ˜¯å‡åºçš„</p></blockquote><h1 id="æ•°ç»„æ–¹æ³•"><a href="#æ•°ç»„æ–¹æ³•" class="headerlink" title="æ•°ç»„æ–¹æ³•"></a>æ•°ç»„æ–¹æ³•</h1><blockquote><p><code>join()</code> å°†æ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ è½¬æ¢ä¸ºå­—ç¬¦ä¸²æ‹¼æ¥</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = [<span class="number">1</span>, <span class="number">2</span>, [<span class="string">'a'</span>, <span class="string">'b'</span>]];</span><br><span class="line"><span class="built_in">console</span>.log(a.join()); <span class="comment">// 1,2,a,b</span></span><br><span class="line"><span class="built_in">console</span>.log(a.join(<span class="string">'-'</span>)); <span class="comment">// 1-2-a,b</span></span><br></pre></td></tr></table></figure><blockquote><p><code>reverse()</code> å°†æ•°ç»„ä¸­çš„å…ƒç´ é¢ å€’é¡ºåº,è¿”å›é€†åºæ•°ç»„<br><strong>ä¿®æ”¹åŸæ•°ç»„</strong></p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = [<span class="number">1</span>, <span class="number">2</span>, [<span class="string">'a'</span>, <span class="string">'b'</span>]];</span><br><span class="line"><span class="built_in">console</span>.log(a.reverse()); <span class="comment">// [ [ 'a', 'b' ], 2, 1 ]</span></span><br><span class="line"><span class="built_in">console</span>.log(a);          <span class="comment">// [ [ 'a', 'b' ], 2, 1 ]</span></span><br></pre></td></tr></table></figure><blockquote><p><code>sort()</code> å°†æ•°ç»„ä¸­çš„å…ƒç´ æ’åºå¹¶è¿”å›æ’åºåçš„æ•°ç»„<br>ä¸å¸¦å‚æ•°æ—¶,æ•°ç»„å…ƒç´ ä»¥å­—æ¯è¡¨é¡ºåºæ’åº<br>å¦‚æœæ•°ç»„åŒ…å« <code>undefined</code> å…ƒç´ ,ä¼šè¢«æ’åˆ°æ•°ç»„å°¾éƒ¨<br><strong>ä¿®æ”¹åŸæ•°ç»„</strong></p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = [<span class="literal">undefined</span>, <span class="number">2</span>, <span class="number">1</span>, [<span class="string">'a'</span>, <span class="string">'b'</span>], [<span class="number">1</span>, <span class="number">2</span>]];</span><br><span class="line"><span class="built_in">console</span>.log(a.sort());  <span class="comment">//[ 1, [ 1, 2 ], 2, [ 'a', 'b' ], undefined ]</span></span><br><span class="line"><span class="built_in">console</span>.log(a);         <span class="comment">//[ 1, [ 1, 2 ], 2, [ 'a', 'b' ], undefined ]</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line"><span class="built_in">console</span>.log(a.sort(<span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> b - a;    <span class="comment">// ä»å¤§åˆ°å°</span></span><br><span class="line">&#125;));</span><br><span class="line"><span class="built_in">console</span>.log(a);         <span class="comment">// [ 4, 3, 2, 1 ]</span></span><br></pre></td></tr></table></figure><blockquote><p><code>concat([ item1 [ , item2 [ , â€¦ ] ] ])</code> å½“ä»¥é›¶æˆ–æ›´å¤šä¸ªå‚æ•° item1, item2, ç­‰ç­‰ï¼Œè°ƒç”¨ concat æ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œè¿™ä¸ªæ•°ç»„åŒ…å«å¯¹è±¡çš„æ•°ç»„å…ƒç´ å’Œåé¢è·Ÿç€çš„æ¯ä¸ªå‚æ•°æŒ‰ç…§é¡ºåºç»„æˆçš„æ•°ç»„å…ƒç´ <br><strong>concat ä¸ä¼šæ‰å¹³åŒ–æ•°ç»„</strong><br><strong>concat ä¸ä¼šä¿®æ”¹åŸæ•°ç»„</strong></p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">var</span> b = [[<span class="number">4</span>, <span class="number">5</span>], [<span class="number">6</span>,<span class="number">7</span>]];</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(a.concat(<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>));  <span class="comment">// [ 1, 2, 3, 4, 5, 6 ]</span></span><br><span class="line"><span class="built_in">console</span>.log(a.concat(b));       <span class="comment">// [ 1, 2, 3, [ 4, 5 ], [ 6, 7 ] ]</span></span><br><span class="line"><span class="built_in">console</span>.log(a);                 <span class="comment">// [ 1, 2, 3 ]</span></span><br><span class="line"><span class="built_in">console</span>.log(b);                 <span class="comment">// [ [ 4, 5 ], [ 6, 7 ] ]</span></span><br></pre></td></tr></table></figure><blockquote><p><code>slice(start, end)</code> è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œè¿™ä¸ªæ•°ç»„åŒ…å«ä»ç¬¬ start ä¸ªå…ƒç´ åˆ° â€“ ä½†ä¸åŒ…æ‹¬ â€“ ç¬¬ end ä¸ªå…ƒç´  ( æˆ–å¦‚æœ end æ˜¯ undefined å°±åˆ°æ•°ç»„æœ«å°¾ )ã€‚å¦‚æœ start ä¸ºè´Ÿï¼Œå®ƒä¼šè¢«å½“åšæ˜¯ length+startï¼Œè¿™é‡Œçš„ length æ˜¯æ•°ç»„é•¿åº¦ã€‚å¦‚æœ end ä¸ºè´Ÿï¼Œå®ƒä¼šè¢«å½“åšæ˜¯ length+endï¼Œè¿™é‡Œçš„ length æ˜¯æ•°ç»„é•¿åº¦ã€‚<br><strong>slice ä¸ä¼šä¿®æ”¹åŸæ•°ç»„</strong></p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(a.slice(<span class="number">1</span>, <span class="number">3</span>));     <span class="comment">//[ 2, 3 ]</span></span><br><span class="line"><span class="built_in">console</span>.log(a.slice(<span class="number">1</span>));        <span class="comment">// [ 2, 3, 4, 5 ]</span></span><br><span class="line"><span class="built_in">console</span>.log(a.slice(<span class="number">1</span>, <span class="number">-1</span>));    <span class="comment">// [ 2, 3, 4 ]</span></span><br><span class="line"><span class="built_in">console</span>.log(a.slice(<span class="number">-3</span>, <span class="number">-2</span>));   <span class="comment">// [ 3 ]</span></span><br><span class="line"><span class="built_in">console</span>.log(a.slice(<span class="number">-2</span>, <span class="number">-3</span>));   <span class="comment">// []</span></span><br><span class="line"><span class="built_in">console</span>.log(a);                 <span class="comment">// [ 1, 2, 3, 4, 5 ]</span></span><br></pre></td></tr></table></figure><blockquote><p><code>splice(start, deleteCount [,item1[, item2 [, â€¦ ] ] ])</code> ä»æ•°ç»„ç´¢å¼• start å¼€å§‹çš„ deleteCount ä¸ªæ•°ç»„å…ƒç´ ä¼šè¢«æ›¿æ¢ä¸ºå‚æ•° item1, item2, ç­‰ç­‰,è¿”å›è¢«åˆ é™¤çš„å…ƒç´ ,å¦‚æœdeleteCountçœç•¥,åˆ™ä»startåˆ°ç»“æŸçš„æ‰€æœ‰å…ƒç´ éƒ½å°†åˆ é™¤<br><strong>spliceä¼šä¿®æ”¹åŸæ•°ç»„</strong></p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(a.splice(<span class="number">1</span>));           <span class="comment">// [ 2, 3, 4, 5 ]</span></span><br><span class="line"><span class="built_in">console</span>.log(a);                     <span class="comment">// [ 1 ]</span></span><br><span class="line">a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"><span class="built_in">console</span>.log(a.splice(<span class="number">1</span>, <span class="number">2</span>));        <span class="comment">// [ 2, 3 ]</span></span><br><span class="line"><span class="built_in">console</span>.log(a);                     <span class="comment">// [ 1, 4, 5 ]</span></span><br><span class="line">a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"><span class="built_in">console</span>.log(a.splice(<span class="number">1</span>, <span class="number">2</span>, <span class="string">'add0'</span>, <span class="string">'add1'</span>));  <span class="comment">// [ 2, 3 ]</span></span><br><span class="line"><span class="built_in">console</span>.log(a);                     <span class="comment">// [ 1, 'add0', 'add1', 4, 5 ]</span></span><br></pre></td></tr></table></figure><blockquote><p><code>push( [ item1 [ , item2 [ , â€¦ ] ] ])</code>  å°†å‚æ•°ä»¥ä»–ä»¬å‡ºç°çš„é¡ºåºè¿½åŠ åˆ°æ•°ç»„æœ«å°¾,è¿”å›æ–°æ•°ç»„é•¿åº¦<br><strong>ä¼šä¿®æ”¹åŸæ•°ç»„</strong></p></blockquote><blockquote><p><code>pop()</code> åˆ é™¤å¹¶è¿”å›æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ <br><strong>ä¼šä¿®æ”¹åŸæ•°ç»„</strong></p></blockquote><blockquote><p><code>unshift([ item1 [ , item2 [ , â€¦ ] ] ])</code> å°†å‚æ•°ä»¬æ’å…¥åˆ°æ•°ç»„çš„å¼€å§‹ä½ç½®ï¼Œå®ƒä»¬åœ¨æ•°ç»„ä¸­çš„é¡ºåºä¸å®ƒä»¬å‡ºç°åœ¨å‚æ•°åˆ—è¡¨ä¸­çš„é¡ºåºç›¸åŒã€‚è¿”å›æ–°æ•°ç»„é•¿åº¦<br><strong>ä¼šä¿®æ”¹åŸæ•°ç»„</strong></p></blockquote><blockquote><p><code>shift()</code>  åˆ é™¤å¹¶è¿”å›æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚<br><strong>ä¼šä¿®æ”¹åŸæ•°ç»„</strong></p></blockquote><blockquote><p>toString()</p><ol><li>ä»¤ array ä¸ºç”¨ this å€¼è°ƒç”¨ ToObject çš„ç»“æœã€‚</li><li>ä»¤ func ä¸ºä»¥ â€œjoinâ€ ä½œä¸ºå‚æ•°è°ƒç”¨ array çš„ [[Get]] å†…éƒ¨æ–¹æ³•çš„ç»“æœã€‚</li><li>å¦‚æœ IsCallable(func) æ˜¯ false, åˆ™ä»¤ func ä¸ºæ ‡å‡†å†…ç½®æ–¹æ³• Object.prototype.toString (15.2.4.2)ã€‚</li><li>æä¾› array ä½œä¸º this å€¼å¹¶ä»¥ç©ºå‚æ•°åˆ—è¡¨è°ƒç”¨ func çš„ [[Call]] å†…éƒ¨æ–¹æ³•ï¼Œè¿”å›ç»“æœã€‚<br>toString å‡½æ•°è¢«æœ‰æ„è®¾è®¡æˆé€šç”¨çš„ï¼›å®ƒçš„ this å€¼å¹¶éå¿…é¡»æ˜¯æ•°ç»„å¯¹è±¡ã€‚å› æ­¤ï¼Œå®ƒå¯ä»¥ä½œä¸ºæ–¹æ³•è½¬ç§»åˆ°å…¶ä»–ç±»å‹çš„å¯¹è±¡ä¸­ã€‚ä¸€ä¸ªå®¿ä¸»å¯¹è±¡æ˜¯å¦å¯ä»¥æ­£ç¡®åº”ç”¨è¿™ä¸ª toString å‡½æ•°æ˜¯ä¾èµ–äºå®ç°çš„ã€‚</li></ol></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = [<span class="number">1</span>, [<span class="string">'a'</span>, <span class="string">'b'</span>, &#123;<span class="attr">o</span>: <span class="string">'obj'</span>&#125;]];</span><br><span class="line"><span class="built_in">console</span>.log(a.toString());              <span class="comment">// 1,a,b,[object Object]</span></span><br></pre></td></tr></table></figure><h1 id="ECMAScript-5-ä¸­çš„æ•°ç»„æ–¹æ³•"><a href="#ECMAScript-5-ä¸­çš„æ•°ç»„æ–¹æ³•" class="headerlink" title="ECMAScript 5 ä¸­çš„æ•°ç»„æ–¹æ³•"></a>ECMAScript 5 ä¸­çš„æ•°ç»„æ–¹æ³•</h1><blockquote><p><code>forEach ( callbackfn [ , thisArg ] )</code>  forEach æŒ‰ç…§ç´¢å¼•çš„å‡åºï¼Œå¯¹æ•°ç»„é‡Œå­˜åœ¨çš„æ¯ä¸ªå…ƒç´ è°ƒç”¨ä¸€æ¬¡ callbackfn<br>callbackfn å°†ä¼ å…¥ä¸‰ä¸ªå‚æ•°ï¼šå…ƒç´ çš„å€¼ï¼Œå…ƒç´ çš„ç´¢å¼•ï¼Œå’Œéå†çš„å¯¹è±¡ã€‚ å¦‚æœæä¾›äº†ä¸€ä¸ª thisArg å‚æ•°ï¼Œå®ƒä¼šè¢«å½“ä½œ this å€¼ä¼ ç»™æ¯ä¸ª callbackfn è°ƒç”¨<br>forEach æ²¡æœ‰ forå¾ªç¯ä¸­ break<br><strong>å¯¹ forEach çš„è°ƒç”¨ä¸ç›´æ¥æ›´æ”¹å¯¹è±¡ï¼Œä½†æ˜¯å¯¹ callbackfn çš„è°ƒç”¨å¯èƒ½æ›´æ”¹å¯¹è±¡ã€‚</strong></p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> sum = <span class="number">0</span>;</span><br><span class="line">a.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">value, index, arr</span>) </span>&#123;</span><br><span class="line">    sum += value;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(sum);                       <span class="comment">// 10</span></span><br><span class="line"><span class="built_in">console</span>.log(a);                         <span class="comment">// [ 1, 2, 3, 4 ]</span></span><br><span class="line"></span><br><span class="line">a.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">value, index, arr</span>) </span>&#123;</span><br><span class="line">    arr[index] = <span class="number">0</span>;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(a);                         <span class="comment">// [ 0, 0, 0, 0 ]</span></span><br></pre></td></tr></table></figure><blockquote><p><code>map ( callbackfn [ , thisArg ] )</code> map æŒ‰ç…§ç´¢å¼•çš„å‡åºï¼Œå¯¹æ•°ç»„é‡Œå­˜åœ¨çš„æ¯ä¸ªå…ƒç´ è°ƒç”¨ä¸€æ¬¡ callbackfnï¼Œå¹¶ç”¨ç»“æœæ„é€ ä¸€ä¸ªæ–°æ•°ç»„<br>callbackfn å°†ä¼ å…¥ä¸‰ä¸ªå‚æ•°ï¼šå…ƒç´ çš„å€¼ï¼Œå…ƒç´ çš„ç´¢å¼•ï¼Œå’Œéå†çš„å¯¹è±¡ã€‚ å¦‚æœæä¾›äº†ä¸€ä¸ª thisArg å‚æ•°ï¼Œå®ƒä¼šè¢«å½“ä½œ this å€¼ä¼ ç»™æ¯ä¸ª callbackfn è°ƒç”¨<br>callbackfn åªè¢«å®é™…å­˜åœ¨çš„æ•°ç»„å…ƒç´ è°ƒç”¨ï¼›å®ƒä¸ä¼šè¢«ç¼ºå°‘çš„æ•°ç»„å…ƒç´ è°ƒç”¨ã€‚<br><strong>å¯¹ map çš„è°ƒç”¨ä¸ç›´æ¥æ›´æ”¹å¯¹è±¡ï¼Œä½†æ˜¯å¯¹ callbackfn çš„è°ƒç”¨å¯èƒ½æ›´æ”¹å¯¹è±¡ã€‚</strong></p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = [<span class="number">1</span>, <span class="number">2</span>, <span class="literal">undefined</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line">a.length = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> b = a.map(<span class="function"><span class="keyword">function</span>(<span class="params">value, index, arr</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(value);              <span class="comment">// 1  2  undefined  3  4</span></span><br><span class="line">    <span class="keyword">return</span> value * value;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(a);                     <span class="comment">// [ 1, 2, undefined, 3, 4, , , , ,  ]</span></span><br><span class="line"><span class="built_in">console</span>.log(b);                     <span class="comment">// [ 1, 4, NaN, 9, 16, , , , ,  ]</span></span><br></pre></td></tr></table></figure><blockquote><p><code>filter ( callbackfn [ , thisArg ] )</code> filter æŒ‰ç…§ç´¢å¼•çš„å‡åºï¼Œå¯¹æ•°ç»„é‡Œå­˜åœ¨çš„æ¯ä¸ªå…ƒç´ è°ƒç”¨ä¸€æ¬¡ callbackfnï¼Œå¹¶ç”¨ä½¿ callbackfn è¿”å› true çš„æ‰€æœ‰å€¼æ„é€ ä¸€ä¸ªæ–°æ•°ç»„<br>callbackfn æ—¶å°†ä¼ å…¥ä¸‰ä¸ªå‚æ•°ï¼šå…ƒç´ çš„å€¼ï¼Œå…ƒç´ çš„ç´¢å¼•ï¼Œå’Œéå†çš„å¯¹è±¡ã€‚<br>å¦‚æœæä¾›äº†ä¸€ä¸ª thisArg å‚æ•°ï¼Œå®ƒä¼šè¢«å½“ä½œ this å€¼ä¼ ç»™æ¯ä¸ª callbackfn è°ƒç”¨ã€‚<br>callbackfn åªè¢«å®é™…å­˜åœ¨çš„æ•°ç»„å…ƒç´ è°ƒç”¨ï¼›å®ƒä¸ä¼šè¢«ç¼ºå°‘çš„æ•°ç»„å…ƒç´ è°ƒç”¨ã€‚<br><strong>å¯¹ filter çš„è°ƒç”¨ä¸ç›´æ¥æ›´æ”¹å¯¹è±¡ï¼Œä½†æ˜¯å¯¹ callbackfn çš„è°ƒç”¨å¯èƒ½æ›´æ”¹å¯¹è±¡</strong></p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = [<span class="number">1</span>, <span class="number">2</span>, <span class="literal">undefined</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line">a.length = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> b = a.filter(<span class="function"><span class="keyword">function</span>(<span class="params">value, index, arr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> value &lt; <span class="number">3</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(a);                     <span class="comment">// [ 1, 2, undefined, 3, 4, , , , ,  ]</span></span><br><span class="line"><span class="built_in">console</span>.log(b);                     <span class="comment">// [ 1, 2 ]</span></span><br></pre></td></tr></table></figure><blockquote><p><code>every ( callbackfn [ , thisArg ] )</code>   every æŒ‰ç…§ç´¢å¼•çš„å‡åºï¼Œå¯¹æ•°ç»„é‡Œå­˜åœ¨çš„æ¯ä¸ªå…ƒç´ è°ƒç”¨ä¸€æ¬¡ callbackfnï¼Œç›´åˆ°ä»–æ‰¾åˆ°ä¸€ä¸ªä½¿ callbackfn è¿”å› false çš„å…ƒç´ ã€‚å¦‚æœæ‰¾åˆ°è¿™æ ·çš„å…ƒç´ ï¼Œevery é©¬ä¸Šè¿”å› falseï¼Œå¦åˆ™å¦‚æœå¯¹æ‰€æœ‰å…ƒç´  callbackfn éƒ½è¿”å› trueï¼Œevery å°†è¿”å› trueã€‚<br>callbackfn æ—¶å°†ä¼ å…¥ä¸‰ä¸ªå‚æ•°ï¼šå…ƒç´ çš„å€¼ï¼Œå…ƒç´ çš„ç´¢å¼•ï¼Œå’Œéå†çš„å¯¹è±¡ã€‚<br>å¦‚æœæä¾›äº†ä¸€ä¸ª thisArg å‚æ•°ï¼Œå®ƒä¼šè¢«å½“ä½œ this å€¼ä¼ ç»™æ¯ä¸ª callbackfn è°ƒç”¨ã€‚<br>callbackfn åªè¢«å®é™…å­˜åœ¨çš„æ•°ç»„å…ƒç´ è°ƒç”¨ï¼›å®ƒä¸ä¼šè¢«ç¼ºå°‘çš„æ•°ç»„å…ƒç´ è°ƒç”¨ã€‚<br><strong>å¯¹ every çš„è°ƒç”¨ä¸ç›´æ¥æ›´æ”¹å¯¹è±¡ï¼Œä½†æ˜¯å¯¹ callbackfn çš„è°ƒç”¨å¯èƒ½æ›´æ”¹å¯¹è±¡</strong></p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = [<span class="number">1</span>, <span class="number">2</span>, <span class="literal">undefined</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> b = a.every(<span class="function"><span class="keyword">function</span>(<span class="params">value, index, arr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> value === <span class="literal">undefined</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(a);                     <span class="comment">// [ 1, 2, undefined, 3, 4 ]</span></span><br><span class="line"><span class="built_in">console</span>.log(b);                     <span class="comment">// false</span></span><br></pre></td></tr></table></figure><blockquote><p><code>some ( callbackfn [ , thisArg ] )</code> some æŒ‰ç…§ç´¢å¼•çš„å‡åºï¼Œå¯¹æ•°ç»„é‡Œå­˜åœ¨çš„æ¯ä¸ªå…ƒç´ è°ƒç”¨ä¸€æ¬¡ callbackfnï¼Œç›´åˆ°ä»–æ‰¾åˆ°ä¸€ä¸ªä½¿ callbackfn è¿”å› true çš„å…ƒç´ ã€‚å¦‚æœæ‰¾åˆ°è¿™æ ·çš„å…ƒç´ ï¼Œsome é©¬ä¸Šè¿”å› trueï¼Œå¦åˆ™ï¼Œsome è¿”å› false<br>callbackfn æ—¶å°†ä¼ å…¥ä¸‰ä¸ªå‚æ•°ï¼šå…ƒç´ çš„å€¼ï¼Œå…ƒç´ çš„ç´¢å¼•ï¼Œå’Œéå†çš„å¯¹è±¡ã€‚<br>å¦‚æœæä¾›äº†ä¸€ä¸ª thisArg å‚æ•°ï¼Œå®ƒä¼šè¢«å½“ä½œ this å€¼ä¼ ç»™æ¯ä¸ª callbackfn è°ƒç”¨ã€‚<br>callbackfn åªè¢«å®é™…å­˜åœ¨çš„æ•°ç»„å…ƒç´ è°ƒç”¨ï¼›å®ƒä¸ä¼šè¢«ç¼ºå°‘çš„æ•°ç»„å…ƒç´ è°ƒç”¨ã€‚<br><strong>å¯¹ some çš„è°ƒç”¨ä¸ç›´æ¥æ›´æ”¹å¯¹è±¡ï¼Œä½†æ˜¯å¯¹ callbackfn çš„è°ƒç”¨å¯èƒ½æ›´æ”¹å¯¹è±¡</strong></p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = [<span class="number">1</span>, <span class="number">2</span>, <span class="literal">undefined</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> b = a.some(<span class="function"><span class="keyword">function</span>(<span class="params">value, index, arr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> value === <span class="literal">undefined</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(a);                     <span class="comment">// [ 1, 2, undefined, 3, 4 ]</span></span><br><span class="line"><span class="built_in">console</span>.log(b);                     <span class="comment">// true</span></span><br></pre></td></tr></table></figure><blockquote><p><code>reduce ( callbackfn [ , initialValue ] )</code> reduce æŒ‰ç…§ç´¢å¼•çš„å‡åºï¼Œå¯¹æ•°ç»„é‡Œå­˜åœ¨çš„æ¯ä¸ªå…ƒç´  , å°† callbackfn ä½œä¸ºå›è°ƒå‡½æ•°è°ƒç”¨ä¸€æ¬¡ã€‚<br>è°ƒç”¨ callbackfn æ—¶å°†ä¼ å…¥å››ä¸ªå‚æ•°ï¼špreviousValueï¼ˆinitialValue çš„å€¼æˆ–ä¸Šæ¬¡è°ƒç”¨ callbackfn çš„è¿”å›å€¼ï¼‰ï¼ŒcurrentValueï¼ˆå½“å‰å…ƒç´ å€¼ï¼‰ï¼ŒcurrentIndexï¼Œå’Œéå†çš„å¯¹è±¡ã€‚ç¬¬ä¸€æ¬¡è°ƒç”¨å›è°ƒå‡½æ•°æ—¶ï¼ŒpreviousValue å’Œ currentValue çš„å–å€¼å¯ä»¥æ˜¯ä¸‹é¢ä¸¤ç§æƒ…å†µä¹‹ä¸€ã€‚å¦‚æœä¸º reduce è°ƒç”¨æä¾›äº†ä¸€ä¸ª initialValueï¼Œåˆ™ previousValue å°†ç­‰äº initialValue å¹¶ä¸” currentValue å°†ç­‰äºæ•°ç»„çš„é¦–ä¸ªå…ƒç´ å€¼ã€‚å¦‚æœæ²¡æä¾› initialValueï¼Œåˆ™ previousValue å°†ç­‰äºæ•°ç»„çš„é¦–ä¸ªå…ƒç´ å€¼å¹¶ä¸” currentValue å°†ç­‰äºæ•°ç»„çš„ç¬¬äºŒä¸ªå…ƒç´ å€¼ã€‚å¦‚æœæ•°ç»„é‡Œæ²¡æœ‰å…ƒç´ å¹¶ä¸”æ²¡æœ‰æä¾› initialValueï¼Œåˆ™æŠ›å‡ºä¸€ä¸ª TypeError å¼‚å¸¸ã€‚<br><strong>å¯¹ reduce çš„è°ƒç”¨ä¸ç›´æ¥æ›´æ”¹å¯¹è±¡ï¼Œä½†æ˜¯å¯¹ callbackfn çš„è°ƒç”¨å¯èƒ½æ›´æ”¹å¯¹è±¡ã€‚</strong></p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> b = a.reduce(<span class="function"><span class="keyword">function</span>(<span class="params">previousValue, currentValue, currentIndex, arr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> previousValue + currentValue;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(a);                     <span class="comment">// [ 1, 2, undefined, 3, 4 ]</span></span><br><span class="line"><span class="built_in">console</span>.log(b);                     <span class="comment">// 10</span></span><br></pre></td></tr></table></figure><blockquote><p><code>reduceRight ( callbackfn [ , initialValue ] )</code> </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> str1 = arr.reduce(<span class="function"><span class="keyword">function</span>(<span class="params">previousValue, currentValue, currentIndex, arr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> previousValue + currentValue;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> str2 = arr.reduceRight(<span class="function"><span class="keyword">function</span>(<span class="params">previousValue, currentValue, currentIndex, arr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> previousValue + currentValue;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(str1);  <span class="comment">// abc</span></span><br><span class="line"><span class="built_in">console</span>.log(str2);  <span class="comment">// cba</span></span><br></pre></td></tr></table></figure><blockquote><p><code>indexOf ( searchElement [ , fromIndex ] )</code> æŒ‰ç…§ç´¢å¼•çš„å‡åºæ¯”è¾ƒ searchElement å’Œæ•°ç»„é‡Œçš„å…ƒç´ ä»¬ï¼Œå®ƒä½¿ç”¨å†…éƒ¨çš„ä¸¥æ ¼ç›¸ç­‰æ¯”è¾ƒç®—æ³•ï¼Œå¦‚æœæ‰¾åˆ°ä¸€ä¸ªæˆ–æ›´å¤šè¿™æ ·çš„ä½ç½®ï¼Œè¿”å›è¿™äº›ä½ç½®ä¸­ç¬¬ä¸€ä¸ªç´¢å¼•ï¼›å¦åˆ™è¿”å› -1<br><code>lastIndexOf ( searchElement [ , fromIndex ] )</code></p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>];</span><br><span class="line"><span class="built_in">console</span>.log(arr.indexOf(<span class="string">'b'</span>));</span><br><span class="line"><span class="built_in">console</span>.log(arr.lastIndexOf(<span class="string">'b'</span>));</span><br></pre></td></tr></table></figure><h1 id="æ•°ç»„ç±»å‹"><a href="#æ•°ç»„ç±»å‹" class="headerlink" title="æ•°ç»„ç±»å‹"></a>æ•°ç»„ç±»å‹</h1><blockquote><p>ECMAScript 5 ä¸­ ä½¿ç”¨ <code>Array.isArray()</code> åˆ¤æ–­æ˜¯å¦ä¸ºæ•°ç»„<br>ECMAScript 3</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> isArray = <span class="built_in">Function</span>.isArray || <span class="function"><span class="keyword">function</span>(<span class="params">o</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">typeof</span> o === <span class="string">'object'</span></span><br><span class="line">        &amp;&amp; <span class="built_in">Object</span>.prototype.toString.call(o) === <span class="string">'[object Array]'</span>;</span><br><span class="line">    &#125;;</span><br></pre></td></tr></table></figure><h1 id="ç±»æ•°ç»„å¯¹è±¡"><a href="#ç±»æ•°ç»„å¯¹è±¡" class="headerlink" title="ç±»æ•°ç»„å¯¹è±¡"></a>ç±»æ•°ç»„å¯¹è±¡</h1><blockquote><p>æ£€æµ‹ç±»æ•°ç»„å¯¹è±¡</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isArrayLike</span>(<span class="params">o</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (o                           <span class="comment">// o é null undefined ç­‰</span></span><br><span class="line">        &amp;&amp; <span class="keyword">typeof</span> o === <span class="string">'object'</span>        <span class="comment">// o æ˜¯å¯¹è±¡</span></span><br><span class="line">        &amp;&amp; <span class="built_in">isFinite</span>(o.length)           <span class="comment">// o.length æ˜¯æœ‰é™æ•°å€¼</span></span><br><span class="line">        &amp;&amp; o.length &gt;= <span class="number">0</span>                <span class="comment">// o.length æ˜¯éè´Ÿæ•°</span></span><br><span class="line">        &amp;&amp; o.length === <span class="built_in">Math</span>.floor(o.length) <span class="comment">// o.length æ˜¯æ•´æ•°</span></span><br><span class="line">        &amp;&amp; o.length &lt; <span class="number">4294967296</span>            <span class="comment">// o.length &lt; 2^32</span></span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ECMAScript 5 æ‰€æœ‰çš„æ•°ç»„æ–¹æ³•éƒ½æ˜¯é€šç”¨çš„</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = &#123;</span><br><span class="line">    <span class="string">'0'</span>: <span class="string">'a'</span>,</span><br><span class="line">    <span class="string">'1'</span>: <span class="string">'b'</span>,</span><br><span class="line">    <span class="string">'2'</span>: <span class="string">'c'</span>,</span><br><span class="line">    length: <span class="number">3</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Array</span>.prototype.join.call(a, <span class="string">'+'</span>));         <span class="comment">// a+b+c</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Array</span>.prototype.slice.call(a, <span class="number">0</span>));          <span class="comment">// [ 'a', 'b', 'c' ]</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Array</span>.prototype.map.call(a, <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;   <span class="comment">// [ 'A', 'B', 'C' ]</span></span><br><span class="line">    <span class="keyword">return</span> x.toUpperCase();</span><br><span class="line">&#125;));</span><br></pre></td></tr></table></figure><blockquote><p>ä½œä¸ºæ•°ç»„çš„å­—ç¬¦ä¸²</p><blockquote><p>å­—ç¬¦ä¸²æ˜¯ä¸å¯å˜å€¼æ•…æŠŠå®ƒä»¬ä½œä¸ºæ•°ç»„çœ‹å¾…æ˜¯,å®ƒä»¬æ˜¯åªè¯»çš„,æ‰€ä»¥push(), sort(), reverse() ç­‰æ–¹æ³•åœ¨å­—ç¬¦ä¸²ä¸Šæ— æ•ˆ</p></blockquote></blockquote><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><h2 id="APIæ–‡æ¡£-ECMAScript5-1ä¸­æ–‡ç‰ˆ"><a href="#APIæ–‡æ¡£-ECMAScript5-1ä¸­æ–‡ç‰ˆ" class="headerlink" title="APIæ–‡æ¡£ ECMAScript5.1ä¸­æ–‡ç‰ˆ"></a>APIæ–‡æ¡£ ECMAScript5.1ä¸­æ–‡ç‰ˆ</h2><hr><blockquote><h3 id="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢"><a href="#æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢" class="headerlink" title="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~"></a>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</h3><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScriptæƒå¨æŒ‡å—å‹˜è¯¯è®°å½•</title>
      <link href="/2015/04/05/JavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E5%8B%98%E8%AF%AF%E8%AE%B0%E5%BD%95/"/>
      <url>/2015/04/05/JavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E5%8B%98%E8%AF%AF%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<h1 id="è®°å½•æˆ‘æ‰€è®¤ä¸ºçš„ç¬¬å…­ç‰ˆä¸­æ–‡ç‰ˆçš„é”™è¯¯-æ¬¢è¿æ‰¹è¯„"><a href="#è®°å½•æˆ‘æ‰€è®¤ä¸ºçš„ç¬¬å…­ç‰ˆä¸­æ–‡ç‰ˆçš„é”™è¯¯-æ¬¢è¿æ‰¹è¯„" class="headerlink" title="è®°å½•æˆ‘æ‰€è®¤ä¸ºçš„ç¬¬å…­ç‰ˆä¸­æ–‡ç‰ˆçš„é”™è¯¯;æ¬¢è¿æ‰¹è¯„~~"></a>è®°å½•æˆ‘æ‰€è®¤ä¸ºçš„ç¬¬å…­ç‰ˆä¸­æ–‡ç‰ˆçš„é”™è¯¯;æ¬¢è¿æ‰¹è¯„~~</h1><a id="more"></a><h1 id="P56"><a href="#P56" class="headerlink" title="P56"></a>P56</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">myscope = <span class="string">"local"</span>;  <span class="comment">//è¿™é‡Œæ˜¾å¼åœ°å£°æ˜äº†ä¸€ä¸ªæ–°çš„å…¨å±€å˜é‡</span></span><br></pre></td></tr></table></figure><hr><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">myscope = <span class="string">"local"</span>;  <span class="comment">//è¿™é‡Œéšå¼åœ°å£°æ˜äº†ä¸€ä¸ªæ–°çš„å…¨å±€å˜é‡</span></span><br></pre></td></tr></table></figure><h1 id="P57"><a href="#P57" class="headerlink" title="P57"></a>P57</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">checkscope()  <span class="comment">// =&gt; "åµŒå¥—çš„ä½œç”¨åŸŸ"</span></span><br></pre></td></tr></table></figure><hr><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ³¨é‡Šéƒ¨åˆ†åº”ä¿æŒè‹±æ–‡ä¸ç¿»è¯‘</span></span><br><span class="line">checkscope()  <span class="comment">// =&gt; "nested scope"</span></span><br></pre></td></tr></table></figure><h1 id="P75"><a href="#P75" class="headerlink" title="P75"></a>P75</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å¦‚æœä¸¤ä¸ªå€¼éƒ½æ˜¯<span class="literal">null</span>æˆ–è€…éƒ½æ˜¯<span class="literal">undefined</span>ï¼Œåˆ™å®ƒä»¬ä¸ç›¸ç­‰ã€‚</span><br></pre></td></tr></table></figure><hr><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å¦‚æœä¸¤ä¸ªå€¼éƒ½æ˜¯<span class="literal">null</span>æˆ–è€…éƒ½æ˜¯<span class="literal">undefined</span>ï¼Œåˆ™å®ƒä»¬ç›¸ç­‰ã€‚</span><br></pre></td></tr></table></figure><h1 id="P77"><a href="#P77" class="headerlink" title="P77"></a>P77</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">String</span>.localCompare()æ–¹æ³•</span><br></pre></td></tr></table></figure><hr><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">String</span>.prototype.localeCompare() <span class="comment">// ä¸ªäººè§‰å¾—æ˜¯prototype; å¹¶ä¸”æ˜¯localeCompare</span></span><br></pre></td></tr></table></figure><h1 id="P125"><a href="#P125" class="headerlink" title="P125"></a>P125</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å¦‚æœä¹‹å‰oç»§æ‰¿è‡ªå±æ€§x</span><br></pre></td></tr></table></figure><hr><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å¦‚æœä¹‹å‰oç»§æ‰¿äº†å±æ€§x</span><br><span class="line">ä¸‹åŒï¼Œæ‰€æœ‰â€œç»§æ‰¿è‡ªâ€éƒ½åº”æ”¹ä¸ºâ€œç»§æ‰¿äº†â€ã€‚</span><br></pre></td></tr></table></figure><h1 id="P129"><a href="#P129" class="headerlink" title="P129"></a>P129</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å¦‚æœxæ˜¯undefinedã€nullã€falseã€" "ã€0æˆ–NaN,åˆ™å®ƒä¿æŒä¸å˜</span></span><br></pre></td></tr></table></figure><hr><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å­—ç¬¦ä¸²ä¸­åº”æ²¡æœ‰ç©ºæ ¼ï¼š</span><br><span class="line"><span class="comment">//å¦‚æœxæ˜¯undefinedã€nullã€falseã€""ã€0æˆ–NaN,åˆ™å®ƒä¿æŒä¸å˜</span></span><br></pre></td></tr></table></figure><h1 id="P140"><a href="#P140" class="headerlink" title="P140"></a>P140</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.esExtensible()</span><br></pre></td></tr></table></figure><hr><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.isExtensible()</span><br></pre></td></tr></table></figure><h1 id="P145"><a href="#P145" class="headerlink" title="P145"></a>P145</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a1 = [,,,]  </span><br><span class="line"><span class="number">0</span> <span class="keyword">in</span> a1  <span class="comment">// =&gt; true</span></span><br></pre></td></tr></table></figure><hr><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a1 = [, , ,];</span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">0</span> <span class="keyword">in</span> a1);<span class="comment">// false</span></span><br></pre></td></tr></table></figure><h1 id="P150"><a href="#P150" class="headerlink" title="P150"></a>P150</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!a[i]) <span class="keyword">continue</span>;        <span class="comment">// è·³è¿‡ null, undefined å’Œä¸å­˜åœ¨å…ƒç´ </span></span><br></pre></td></tr></table></figure><hr><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!a[i]) <span class="keyword">continue</span>;        <span class="comment">// è·³è¿‡ null, undefined , 0, '' å’Œä¸å­˜åœ¨å…ƒç´ </span></span><br></pre></td></tr></table></figure><h1 id="P152"><a href="#P152" class="headerlink" title="P152"></a>P152</h1><p>æ•°ç»„æ–¹æ³•<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¸ªäººè§‰å¾—æ–¹æ³•ä¸éƒ½æ˜¯åœ¨ Array.prototype ä¸Šçš„å—?</span></span><br><span class="line"><span class="comment">// P163 è¯´åœ¨Firefox ä¸Šå¯ä»¥ä½¿ç”¨ Array.join() ç­‰,ä½†æ˜¯chromeä¸‹å¤±è´¥........</span></span><br></pre></td></tr></table></figure></p><h1 id="P196"><a href="#P196" class="headerlink" title="P196"></a>P196</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> even = <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;        <span class="comment">// åˆ¤æ–­aæ˜¯å¦ä¸ºå¶æ•°çš„å‡½æ•°</span></span><br><span class="line">    <span class="keyword">return</span> x % <span class="number">2</span> === <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><hr><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> even = <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;        <span class="comment">// åˆ¤æ–­xæ˜¯å¦ä¸ºå¶æ•°çš„å‡½æ•°</span></span><br><span class="line">    <span class="keyword">return</span> x % <span class="number">2</span> === <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h1 id="P203"><a href="#P203" class="headerlink" title="P203"></a>P203</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> r = range(<span class="number">1</span>, <span class="number">3</span>);</span><br><span class="line"><span class="built_in">console</span>.log(r.includes(<span class="number">2</span>));</span><br><span class="line">r.foreach(<span class="built_in">console</span>.log);</span><br><span class="line"><span class="built_in">console</span>.log(r);             <span class="comment">// è¾“å‡º(1...3)</span></span><br></pre></td></tr></table></figure><hr><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> r = range(<span class="number">1</span>, <span class="number">3</span>);</span><br><span class="line"><span class="built_in">console</span>.log(r.includes(<span class="number">2</span>));</span><br><span class="line">r.foreach(<span class="built_in">console</span>.log);         <span class="comment">// nodeä¸‹æ­£ç¡®  chrome/firefoxçš„ Console ä¸‹è¾“å‡ºå¦‚ä¸‹é”™è¯¯:</span></span><br><span class="line">                                <span class="comment">// TypeError: 'log' called on an object that does not implement interface Console</span></span><br><span class="line">                                <span class="comment">// å‚è€ƒ: https://bugzilla.mozilla.org/show_bug.cgi?id=989619</span></span><br><span class="line"><span class="built_in">console</span>.log(r); <span class="comment">// nodeä¸‹: &#123; from: 1, to: 3 &#125;   chromeä¸‹: Object &#123;from: 1, to: 3, includes: function, foreach: function, toString: function&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(r.toString());          <span class="comment">// æ˜¾ç¤º æˆ– éšå¼ è°ƒç”¨æ‰ä¼šè¾“å‡º (1...3)</span></span><br><span class="line"><span class="built_in">console</span>.log(r + <span class="string">''</span>);</span><br></pre></td></tr></table></figure><h1 id="P204"><a href="#P204" class="headerlink" title="P204"></a>P204</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> r = range(<span class="number">1</span>, <span class="number">3</span>);            <span class="comment">// è¿™é‡Œåº”è¯¥ä½¿ç”¨ æ„é€ å‡½æ•°çš„æ–¹å¼äº†!!</span></span><br><span class="line"><span class="built_in">console</span>.log(r.includes(<span class="number">2</span>));</span><br><span class="line">r.foreach(<span class="built_in">console</span>.log);</span><br></pre></td></tr></table></figure><hr><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> r = <span class="keyword">new</span> Range(<span class="number">1</span>, <span class="number">3</span>);        <span class="comment">// new Range(1, 3)</span></span><br><span class="line"><span class="built_in">console</span>.log(r.includes(<span class="number">2</span>));     </span><br><span class="line">r.foreach(<span class="built_in">console</span>.log);</span><br></pre></td></tr></table></figure><h1 id="P211"><a href="#P211" class="headerlink" title="P211"></a>P211</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.toString().match( <span class="regexp">/function\s*([^()*]\(/</span> )[<span class="number">1</span>];</span><br></pre></td></tr></table></figure><hr><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.toString().match( <span class="regexp">/function\s*([^(]*)\(/</span> )[<span class="number">1</span>];</span><br></pre></td></tr></table></figure><h1 id="P230"><a href="#P230" class="headerlink" title="P230"></a>P230</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å¦‚æœBæ–¹æ³•é‡è½½äº†Aæ–¹æ³•</span><br></pre></td></tr></table></figure><hr><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">å¦‚æœBæ–¹æ³•è¦†ç›–äº†Aæ–¹æ³•  <span class="comment">// é‡è½½ï¼ˆoverloadï¼‰è¦†ç›–ï¼ˆoverrideï¼‰</span></span><br><span class="line"><span class="comment">// è‹±æ–‡åŸç‰ˆP228  If a method of B overrides a method of A</span></span><br><span class="line"><span class="comment">// 9.7èŠ‚å°†æ‰€æœ‰çš„overrideéƒ½é”™è¯¯åœ°ç¿»è¯‘æˆäº†â€œé‡è½½â€ï¼Œåº”ä¸ºâ€œè¦†ç›–â€ã€‚</span></span><br></pre></td></tr></table></figure><blockquote><p> é‡è½½æ˜¯æŒ‡ä¸åŒçš„å‡½æ•°ä½¿ç”¨ç›¸åŒçš„å‡½æ•°åï¼Œä½†æ˜¯å‡½æ•°çš„å‚æ•°ä¸ªæ•°æˆ–ç±»å‹ä¸åŒã€‚è°ƒ çš„æ—¶å€™æ ¹æ®å‡½æ•°çš„å‚æ•°æ¥åŒºåˆ«ä¸åŒçš„å‡½æ•°ã€‚</p></blockquote><blockquote><p> è¦†ç›–ï¼ˆä¹Ÿå«é‡å†™ï¼‰æ˜¯æŒ‡åœ¨æ´¾ç”Ÿç±»ä¸­é‡æ–°å¯¹åŸºç±»ä¸­çš„è™šå‡½æ•°ï¼ˆæ³¨æ„æ˜¯è™šå‡½æ•°ï¼‰é‡æ–°å®ç°ã€‚å³å‡½æ•°åå’Œå‚æ•°éƒ½ä¸€æ ·ï¼Œåªæ˜¯å‡½æ•°çš„å®ç°ä½“ä¸ä¸€æ ·ã€‚</p></blockquote><blockquote><p>éšè—æ˜¯æŒ‡æ´¾ç”Ÿç±»ä¸­çš„å‡½æ•°æŠŠåŸºç±»ä¸­ç›¸åŒåå­—çš„å‡½æ•°å±è”½æ‰äº†ã€‚éšè—ä¸å¦å¤–ä¸¤ä¸ªæ¦‚å¿µè¡¨é¢ä¸Šçœ‹æ¥å¾ˆåƒï¼Œå¾ˆéš¾åŒºåˆ†ï¼Œå…¶å®ä»–ä»¬çš„å…³é”®åŒºåˆ«å°±æ˜¯åœ¨å¤šæ€çš„å®ç°ä¸Šã€‚ä»€ä¹ˆå«å¤šæ€ï¼Ÿç®€å•åœ°è¯´å°±æ˜¯ä¸€ä¸ªæ¥å£ï¼Œå¤šç§å®ç°å§ã€‚</p></blockquote><blockquote><p><a href="http://blog.csdn.net/yanjun_1982/article/details/470405" target="_blank" rel="noopener">é‡è½½ è¦†ç›– è§£é‡Šæ¥è‡ªäºyanjun_1982</a></p></blockquote><h1 id="P233"><a href="#P233" class="headerlink" title="P233"></a>P233</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä½†å®ƒéœ€è¦å®Œå…¨é‡æ–°å®ç°ä¸€ä¸ªadd()æ–¹æ³•</span><br></pre></td></tr></table></figure><hr><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä½†å®ƒä¸éœ€è¦å®Œå…¨é‡æ–°å®ç°ä¸€ä¸ªadd()æ–¹æ³•</span><br></pre></td></tr></table></figure><h1 id="P255"><a href="#P255" class="headerlink" title="P255"></a>P255</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\o     NULå­—ç¬¦(\u0000)]</span><br></pre></td></tr></table></figure><hr><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\<span class="number">0</span>     NULå­—ç¬¦(\u0000)]   <span class="comment">// æ˜¯é›¶ä¸æ˜¯æ¬§</span></span><br></pre></td></tr></table></figure><h1 id="P256"><a href="#P256" class="headerlink" title="P256"></a>P256</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">\wä»»ä½•ASCIIå­—ç¬¦ç»„æˆçš„å•è¯ï¼Œç­‰ä»·äº[a-zA-Z0<span class="number">-9</span>]</span><br><span class="line">\Wä»»ä½•ä¸æ˜¯ASCIIå­—ç¬¦ç»„æˆçš„å•è¯ï¼Œç­‰ä»·äº[^a-zA-Z0<span class="number">-9</span>]</span><br></pre></td></tr></table></figure><hr><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">\wä»»ä½•ASCIIå­—ç¬¦ï¼Œç­‰ä»·äº [a-zA-Z0<span class="number">-9</span>_]      <span class="comment">// æ˜¯å­—ç¬¦è€Œéå•è¯ï¼Œä¸”é—æ¼åŸæ–‡ä¸­ç­‰ä»·ç±»çš„ä¸‹åˆ’çº¿</span></span><br><span class="line">\Wä»»ä½•éASCIIå­—ç¬¦ï¼Œç­‰ä»·äº [^a-zA-Z0<span class="number">-9</span>_]</span><br></pre></td></tr></table></figure><h1 id="P260"><a href="#P260" class="headerlink" title="P260"></a>P260</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/Java(?! Script)([A-Z]\w*)/</span><br></pre></td></tr></table></figure><hr><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/Java(?!Script)([A-Z]\w*)/     æ²¡æœ‰ç©ºæ ¼</span><br></pre></td></tr></table></figure><h1 id="P260-1"><a href="#P260-1" class="headerlink" title="P260"></a>P260</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å®ƒå¯ä»¥åŒ¹é…â€œJavaScriptâ€ï¼Œä½†ä¸èƒ½åŒ¹é…â€œJavaScripterâ€ã€‚</span><br></pre></td></tr></table></figure><hr><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åŸæ–‡: it matches â€œJavaScripâ€ but not â€œJavaScriptâ€ or â€œJavaScripterâ€.</span></span><br><span class="line">å®ƒå¯ä»¥åŒ¹é…â€œJavaScripâ€ï¼Œä½†ä¸èƒ½åŒ¹é…â€œJavaScriptâ€æˆ–â€œJavaScripterâ€ã€‚</span><br></pre></td></tr></table></figure><h1 id="P371"><a href="#P371" class="headerlink" title="P371"></a>P371</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nextSibling previoursSibling   <span class="comment">// æ‹¼å†™é”™è¯¯</span></span><br></pre></td></tr></table></figure><hr><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nextSibling previousSibling</span><br></pre></td></tr></table></figure><h1 id="P393"><a href="#P393" class="headerlink" title="P393"></a>P393</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Windowå¯¹è±¡çš„ScrollTop()æ–¹æ³•</span><br></pre></td></tr></table></figure><hr><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Windowå¯¹è±¡çš„ScrollTo()æ–¹æ³•</span><br></pre></td></tr></table></figure><h1 id="P408"><a href="#P408" class="headerlink" title="P408"></a>P408</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bold</span>(<span class="params"></span>) </span>&#123; <span class="built_in">document</span>.execCommand(<span class="string">"bold"</span>, <span class="literal">false</span>, url); &#125;</span><br></pre></td></tr></table></figure><hr><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bold</span>(<span class="params"></span>) </span>&#123; <span class="built_in">document</span>.execCommand(<span class="string">"bold"</span>, <span class="literal">false</span>, <span class="literal">null</span>); &#125;   <span class="comment">// æ²¡æœ‰ url.........</span></span><br></pre></td></tr></table></figure><h1 id="P409"><a href="#P409" class="headerlink" title="P409"></a>P409</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.queryCommandSupport()</span><br></pre></td></tr></table></figure><hr><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.queryCommandSupported()</span><br></pre></td></tr></table></figure><h1 id="P447-17-1-2-DOMäº‹ä»¶"><a href="#P447-17-1-2-DOMäº‹ä»¶" class="headerlink" title="P447  17.1.2 DOMäº‹ä»¶"></a>P447  17.1.2 DOMäº‹ä»¶</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3</span>çº§DOMäº‹ä»¶è§„èŒƒæ ‡å‡†åŒ–äº†ä¸å†’æ³¡çš„focusinå’Œfocusoutäº‹ä»¶æ¥å–ä»£å†’æ³¡çš„focuså’Œbluräº‹ä»¶</span><br></pre></td></tr></table></figure><hr><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3</span>çº§DOMäº‹ä»¶è§„èŒƒæ ‡å‡†åŒ–äº†å†’æ³¡çš„focusinå’Œfocusoutäº‹ä»¶æ¥å–ä»£ä¸å†’æ³¡çš„focuså’Œbluräº‹ä»¶</span><br></pre></td></tr></table></figure><h1 id="P447-17-1-2-DOMäº‹ä»¶-1"><a href="#P447-17-1-2-DOMäº‹ä»¶-1" class="headerlink" title="P447  17.1.2 DOMäº‹ä»¶"></a>P447  17.1.2 DOMäº‹ä»¶</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ ‡å‡†åŒ–äº†å†’æ³¡çš„mouseenterå’Œmouseleaveäº‹ä»¶æ¥å–ä»£ä¸å†’æ³¡çš„mouseoverå’Œmouseoutäº‹ä»¶</span><br></pre></td></tr></table></figure><hr><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ ‡å‡†åŒ–äº†ä¸å†’æ³¡çš„mouseenterå’Œmouseleaveäº‹ä»¶æ¥å–ä»£å†’æ³¡çš„mouseoverå’Œmouseoutäº‹ä»¶</span><br></pre></td></tr></table></figure><h1 id="P453-17-2-3-addEventListener"><a href="#P453-17-2-3-addEventListener" class="headerlink" title="P453 17.2.3 addEventListener()"></a>P453 17.2.3 addEventListener()</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;button id=<span class="string">"my button"</span>&gt;</span><br></pre></td></tr></table></figure><hr><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;button id=<span class="string">"mybutton"</span>&gt;</span><br></pre></td></tr></table></figure><h1 id="P490-18-1-1-æŒ‡å®šè¯·æ±‚"><a href="#P490-18-1-1-æŒ‡å®šè¯·æ±‚" class="headerlink" title="P490 18.1.1 æŒ‡å®šè¯·æ±‚"></a>P490 18.1.1 æŒ‡å®šè¯·æ±‚</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setRequestHeader()æ–¹æ³•çš„è°ƒç”¨å¿…é¡»åœ¨è°ƒç”¨open()ä¹‹å‰ä½†åœ¨è°ƒç”¨send()ä¹‹å</span><br></pre></td></tr></table></figure><hr><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setRequestHeader()æ–¹æ³•çš„è°ƒç”¨å¿…é¡»åœ¨è°ƒç”¨open()ä¹‹åä½†åœ¨è°ƒç”¨send()ä¹‹å‰</span><br></pre></td></tr></table></figure><h1 id="P580-å®¢æˆ·ç«¯å­˜å‚¨-å¯¼è¨€"><a href="#P580-å®¢æˆ·ç«¯å­˜å‚¨-å¯¼è¨€" class="headerlink" title="P580 å®¢æˆ·ç«¯å­˜å‚¨_å¯¼è¨€"></a>P580 å®¢æˆ·ç«¯å­˜å‚¨_å¯¼è¨€</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æœ¬ä¹¦ç¬¬<span class="number">8</span>ç« ä»‹ç»è¿‡ç°åœ¨ä¸»æµæµè§ˆå™¨éƒ½æ”¯æŒä¸€ä¸ªæ–‡ä»¶å¯¹è±¡</span><br></pre></td></tr></table></figure><hr><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æœ¬ä¹¦ç¬¬<span class="number">18</span>ç« ä»‹ç»è¿‡ç°åœ¨ä¸»æµæµè§ˆå™¨éƒ½æ”¯æŒä¸€ä¸ªæ–‡ä»¶å¯¹è±¡</span><br></pre></td></tr></table></figure><h1 id="P598-20-4-2-ç¼“å­˜æ›´æ–°-ä¾‹20-4"><a href="#P598-20-4-2-ç¼“å­˜æ›´æ–°-ä¾‹20-4" class="headerlink" title="P598 20.4.2 ç¼“å­˜æ›´æ–°_ä¾‹20-4"></a>P598 20.4.2 ç¼“å­˜æ›´æ–°_ä¾‹20-4</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// äº‹ä»¶å¯¹è±¡åº”å½“æ˜¯"process"äº‹ä»¶(å°±åƒå“ªäº›è¢«XH2ä½¿ç”¨çš„)</span></span><br></pre></td></tr></table></figure><hr><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// äº‹ä»¶å¯¹è±¡åº”å½“æ˜¯"progress"äº‹ä»¶(å°±åƒé‚£äº›è¢«XH2ä½¿ç”¨çš„)</span></span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul><li><a href="http://mjpclab.blog.163.com/blog/static/6234841120142250612657/" target="_blank" rel="noopener">http://mjpclab.blog.163.com/blog/static/6234841120142250612657/</a></li><li><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=989619" target="_blank" rel="noopener">https://bugzilla.mozilla.org/show_bug.cgi?id=989619</a></li><li><a href="http://blog.csdn.net/yanjun_1982/article/details/470405" target="_blank" rel="noopener">http://blog.csdn.net/yanjun_1982/article/details/470405</a></li></ul><hr><blockquote><h3 id="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢"><a href="#æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢" class="headerlink" title="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~"></a>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</h3><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScriptæƒå¨æŒ‡å—ç¬”è®°3</title>
      <link href="/2015/04/03/JavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E7%AC%94%E8%AE%B03/"/>
      <url>/2015/04/03/JavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E7%AC%94%E8%AE%B03/</url>
      
        <content type="html"><![CDATA[<p>JavaScriptæƒå¨æŒ‡å—ç¬”è®°150403<br><a id="more"></a></p><h2 id="å¯¹è±¡-P120"><a href="#å¯¹è±¡-P120" class="headerlink" title="å¯¹è±¡ P120"></a>å¯¹è±¡ <code>P120</code></h2><blockquote><p>é€šè¿‡<code>å¯¹è±¡ç›´æ¥é‡</code>,<code>å…³é”®å­—new</code>,<code>Object.create()</code>(<em>ECMAScript 5</em>)åˆ›å»ºå¯¹è±¡<br><code>Object.create(null)</code>åˆ›å»ºä¸€ä¸ªæ²¡æœ‰åŸå‹çš„å¯¹è±¡;ä½†å®ƒä¸ä¼šç»§æ‰¿ä»»ä½•ä¸œè¥¿,åŒ…æ‹¬<code>toString()</code>ç­‰åŸºç¡€æ–¹æ³•;ä¹Ÿå°±æ˜¯è¯´,å®ƒä¸èƒ½å’Œ<code>+</code>è¿ç®—ç¬¦ä¸€èµ·å·¥ä½œ<br>åˆ›å»ºä¸€ä¸ªæ™®é€šçš„ç©ºå¯¹è±¡</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> o = <span class="built_in">Object</span>.create(<span class="built_in">Object</span>.prototype);</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * /**</span></span><br><span class="line"><span class="comment"> * å…¼å®¹ECMAScript 5</span></span><br><span class="line"><span class="comment"> * è¿”å›ä¸€ä¸ªç»§æ‰¿è‡ªåŸå‹å¯¹è±¡pçš„å±æ€§çš„æ–°å¯¹è±¡</span></span><br><span class="line"><span class="comment"> * @param p è¦ç»§æ‰¿åŸå‹å¯¹è±¡</span></span><br><span class="line"><span class="comment"> * @returns &#123;*&#125; æ–°å¯¹è±¡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">inherit</span>(<span class="params">p</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (p == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span>  <span class="built_in">TypeError</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">Object</span>.create) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Object</span>.create(p);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> t = <span class="keyword">typeof</span> p;</span><br><span class="line">    <span class="keyword">if</span> (t !== <span class="string">'object'</span> &amp;&amp; t != <span class="string">'function'</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span>  <span class="built_in">TypeError</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">    f.prototype = p;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> f();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å±æ€§è®¿é—®é”™è¯¯-P127"><a href="#å±æ€§è®¿é—®é”™è¯¯-P127" class="headerlink" title="å±æ€§è®¿é—®é”™è¯¯ P127"></a>å±æ€§è®¿é—®é”™è¯¯ <code>P127</code></h2><blockquote><p>ä¸‹åˆ—åœºæ™¯ç»™å¯¹è±¡oè®¾ç½®å±æ€§på¤±è´¥</p><blockquote><p>oä¸­çš„ç†Ÿæ‚‰pæ˜¯åªè¯»çš„<br>oä¸­çš„å±æ€§pæ˜¯ç»§æ‰¿å±æ€§,å¹¶ä¸”å®ƒæ˜¯åªè¯»çš„<br>oæ²¡æœ‰ä½¿ç”¨setteræ–¹æ³•ç»§æ‰¿å±æ€§p;å¹¶ä¸”oçš„å¯æ‰©å±•æ€§æ˜¯false</p></blockquote></blockquote><h2 id="åˆ é™¤å±æ€§-P127"><a href="#åˆ é™¤å±æ€§-P127" class="headerlink" title="åˆ é™¤å±æ€§ P127"></a>åˆ é™¤å±æ€§ <code>P127</code></h2><blockquote><p><code>delete</code>è¿ç®—ç¬¦åªèƒ½åˆ é™¤è‡ªæœ‰å±æ€§,ä¸èƒ½åˆ é™¤ç»§æ‰¿å±æ€§</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = &#123;</span><br><span class="line">    p: &#123;</span><br><span class="line">        x: <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> b = a.p;</span><br><span class="line"><span class="keyword">delete</span> a.p;</span><br><span class="line"><span class="built_in">console</span>.log(b.x); <span class="comment">// 1</span></span><br></pre></td></tr></table></figure><blockquote><p>ç”±äºå·²ç»åˆ é™¤çš„å±æ€§çš„å¼•ç”¨ä¾ç„¶å­˜åœ¨,åœ¨æŸäº›ä¸ä¸¥è°¨çš„ä»£ç ä¸­å¯èƒ½é€ æˆå†…å­˜æ³„æ¼<br>åœ¨é”€æ¯å¯¹è±¡çš„æ—¶å€™,è¦éå†å±æ€§ä¸­çš„å±æ€§,ä¾æ¬¡åˆ é™¤</p></blockquote><blockquote><p>deleteè¡¨è¾¾å¼åˆ é™¤æˆåŠŸæˆ–æ²¡æœ‰ä»»ä½•å‰¯ä½œç”¨(å¦‚åˆ é™¤ä¸å­˜åœ¨çš„å±æ€§)æˆ–deleteåä¸æ˜¯ä¸€ä¸ªå±æ€§è®¿é—®è¡¨è¾¾å¼,delete è¿”å›true</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> o = &#123;<span class="attr">x</span>: <span class="number">1</span>&#125;;</span><br><span class="line"><span class="keyword">delete</span> o.x;   <span class="comment">// åˆ é™¤x;è¿”å›true</span></span><br><span class="line"><span class="keyword">delete</span> o.x;   <span class="comment">// ä»€ä¹ˆä¹Ÿä¸åš(xä¸å­˜åœ¨); è¿”å›true</span></span><br><span class="line"><span class="keyword">delete</span> o.toString; <span class="comment">// ä»€ä¹ˆä¹Ÿä¸åš(toStringæ˜¯ç»§æ‰¿æ¥çš„); è¿”å›true</span></span><br><span class="line"><span class="keyword">delete</span> o<span class="number">.1</span>      <span class="comment">// æ— æ„ä¹‰,è¿”å›true</span></span><br></pre></td></tr></table></figure><h2 id="æ£€æµ‹å±æ€§"><a href="#æ£€æµ‹å±æ€§" class="headerlink" title="æ£€æµ‹å±æ€§"></a>æ£€æµ‹å±æ€§</h2><h3 id="æ£€æµ‹-å±æ€§å-å­—ç¬¦ä¸²-in-å¯¹è±¡"><a href="#æ£€æµ‹-å±æ€§å-å­—ç¬¦ä¸²-in-å¯¹è±¡" class="headerlink" title="æ£€æµ‹: å±æ€§å(å­—ç¬¦ä¸²) in å¯¹è±¡;"></a>æ£€æµ‹: å±æ€§å(å­—ç¬¦ä¸²) in å¯¹è±¡;</h3><blockquote><p>å¦‚æœå¯¹è±¡çš„è‡ªæœ‰å±æ€§æˆ–è€…ç»§æ‰¿å±æ€§åŒ…å«è¿™ä¸ªå±æ€§åˆ™è¿”å›true<br><code>hasOwnProperty()</code> æ£€æµ‹æ˜¯å¦æ˜¯å¯¹è±¡çš„è‡ªæœ‰å±æ€§<br><code>propertyIsEnumerable()</code> æ£€æµ‹è‡ªæœ‰å±æ€§å¹¶ä¸”æ˜¯å¯æšä¸¾çš„</p></blockquote><h3 id="åˆ¤æ–­ä¸€ä¸ªå±æ€§æ˜¯å¦ä¸º-undefined"><a href="#åˆ¤æ–­ä¸€ä¸ªå±æ€§æ˜¯å¦ä¸º-undefined" class="headerlink" title="!== åˆ¤æ–­ä¸€ä¸ªå±æ€§æ˜¯å¦ä¸º undefined"></a>!== åˆ¤æ–­ä¸€ä¸ªå±æ€§æ˜¯å¦ä¸º <code>undefined</code></h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> o = &#123;</span><br><span class="line">    x: <span class="number">1</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(o.x !== <span class="literal">undefined</span>); <span class="comment">//true: oä¸­å±æ€§x</span></span><br><span class="line"><span class="built_in">console</span>.log(o.y !== <span class="literal">undefined</span>); <span class="comment">// false: oä¸­æ²¡æœ‰å±æ€§y</span></span><br><span class="line"><span class="built_in">console</span>.log(o.toString !== <span class="literal">undefined</span>); <span class="comment">// true: oç»§æ‰¿äº†toStringå±æ€§</span></span><br></pre></td></tr></table></figure><h3 id="in-å’Œ-å’Œ"><a href="#in-å’Œ-å’Œ" class="headerlink" title="in å’Œ !== å’Œ !="></a><code>in</code> å’Œ <code>!==</code> å’Œ <code>!=</code></h3><blockquote><p>in å¯ä»¥åŒºåˆ†ä¸å­˜åœ¨çš„å±æ€§å’Œå­˜åœ¨ä½†æ˜¯å€¼ä¸ºundefinedçš„å±æ€§</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> o = &#123;</span><br><span class="line">    x: <span class="literal">undefined</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(o.x !== <span class="literal">undefined</span>); <span class="comment">// false: å±æ€§å­˜åœ¨,å€¼ä¸ºfalse</span></span><br><span class="line"><span class="built_in">console</span>.log(o.y !== <span class="literal">undefined</span>); <span class="comment">// false: å±æ€§ä¸å­˜åœ¨</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'x'</span> <span class="keyword">in</span> o);          <span class="comment">// true: å±æ€§å­˜åœ¨</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'y'</span> <span class="keyword">in</span> o);          <span class="comment">// false; å±æ€§ä¸å­˜åœ¨</span></span><br></pre></td></tr></table></figure><blockquote><p><code>!==</code>åŒºåˆ† <code>undefined</code> å’Œ  <code>null</code></p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// xçš„å€¼ä¸æ˜¯nullæˆ–undefined</span></span><br><span class="line"><span class="keyword">if</span> (x != <span class="literal">null</span>) &#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// xçš„å€¼ä¸æ˜¯ null undefined false '' 0 NaN</span></span><br><span class="line"><span class="keyword">if</span> (x) &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æšä¸¾å±æ€§"><a href="#æšä¸¾å±æ€§" class="headerlink" title="æšä¸¾å±æ€§"></a>æšä¸¾å±æ€§</h2><blockquote><p>got/inéå†å¯æšä¸¾å±æ€§(è‡ªæœ‰å±æ€§å’Œç»§æ‰¿å±æ€§)<br><code>ECMAScript 5</code> ä¸­:</p><blockquote><p><code>Object.keys()</code> è¿”å›å¯æšä¸¾çš„è‡ªæœ‰å±æ€§çš„åç§°æ•°ç»„<br><code>Object.getOwnPropertyNames()</code> è¿”å›æ‰€æœ‰è‡ªæœ‰å±æ€§çš„åç§°æ•°ç»„</p></blockquote></blockquote><h2 id="getter-å’Œ-setter"><a href="#getter-å’Œ-setter" class="headerlink" title="getter å’Œ setter"></a><code>getter</code> å’Œ <code>setter</code></h2><blockquote><p>å®šä¹‰å­˜å‚¨å™¨çš„å±æ€§ä½¿ç”¨ä¸€ä¸ªæˆ–ä¸¤ä¸ªå’Œå±æ€§åŒåçš„å‡½æ•°,ä½¿ç”¨ <code>get</code> å’Œ <code>set</code> å…³é”®å­—<br>å‡½æ•°ä½“å†…çš„ <code>this</code> æŒ‡å‘è¿™ä¸ªå¯¹è±¡<br>å­˜å–å™¨å±æ€§æ˜¯å¯ä»¥ç»§æ‰¿çš„</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç›´è§’åæ ‡ç³»å®šä¹‰</span></span><br><span class="line"><span class="keyword">var</span> p = &#123;</span><br><span class="line">    x : <span class="number">1.0</span>,        <span class="comment">// xå’Œyä¸ºæ™®é€šçš„å¯è¯»å†™çš„æ•°æ®å±æ€§</span></span><br><span class="line">    y: <span class="number">1.0</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// r  æ˜¯å¯è¯»å†™çš„å­˜å–å™¨å±æ€§, æœ‰ getter å’Œ setter</span></span><br><span class="line">    get r() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Math</span>.sqrt(<span class="keyword">this</span>.x * <span class="keyword">this</span>.x + <span class="keyword">this</span>.y * <span class="keyword">this</span>.y);</span><br><span class="line">    &#125;,</span><br><span class="line">    set r(newValue) &#123;</span><br><span class="line">        <span class="keyword">var</span> oldValue = <span class="built_in">Math</span>.sqrt(<span class="keyword">this</span>.x * <span class="keyword">this</span>.x + <span class="keyword">this</span>.y * <span class="keyword">this</span>.y);</span><br><span class="line">        <span class="keyword">var</span> ratio = newValue / oldValue;</span><br><span class="line">        <span class="keyword">this</span>.x *= ratio;</span><br><span class="line">        <span class="keyword">this</span>.y *= ratio;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// theatè§’åº¦ æ˜¯åªè¯»å­˜å–å™¨å±æ€§, å®ƒåªæœ‰getteræ–¹æ³•</span></span><br><span class="line">    get theta() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Math</span>.atan2(<span class="keyword">this</span>.y, <span class="keyword">this</span>.x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="å±æ€§çš„ç‰¹æ€§"><a href="#å±æ€§çš„ç‰¹æ€§" class="headerlink" title="å±æ€§çš„ç‰¹æ€§"></a>å±æ€§çš„ç‰¹æ€§</h2><blockquote><p>æ•°æ®å±æ€§çš„4ä¸ªç‰¹æ€§: </p><blockquote><p><code>value</code> (å®ƒçš„å€¼) <code>writable</code> (å¯å†™æ€§) <code>enumerable</code> (å¯æšä¸¾æ€§) <code>configurable</code> (å¯é…æ€§)</p></blockquote></blockquote><blockquote><p>å­˜å–å™¨å±æ€§çš„4ä¸ªç‰¹æ€§:</p><blockquote><p><code>get</code> (è¯»å–) <code>set</code>(å†™å…¥) <code>enumerable</code> (å¯æšä¸¾æ€§) <code>configurable</code> (å¯é…æ€§)</p></blockquote></blockquote><blockquote><p><code>Object.getOwnPropertyDescriptor()</code> è·å–æŸä¸ªå¯¹è±¡ç‰¹å®šçš„å±æ€§æè¿°ç¬¦<br>åªèƒ½å¾—åˆ°è‡ªæœ‰å±æ€§çš„æè¿°ç¬¦;å¯¹äºç»§æ‰¿å±æ€§å’Œä¸å­˜åœ¨çš„å±æ€§,è¿”å› <code>undefined</code></p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.getOwnPropertyDescriptor(p, <span class="string">'r'</span>));</span><br><span class="line"><span class="comment">/*&#123;</span></span><br><span class="line"><span class="comment">    get: [Function: r],</span></span><br><span class="line"><span class="comment">    set: [Function: r],</span></span><br><span class="line"><span class="comment">    enumerable: true,</span></span><br><span class="line"><span class="comment">    configurable: true</span></span><br><span class="line"><span class="comment">&#125;*/</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.getOwnPropertyDescriptor(&#123;&#125;, <span class="string">'x'</span>));  <span class="comment">// undefined æ²¡æœ‰è¿™ä¸ªå±æ€§</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.getOwnPropertyDescriptor(&#123;&#125;, <span class="string">'toString'</span>)); <span class="comment">// undefined ç»§æ‰¿å±æ€§</span></span><br></pre></td></tr></table></figure><blockquote><p><code>Object.defineProperty()</code> è®¾ç½®å±æ€§çš„ç‰¹æ€§æˆ–æ–°å»ºå±æ€§ç‰¹æ€§<br>åªèƒ½ä¿®æ”¹è‡ªæœ‰å±æ€§,ä¸èƒ½ä¿®æ”¹ç»§æ‰¿å±æ€§<br>è¿”å›ä¿®æ”¹åçš„å¯¹è±¡</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> o = &#123;&#125;;</span><br><span class="line"><span class="comment">// æ·»åŠ ä¸€ä¸ªä¸å¯æšä¸¾çš„å±æ€§x,èµ‹å€¼ä¸º1</span></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(o, <span class="string">'x'</span>, &#123;</span><br><span class="line">    value : <span class="number">1</span>,</span><br><span class="line">    writable: <span class="literal">true</span>,</span><br><span class="line">    enumerable: <span class="literal">false</span>,</span><br><span class="line">    configurable: <span class="literal">true</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å±æ€§å­˜åœ¨ä½†æ˜¯ä¸å¯æšä¸¾</span></span><br><span class="line"><span class="built_in">console</span>.log(o.x);  <span class="comment">//1</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.keys(o)); <span class="comment">// []</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¹å±æ€§xåšä¿®æ”¹,å˜æˆåªè¯»</span></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(o, <span class="string">'x'</span>, &#123;</span><br><span class="line">    writable: <span class="literal">false</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¯•å›¾ä¿®æ”¹</span></span><br><span class="line">o.x = <span class="number">2</span>; <span class="comment">// æ“ä½œå¤±è´¥ä½†æ˜¯ä¸æŠ¥é”™; ä¸¥æ ¼æ¨¡å¼ä¸­æŠ›å‡ºç±»å‹é”™è¯¯å¼‚å¸¸</span></span><br><span class="line"><span class="built_in">console</span>.log(o.x);   <span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å±æ€§å¯é…ç½®,æ‰€ä»¥å¯ä»¥ä½¿ç”¨definePropertyä¿®æ”¹å€¼</span></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(o, <span class="string">'x'</span>, &#123;</span><br><span class="line">    value: <span class="number">2</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(o.x);  <span class="comment">// 2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä»æ•°æ®å±æ€§æ”¹ä¸ºå­˜å–å™¨å±æ€§</span></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(o, <span class="string">'x'</span>, &#123;</span><br><span class="line">    get: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(o.x); <span class="comment">// 0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ²¡æœ‰setæ–¹æ³•</span></span><br><span class="line">o.x = <span class="number">2</span>;</span><br><span class="line"><span class="built_in">console</span>.log(o.x); <span class="comment">// 0</span></span><br></pre></td></tr></table></figure><blockquote><p><code>Object.defineProperties()</code> åŒæ—¶ä¿®æ”¹å¤šä¸ªå±æ€§<br>è¿”å›ä¿®æ”¹åçš„å¯¹è±¡</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> p = <span class="built_in">Object</span>.defineProperties(&#123;&#125;,&#123;</span><br><span class="line">    x: &#123;</span><br><span class="line">        value: <span class="number">1</span>,</span><br><span class="line">        writable: <span class="literal">true</span>,</span><br><span class="line">        enumerable: <span class="literal">false</span>,</span><br><span class="line">        configurable: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    y: &#123;</span><br><span class="line">        value: <span class="number">2</span>,</span><br><span class="line">        writable: <span class="literal">true</span>,</span><br><span class="line">        enumerable: <span class="literal">true</span>,</span><br><span class="line">        configurable: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="Object-defineProperty-Object-defineProperties-æŠ›å‡ºç±»å‹é”™è¯¯å¼‚å¸¸"><a href="#Object-defineProperty-Object-defineProperties-æŠ›å‡ºç±»å‹é”™è¯¯å¼‚å¸¸" class="headerlink" title="Object.defineProperty() Object.defineProperties() æŠ›å‡ºç±»å‹é”™è¯¯å¼‚å¸¸"></a><code>Object.defineProperty()</code> <code>Object.defineProperties()</code> æŠ›å‡ºç±»å‹é”™è¯¯å¼‚å¸¸</h2><blockquote><ol><li>å¦‚æœå¯¹è±¡æ˜¯ä¸å¯æ‰©å±•çš„,åˆ™å¯ä»¥ç¼–è¾‘å·²æœ‰çš„è‡ªæœ‰å±æ€§,ä½†ä¸èƒ½ç»™å®ƒæ·»åŠ æ–°å±æ€§</li><li>å¦‚æœå±æ€§æ˜¯ä¸å¯é…ç½®çš„, åˆ™ä¸èƒ½ä¿®æ”¹å®ƒçš„å¯é…ç½®æ€§å’Œå¯æšä¸¾æ€§</li><li>å¦‚æœå­˜å–å™¨å±æ€§æ˜¯ä¸å¯é…ç½®çš„,åˆ™ä¸èƒ½ä¿®æ”¹å…¶ <code>getter</code> å’Œ <code>setter</code> æ–¹æ³•,ä¹Ÿä¸èƒ½å°†å®ƒè½¬æ¢ä¸ºæ•°æ®å±æ€§</li><li>å¦‚æœæ•°æ®å±æ€§æ˜¯ä¸å¯é…ç½®çš„, åˆ™ä¸èƒ½å°†å®ƒè½¬æ¢ä¸ºå­˜å–å™¨å±æ€§</li><li>å¦‚æœæ•°æ®å±æ€§æ˜¯ä¸å¯é…ç½®çš„, åˆ™ä¸èƒ½å°†å®ƒçš„å¯å†™æ€§ä» <code>false</code> è®¾ç½®ä¸º <code>true</code>, ä½†æ˜¯å¯ä»¥ä» <code>true</code> ä¿®æ”¹ä¸º <code>false</code></li><li>å¦‚æœæ•°æ®å±æ€§æ˜¯ä¸å¯é…ç½®çš„ä¸”ä¸å¯å†™çš„, åˆ™ä¸èƒ½ä¿®æ”¹å®ƒçš„å€¼;</li><li>å¦‚æœæ•°æ®å±æ€§æ˜¯å¯é…ç½®çš„ä½†ä¸å¯å†™,å±æ€§çš„å€¼æ˜¯å¯ä»¥ä¿®æ”¹çš„(æ ‡è®°ä¸ºå¯å†™-&gt;ä¿®æ”¹å®ƒçš„å€¼-&gt;è½¬æ¢ä¸ºä¸å¯å†™)</li></ol></blockquote><h2 id="å¤åˆ¶å±æ€§çš„ç‰¹æ€§"><a href="#å¤åˆ¶å±æ€§çš„ç‰¹æ€§" class="headerlink" title="å¤åˆ¶å±æ€§çš„ç‰¹æ€§"></a>å¤åˆ¶å±æ€§çš„ç‰¹æ€§</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç»™Object.prototype æ·»åŠ ä¸€ä¸ªä¸å¯æšä¸¾çš„extend()æ–¹æ³•</span></span><br><span class="line"><span class="comment"> * è¿™ä¸ªæ–¹æ³•ç»§æ‰¿è‡ªè°ƒç”¨å®ƒçš„å¯¹è±¡,å°†ä½œä¸ºå‚æ•°ä¼ å…¥å¯¹è±¡çš„å±æ€§ä¸€ä¸€å¤åˆ¶</span></span><br><span class="line"><span class="comment"> * é™¤äº†å€¼ä¹‹å¤–,ä¹Ÿå¤åˆ¶äº†å±æ€§çš„æ‰€æœ‰ç‰¹æ€§,é™¤éåœ¨ç›®æ ‡å¯¹è±¡ä¸­å­˜åœ¨åŒåçš„å±æ€§,</span></span><br><span class="line"><span class="comment"> * å‚æ•°å¯¹è±¡çš„æ‰€æœ‰è‡ªæœ‰å¯¹è±¡(åŒ…æ‹¬ä¸å¯æšä¸¾çš„å±æ€§)ä¹Ÿä¼šä¸€ä¸€å¤åˆ¶</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(<span class="built_in">Object</span>.prototype, <span class="string">'extend'</span>, &#123;</span><br><span class="line">    writable: <span class="literal">true</span>,</span><br><span class="line">    enumerable: <span class="literal">false</span>, <span class="comment">//ä¸å¯æšä¸¾</span></span><br><span class="line">    configurable: <span class="literal">true</span>,</span><br><span class="line">    value: <span class="function"><span class="keyword">function</span>(<span class="params">o</span>) </span>&#123;   <span class="comment">// å€¼å°±æ˜¯è¿™ä¸ªå‡½æ•°</span></span><br><span class="line">        <span class="comment">// å¾—åˆ°æ‰€æœ‰çš„è‡ªç”±å±æ€§,åŒ…æ‹¬ä¸å¯æšä¸¾å±æ€§</span></span><br><span class="line">        <span class="keyword">var</span> names = <span class="built_in">Object</span>.getOwnPropertyNames(o);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; names.length; i++) &#123;</span><br><span class="line">            <span class="comment">// å±æ€§å­˜åœ¨åˆ™è·³è¿‡</span></span><br><span class="line">            <span class="keyword">if</span> (names[i] <span class="keyword">in</span> <span class="keyword">this</span>) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// è·å–oä¸­çš„å±æ€§çš„æè¿°ç¬¦</span></span><br><span class="line">            <span class="keyword">var</span> desc = <span class="built_in">Object</span>.getOwnPropertyDescriptor(<span class="number">0</span>, names[i]);</span><br><span class="line">            <span class="comment">// ç”¨å®ƒç»™thisåˆ›å»ºä¸€ä¸ªå±æ€§</span></span><br><span class="line">            <span class="built_in">Object</span>.defineProperty(<span class="keyword">this</span>, names[i], desc);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="å¯¹è±¡çš„ä¸‰ä¸ªå±æ€§"><a href="#å¯¹è±¡çš„ä¸‰ä¸ªå±æ€§" class="headerlink" title="å¯¹è±¡çš„ä¸‰ä¸ªå±æ€§"></a>å¯¹è±¡çš„ä¸‰ä¸ªå±æ€§</h2><h3 id="åŸå‹å±æ€§"><a href="#åŸå‹å±æ€§" class="headerlink" title="åŸå‹å±æ€§"></a>åŸå‹å±æ€§</h3><blockquote><p>æˆ‘ä»¬ç»å¸¸æŠŠ <code>oçš„åŸå‹å±æ€§</code> ç›´æ¥å«åš <code>oçš„åŸå‹</code><br>é€šè¿‡ <code>new</code> åˆ›å»ºçš„å¯¹è±¡ä½¿ç”¨æ„é€ å‡½æ•°çš„ <code>prototype</code> å±æ€§ä½œä¸ºå®ƒä»¬çš„åŸå‹<br>é€šè¿‡ <code>Object.reate()</code> åˆ›å»ºçš„å¯¹è±¡ä½¿ç”¨ç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºå®ƒä»¬çš„åŸå‹<br><code>Object.getPrototypeOf()</code> æŸ¥è¯¢åŸå‹<br><code>p.isPrototypeOf(o)</code> æ£€æµ‹ p æ˜¯å¦æ˜¯ o çš„åŸå‹</p></blockquote><h3 id="ç±»å±æ€§"><a href="#ç±»å±æ€§" class="headerlink" title="ç±»å±æ€§"></a>ç±»å±æ€§</h3><blockquote><p>è¡¨ç¤ºå¯¹è±¡çš„ç±»å‹ä¿¡æ¯([object class])</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">classof</span>(<span class="params">o</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (o === <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'Null'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (o === <span class="literal">undefined</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'Undefined'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Object</span>.prototype.toString.call(o).slice(<span class="number">8</span>, <span class="number">-1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å¯æ‰©å±•æ€§"><a href="#å¯æ‰©å±•æ€§" class="headerlink" title="å¯æ‰©å±•æ€§"></a>å¯æ‰©å±•æ€§</h3><blockquote><p><code>Object.isExtensible()</code> åˆ¤æ–­æ˜¯å¦å¯æ‰©å±•<br><code>Object.preventExtensions()</code> å°†å¯¹è±¡è½¬æ¢ä¸ºä¸å¯æ‰©å±• <strong>æ— æ³•å†è½¬æ¢ä¸ºå¯æ‰©å±•</strong><br><code>Object.seal()</code> å°†å¯¹è±¡è®¾ç½®ä¸ºä¸å¯æ‰©å±•,å°†æ‰€æœ‰è‡ªæœ‰å±æ€§éƒ½è®¾ç½®ä¸ºä¸å¯é…ç½®;å³ä¸èƒ½ç»™è¿™ä¸ªå¯¹è±¡æ·»åŠ æ–°å±æ€§,è€Œä¸”å®ƒå·²æœ‰çš„å±æ€§ä¹Ÿä¸èƒ½åˆ é™¤æˆ–é…ç½®,ä¸è¿‡å®ƒå·²æœ‰çš„å¯å†™å±æ€§ä¾ç„¶å¯ä»¥è®¾ç½®<br><code>Object.isSealed()</code> æ£€æµ‹æ˜¯å¦å·²ç»å°é—­(sealed)<br><code>Object.freeze()</code> å†»ç»“å¯¹è±¡, å°†å¯¹è±¡è®¾ç½®ä¸ºä¸å¯æ‰©å±•, å°†å…¶å±æ€§è®¾ç½®ä¸ºä¸å¯é…ç½®, å°†å®ƒè‡ªæœ‰çš„æ‰€æœ‰æ•°æ®å±æ€§è®¾ç½®ä¸ºåªè¯»(å¦‚æœå¯¹è±¡çš„å­˜å–å™¨å±æ€§å…·æœ‰setteræ–¹æ³•,å­˜å–å™¨å±æ€§å°†ä¸å—å½±å“,ä»å¯ä»¥é€šè¿‡ç»™å±æ€§èµ‹å€¼è°ƒç”¨)<br><code>Object.isFrozen()</code> æ£€æµ‹å¯¹è±¡æ˜¯å¦å†»ç»“</p></blockquote><h2 id="åºåˆ—åŒ–å¯¹è±¡"><a href="#åºåˆ—åŒ–å¯¹è±¡" class="headerlink" title="åºåˆ—åŒ–å¯¹è±¡"></a>åºåˆ—åŒ–å¯¹è±¡</h2><blockquote><p>ECMAScript 5 æä¾›<code>JSON.stringify()</code> å’Œ <code>JSON.parse()</code><br><code>NaN</code> <code>Infinity</code> <code>-Infinity</code> åºåˆ—åŒ–çš„ç»“æœæ˜¯ <code>null</code><br>æ—¥æœŸå¯¹è±¡åºåˆ—åŒ–çš„ç»“æœæ˜¯ISOæ ¼å¼çš„æ—¥æœŸå­—ç¬¦ä¸²<br>å‡½æ•° RegExp Errorå¯¹è±¡ å’Œ undefinedå€¼ä¸èƒ½åºåˆ—åŒ–å’Œè¿˜åŸ<br><code>JSON.stringify()</code> åªèƒ½åºåˆ—åŒ–å¯¹è±¡çš„å¯æ²¡æ®çš„è‡ªæœ‰å±æ€§<br>ä¸èƒ½åºåˆ—åŒ–çš„åœ¨åºåˆ—åŒ–çš„è¾“å‡ºå­—ç¬¦ä¸²ä¸­ä¼šå°†è¿™ä¸ªå±æ€§çœç•¥æ‰</p></blockquote><hr><blockquote><h3 id="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢"><a href="#æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢" class="headerlink" title="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~"></a>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</h3><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScriptæƒå¨æŒ‡å—ç¬”è®°2</title>
      <link href="/2015/04/02/JavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E7%AC%94%E8%AE%B02/"/>
      <url>/2015/04/02/JavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E7%AC%94%E8%AE%B02/</url>
      
        <content type="html"><![CDATA[<p>JavaScriptæƒå¨æŒ‡å—ç¬”è®°150402<br><a id="more"></a></p><h2 id="ç»“åˆæ€§-P69"><a href="#ç»“åˆæ€§-P69" class="headerlink" title="ç»“åˆæ€§ P69"></a>ç»“åˆæ€§ <code>P69</code></h2><blockquote><p>ä¸€å…ƒæ“ä½œç¬¦,èµ‹å€¼å’Œä¸‰å…ƒæ¡ä»¶è¿ç®—ç¬¦å…·æœ‰ä»å·¦åˆ°å³çš„ç»“åˆæ€§</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">x = ~-y;</span><br><span class="line">x = ~(-y);</span><br><span class="line"></span><br><span class="line">w = x = y = z;</span><br><span class="line">w = ( x = (y = z));</span><br><span class="line"></span><br><span class="line">a ? b : c ? d : e ? f : g;</span><br><span class="line">a ? b : (c ? d : (e ? f : g));</span><br></pre></td></tr></table></figure><h2 id="javascript-æ€»æ˜¯ä¸¥æ ¼çš„æŒ‰ç…§ä»å·¦åˆ°å³çš„é¡ºåºè®¡ç®—è¡¨è¾¾å¼-P69"><a href="#javascript-æ€»æ˜¯ä¸¥æ ¼çš„æŒ‰ç…§ä»å·¦åˆ°å³çš„é¡ºåºè®¡ç®—è¡¨è¾¾å¼-P69" class="headerlink" title="javascript æ€»æ˜¯ä¸¥æ ¼çš„æŒ‰ç…§ä»å·¦åˆ°å³çš„é¡ºåºè®¡ç®—è¡¨è¾¾å¼ P69"></a>javascript æ€»æ˜¯ä¸¥æ ¼çš„æŒ‰ç…§ä»å·¦åˆ°å³çš„é¡ºåºè®¡ç®—è¡¨è¾¾å¼ <code>P69</code></h2><blockquote><p>è®¡ç®—bçš„å€¼: <code>a=1; b = (a++) + a;</code></p><ol><li>è®¡ç®— <code>b</code></li><li>è®¡ç®— <code>a++</code> (å‡è®¾å…¶å€¼ä¸ºc)</li><li>è®¡ç®— <code>a</code></li><li>è®¡ç®— <code>c + a</code></li><li>å°† <code>c + a</code> çš„å€¼èµ‹å€¼ç»™ <code>b</code></li></ol></blockquote><blockquote><p>å…¶ä¸­ ç¬¬2æ­¥ å…ˆ <code>c = 1;</code> ç„¶å <code>a = a + 1;</code><br>æ‰€ä»¥ç¬¬3æ­¥çš„ <code>a = 2</code><br>æ‰€ä»¥ <code>b = 3</code></p></blockquote><h2 id="â€˜-â€™-è¿ç®—ç¬¦-P70"><a href="#â€˜-â€™-è¿ç®—ç¬¦-P70" class="headerlink" title="â€˜+â€™ è¿ç®—ç¬¦ P70"></a>â€˜+â€™ è¿ç®—ç¬¦ <code>P70</code></h2><blockquote><p>åŠ æ³•çš„è½¬æ¢è§„åˆ™ä¼˜å…ˆè€ƒè™‘å­—ç¬¦ä¸²è½¬æ¢,å¦‚æœå…¶ä¸­ä¸€ä¸ªæ“ä½œæ•°æ˜¯å­—ç¬¦ä¸²æˆ–è€…è½¬æ¢ä¸ºå­—ç¬¦ä¸²çš„å¯¹è±¡,å¦ä¸€ä¸ªæ“ä½œç¬¦ä¼šè½¬æ¢ä¸ºå­—ç¬¦ä¸²<br>å¦‚æœ2ä¸ªæ“ä½œæ•°éƒ½ä¸æ˜¯ç±»å­—ç¬¦ä¸²,è¿›è¡Œç®—æ•°åŠ æ³•è¿ç®—<br>è½¬æ¢è§„åˆ™è§<a href="http://blog.xinshangshangxin.com/2015/04/01/JavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E7%AC%94%E8%AE%B0/">ä¸Šä¸€ç¯‡çš„ç±»å‹è½¬æ¢å’Œå¯¹è±¡è½¬å­—ç¬¦ä¸²_æ•°å­—</a></p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'1'</span> + <span class="string">'2'</span> = <span class="string">'12'</span>;</span><br><span class="line"><span class="string">'1'</span> + <span class="number">2</span> = <span class="string">'12'</span>;</span><br><span class="line"><span class="number">1</span> + &#123;&#125; = <span class="number">1</span>[object <span class="built_in">Object</span>]; <span class="comment">//å¯¹è±¡è½¬æˆå­—ç¬¦ä¸²</span></span><br><span class="line"><span class="literal">true</span> + <span class="literal">true</span> = <span class="number">2</span>;</span><br><span class="line"><span class="number">2</span> + <span class="literal">null</span> = <span class="number">2</span>;</span><br><span class="line"><span class="number">2</span> + <span class="literal">undefined</span> = <span class="literal">NaN</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">1</span> + <span class="number">2</span> + <span class="string">'str'</span> = <span class="string">'3str'</span>;</span><br><span class="line"><span class="number">1</span> + (<span class="number">2</span> + <span class="string">'str'</span>) = <span class="string">'12str'</span>;</span><br></pre></td></tr></table></figure><h2 id="ä¸€å…ƒç®—æ•°è¿ç®—ç¬¦"><a href="#ä¸€å…ƒç®—æ•°è¿ç®—ç¬¦" class="headerlink" title="ä¸€å…ƒç®—æ•°è¿ç®—ç¬¦"></a>ä¸€å…ƒç®—æ•°è¿ç®—ç¬¦</h2><blockquote><p>â€˜++â€™ å°†æ“ä½œæ•°è½¬æ¢ä¸ºæ•°å­—,ç„¶åç»™æ•°å­—åŠ 1</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x = <span class="string">'1'</span>;</span><br><span class="line"><span class="built_in">console</span>.log(x + <span class="number">1</span>);     <span class="comment">//'11'</span></span><br><span class="line">x = <span class="string">'1'</span>;</span><br><span class="line"><span class="built_in">console</span>.log(x++);       <span class="comment">// '1'</span></span><br><span class="line">x = <span class="string">'1'</span>;</span><br><span class="line"><span class="built_in">console</span>.log(++x);       <span class="comment">// '2'</span></span><br></pre></td></tr></table></figure><h2 id="é€»è¾‘ä¸-amp-amp-P79"><a href="#é€»è¾‘ä¸-amp-amp-P79" class="headerlink" title="é€»è¾‘ä¸ &amp;&amp; P79"></a>é€»è¾‘ä¸ &amp;&amp; <code>P79</code></h2><blockquote><p>å‡å€¼:<code>false</code> <code>null</code> <code>undefined</code> <code>0</code> <code>-0</code> <code>NaN</code> <code>&#39;&#39;</code></p><ol><li>å…ˆè®¡ç®—å·¦æ“ä½œæ•°çš„å€¼,å¦‚æœä¸ºå‡å€¼,åˆ™è¿”å›å·¦æ“ä½œæ•°</li><li>å¦‚æœä¸ºçœŸå€¼, è®¡ç®—å³æ“ä½œç¬¦å¹¶å°†å…¶è¿”å›</li></ol></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="number">1</span> &amp;&amp; <span class="literal">NaN</span>); <span class="comment">// NaN</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="literal">null</span> &amp;&amp; <span class="number">1</span>); <span class="comment">// null</span></span><br><span class="line"><span class="built_in">console</span>.log(&#123;<span class="attr">x</span> : <span class="string">'å·¦'</span>&#125; &amp;&amp; &#123;<span class="attr">x</span>: <span class="string">'å³'</span>&#125;); <span class="comment">//&#123; x: 'å³' &#125;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‡è®¾ fun ä¸ºæŸå‡½æ•°</span></span><br><span class="line"><span class="keyword">if</span> (fun) &#123;</span><br><span class="line">    fun();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ç®€å†™ä¸º</span></span><br><span class="line">fun &amp;&amp; fun();  <span class="comment">// jsHintä¼šè­¦å‘Š.....</span></span><br></pre></td></tr></table></figure><h2 id="é€»è¾‘æˆ–-P80"><a href="#é€»è¾‘æˆ–-P80" class="headerlink" title="é€»è¾‘æˆ– || P80"></a>é€»è¾‘æˆ– || <code>P80</code></h2><blockquote><ol><li>å…ˆè®¡ç®—å·¦æ“ä½œæ•°çš„å€¼,å¦‚æœä¸ºçœŸå€¼,åˆ™è¿”å›å·¦æ“ä½œæ•°</li><li>å¦‚æœä¸ºå‡å€¼, è®¡ç®—å³æ“ä½œç¬¦å¹¶å°†å…¶è¿”å›</li></ol></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(&#123;<span class="attr">x</span>: <span class="string">'å·¦'</span>&#125; || &#123;<span class="attr">x</span>: <span class="string">'å³'</span>&#125;); <span class="comment">// &#123; x: 'å·¦' &#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="literal">null</span> || &#123;<span class="attr">x</span>: <span class="string">'å³'</span>&#125;); <span class="comment">// &#123; x: 'å³' &#125;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç»™å‚æ•°æä¾›é»˜è®¤å€¼</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">copy</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">    str = str || <span class="string">'123'</span>; <span class="comment">//è®¾ç½®é»˜è®¤å€¼</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="eval-P84"><a href="#eval-P84" class="headerlink" title="eval P84"></a>eval <code>P84</code></h2><blockquote><p>evalä½¿ç”¨äº†è°ƒç”¨å®ƒçš„å˜é‡ä½œç”¨åŸŸç¯å¢ƒ</p></blockquote><h2 id="typeof-P87"><a href="#typeof-P87" class="headerlink" title="typeof P87"></a>typeof <code>P87</code></h2><table><thead><tr><th style="text-align:center">x</th><th style="text-align:center">typeof x</th></tr></thead><tbody><tr><td style="text-align:center">undefined</td><td style="text-align:center">â€˜undefinedâ€™</td></tr><tr><td style="text-align:center">null</td><td style="text-align:center">â€˜objectâ€™</td></tr><tr><td style="text-align:center">true/false</td><td style="text-align:center">â€˜booleanâ€™</td></tr><tr><td style="text-align:center">æ•°å­—/NaN</td><td style="text-align:center">â€˜numberâ€™</td></tr><tr><td style="text-align:center">å­—ç¬¦ä¸²</td><td style="text-align:center">â€˜stringâ€™</td></tr><tr><td style="text-align:center">å‡½æ•°</td><td style="text-align:center">â€˜functionâ€™</td></tr><tr><td style="text-align:center">å†…ç½®å¯¹è±¡(éå‡½æ•°)</td><td style="text-align:center">â€˜onjectâ€™</td></tr><tr><td style="text-align:center">å®¿ä¸»å¯¹è±¡</td><td style="text-align:center">ç”±ç¼–è¯‘å™¨å„è‡ªå®ç°çš„å­—ç¬¦ä¸², ä½†ä¸æ˜¯ â€˜undefinedâ€™ â€˜booleanâ€™ â€˜numberâ€™ â€˜stringâ€™</td></tr></tbody></table><p>æœ€åä¸€å¼ æ€ç»´å¯¼å›¾<br><figure class="image-box">                <img src="https://raw.githubusercontent.com/xinshangshangxin/hexo-blog/gh-pages/img/Definitive_Guide_js/operator.gif" alt="" title="" class="">                <p></p>            </figure></p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™:"></a>å‚è€ƒèµ„æ–™:</h2><p><a href="http://segmentfault.com/a/1190000002423935" target="_blank" rel="noopener">http://segmentfault.com/a/1190000002423935</a></p><hr><blockquote><h3 id="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢"><a href="#æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢" class="headerlink" title="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~"></a>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</h3><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScriptæƒå¨æŒ‡å—ç¬”è®°</title>
      <link href="/2015/04/01/JavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E7%AC%94%E8%AE%B0/"/>
      <url>/2015/04/01/JavaScript%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<p>JavaScriptæƒå¨æŒ‡å—ç¬”è®°150401<br><a id="more"></a></p><h2 id="å­—ç¬¦é•¿åº¦-P39"><a href="#å­—ç¬¦é•¿åº¦-P39" class="headerlink" title="å­—ç¬¦é•¿åº¦ P39"></a>å­—ç¬¦é•¿åº¦ <code>P39</code></h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> p = <span class="string">'Ï€'</span>;</span><br><span class="line"><span class="keyword">var</span> e = <span class="string">'e'</span>;</span><br><span class="line"><span class="keyword">var</span> ch = <span class="string">'ä¸­'</span>;</span><br><span class="line">p.length</span><br><span class="line">e.length</span><br><span class="line">ch.length</span><br></pre></td></tr></table></figure><figure class="image-box">                <img src="https://raw.githubusercontent.com/xinshangshangxin/hexo-blog/gh-pages/img/Definitive_Guide_js/str_len.png" alt="" title="" class="">                <p></p>            </figure><blockquote><p>åœ¨æ–‡ä»¶ä¸åŒç¼–ç ä¸‹,å­—ç¬¦é•¿åº¦ä¸åŒâ€¦<br><code>GBK</code>ä¸‹ç­”æ¡ˆä¸º2/1/2; <code>utf8</code>ä¸‹ä¸º1/1/1</p></blockquote><blockquote><p>ä¹¦ä¸­<code>P39</code>ä¸­çš„ ä¾‹å­æ€ä¹ˆå®ç°å‘¢(p.length =&gt;1  e.length =&gt; 2)??æ±‚å‘ŠçŸ¥</p></blockquote><h2 id="å¸ƒå°”å€¼P43"><a href="#å¸ƒå°”å€¼P43" class="headerlink" title="å¸ƒå°”å€¼P43"></a>å¸ƒå°”å€¼<code>P43</code></h2><blockquote><p>ä¸‹é¢çš„å€¼ä¼šè½¬æ¢æˆ <code>false</code></p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">undefined</span></span><br><span class="line"><span class="literal">null</span></span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="number">-0</span></span><br><span class="line"><span class="literal">NaN</span></span><br><span class="line"><span class="string">""</span> <span class="comment">//ç©ºå­—ç¬¦ä¸²</span></span><br></pre></td></tr></table></figure><blockquote><p>å¯¹è±¡(åŒ…æ‹¬æ•°ç»„)æˆ–è½¬æ¢æˆ <code>true</code></p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (arr) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'true'</span>);  <span class="comment">//è¾“å‡ºtrue</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'false'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ä½†æ˜¯è¿™é‡Œåˆä¸å¯¹äº†:</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (arr == <span class="literal">false</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'arr == false'</span>) <span class="comment">//è¾“å‡ºäº†false</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'arr != false'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŸå› :</p><p><strong>ç±»å‹è½¬æ¢</strong></p><table><thead><tr><th style="text-align:center">Value</th><th style="text-align:center">String</th><th style="text-align:center">Number</th><th style="text-align:center">Boolean</th><th style="text-align:center">Object </th></tr></thead><tbody><tr><td style="text-align:center">undefined</td><td style="text-align:center">â€˜undefinedâ€™</td><td style="text-align:center">NaN</td><td style="text-align:center">false</td><td style="text-align:center">throws TypeError</td></tr><tr><td style="text-align:center">null</td><td style="text-align:center">â€˜nullâ€™</td><td style="text-align:center">0</td><td style="text-align:center">false</td><td style="text-align:center">throws TypeError</td></tr><tr><td style="text-align:center">true</td><td style="text-align:center">â€˜trueâ€™</td><td style="text-align:center">1</td><td style="text-align:center"></td><td style="text-align:center">new Boolean(true)</td><td></td></tr><tr><td style="text-align:center">false</td><td style="text-align:center">â€˜falseâ€™</td><td style="text-align:center">0</td><td style="text-align:center"></td><td style="text-align:center">new Boolean(false)</td><td></td></tr><tr><td style="text-align:center">â€œâ€ (empty string)</td><td style="text-align:center"></td><td style="text-align:center">0</td><td style="text-align:center">false</td><td style="text-align:center">new String(â€œâ€)</td></tr><tr><td style="text-align:center">â€œ1.2â€ (nonempty, numeric)</td><td style="text-align:center"></td><td style="text-align:center">1.2</td><td style="text-align:center">true</td><td style="text-align:center">new String(â€œ1.2â€)</td></tr><tr><td style="text-align:center">â€œoneâ€ (nonempty, non-numeric)</td><td style="text-align:center"></td><td style="text-align:center">NaN</td><td style="text-align:center">true</td><td style="text-align:center">new String(â€œoneâ€)</td></tr><tr><td style="text-align:center">0</td><td style="text-align:center">â€˜0â€™</td><td style="text-align:center"></td><td style="text-align:center">false</td><td style="text-align:center">new Number(0)</td><td></td></tr><tr><td style="text-align:center">-0</td><td style="text-align:center">â€˜0â€™</td><td style="text-align:center"></td><td style="text-align:center">false</td><td style="text-align:center">new Number(-0)</td></tr><tr><td style="text-align:center">NaN</td><td style="text-align:center">â€˜undefinedâ€™</td><td style="text-align:center"></td><td style="text-align:center">false</td><td style="text-align:center">new Number(NaN)</td></tr><tr><td style="text-align:center">Infinity</td><td style="text-align:center">â€˜Infinityâ€™</td><td style="text-align:center"></td><td style="text-align:center">true</td><td style="text-align:center">new Number(Infinity)</td></tr><tr><td style="text-align:center">-Infinity</td><td style="text-align:center">â€˜-Infinityâ€™</td><td style="text-align:center"></td><td style="text-align:center">true</td><td style="text-align:center">new Number(-Infinity)</td></tr><tr><td style="text-align:center">1 (finite, non-zero)</td><td style="text-align:center">â€˜1â€™</td><td style="text-align:center"></td><td style="text-align:center">true</td><td style="text-align:center">new Number(1)</td></tr><tr><td style="text-align:center">{} (any object)</td><td style="text-align:center"></td><td style="text-align:center">NaN</td><td style="text-align:center">true     </td></tr><tr><td style="text-align:center">[] (empty array)</td><td style="text-align:center">â€˜â€™</td><td style="text-align:center">0</td><td style="text-align:center">true     </td></tr><tr><td style="text-align:center">[9] (1 numeric elt)</td><td style="text-align:center">â€˜9â€™</td><td style="text-align:center">9</td><td style="text-align:center">true     </td></tr><tr><td style="text-align:center">[â€˜aâ€™] (any other array)</td><td style="text-align:center">use join() method</td><td style="text-align:center">NaN</td><td style="text-align:center">true     </td></tr><tr><td style="text-align:center">function(){} (any function)</td><td style="text-align:center">â€˜undefinedâ€™</td><td style="text-align:center">NaN</td><td style="text-align:center">true     </td></tr></tbody></table><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">false</span> =&gt; <span class="number">0</span></span><br><span class="line">[] =&gt; <span class="number">0</span>    [<span class="number">0</span>] =&gt; <span class="number">0</span></span><br></pre></td></tr></table></figure><p><strong>éšæ€§ç±»å‹è½¬æ¢æ­¥éª¤</strong></p><blockquote><ol><li>é¦–å…ˆçœ‹åŒç­‰å·å‰åæœ‰æ²¡æœ‰NaNï¼Œå¦‚æœå­˜åœ¨NaNï¼Œä¸€å¾‹è¿”å›falseã€‚</li><li>å†çœ‹åŒç­‰å·å‰åæœ‰æ²¡æœ‰å¸ƒå°”ï¼Œæœ‰å¸ƒå°”å°±å°†å¸ƒå°”è½¬æ¢ä¸ºæ•°å­—ã€‚ï¼ˆfalseæ˜¯0ï¼Œtrueæ˜¯1ï¼‰</li><li>æ¥ç€çœ‹åŒç­‰å·å‰åæœ‰æ²¡æœ‰å­—ç¬¦ä¸², å¦‚æœæ˜¯å­—ç¬¦ä¸²ï¼š<blockquote><ul><li>å¯¹æ–¹æ˜¯å¯¹è±¡ï¼Œå¯¹è±¡è½¬å­—ç¬¦ä¸²(<em>æ–¹æ³•è§ä¸‹é¢</em>)ï¼›</li><li>å¯¹æ–¹æ˜¯æ•°å­—ï¼Œå­—ç¬¦ä¸²è½¬æ•°å­—</li><li>å¯¹æ–¹æ˜¯å­—ç¬¦ä¸²ï¼Œç›´æ¥æ¯”è¾ƒ</li><li>å…¶ä»–è¿”å›false</li></ul></blockquote></li><li>å¦‚æœæ˜¯æ•°å­—ï¼Œå¯¹æ–¹æ˜¯å¯¹è±¡ï¼Œå¯¹è±¡è½¬æ•°å­—(<em>æ–¹æ³•è§ä¸‹é¢</em>), å…¶ä»–ä¸€å¾‹è¿”å›false</li><li>null, undefinedä¸ä¼šè¿›è¡Œç±»å‹è½¬æ¢, ä½†å®ƒä»¬ä¿©ç›¸ç­‰</li></ol></blockquote><p><strong>å¯¹è±¡è½¬å­—ç¬¦ä¸²</strong><br><figure class="image-box">                <img src="https://raw.githubusercontent.com/xinshangshangxin/hexo-blog/gh-pages/img/Definitive_Guide_js/obj2str.png" alt="" title="" class="">                <p></p>            </figure></p><p><strong>å¯¹è±¡è½¬æ•°å­—</strong><br><figure class="image-box">                <img src="https://raw.githubusercontent.com/xinshangshangxin/hexo-blog/gh-pages/img/Definitive_Guide_js/obj2nu.png" alt="" title="" class="">                <p></p>            </figure></p><p><a href="https://raw.githubusercontent.com/xinshangshangxin/hexo-blog/gh-pages/other/Definitive_Guide_js/obj2nu_str.pdf" target="_blank" rel="noopener">ä¸Šå›¾pdfä¸‹è½½</a></p><p><strong>æ —å­:</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a;</span><br><span class="line"><span class="built_in">console</span>.dir(<span class="number">0</span> == <span class="literal">false</span>);<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.dir(<span class="number">1</span> == <span class="literal">true</span>);<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.dir(<span class="number">2</span> == &#123;<span class="attr">valueOf</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="number">2</span>&#125;&#125;);<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.dir(a == <span class="literal">NaN</span>);<span class="comment">//false</span></span><br><span class="line"><span class="built_in">console</span>.dir(<span class="literal">NaN</span> == <span class="literal">NaN</span>);<span class="comment">//false</span></span><br><span class="line"><span class="built_in">console</span>.dir(<span class="number">8</span> == <span class="literal">undefined</span>);<span class="comment">//false</span></span><br><span class="line"><span class="built_in">console</span>.dir(<span class="number">1</span> == <span class="literal">undefined</span>);<span class="comment">//false</span></span><br><span class="line"><span class="built_in">console</span>.dir(<span class="number">2</span> == &#123;<span class="attr">toString</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="number">2</span>&#125;&#125;);<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.dir(<span class="literal">undefined</span> == <span class="literal">null</span>);<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.dir(<span class="literal">null</span> == <span class="number">1</span>);<span class="comment">//false</span></span><br><span class="line"><span class="built_in">console</span>.dir(&#123; <span class="attr">toString</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="keyword">return</span> <span class="number">1</span> &#125; , <span class="attr">valueOf</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="keyword">return</span> [] &#125;&#125; == <span class="number">1</span>);<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.dir(<span class="number">1</span>==<span class="string">"1"</span>);<span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.dir(<span class="number">1</span>===<span class="string">"1"</span>);<span class="comment">//false</span></span><br></pre></td></tr></table></figure></p><h2 id="åŒ…è£…å¯¹è±¡-P46"><a href="#åŒ…è£…å¯¹è±¡-P46" class="headerlink" title="åŒ…è£…å¯¹è±¡ P46"></a>åŒ…è£…å¯¹è±¡ <code>P46</code></h2><blockquote><p>å¦‚æœå¼•ç”¨å­—ç¬¦ä¸²çš„å±æ€§,å°±ä¼šå°†å­—ç¬¦ä¸²é€šè¿‡new String()è½¬æ¢æˆå¯¹è±¡,è¿™ä¸ªå¯¹è±¡å¤„ç†å±æ€§çš„å¼•ç”¨;ä¸€æ—¦å¼•ç”¨ç»“æŸ,è¿™ä¸ªæ–°åˆ›å»ºçš„å¯¹è±¡å°±ä¼šè¢«é”€æ¯</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s = <span class="string">'test'</span>;</span><br><span class="line">s.len = <span class="number">4</span>;          <span class="comment">// å¼•ç”¨ç»“æŸç«‹å³é”€æ¯</span></span><br><span class="line"><span class="built_in">console</span>.log(s.len); <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure><blockquote><p><code>null</code> å’Œ <code>undefined</code> æ²¡æœ‰åŒ…è£…å¯¹è±¡</p></blockquote><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™:"></a>å‚è€ƒèµ„æ–™:</h2><p><a href="http://www.haorooms.com/post/js_yinxingleixing" target="_blank" rel="noopener">http://www.haorooms.com/post/js_yinxingleixing</a><br><a href="http://www.lookcss.com/js-type/" target="_blank" rel="noopener">http://www.lookcss.com/js-type/</a></p><hr><blockquote><h3 id="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢"><a href="#æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢" class="headerlink" title="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~"></a>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</h3><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexoæ— æ³•è¾“å…¥åŒæ‹¬å·{{</title>
      <link href="/2015/03/31/hexo%E6%97%A0%E6%B3%95%E8%BE%93%E5%85%A5%E5%8F%8C%E6%8B%AC%E5%8F%B7/"/>
      <url>/2015/03/31/hexo%E6%97%A0%E6%B3%95%E8%BE%93%E5%85%A5%E5%8F%8C%E6%8B%AC%E5%8F%B7/</url>
      
        <content type="html"><![CDATA[<blockquote><p>åœ¨blogä¸­ä½¿ç”¨äº†angularjsçš„ä»£ç ,å¯¼è‡´hexo æ— æ³•è§£æ{ {}}<br><a id="more"></a></p></blockquote><h1 id="è§£å†³åŠæ³•"><a href="#è§£å†³åŠæ³•" class="headerlink" title="è§£å†³åŠæ³•"></a>è§£å†³åŠæ³•</h1>> {% raw %}> {% end_raw %} > > æ›¿æ¢ä¸Šé¢çš„`end_raw` ä¸º `endraw`> {% endraw %} <p>æœ€ç»ˆå¦‚å›¾æ‰€ç¤º:<br><figure class="image-box">                <img src="/img/hexo/hexo.png" alt="hexo" title="" class="">                <p>hexo</p>            </figure></p><blockquote><p>æˆåŠŸè¾“å…¥åŒæ‹¬å·</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% raw %&#125;&#123;&#123;  &#125;&#125;&#123;% endraw %&#125;</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™:"></a>å‚è€ƒèµ„æ–™:</h2><p><a href="http://hexo.io/docs/tag-plugins.html#Raw" target="_blank" rel="noopener">http://hexo.io/docs/tag-plugins.html#Raw</a><br><a href="https://github.com/hexojs/hexo/issues/1071" target="_blank" rel="noopener">https://github.com/hexojs/hexo/issues/1071</a></p><hr><blockquote><h3 id="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢"><a href="#æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢" class="headerlink" title="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~"></a>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</h3><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AngularJSè¿‡æ»¤å™¨</title>
      <link href="/2015/03/31/AngularJS-Filter/"/>
      <url>/2015/03/31/AngularJS-Filter/</url>
      
        <content type="html"><![CDATA[<p>AngularJSè¿‡æ»¤å™¨<br><a id="more"></a></p><blockquote><p>AngularJSè¿‡æ»¤å™¨</p></blockquote><p>åœ¨{{  }}å†…é€šè¿‡|æ¥è°ƒç”¨filter,ä¾‹å¦‚:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;<span class="number">2015</span> | number:<span class="number">2</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;</span><br></pre></td></tr></table></figure></p><h2 id="å†…ç½®filter"><a href="#å†…ç½®filter" class="headerlink" title="å†…ç½®filter"></a>å†…ç½®filter</h2><ul><li>number<blockquote><p>ä»¥æ•°å­—æ ¼å¼è¾“å‡ºï¼Œç¬¬äºŒä¸ªä¸ºå¯é€‰å‚æ•°ï¼Œè¡¨ç¤ºå°æ•°ç‚¹åä¿ç•™çš„ä½æ•°ã€‚ åŒ…å«éæ•°å­—å­—ç¬¦æ—¶ä½¿ç”¨ä½¿ç”¨å¯é€‰å‚æ•°ä¼šå‡ºç°Syntax Errorï¼Œä¸ä½¿ç”¨åˆ™è¾“å‡ºç©ºå­—ç¬¦ã€‚</p></blockquote></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123; <span class="number">1234.12</span> | number:<span class="number">3</span>&#125;&#125;</span><br><span class="line">&#123;% endraw %&#125; &lt;!-- <span class="number">1234.12</span> --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123; <span class="number">1234.12</span> | number&#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;  &lt;!-- <span class="number">1</span>,<span class="number">234.12</span> --&gt;</span><br></pre></td></tr></table></figure><ul><li>currency<blockquote><p>ä»¥è´§å¸æ ¼å¼è¾“å‡ºï¼ŒåŒ…æ‹¬éæ•°å­—å­—ç¬¦æ—¶å‡ºç°Syntax Errorã€‚</p></blockquote></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;<span class="number">1234.12</span> | currency &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125; &lt;!-- $<span class="number">1</span>,<span class="number">234.12</span> --&gt;</span><br></pre></td></tr></table></figure><ul><li>lowercase/uppercase<blockquote><p>å°†å­—ç¬¦è½¬å°å†™/å¤§å†™</p></blockquote></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;<span class="string">"Kavlez! 2015;"</span> | lowercase &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;  &lt;!-- kavlez! <span class="number">2015</span>; --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;<span class="string">"Kavlez! 2015;"</span> | uppercase &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;  &lt;!-- KAVLEZ! <span class="number">2015</span>; --&gt;</span><br></pre></td></tr></table></figure><ul><li>json<blockquote><p>å°†å¯¹è±¡è½¬ä¸ºjsonå­—ç¬¦ä¸²</p></blockquote></li></ul><p><em>ä¾‹å¦‚å·²æœ‰å£°æ˜å¦‚ä¸‹:</em><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$scope.person = <span class="keyword">new</span> <span class="built_in">Object</span>();</span><br><span class="line">$scope.person.firstname = <span class="string">'Kavlez'</span>;</span><br><span class="line">$scope.person.lastname = <span class="string">'Jin'</span></span><br></pre></td></tr></table></figure></p><p><em>jsonè¿‡æ»¤è¾“å‡º:</em><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;person | json&#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;</span><br><span class="line">&lt;!-- &#123; <span class="string">"firstname"</span>: <span class="string">"Kavlez"</span>, <span class="string">"lastname"</span>: <span class="string">"Jin"</span> &#125; --&gt;</span><br></pre></td></tr></table></figure></p><ul><li>limitTo<blockquote><p>å¯¹å­—ç¬¦ä¸²æˆ–æ•°ç»„è¿›è¡Œæˆªå–</p></blockquote></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;<span class="string">'Kavlez!!!!'</span> | limitTo:<span class="number">6</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125; &lt;!-- Kavlez --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;<span class="string">'Kavlez!!!!'</span> | limitTo:<span class="number">-4</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125; &lt;!-- !!!! --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;[<span class="string">'0'</span>,<span class="string">'1'</span>,<span class="string">'2'</span>,<span class="string">'3'</span>,<span class="string">'4'</span>,<span class="string">'5'</span>] | limitTo:<span class="number">1</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125; &lt;!-- [<span class="string">"0"</span>]--&gt;</span><br></pre></td></tr></table></figure><ul><li>orderBy<blockquote><p>å¯¹æ•°ç»„è¿›è¡Œæ’åºï¼Œè¯¥filteræœ‰ä¸¤ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯æ’åºä¾æ®å’Œæ­£é€†åº(å¯é€‰)</p></blockquote></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;[</span><br><span class="line">    &#123;<span class="string">'alphabet'</span>: <span class="string">'K'</span>&#125;,</span><br><span class="line">    &#123;<span class="string">'alphabet'</span>: <span class="string">'A'</span>&#125;,</span><br><span class="line">    &#123;<span class="string">'alphabet'</span>: <span class="string">'V'</span>&#125;,</span><br><span class="line">    &#123;<span class="string">'alphabet'</span>: <span class="string">'L'</span>&#125;,</span><br><span class="line">    &#123;<span class="string">'alphabet'</span>: <span class="string">'E'</span>&#125;,</span><br><span class="line">    &#123;<span class="string">'alphabet'</span>: <span class="string">'Z'</span>&#125;] </span><br><span class="line">    | orderBy:<span class="string">'alphabet'</span>:<span class="literal">true</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;</span><br><span class="line">&lt;!-- [&#123;<span class="string">"alphabet"</span>:<span class="string">"Z"</span>&#125;,&#123;<span class="string">"alphabet"</span>:<span class="string">"V"</span>&#125;,&#123;<span class="string">"alphabet"</span>:<span class="string">"L"</span>&#125;,&#123;<span class="string">"alphabet"</span>:<span class="string">"K"</span>&#125;,&#123;<span class="string">"alphabet"</span>:<span class="string">"E"</span>&#125;,&#123;<span class="string">"alphabet"</span>:<span class="string">"A"</span>&#125;] --&gt;</span><br></pre></td></tr></table></figure><ul><li>filter<blockquote><p>ä»æ•°ç»„ä¸­è¿”å›æŒ‡å®šå­é›†</p></blockquote></li></ul><p><em>å¯¹è±¡</em><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;</span><br><span class="line">    [&#123;<span class="string">'firstname'</span>:<span class="string">'Kavlez'</span>,<span class="string">'lastname'</span>:<span class="string">'Jin'</span>&#125;,</span><br><span class="line">        &#123;<span class="string">'firstname'</span>:<span class="string">'Ken'</span>,<span class="string">'lastname'</span>:<span class="string">'Jin'</span>&#125;] </span><br><span class="line">| filter:&#123;<span class="string">'firstname'</span>: <span class="string">'n'</span>&#125; &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;</span><br><span class="line">&lt;!-- [&#123;<span class="string">"firstname"</span>:<span class="string">"Ken"</span>,<span class="string">"lastname"</span>:<span class="string">"Jin"</span>&#125;]  --&gt;</span><br></pre></td></tr></table></figure></p><p><em>å­—ç¬¦ä¸²</em><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;[<span class="string">'K'</span>,<span class="string">'a'</span>,<span class="string">'v'</span>,<span class="string">'l'</span>,<span class="string">'e'</span>,<span class="string">'z'</span>] | filter:<span class="string">'e'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125; &lt;!-- [<span class="string">"e"</span>] --&gt;</span><br></pre></td></tr></table></figure></p><p><em>date</em></p><blockquote><p>ä»¥æŒ‡å®šæ ¼å¼æ˜¾ç¤ºæ—¶é—´ã€‚ </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br></pre></td><td class="code"><pre><span class="line">$scope.today=<span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line"></span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'medium'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  Jan <span class="number">24</span>, <span class="number">2015</span> <span class="number">5</span>:<span class="number">36</span>:<span class="number">38</span> PM    --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'short'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  <span class="number">1</span>/<span class="number">24</span>/<span class="number">15</span> <span class="number">5</span>:<span class="number">36</span> PM    --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'fullDate'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  Saturday, January <span class="number">24</span>, <span class="number">2015</span>     --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'longDate'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  January <span class="number">24</span>, <span class="number">2015</span>   --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'mediumDate'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  Jan <span class="number">24</span>, <span class="number">2015</span>   --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'shortDate'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  <span class="number">1</span>/<span class="number">24</span>/<span class="number">15</span>   --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'mediumTime'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  <span class="number">5</span>:<span class="number">36</span>:<span class="number">38</span> PM   --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'shortTime'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  <span class="number">5</span>:<span class="number">36</span> PM   --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'yyyy'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  <span class="number">2015</span>  --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'yy'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  <span class="number">15</span>   --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'y'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  <span class="number">2015</span>  --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'MMMM'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  January   --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'MMM'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  Jan   --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'MM'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  <span class="number">01</span>  --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'M'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  <span class="number">1</span>  --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'dd'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  <span class="number">24</span>  --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'d'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  <span class="number">24</span>  --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'EEEE'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  Saturday   --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'EEE'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  Sat   --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'HH'</span>&#125;&#125;</span><br><span class="line">&#123;% endraw %&#125; &lt;!--  <span class="number">17</span>  --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'H'</span>&#125;&#125;</span><br><span class="line">&#123;% endraw %&#125; &lt;!--  <span class="number">17</span>  --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'hh'</span>&#125;&#125;</span><br><span class="line">&#123;% endraw %&#125; &lt;!--  <span class="number">05</span>  --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'h'</span>&#125;&#125;</span><br><span class="line">&#123;% endraw %&#125; &lt;!--  <span class="number">5</span>  --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'mm'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  <span class="number">36</span>  --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'m'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  <span class="number">36</span>  --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'ss'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  <span class="number">38</span>  --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'s'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  <span class="number">38</span>  --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'.sss'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  <span class="number">.628</span>  --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'a'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  PM  --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'Z'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  +<span class="number">0800</span>   --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'MMMd, y'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  Jan24, <span class="number">2015</span>  --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'EEEE, d, M'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125; &lt;!--  Saturday, <span class="number">24</span>, <span class="number">1</span>  --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'hh:mm:ss.sss'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  <span class="number">05</span>:<span class="number">36</span>:<span class="number">38.628</span>  --&gt;    </span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'medium'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  Jan <span class="number">24</span>, <span class="number">2015</span> <span class="number">5</span>:<span class="number">36</span>:<span class="number">38</span> PM    --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'short'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  <span class="number">1</span>/<span class="number">24</span>/<span class="number">15</span> <span class="number">5</span>:<span class="number">36</span> PM    --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'fullDate'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  Saturday, January <span class="number">24</span>, <span class="number">2015</span>     --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'longDate'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  January <span class="number">24</span>, <span class="number">2015</span>   --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'mediumDate'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  Jan <span class="number">24</span>, <span class="number">2015</span>   --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'shortDate'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  <span class="number">1</span>/<span class="number">24</span>/<span class="number">15</span>   --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'mediumTime'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  <span class="number">5</span>:<span class="number">36</span>:<span class="number">38</span> PM   --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'shortTime'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  <span class="number">5</span>:<span class="number">36</span> PM   --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'yyyy'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  <span class="number">2015</span>  --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'yy'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  <span class="number">15</span>   --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'y'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  <span class="number">2015</span>  --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'MMMM'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  January   --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'MMM'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  Jan   --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'MM'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  <span class="number">01</span>  --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'M'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  <span class="number">1</span>  --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'dd'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  <span class="number">24</span>  --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'d'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  <span class="number">24</span>  --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'EEEE'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  Saturday   --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'EEE'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  Sat   --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'HH'</span>&#125;&#125;</span><br><span class="line">&#123;% endraw %&#125; &lt;!--  <span class="number">17</span>  --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'H'</span>&#125;&#125;</span><br><span class="line">&#123;% endraw %&#125; &lt;!--  <span class="number">17</span>  --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'hh'</span>&#125;&#125;</span><br><span class="line">&#123;% endraw %&#125; &lt;!--  <span class="number">05</span>  --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'h'</span>&#125;&#125;</span><br><span class="line">&#123;% endraw %&#125; &lt;!--  <span class="number">5</span>  --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'mm'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  <span class="number">36</span>  --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'m'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  <span class="number">36</span>  --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'ss'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  <span class="number">38</span>  --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'s'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  <span class="number">38</span>  --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'.sss'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  <span class="number">.628</span>  --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'a'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  PM  --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'Z'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  +<span class="number">0800</span>   --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'MMMd, y'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  Jan24, <span class="number">2015</span>  --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'EEEE, d, M'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125; &lt;!--  Saturday, <span class="number">24</span>, <span class="number">1</span>  --&gt;</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;today | date:<span class="string">'hh:mm:ss.sss'</span> &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;&lt;!--  <span class="number">05</span>:<span class="number">36</span>:<span class="number">38.628</span>  --&gt;</span><br></pre></td></tr></table></figure><h2 id="è‡ªå®šä¹‰filter"><a href="#è‡ªå®šä¹‰filter" class="headerlink" title="è‡ªå®šä¹‰filter"></a>è‡ªå®šä¹‰filter</h2><blockquote><p>å¦‚Controlleré‚£æ ·ï¼Œfilterä¹Ÿæœ€å¥½ä¸è¦å…¨å±€æ»¡å¤©é£ï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰åœ¨ä¸€ä¸ªmoduleé‡Œé¢ã€‚<br>è¿™é‡Œå†™ä¸€ä¸ªç®€å•çš„ä¾‹å­:</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myApp = angular.module(<span class="string">"myApp"</span>,[])</span><br><span class="line">.filter(<span class="string">'kavlezFilter'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">input</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(input)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">'Kavlez:\"'</span>+input+<span class="string">'"'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><blockquote><p>ä½¿ç”¨è¯¥filter:</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;&#123;<span class="string">'Any time, Any where, Whoever or whatever you are, just bring it on'</span>|kavlezFilter &#125;&#125;</span><br><span class="line">&#123;% endraw %&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è¾“å‡º:</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Kavlez:<span class="string">"Any time, Any where, Whoever or whatever you are, just bring it on"</span><span class="keyword">as</span></span><br></pre></td></tr></table></figure><h2 id="è½¬è½½è‡ª"><a href="#è½¬è½½è‡ª" class="headerlink" title="è½¬è½½è‡ª:"></a>è½¬è½½è‡ª:</h2><p><a href="http://www.cnblogs.com/Kavlez/p/4246203.html" target="_blank" rel="noopener">http://www.cnblogs.com/Kavlez/p/4246203.html</a></p><hr><blockquote><h3 id="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢"><a href="#æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢" class="headerlink" title="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~"></a>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</h3><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> AngularJS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>karmaå…¨å±€å®‰è£…è®°å½•</title>
      <link href="/2015/03/29/karma-notes/"/>
      <url>/2015/03/29/karma-notes/</url>
      
        <content type="html"><![CDATA[<blockquote><p>karmaå…¨å±€å®‰è£…è®°å½•</p></blockquote><a id="more"></a><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æˆ‘å…¨å±€å®‰è£…äº†...</span></span><br><span class="line">npm install karma -g</span><br></pre></td></tr></table></figure><h2 id="ç§»åŠ¨æ–‡ä»¶å¤¹"><a href="#ç§»åŠ¨æ–‡ä»¶å¤¹" class="headerlink" title="ç§»åŠ¨æ–‡ä»¶å¤¹"></a>ç§»åŠ¨æ–‡ä»¶å¤¹</h2><blockquote><p>è¿›å…¥<code>C:\Users\ä½ çš„ç”¨æˆ·å\AppData\Roaming\npm\node_modules</code>, æ–°å»ºæ–‡ä»¶å¤¹,å°†karmaæ–‡ä»¶å¤¹ç§»åŠ¨åˆ°æ–°å»ºçš„æ–‡ä»¶å¤¹; ç›®å½•å¦‚ä¸‹:</p></blockquote><ul><li>karma // ä½ æ–°å»ºçš„æ–‡ä»¶å¤¹åç§°<ul><li>karma //åŸå§‹çš„karmaæ–‡ä»¶å¤¹</li></ul></li></ul><p><strong>å¦‚æ­¤æ“ä½œçš„åŸå› :</strong></p><blockquote><p>åœ¨ karma çš„æ–‡ä»¶å¤¹çš„<code>package.json</code>çš„<code>devDependencies</code>æ²¡æœ‰ç”Ÿæˆ<code>node_modules</code></p></blockquote><h2 id="ç”Ÿæˆ-devDependencies"><a href="#ç”Ÿæˆ-devDependencies" class="headerlink" title="ç”Ÿæˆ devDependencies"></a>ç”Ÿæˆ <code>devDependencies</code></h2><blockquote><p>æ–°å»º<code>package.json</code></p></blockquote><p><strong>ç»“æ„å¦‚ä¸‹</strong></p><ul><li>karma<ul><li>karma</li><li>package.json</li></ul></li></ul><p>å…¶ä¸­<code>package.json</code>ä¸º:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"name"</span>: <span class="string">"random"</span>,</span><br><span class="line">    <span class="string">"version"</span>: <span class="string">"1.0.0"</span>,</span><br><span class="line">    <span class="string">"description"</span>: <span class="string">""</span>,</span><br><span class="line">    <span class="string">"author"</span>: <span class="string">"SHANG"</span>,</span><br><span class="line">    <span class="string">"devDependencies"</span>: &#123;</span><br><span class="line">        <span class="string">"karma-jasmine"</span>: <span class="string">"~0.1.0"</span>,</span><br><span class="line">        <span class="string">"karma-mocha"</span>: <span class="string">"*"</span>,</span><br><span class="line">        <span class="string">"karma-qunit"</span>: <span class="string">"*"</span>,</span><br><span class="line">        <span class="string">"karma-coverage"</span>: <span class="string">"*"</span>,</span><br><span class="line">        <span class="string">"karma-requirejs"</span>: <span class="string">"*"</span>,</span><br><span class="line">        <span class="string">"karma-commonjs"</span>: <span class="string">"*"</span>,</span><br><span class="line">        <span class="string">"karma-growl-reporter"</span>: <span class="string">"*"</span>,</span><br><span class="line">        <span class="string">"karma-junit-reporter"</span>: <span class="string">"*"</span>,</span><br><span class="line">        <span class="string">"karma-chrome-launcher"</span>: <span class="string">"*"</span>,</span><br><span class="line">        <span class="string">"karma-firefox-launcher"</span>: <span class="string">"*"</span>,</span><br><span class="line">        <span class="string">"karma-sauce-launcher"</span>: <span class="string">"*"</span>,</span><br><span class="line">        <span class="string">"karma-phantomjs-launcher"</span>: <span class="string">"*"</span>,</span><br><span class="line">        <span class="string">"karma-ng-scenario"</span>: <span class="string">"*"</span>,</span><br><span class="line">        <span class="string">"karma-coffee-preprocessor"</span>: <span class="string">"*"</span>,</span><br><span class="line">        <span class="string">"karma-live-preprocessor"</span>: <span class="string">"*"</span>,</span><br><span class="line">        <span class="string">"karma-html2js-preprocessor"</span>: <span class="string">"*"</span>,</span><br><span class="line">        <span class="string">"karma-browserstack-launcher"</span>: <span class="string">"*"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><blockquote><p>æ‰§è¡Œ<code>npm install</code>å‘½ä»¤;ç­‰å¾…æ‰§è¡Œå®Œæˆå;å°†å½“å‰è·¯å¾„ä¸‹çš„<code>node_modules</code>ä¸‹æ–‡ä»¶å¤¹å‰ªåˆ‡åˆ°å’Œ<code>karma</code>åŒçº§. æ–‡ä»¶ç›®å½•å¦‚ä¸‹:</p></blockquote><ul><li>karma<ul><li>karma         //æœ€åŸå§‹çš„karma</li><li>karma-browserstack-launcher</li><li>karma-chrome-launcher</li><li>karma-jasmine</li><li>â€¦â€¦.</li><li>node_modules //å¯ä»¥åˆ é™¤</li></ul></li></ul><h2 id="å»ºç«‹karma-cmd"><a href="#å»ºç«‹karma-cmd" class="headerlink" title="å»ºç«‹karma.cmd"></a>å»ºç«‹karma.cmd</h2><blockquote><p>å®‰è£…åæ²¡æœ‰ç”Ÿæˆé“¾æ¥,æ— æ³•ä½¿ç”¨å‘½ä»¤å¯åŠ¨;æ•…å¦‚ä¸‹æ“ä½œ<br>åœ¨è·¯å¾„<code>C:\Users\ä½ çš„ç”¨æˆ·å\AppData\Roaming\npm</code>ä¸‹å»ºç«‹<code>karma.cmd</code>;é‡Œé¢å†…å®¹å¦‚ä¸‹</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@IF EXIST <span class="string">"%~dp0\node.exe"</span> (</span><br><span class="line">  <span class="string">"%~dp0\node.exe"</span>  <span class="string">"%~dp0\node_modules\karma\karma\bin\karma"</span> %*</span><br><span class="line">) ELSE (</span><br><span class="line">  @SETLOCAL</span><br><span class="line">  @SET PATHEXT=%PATHEXT:;.JS;=;%</span><br><span class="line">  node  <span class="string">"%~dp0\node_modules\karma\karma\bin\karma"</span> %*</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><blockquote><p>åœ¨éšä¾¿å“ªä¸ªè·¯å¾„ä¸‹æ–°å»ºæµ‹è¯•æ–‡ä»¶å¤¹;æˆ‘çš„ç›®å½•å¦‚ä¸‹</p></blockquote><ul><li>src<ul><li>index.js</li></ul></li><li>test<ul><li>TestCase1.js</li></ul></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.js</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">reverse</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> name.split(<span class="string">""</span>).reverse().join(<span class="string">""</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// TestCase1.js</span></span><br><span class="line">describe(<span class="string">"A suite"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    it(<span class="string">"contains spec with an expectation"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"This is msg from log..."</span>);</span><br><span class="line">        expect(<span class="literal">true</span>).toBe(<span class="literal">true</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">describe(<span class="string">"A suite of basic functions"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    it(<span class="string">"reverse word"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        expect(<span class="string">"DCBA"</span>).toEqual(reverse(<span class="string">"ABCD"</span>));</span><br><span class="line">        expect(<span class="string">"damo"</span>).toEqual(reverse(<span class="string">"omad1"</span>));</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><blockquote><p>cmd å½“å‰ç›®å½•ä¸‹è¾“å…¥  <code>karma init conf</code></p></blockquote><figure class="image-box">                <img src="/img/karma/karma_init.png" alt="karma" title="" class="">                <p>karma</p>            </figure><blockquote><p>å®Œæˆåè¾“å…¥ <code>karma start conf</code>; æ‹‰èµ·chromeå¼€å§‹æµ‹è¯•äº†~~</p></blockquote><figure class="image-box">                <img src="/img/karma/karma_start.png" alt="karma" title="" class="">                <p>karma</p>            </figure><blockquote><p>æµ‹è¯•å®ŒæˆæŒ‰<code>ctrl+c</code>å…³é—­;å…³é—­æµè§ˆå™¨æ˜¯æ²¡æœ‰ç”¨çš„~~</p></blockquote><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™:"></a>å‚è€ƒèµ„æ–™:</h1><p><a href="http://blog.jobbole.com/54936/" target="_blank" rel="noopener">http://blog.jobbole.com/54936/</a></p><hr><blockquote><h3 id="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢"><a href="#æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢" class="headerlink" title="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~"></a>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</h3><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> karma </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ¤æ–­AngularJSæ¸²æŸ“é¡µé¢å®Œæˆ</title>
      <link href="/2015/03/27/%E5%88%A4%E6%96%ADAngularJS%E6%B8%B2%E6%9F%93%E9%A1%B5%E9%9D%A2%E5%AE%8C%E6%88%90/"/>
      <url>/2015/03/27/%E5%88%A4%E6%96%ADAngularJS%E6%B8%B2%E6%9F%93%E9%A1%B5%E9%9D%A2%E5%AE%8C%E6%88%90/</url>
      
        <content type="html"><![CDATA[<p>å†™demoçš„æ—¶å€™éœ€è¦è°ƒæ•´é¡µé¢é«˜åº¦,ä¹‹å‰ç”¨jqueryçš„æ—¶å€™ä¸€ç›´æ˜¯ <code>$(document).ready()</code> æ¥åˆ¤æ–­é¡µé¢æ¸²æŸ“å®Œæˆ<br>ä½†æ˜¯åˆ°äº†angularjsä¹‹å,ä¸èµ·ä½œç”¨â€¦â€¦â€¦â€¦<br><a id="more"></a></p><blockquote><p>ä½¿ç”¨$viewContentLoadedäº‹ä»¶</p></blockquote><ul><li><a href="http://plnkr.co/edit/isbTireh3w9OomDOvx87?p=preview" target="_blank" rel="noopener">å®Œæ•´Demo</a></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;div ng-controller=<span class="string">"MainCtrl"</span>&gt;</span><br><span class="line">  &lt;div ng-view&gt;<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;<span class="regexp">/div&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$scope.$on(<span class="string">'$viewContentLoaded'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æˆ–è€…</span></span><br><span class="line">$scope.$watch(<span class="string">'$viewContentLoaded'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;  </span><br><span class="line">  </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><blockquote><p>åˆ©ç”¨data-ng-init<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;div ng-controller=<span class="string">"test"</span>&gt;  </span><br><span class="line">     &lt;div data-ng-init=<span class="string">"load()"</span> &gt;<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>  </span><br><span class="line">&lt;<span class="regexp">/div&gt;</span></span><br></pre></td></tr></table></figure></p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">bookControllers.controller(<span class="string">'testInit'</span>, [<span class="string">'$scope'</span>, <span class="string">'$routeParams'</span>,  <span class="function"><span class="keyword">function</span>(<span class="params">$scope, $routeParams</span>) </span>&#123;  </span><br><span class="line">    $scope.load = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;  </span><br><span class="line">         alert(<span class="string">'code here'</span>);  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;]);</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™:"></a>å‚è€ƒèµ„æ–™:</h1><ul><li><a href="http://stackoverflow.com/questions/21715256/angularjs-event-to-call-after-content-is-loaded" target="_blank" rel="noopener">http://stackoverflow.com/questions/21715256/angularjs-event-to-call-after-content-is-loaded</a></li><li><a href="http://blog.51yip.com/jsjquery/1599.html" target="_blank" rel="noopener">http://blog.51yip.com/jsjquery/1599.html</a></li></ul><hr><blockquote><h3 id="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢"><a href="#æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢" class="headerlink" title="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~"></a>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</h3><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> AngularJS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>html5 æœ¬åœ°å›¾ç‰‡é¢„è§ˆ</title>
      <link href="/2015/03/24/html5-%E6%9C%AC%E5%9C%B0%E5%9B%BE%E7%89%87%E9%A2%84%E8%A7%88/"/>
      <url>/2015/03/24/html5-%E6%9C%AC%E5%9C%B0%E5%9B%BE%E7%89%87%E9%A2%84%E8%A7%88/</url>
      
        <content type="html"><![CDATA[<blockquote><p>åœ¨æ²¡æœ‰æŠŠå›¾ç‰‡æäº¤åˆ°æœåŠ¡å™¨ä¹‹å‰ï¼ŒæŠŠå›¾ç‰‡çš„å†…å®¹æ˜¾ç¤ºåœ¨å®¢æˆ·ç«¯ä¸Š<br><a id="more"></a></p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head lang=<span class="string">"en"</span>&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">    &lt;title&gt;test&lt;<span class="regexp">/title&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;input type=<span class="string">"file"</span> accept=<span class="string">"image/*"</span> id=<span class="string">"img"</span>/&gt;</span><br><span class="line">    &lt;img id=<span class="string">"showImg"</span> alt=<span class="string">"å¾…æ˜¾ç¤ºçš„å›¾ç‰‡"</span>/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        <span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> fileInput = <span class="built_in">document</span>.getElementById(<span class="string">'img'</span>);</span><br><span class="line">            fileInput.addEventListener(<span class="string">'change'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">                <span class="comment">// è·å–files</span></span><br><span class="line">                <span class="keyword">var</span> files = e.target.files;</span><br><span class="line">                <span class="comment">// è·å–å•ä¸ªfile</span></span><br><span class="line">                <span class="keyword">if</span> (files &amp;&amp; files.length) &#123;</span><br><span class="line">                    <span class="keyword">var</span> file = files[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    <span class="comment">// é€šè¿‡ FileReader</span></span><br><span class="line">                    <span class="keyword">var</span> reader = <span class="keyword">new</span> FileReader();</span><br><span class="line">                    reader.onload = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">                        <span class="keyword">var</span> image = <span class="keyword">new</span> Image();</span><br><span class="line">                        image.src = event.target.result;</span><br><span class="line">                        image.width = <span class="number">100</span>;</span><br><span class="line">                        <span class="built_in">document</span>.body.appendChild(image);</span><br><span class="line">                    &#125;;</span><br><span class="line">                    reader.readAsDataURL(file);</span><br><span class="line"></span><br><span class="line">                    <span class="comment">// ----------------------------------------</span></span><br><span class="line"></span><br><span class="line">                    <span class="comment">// é€šè¿‡ window.URL å·¥å…·ä» file å¯¹è±¡ç”Ÿæˆä¸€ä¸ªå¯ç”¨çš„ URL</span></span><br><span class="line">                    <span class="keyword">var</span> URL = <span class="built_in">window</span>.URL || <span class="built_in">window</span>.webkitURL;</span><br><span class="line">                    <span class="keyword">var</span> imgURL = URL.createObjectURL(file);</span><br><span class="line">                    <span class="comment">// æ˜¾ç¤º</span></span><br><span class="line">                    <span class="built_in">document</span>.getElementById(<span class="string">'showImg'</span>).src = imgURL;</span><br><span class="line"></span><br><span class="line">                    setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                        <span class="comment">// ä½¿ç”¨ä¸‹é¢è¿™å¥å¯ä»¥åœ¨å†…å­˜ä¸­é‡Šæ”¾å¯¹æ­¤ url çš„ä¼ºæœ</span></span><br><span class="line">                        URL.revokeObjectURL(imgURL);</span><br><span class="line">                        <span class="comment">// å†æ¬¡è®¾ç½®æ— æ•ˆ!</span></span><br><span class="line">                        <span class="built_in">document</span>.getElementById(<span class="string">'showImg'</span>).src = imgURL;</span><br><span class="line">                    &#125;, <span class="number">1000</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>body&gt;</span><br><span class="line">&lt;<span class="regexp">/html&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>è°ƒç”¨ URL.createObjectURL çš„æ—¶å€™ï¼Œæµè§ˆå™¨è‡ªåŠ¨åœ¨å†…å­˜ä¸­å¼€è¾Ÿç©ºé—´ï¼Œç”¨äºä¼ºæœè¿™ä¸ª URLï¼Œä¹Ÿå°±æ˜¯ä½¿å¾—è¿™ä¸ª URL å¯ä»¥è¯·æ±‚æˆåŠŸï¼›</p></blockquote><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™:"></a>å‚è€ƒèµ„æ–™:</h1><ul><li><a href="http://www.huangwenchao.com.cn/2015/03/html5-image-preview.html" target="_blank" rel="noopener">http://www.huangwenchao.com.cn/2015/03/html5-image-preview.html</a></li><li><a href="http://www.ruanyifeng.com/blog/2012/08/file_upload.html" target="_blank" rel="noopener">http://www.ruanyifeng.com/blog/2012/08/file_upload.html</a></li></ul><hr><blockquote><h3 id="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢"><a href="#æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢" class="headerlink" title="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~"></a>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</h3><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> html5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[è½¬]AngularJS ä½œç”¨åŸŸæ•°æ®ç»‘å®š</title>
      <link href="/2015/03/22/-%E8%BD%AC-AngularJS-%E4%BD%9C%E7%94%A8%E5%9F%9F%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A/"/>
      <url>/2015/03/22/-%E8%BD%AC-AngularJS-%E4%BD%9C%E7%94%A8%E5%9F%9F%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A/</url>
      
        <content type="html"><![CDATA[<p>åœ¨imoocä¸Šçœ‹<a href="http://www.imooc.com/video/3085" target="_blank" rel="noopener">angularjsæŒ‡ä»¤4</a>,æœç´¢äº†è½¬è½½ä¸‹<br><a id="more"></a></p><ol><li>åŸºäºå­—ç¬¦ä¸²çš„ç»‘å®šï¼šä½¿ç”¨@æ“ä½œç¬¦ï¼ŒåŒå¼•å·å†…çš„å†…å®¹å½“åšå­—ç¬¦ä¸²è¿›è¡Œç»‘å®šã€‚</li><li>åŸºäºå˜é‡çš„ç»‘å®šï¼šä½¿ç”¨=æ“ä½œç¬¦ï¼Œç»‘å®šçš„å†…å®¹æ˜¯ä¸ªå˜é‡,åŒå‘æ•°æ®ç»‘å®š</li><li>åŸºäºæ–¹æ³•çš„ç»‘å®šï¼šä½¿ç”¨&amp;æ“ä½œç¬¦ï¼Œç»‘å®šçš„å†…å®¹æ˜¯ä¸ªæ–¹æ³•ã€‚</li></ol><ol><li><p><strong>@</strong></p><figure class="image-box">                <img src="/img/angularjs/@.png" alt="@" title="" class="">                <p>@</p>            </figure></li><li><p><strong>=</strong></p><figure class="image-box">                <img src="/img/angularjs/=.png" alt="=" title="" class="">                <p>=</p>            </figure></li><li><p><strong>&amp;</strong></p><figure class="image-box">                <img src="/img/angularjs/&.png" alt="&" title="" class="">                <p>&</p>            </figure></li></ol><blockquote><p>ä¸Šå›¾ä»£ç : </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&lt;!doctype html&gt;</span><br><span class="line">&lt;html ng-app=<span class="string">"myApp"</span>&gt;</span><br><span class="line">    &lt;head&gt;</span><br><span class="line">         &lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=utf-8"</span> /&gt;</span><br><span class="line">         &lt;script src=<span class="string">"http://apps.bdimg.com/libs/angular.js/1.2.16/angular.min.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">    &lt;<span class="regexp">/head&gt;</span></span><br><span class="line"><span class="regexp">    &lt;body&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">        &lt;div ng-controller="myAppCtrl"&gt;</span></span><br><span class="line"><span class="regexp">            &lt;xingoo say="test string"&gt;&lt;/</span>xingoo&gt;</span><br><span class="line">            &lt;xingoo say=<span class="string">"&#123;&#123;str2&#125;&#125;"</span>&gt;&lt;/xingoo&gt;</span><br><span class="line">            &lt;xingoo say=<span class="string">"test()"</span>&gt;&lt;/xingoo&gt;</span><br><span class="line">        &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">        &lt;script type="text/</span>javascript<span class="string">"&gt;</span></span><br><span class="line"><span class="string">            var myAppModule = angular.module("</span>myApp<span class="string">",[]);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            myAppModule.controller("</span>myAppCtrl<span class="string">",['$scope',function($scope)&#123;</span></span><br><span class="line"><span class="string">                $scope.str1 = "</span>hello<span class="string">";</span></span><br><span class="line"><span class="string">                $scope.str2 = "</span>world<span class="string">";</span></span><br><span class="line"><span class="string">                $scope.str3 = "</span>angular<span class="string">";</span></span><br><span class="line"><span class="string">            &#125;]);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            myAppModule.directive("</span>xingoo<span class="string">",function()&#123;</span></span><br><span class="line"><span class="string">                return &#123;</span></span><br><span class="line"><span class="string">                    restrict:'AE',</span></span><br><span class="line"><span class="string">                    scope:&#123;</span></span><br><span class="line"><span class="string">                        say:'@'</span></span><br><span class="line"><span class="string">                    &#125;,</span></span><br><span class="line"><span class="string">                    template:"</span>&lt;div&gt;&#123;&#123;say&#125;&#125;&lt;<span class="regexp">/div&gt;&lt;br&gt;",</span></span><br><span class="line"><span class="regexp">                    repalce:true</span></span><br><span class="line"><span class="regexp">                &#125;</span></span><br><span class="line"><span class="regexp">            &#125;)</span></span><br><span class="line"><span class="regexp">        &lt;/</span>script&gt;</span><br><span class="line">    &lt;<span class="regexp">/body&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>html&gt;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;!doctype html&gt;</span><br><span class="line">&lt;html ng-app=<span class="string">"myApp"</span>&gt;</span><br><span class="line">    &lt;head&gt;</span><br><span class="line">         &lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=utf-8"</span> /&gt;</span><br><span class="line">         &lt;script src=<span class="string">"http://apps.bdimg.com/libs/angular.js/1.2.16/angular.min.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">    &lt;<span class="regexp">/head&gt;</span></span><br><span class="line"><span class="regexp">    &lt;body&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">        &lt;div ng-controller="myAppCtrl"&gt;</span></span><br><span class="line"><span class="regexp">            ctrl:&lt;input type="text" ng-model="testname"&gt;&lt;br&gt;</span></span><br><span class="line"><span class="regexp">            directive:&lt;xingoo name="testname"&gt;&lt;/</span>xingoo&gt;</span><br><span class="line">        &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">        &lt;script type="text/</span>javascript<span class="string">"&gt;</span></span><br><span class="line"><span class="string">            var myAppModule = angular.module("</span>myApp<span class="string">",[]);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            myAppModule.controller("</span>myAppCtrl<span class="string">",['$scope',function($scope)&#123;</span></span><br><span class="line"><span class="string">                $scope.testname="</span>my name is xingoo<span class="string">";</span></span><br><span class="line"><span class="string">            &#125;]);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            myAppModule.directive("</span>xingoo<span class="string">",function()&#123;</span></span><br><span class="line"><span class="string">                return &#123;</span></span><br><span class="line"><span class="string">                    restrict:'AE',</span></span><br><span class="line"><span class="string">                    scope:&#123;</span></span><br><span class="line"><span class="string">                        name:'='</span></span><br><span class="line"><span class="string">                    &#125;,</span></span><br><span class="line"><span class="string">                    template:'&lt;input type="</span>text<span class="string">" ng-model="</span>name<span class="string">"&gt;',</span></span><br><span class="line"><span class="string">                    repalce:true</span></span><br><span class="line"><span class="string">                &#125;</span></span><br><span class="line"><span class="string">            &#125;)</span></span><br><span class="line"><span class="string">        &lt;/script&gt;</span></span><br><span class="line"><span class="string">    &lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;!doctype html&gt;</span><br><span class="line">&lt;html ng-app=<span class="string">"myApp"</span>&gt;</span><br><span class="line">    &lt;head&gt;</span><br><span class="line">         &lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=utf-8"</span> /&gt;</span><br><span class="line">         &lt;script src=<span class="string">"http://apps.bdimg.com/libs/angular.js/1.2.16/angular.min.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">    &lt;<span class="regexp">/head&gt;</span></span><br><span class="line"><span class="regexp">    &lt;body&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">        &lt;div ng-controller="myAppCtrl"&gt;</span></span><br><span class="line"><span class="regexp">            &lt;xingoo say="sayHello(name)"&gt;&lt;/</span>xingoo&gt;</span><br><span class="line">            &lt;xingoo say=<span class="string">"sayNo(name)"</span>&gt;&lt;/xingoo&gt;</span><br><span class="line">            &lt;xingoo say=<span class="string">"sayYes(name)"</span>&gt;&lt;/xingoo&gt;</span><br><span class="line">        &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">        &lt;script type="text/</span>javascript<span class="string">"&gt;</span></span><br><span class="line"><span class="string">            var myAppModule = angular.module("</span>myApp<span class="string">",[]);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            myAppModule.controller("</span>myAppCtrl<span class="string">",['$scope',function($scope)&#123;</span></span><br><span class="line"><span class="string">                $scope.sayHello = function(name)&#123;</span></span><br><span class="line"><span class="string">                    console.log("</span>hello !<span class="string">"+ name);</span></span><br><span class="line"><span class="string">                &#125;;</span></span><br><span class="line"><span class="string">                $scope.sayNo = function(name)&#123;</span></span><br><span class="line"><span class="string">                    console.log("</span>no !<span class="string">"+ name);</span></span><br><span class="line"><span class="string">                &#125;;</span></span><br><span class="line"><span class="string">                $scope.sayYes = function(name)&#123;</span></span><br><span class="line"><span class="string">                    console.log("</span>yes !<span class="string">"+ name);</span></span><br><span class="line"><span class="string">                &#125;;</span></span><br><span class="line"><span class="string">            &#125;]);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            myAppModule.directive("</span>xingoo<span class="string">",function()&#123;</span></span><br><span class="line"><span class="string">                return &#123;</span></span><br><span class="line"><span class="string">                    restrict:'AE',</span></span><br><span class="line"><span class="string">                    scope:&#123;</span></span><br><span class="line"><span class="string">                        say:'&amp;'</span></span><br><span class="line"><span class="string">                    &#125;,</span></span><br><span class="line"><span class="string">                    template:'&lt;input type="</span>text<span class="string">" ng-model="</span>username<span class="string">"/&gt;&lt;br&gt;'+</span></span><br><span class="line"><span class="string">                        '&lt;button ng-click="</span>say(&#123;<span class="attr">name</span>:username&#125;)<span class="string">"&gt;click&lt;/button&gt;&lt;br&gt;',</span></span><br><span class="line"><span class="string">                    repalce:true</span></span><br><span class="line"><span class="string">                &#125;</span></span><br><span class="line"><span class="string">            &#125;)</span></span><br><span class="line"><span class="string">        &lt;/script&gt;</span></span><br><span class="line"><span class="string">    &lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™:"></a>å‚è€ƒèµ„æ–™:</h1><ul><li><a href="http://www.cnblogs.com/xing901022/p/4291521.html" target="_blank" rel="noopener">http://www.cnblogs.com/xing901022/p/4291521.html</a></li></ul><hr><blockquote><h3 id="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢"><a href="#æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢" class="headerlink" title="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~"></a>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</h3><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> AngularJS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ‰‹æœºHTML5 audio æ— æ³•è‡ªåŠ¨æ’­æ”¾ä¸‹ä¸€é¦–</title>
      <link href="/2015/03/19/%E6%89%8B%E6%9C%BAHTML5-audio-%E6%97%A0%E6%B3%95%E8%87%AA%E5%8A%A8%E6%92%AD%E6%94%BE%E4%B8%8B%E4%B8%80%E9%A6%96/"/>
      <url>/2015/03/19/%E6%89%8B%E6%9C%BAHTML5-audio-%E6%97%A0%E6%B3%95%E8%87%AA%E5%8A%A8%E6%92%AD%E6%94%BE%E4%B8%8B%E4%B8%80%E9%A6%96/</url>
      
        <content type="html"><![CDATA[<p>åœ¨PCçš„chromeä¸Šä¸‹ä¸€é¦–å¾ˆå¥½çš„å·¥ä½œ;ä½†æ˜¯åœ¨Androidçš„chromeä¸Šå‡ºç°äº†æ‰‹åŠ¨åˆ‡æ¢ä¸‹ä¸€é¦–æ— é—®é¢˜,è‡ªåŠ¨åˆ‡æ¢ä¸‹ä¸€é¦–æ— æ³•æ’­æ”¾é—®é¢˜</p><a id="more"></a><h1 id="è§£å†³åŠæ³•"><a href="#è§£å†³åŠæ³•" class="headerlink" title="è§£å†³åŠæ³•"></a>è§£å†³åŠæ³•</h1><p><strong>ä¸åœ¨ç½‘é¡µé‡Œé¢ç›´æ¥å†™<code>&lt;audio&gt;</code></strong></p><blockquote><p>åŸæ¥ä»£ç : </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (audio) &#123;</span><br><span class="line">  <span class="built_in">document</span>.body.removeChild(audio);</span><br><span class="line">&#125;</span><br><span class="line">audio = <span class="built_in">document</span>.createElement(<span class="string">'audio'</span>);</span><br><span class="line">audio.innerHTML = <span class="string">'&lt;source src='</span> + audioobj.mp3 + <span class="string">'&gt;'</span>;</span><br><span class="line"><span class="built_in">document</span>.body.appendChild(audio);</span><br><span class="line">audio.play();</span><br></pre></td></tr></table></figure><blockquote><p>ä¿®æ”¹åçš„ä»£ç </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (audio) &#123;</span><br><span class="line">  <span class="comment">// æŠŠaudio.srcè®¾ä¸ºnullï¼Œå¹¶æ˜¾å¼è°ƒç”¨audio.load()ï¼Œ</span></span><br><span class="line">  <span class="comment">// æ­¤æ—¶å¯¹äºAndroidä¼šä¸­æ–­æ•°æ®è¯»å–</span></span><br><span class="line">  audio.src = <span class="literal">null</span>;</span><br><span class="line">  audio.load();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="comment">//  é€šè¿‡new</span></span><br><span class="line">  audio = <span class="keyword">new</span> Audio();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">audio.src = audioobj.mp3;</span><br><span class="line">audio.play();</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™:"></a>å‚è€ƒèµ„æ–™:</h1><ul><li><a href="http://www.86y.org/art_detail.aspx?id=720" target="_blank" rel="noopener">http://www.86y.org/art_detail.aspx?id=720</a></li></ul><hr><blockquote><h3 id="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢"><a href="#æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢" class="headerlink" title="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~"></a>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</h3><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> html5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¸¸ç”¨meatæ•´ç†[è½¬]</title>
      <link href="/2015/03/17/%E5%B8%B8%E7%94%A8meat%E6%95%B4%E7%90%86-%E8%BD%AC/"/>
      <url>/2015/03/17/%E5%B8%B8%E7%94%A8meat%E6%95%B4%E7%90%86-%E8%BD%AC/</url>
      
        <content type="html"><![CDATA[<blockquote><p>å‰ä¸¤å¤©çœ‹åˆ° â€œä½¿ç”¨metaå®ç°é¡µé¢çš„å®šæ—¶åˆ·æ–°æˆ–è·³è½¬â€<br><a id="more"></a></p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ä½¿ç”¨&lt;meta&gt;å®ç°ï¼Œä¸‹é¢å‡ ä¸ªå…¸å‹ä»£ç ç¤ºä¾‹ï¼š</span><br><span class="line">&lt;meta http-equiv=<span class="string">"refresh"</span> content=<span class="string">"5"</span>&gt;</span><br><span class="line">è¿™ä¸ªè¡¨ç¤ºå½“å‰é¡µé¢æ¯<span class="number">5</span>ç§’é’Ÿåˆ·ä¸€ä¸‹ï¼Œåˆ·ä¸€ä¸‹~</span><br><span class="line">&lt;meta http-equiv=<span class="string">"refresh"</span> content=<span class="string">"2; url='/'"</span>&gt;</span><br><span class="line">è¿™ä¸ªè¡¨ç¤ºå½“å‰é¡µé¢<span class="number">2</span>ç§’åè·³åˆ°é¦–é¡µ~</span><br><span class="line">&lt;meta http-equiv=<span class="string">"refresh"</span> content=<span class="string">"0; url='http://www.qq.com/'"</span>&gt;</span><br><span class="line">é¡µé¢ç›´æ¥è·³è½¬åˆ°è…¾è®¯ç½‘~</span><br></pre></td></tr></table></figure><blockquote><p>ä»Šå¤©çœ‹åˆ° â€œå¸¸ç”¨metaæ•´ç†â€; è½¬è½½è®°å½•ä¸‹~~</p></blockquote><h1 id="lt-meta-gt-å…ƒç´ "><a href="#lt-meta-gt-å…ƒç´ " class="headerlink" title="&lt;meta&gt;å…ƒç´ "></a>&lt;meta&gt;å…ƒç´ </h1><h2 id="æ¦‚è¦"><a href="#æ¦‚è¦" class="headerlink" title="æ¦‚è¦"></a>æ¦‚è¦</h2><blockquote><p>æ ‡ç­¾æä¾›å…³äºHTMLæ–‡æ¡£çš„å…ƒæ•°æ®ã€‚å…ƒæ•°æ®ä¸ä¼šæ˜¾ç¤ºåœ¨é¡µé¢ä¸Šï¼Œä½†æ˜¯å¯¹äºæœºå™¨æ˜¯å¯è¯»çš„ã€‚å®ƒå¯ç”¨äºæµè§ˆå™¨ï¼ˆå¦‚ä½•æ˜¾ç¤ºå†…å®¹æˆ–é‡æ–°åŠ è½½é¡µé¢ï¼‰ï¼Œæœç´¢å¼•æ“ï¼ˆå…³é”®è¯ï¼‰ï¼Œæˆ–å…¶ä»– web æœåŠ¡ã€‚ â€”â€” <a href="http://www.w3school.com.cn/" target="_blank" rel="noopener">W3School</a></p></blockquote><p><strong>å¿…è¦å±æ€§</strong></p><table><thead><tr><th>å±æ€§</th><th style="text-align:center">å€¼</th><th style="text-align:center">æè¿°</th></tr></thead><tbody><tr><td>content</td><td style="text-align:center">some text</td><td style="text-align:center">å®šä¹‰ä¸http-equivæˆ–nameå±æ€§ç›¸å…³çš„å…ƒä¿¡æ¯</td></tr></tbody></table><p><strong>å¯é€‰å±æ€§</strong></p><table><thead><tr><th>å±æ€§</th><th style="text-align:center">å€¼</th><th style="text-align:center">æè¿°</th></tr></thead><tbody><tr><td>http-equiv</td><td style="text-align:center">content-type / expire / refresh / set-cookie</td><td style="text-align:center">æŠŠcontentå±æ€§å…³è”åˆ°HTTPå¤´éƒ¨ã€‚</td></tr><tr><td>name</td><td style="text-align:center">author / description / keywords / generator / revised / others</td><td style="text-align:center">æŠŠ content å±æ€§å…³è”åˆ°ä¸€ä¸ªåç§°ã€‚</td></tr><tr><td>content</td><td style="text-align:center">some text</td><td style="text-align:center">å®šä¹‰ç”¨äºç¿»è¯‘ content å±æ€§å€¼çš„æ ¼å¼ã€‚</td></tr></tbody></table><h2 id="SEOä¼˜åŒ–"><a href="#SEOä¼˜åŒ–" class="headerlink" title="SEOä¼˜åŒ–"></a>SEOä¼˜åŒ–</h2><p><a href="http://msdn.microsoft.com/zh-cn/library/ff724016" target="_blank" rel="noopener">å‚è€ƒé“¾æ¥</a></p><ul><li><strong>é¡µé¢å…³é”®è¯</strong>ï¼Œæ¯ä¸ªç½‘é¡µåº”å…·æœ‰æè¿°è¯¥ç½‘é¡µå†…å®¹çš„ä¸€ç»„å”¯ä¸€çš„å…³é”®å­—ã€‚<br>ä½¿ç”¨äººä»¬å¯èƒ½ä¼šæœç´¢ï¼Œå¹¶å‡†ç¡®æè¿°ç½‘é¡µä¸Šæ‰€æä¾›ä¿¡æ¯çš„æè¿°æ€§å’Œä»£è¡¨æ€§å…³é”®å­—åŠçŸ­è¯­ã€‚æ ‡è®°å†…å®¹å¤ªçŸ­ï¼Œåˆ™æœç´¢å¼•æ“å¯èƒ½ä¸ä¼šè®¤ä¸ºè¿™äº›å†…å®¹ç›¸å…³ã€‚å¦å¤–æ ‡è®°ä¸åº”è¶…è¿‡ 874 ä¸ªå­—ç¬¦ã€‚</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta name=<span class="string">"keywords"</span> content=<span class="string">"your tags"</span> /&gt;</span><br></pre></td></tr></table></figure><ul><li><strong>é¡µé¢æè¿°</strong>ï¼Œæ¯ä¸ªç½‘é¡µéƒ½åº”æœ‰ä¸€ä¸ªä¸è¶…è¿‡ 150 ä¸ªå­—ç¬¦ä¸”èƒ½å‡†ç¡®åæ˜ ç½‘é¡µå†…å®¹çš„æè¿°æ ‡ç­¾ã€‚</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta name=<span class="string">"description"</span> content=<span class="string">"150 words"</span> /&gt;</span><br></pre></td></tr></table></figure><ul><li><p><strong>æœç´¢å¼•æ“ç´¢å¼•æ–¹å¼</strong>ï¼Œrobottermsæ˜¯ä¸€ç»„ä½¿ç”¨é€—å·(,)åˆ†å‰²çš„å€¼ï¼Œé€šå¸¸æœ‰å¦‚ä¸‹å‡ ç§å–å€¼ï¼šnoneï¼Œnoindexï¼Œnofollowï¼Œallï¼Œindexå’Œfollowã€‚ç¡®ä¿æ­£ç¡®ä½¿ç”¨nofollowå’Œnoindexå±æ€§å€¼ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta name=<span class="string">"robots"</span> content=<span class="string">"index,follow"</span> /&gt;</span><br><span class="line">&lt;!--</span><br><span class="line">    allï¼šæ–‡ä»¶å°†è¢«æ£€ç´¢ï¼Œä¸”é¡µé¢ä¸Šçš„é“¾æ¥å¯ä»¥è¢«æŸ¥è¯¢ï¼›</span><br><span class="line">    noneï¼šæ–‡ä»¶å°†ä¸è¢«æ£€ç´¢ï¼Œä¸”é¡µé¢ä¸Šçš„é“¾æ¥ä¸å¯ä»¥è¢«æŸ¥è¯¢ï¼›</span><br><span class="line">    indexï¼šæ–‡ä»¶å°†è¢«æ£€ç´¢ï¼›</span><br><span class="line">    followï¼šé¡µé¢ä¸Šçš„é“¾æ¥å¯ä»¥è¢«æŸ¥è¯¢ï¼›</span><br><span class="line">    noindexï¼šæ–‡ä»¶å°†ä¸è¢«æ£€ç´¢ï¼›</span><br><span class="line">    nofollowï¼šé¡µé¢ä¸Šçš„é“¾æ¥ä¸å¯ä»¥è¢«æŸ¥è¯¢ã€‚</span><br><span class="line"> --&gt;</span><br></pre></td></tr></table></figure></li><li><p><strong>é¡µé¢é‡å®šå‘å’Œåˆ·æ–°</strong>ï¼šcontentå†…çš„æ•°å­—ä»£è¡¨æ—¶é—´ï¼ˆç§’ï¼‰ï¼Œæ—¢å¤šå°‘æ—¶é—´ååˆ·æ–°ã€‚å¦‚æœåŠ url,åˆ™ä¼šé‡å®šå‘åˆ°æŒ‡å®šç½‘é¡µï¼ˆæœç´¢å¼•æ“èƒ½å¤Ÿè‡ªåŠ¨æ£€æµ‹ï¼Œä¹Ÿå¾ˆå®¹æ˜“è¢«å¼•æ“è§†ä½œè¯¯å¯¼è€Œå—åˆ°æƒ©ç½šï¼‰ã€‚</p></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta http-equiv=<span class="string">"refresh"</span> content=<span class="string">"0;url="</span> /&gt;</span><br></pre></td></tr></table></figure><ul><li><strong>å…¶ä»–</strong></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta name=<span class="string">"author"</span> content=<span class="string">"author name"</span> /&gt; <span class="xml"><span class="comment">&lt;!-- å®šä¹‰ç½‘é¡µä½œè€… --&gt;</span></span></span><br><span class="line">&lt;meta name="google" content="index,follow" /&gt;</span><br><span class="line">&lt;meta name="googlebot" content="index,follow" /&gt;</span><br><span class="line">&lt;meta name="verify" content="index,follow" /&gt;</span><br></pre></td></tr></table></figure><h2 id="ç§»åŠ¨è®¾å¤‡"><a href="#ç§»åŠ¨è®¾å¤‡" class="headerlink" title="ç§»åŠ¨è®¾å¤‡"></a>ç§»åŠ¨è®¾å¤‡</h2><ul><li><strong>viewportï¼š</strong>èƒ½ä¼˜åŒ–ç§»åŠ¨æµè§ˆå™¨çš„æ˜¾ç¤ºã€‚å¦‚æœä¸æ˜¯å“åº”å¼ç½‘ç«™ï¼Œä¸è¦ä½¿ç”¨initial-scaleæˆ–è€…ç¦ç”¨ç¼©æ”¾ã€‚<br>å¤§éƒ¨åˆ†4.7-5å¯¸è®¾å¤‡çš„viewportå®½è®¾ä¸º360pxï¼›5.5å¯¸è®¾å¤‡è®¾ä¸º400pxï¼›iphone6è®¾ä¸º375pxï¼›ipone6 plusè®¾ä¸º414pxã€‚</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta name=<span class="string">"viewport"</span> content=<span class="string">"width=device-width, initial-scale=1.0,maximum-scale=1.0, user-scalable=no"</span>/&gt;</span><br><span class="line">&lt;!-- <span class="string">`width=device-width`</span> ä¼šå¯¼è‡´ iPhone <span class="number">5</span> æ·»åŠ åˆ°ä¸»å±åä»¥ WebApp å…¨å±æ¨¡å¼æ‰“å¼€é¡µé¢æ—¶å‡ºç°é»‘è¾¹  --&gt;</span><br></pre></td></tr></table></figure><blockquote><ol><li>widthï¼šå®½åº¦ï¼ˆæ•°å€¼ / device-widthï¼‰ï¼ˆèŒƒå›´ä»200 åˆ°10,000ï¼Œé»˜è®¤ä¸º980 åƒç´ ï¼‰</li><li>heightï¼šé«˜åº¦ï¼ˆæ•°å€¼ / device-heightï¼‰ï¼ˆèŒƒå›´ä»223 åˆ°10,000ï¼‰</li><li>initial-scaleï¼šåˆå§‹çš„ç¼©æ”¾æ¯”ä¾‹ ï¼ˆèŒƒå›´ä»&gt;0 åˆ°10ï¼‰</li><li>minimum-scaleï¼šå…è®¸ç”¨æˆ·ç¼©æ”¾åˆ°çš„æœ€å°æ¯”ä¾‹</li><li>maximum-scaleï¼šå…è®¸ç”¨æˆ·ç¼©æ”¾åˆ°çš„æœ€å¤§æ¯”ä¾‹</li><li>user-scalableï¼šç”¨æˆ·æ˜¯å¦å¯ä»¥æ‰‹åŠ¨ç¼© (no,yes)</li><li>minimal-uiï¼šå¯ä»¥åœ¨é¡µé¢åŠ è½½æ—¶æœ€å°åŒ–ä¸Šä¸‹çŠ¶æ€æ ã€‚ï¼ˆå·²å¼ƒç”¨ï¼‰</li></ol></blockquote><p><em>æ³¨æ„ï¼Œå¾ˆå¤šäººä½¿ç”¨initial-scale=1åˆ°éå“åº”å¼ç½‘ç«™ä¸Šï¼Œè¿™ä¼šè®©ç½‘ç«™ä»¥100%å®½åº¦æ¸²æŸ“ï¼Œç”¨æˆ·éœ€è¦æ‰‹åŠ¨ç§»åŠ¨é¡µé¢æˆ–è€…ç¼©æ”¾ã€‚å¦‚æœå’Œinitial-scale=1åŒæ—¶ä½¿ç”¨user-scalable=noæˆ–maximum-scale=1ï¼Œåˆ™ç”¨æˆ·å°†ä¸èƒ½æ”¾å¤§/ç¼©å°ç½‘é¡µæ¥çœ‹åˆ°å…¨éƒ¨çš„å†…å®¹ã€‚</em></p><ul><li><p><strong>WebAppå…¨å±æ¨¡å¼ï¼š</strong>ä¼ªè£…appï¼Œç¦»çº¿åº”ç”¨ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta name=<span class="string">"apple-mobile-web-app-capable"</span> content=<span class="string">"yes"</span> /&gt; <span class="xml"><span class="comment">&lt;!-- å¯ç”¨ WebApp å…¨å±æ¨¡å¼ --&gt;</span></span></span><br></pre></td></tr></table></figure></li><li><p><strong>éšè—çŠ¶æ€æ /è®¾ç½®çŠ¶æ€æ é¢œè‰²ï¼š</strong>åªæœ‰åœ¨å¼€å¯WebAppå…¨å±æ¨¡å¼æ—¶æ‰ç”Ÿæ•ˆã€‚contentçš„å€¼ä¸ºdefault | black | black-translucent ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta name=<span class="string">"apple-mobile-web-app-status-bar-style"</span> content=<span class="string">"black-translucent"</span> /&gt;</span><br></pre></td></tr></table></figure></li><li><p><strong>æ·»åŠ åˆ°ä¸»å±åçš„æ ‡é¢˜</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta name=<span class="string">"apple-mobile-web-app-title"</span> content=<span class="string">"æ ‡é¢˜"</span>&gt;</span><br></pre></td></tr></table></figure></li></ul><figure class="image-box">                <img src="/img/meta/articlex.jpg" alt="meta" title="" class="">                <p>meta</p>            </figure><p><strong>å¿½ç•¥æ•°å­—è‡ªåŠ¨è¯†åˆ«ä¸ºç”µè¯å·ç </strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta content=<span class="string">"telephone=no"</span> name=<span class="string">"format-detection"</span> /&gt;</span><br></pre></td></tr></table></figure></p><p><strong>å¿½ç•¥è¯†åˆ«é‚®ç®±</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta content=<span class="string">"email=no"</span> name=<span class="string">"format-detection"</span> /&gt;</span><br></pre></td></tr></table></figure></p><p><strong>æ·»åŠ æ™ºèƒ½ App å¹¿å‘Šæ¡ Smart App Bannerï¼š</strong>å‘Šè¯‰æµè§ˆå™¨è¿™ä¸ªç½‘ç«™å¯¹åº”çš„appï¼Œå¹¶åœ¨é¡µé¢ä¸Šæ˜¾ç¤ºä¸‹è½½banner(å¦‚ä¸‹å›¾)ã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta name=<span class="string">"apple-itunes-app"</span> content=<span class="string">"app-id=myAppStoreID, affiliate-data=myAffiliateData, app-argument=myURL"</span>&gt;</span><br></pre></td></tr></table></figure></p><figure class="image-box">                <img src="/img/meta/banner.jpg" alt="Alt text" title="" class="">                <p>Alt text</p>            </figure><p><strong>å…¶ä»–</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- é’ˆå¯¹æ‰‹æŒè®¾å¤‡ä¼˜åŒ–ï¼Œä¸»è¦æ˜¯é’ˆå¯¹ä¸€äº›è€çš„ä¸è¯†åˆ«viewportçš„æµè§ˆå™¨ï¼Œæ¯”å¦‚é»‘è“ --&gt;</span><br><span class="line">&lt;meta name=<span class="string">"HandheldFriendly"</span> content=<span class="string">"true"</span>&gt;</span><br><span class="line">&lt;!-- å¾®è½¯çš„è€å¼æµè§ˆå™¨ --&gt;</span><br><span class="line">&lt;meta name=<span class="string">"MobileOptimized"</span> content=<span class="string">"320"</span>&gt;</span><br><span class="line">&lt;!-- ucå¼ºåˆ¶ç«–å± --&gt;</span><br><span class="line">&lt;meta name=<span class="string">"screen-orientation"</span> content=<span class="string">"portrait"</span>&gt;</span><br><span class="line">&lt;!-- QQå¼ºåˆ¶ç«–å± --&gt;</span><br><span class="line">&lt;meta name=<span class="string">"x5-orientation"</span> content=<span class="string">"portrait"</span>&gt;</span><br><span class="line">&lt;!-- UCå¼ºåˆ¶å…¨å± --&gt;</span><br><span class="line">&lt;meta name=<span class="string">"full-screen"</span> content=<span class="string">"yes"</span>&gt;</span><br><span class="line">&lt;!-- QQå¼ºåˆ¶å…¨å± --&gt;</span><br><span class="line">&lt;meta name=<span class="string">"x5-fullscreen"</span> content=<span class="string">"true"</span>&gt;</span><br><span class="line">&lt;!-- UCåº”ç”¨æ¨¡å¼ --&gt;</span><br><span class="line">&lt;meta name=<span class="string">"browsermode"</span> content=<span class="string">"application"</span>&gt;</span><br><span class="line">&lt;!-- QQåº”ç”¨æ¨¡å¼ --&gt;</span><br><span class="line">&lt;meta name=<span class="string">"x5-page-mode"</span> content=<span class="string">"app"</span>&gt;</span><br><span class="line">&lt;!-- windows phone ç‚¹å‡»æ— é«˜å…‰ --&gt;</span><br><span class="line">&lt;meta name=<span class="string">"msapplication-tap-highlight"</span> content=<span class="string">"no"</span>&gt;</span><br></pre></td></tr></table></figure></p><h2 id="ç½‘é¡µç›¸å…³"><a href="#ç½‘é¡µç›¸å…³" class="headerlink" title="ç½‘é¡µç›¸å…³"></a>ç½‘é¡µç›¸å…³</h2><p><strong>ç”³æ˜ç¼–ç </strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta charset=<span class="string">'utf-8'</span> /&gt;</span><br></pre></td></tr></table></figure></p><p><strong>ä¼˜å…ˆä½¿ç”¨ IE æœ€æ–°ç‰ˆæœ¬å’Œ Chrome</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta http-equiv=<span class="string">"X-UA-Compatible"</span> content=<span class="string">"IE=edge,chrome=1"</span> /&gt;</span><br><span class="line">&lt;!-- å…³äºX-UA-Compatible --&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">"X-UA-Compatible"</span> content=<span class="string">"IE=6"</span> &gt;<span class="xml"><span class="comment">&lt;!-- ä½¿ç”¨IE6 --&gt;</span></span></span><br><span class="line">&lt;meta http-equiv="X-UA-Compatible" content="IE=7" &gt;&lt;!-- ä½¿ç”¨IE7 --&gt;</span><br><span class="line">&lt;meta http-equiv="X-UA-Compatible" content="IE=8" &gt;&lt;!-- ä½¿ç”¨IE8 --&gt;</span><br></pre></td></tr></table></figure></p><p><strong>æµè§ˆå™¨å†…æ ¸æ§åˆ¶ï¼š</strong> å›½å†…æµè§ˆå™¨å¾ˆå¤šéƒ½æ˜¯åŒå†…æ ¸ï¼ˆwebkitå’ŒTridentï¼‰ï¼Œwebkitå†…æ ¸é«˜é€Ÿæµè§ˆï¼ŒIEå†…æ ¸å…¼å®¹ç½‘é¡µå’Œæ—§ç‰ˆç½‘ç«™ã€‚è€Œæ·»åŠ metaæ ‡ç­¾çš„ç½‘ç«™å¯ä»¥æ§åˆ¶æµè§ˆå™¨é€‰æ‹©ä½•ç§å†…æ ¸æ¸²æŸ“ã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta name=<span class="string">"renderer"</span> content=<span class="string">"webkit|ie-comp|ie-stand"</span>&gt;</span><br></pre></td></tr></table></figure></p><blockquote><p>å›½å†…åŒæ ¸æµè§ˆå™¨é»˜è®¤å†…æ ¸æ¨¡å¼å¦‚ä¸‹ï¼š</p><ol><li>æœç‹—é«˜é€Ÿæµè§ˆå™¨ã€QQæµè§ˆå™¨ï¼šIEå†…æ ¸ï¼ˆå…¼å®¹æ¨¡å¼ï¼‰</li><li>360æé€Ÿæµè§ˆå™¨ã€é¨æ¸¸æµè§ˆå™¨ï¼šWebkitå†…æ ¸ï¼ˆæé€Ÿæ¨¡å¼ï¼‰</li></ol></blockquote><p><strong>ç¦æ­¢æµè§ˆå™¨ä»æœ¬åœ°è®¡ç®—æœºçš„ç¼“å­˜ä¸­è®¿é—®é¡µé¢å†…å®¹ï¼š</strong>è¿™æ ·è®¾å®šï¼Œè®¿é—®è€…å°†æ— æ³•è„±æœºæµè§ˆã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta http-equiv=<span class="string">"Pragma"</span> content=<span class="string">"no-cache"</span>&gt;</span><br></pre></td></tr></table></figure></p><p><strong>Windows 8</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta name=<span class="string">"msapplication-TileColor"</span> content=<span class="string">"#000"</span>/&gt; <span class="xml"><span class="comment">&lt;!-- Windows 8 ç£è´´é¢œè‰² --&gt;</span></span></span><br><span class="line">&lt;meta name="msapplication-TileImage" content="icon.png"/&gt; &lt;!-- Windows 8 ç£è´´å›¾æ ‡ --&gt;</span><br></pre></td></tr></table></figure></p><p><strong>ç«™ç‚¹é€‚é…ï¼š</strong>ä¸»è¦ç”¨äºPC-æ‰‹æœºé¡µçš„å¯¹åº”å…³ç³»ã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta name=<span class="string">"mobile-agent"</span>content=<span class="string">"format=[wml|xhtml|html5]; url=url"</span>&gt;</span><br><span class="line">&lt;!--</span><br><span class="line">[wml|xhtml|html5]æ ¹æ®æ‰‹æœºé¡µçš„åè®®è¯­è¨€ï¼Œé€‰æ‹©å…¶ä¸­ä¸€ç§ï¼›</span><br><span class="line">url=<span class="string">"url"</span> åè€…ä»£è¡¨å½“å‰PCé¡µæ‰€å¯¹åº”çš„æ‰‹æœºé¡µURLï¼Œä¸¤è€…å¿…é¡»æ˜¯ä¸€ä¸€å¯¹åº”å…³ç³»ã€‚</span><br><span class="line"> --&gt;</span><br></pre></td></tr></table></figure></p><p><strong>è½¬ç ç”³æ˜ï¼š</strong>ç”¨ç™¾åº¦æ‰“å¼€ç½‘é¡µå¯èƒ½ä¼šå¯¹å…¶è¿›è¡Œè½¬ç ï¼ˆæ¯”å¦‚è´´å¹¿å‘Šï¼‰ï¼Œé¿å…è½¬ç å¯æ·»åŠ å¦‚ä¸‹meta<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta http-equiv=<span class="string">"Cache-Control"</span> content=<span class="string">"no-siteapp"</span> /&gt;</span><br></pre></td></tr></table></figure></p><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™:"></a>å‚è€ƒèµ„æ–™:</h1><ul><li><a href="http://www.zhangxinxu.com/wordpress/2015/03/meta-http-equiv-refresh-content/" target="_blank" rel="noopener">http://www.zhangxinxu.com/wordpress/2015/03/meta-http-equiv-refresh-content/</a></li><li><a href="http://segmentfault.com/blog/ciaocc/1190000002407912" target="_blank" rel="noopener">http://segmentfault.com/blog/ciaocc/1190000002407912</a></li></ul><hr><blockquote><h3 id="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢"><a href="#æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢" class="headerlink" title="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~"></a>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</h3><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> html5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>node-webkit æ’­æ”¾video/audioçš„mp3,mp4</title>
      <link href="/2015/03/15/node-webkit-%E6%92%AD%E6%94%BEvideo-audio%E7%9A%84mp3-mp4/"/>
      <url>/2015/03/15/node-webkit-%E6%92%AD%E6%94%BEvideo-audio%E7%9A%84mp3-mp4/</url>
      
        <content type="html"><![CDATA[<h1 id="node-webkit-æ’­æ”¾video-audioçš„mp3-mp4"><a href="#node-webkit-æ’­æ”¾video-audioçš„mp3-mp4" class="headerlink" title="node-webkit æ’­æ”¾video/audioçš„mp3,mp4"></a>node-webkit æ’­æ”¾video/audioçš„mp3,mp4</h1><blockquote><p>æ›¿æ¢node-webkitçš„è§£ç å™¨<br>ä½¿ç”¨chromeåŸç‰ˆçš„æ›¿æ¢<br>linuxä¸Šæ˜¯ libffmpegsumo.so,Windowsæ˜¯ ffmpegsumo.dll</p></blockquote><a id="more"></a><p><strong>node-webkitä½¿ç”¨çš„chromeç‰ˆæœ¬è¦å’Œæ›¿æ¢çš„chromeç‰ˆæœ¬ä¸€æ ·!!</strong></p><blockquote><p> <a href="https://raw.githubusercontent.com/xinshangshangxin/hexo-blog/gh-pages/other/node-webkit/ffmpegsumo.dll" target="_blank" rel="noopener">ä¸‹è½½windowsç‰ˆ <code>Chromium 41.0.2272.76</code> çš„ <code>ffmpegsumo.dll</code></a></p></blockquote><h2 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„:"></a>æ³¨æ„:</h2><p><strong>chromeçš„è§£ç å™¨æ˜¯ä»˜è´¹çš„;so~~</strong></p><blockquote><p>æœ¬åœ°éŸ³ä¹çš„è¯æŠŠ.mp3/.mp4è½¬æˆ.ogg</p></blockquote><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™:"></a>å‚è€ƒèµ„æ–™:</h1><p><a href="http://kevinchen.synology.me/TechnicalDocuments/node-webkit/use_audio_video.html" target="_blank" rel="noopener">http://kevinchen.synology.me/TechnicalDocuments/node-webkit/use_audio_video.html</a></p><hr><blockquote><h3 id="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢"><a href="#æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢" class="headerlink" title="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~"></a>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</h3><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> node-webkit </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>js/jq è·å– é«˜åº¦/å®½åº¦</title>
      <link href="/2015/03/14/js-jq-%E8%8E%B7%E5%8F%96-%E9%AB%98%E5%BA%A6-%E5%AE%BD%E5%BA%A6/"/>
      <url>/2015/03/14/js-jq-%E8%8E%B7%E5%8F%96-%E9%AB%98%E5%BA%A6-%E5%AE%BD%E5%BA%A6/</url>
      
        <content type="html"><![CDATA[<blockquote><p>åœ¨<a href="http://musicplayer.coding.io/" target="_blank" rel="noopener">musicplayer</a>ä¸­è¦åŠ¨æ€è°ƒæ•´é«˜åº¦,åœ¨ç½‘ä¸Šæ‰¾äº†äº›æ±‡æ€»ä¸‹<br><a id="more"></a></p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">$(<span class="built_in">window</span>).height(); <span class="comment">//æµè§ˆå™¨å½“å‰çª—å£å¯è§†åŒºåŸŸé«˜åº¦ </span></span><br><span class="line">$(<span class="built_in">document</span>).height(); <span class="comment">//æµè§ˆå™¨å½“å‰çª—å£æ–‡æ¡£çš„é«˜åº¦ </span></span><br><span class="line">$(<span class="built_in">document</span>.body).height();<span class="comment">//æµè§ˆå™¨å½“å‰çª—å£æ–‡æ¡£bodyçš„é«˜åº¦ </span></span><br><span class="line">$(<span class="built_in">document</span>.body).outerHeight(<span class="literal">true</span>);<span class="comment">//æµè§ˆå™¨å½“å‰çª—å£æ–‡æ¡£bodyçš„æ€»é«˜åº¦ åŒ…æ‹¬border padding margin </span></span><br><span class="line">$(<span class="built_in">window</span>).width(); <span class="comment">//æµè§ˆå™¨å½“å‰çª—å£å¯è§†åŒºåŸŸå®½åº¦ </span></span><br><span class="line">$(<span class="built_in">document</span>).width();<span class="comment">//æµè§ˆå™¨å½“å‰çª—å£æ–‡æ¡£å¯¹è±¡å®½åº¦ </span></span><br><span class="line">$(<span class="built_in">document</span>.body).width();<span class="comment">//æµè§ˆå™¨å½“å‰çª—å£æ–‡æ¡£bodyçš„é«˜åº¦ </span></span><br><span class="line">$(<span class="built_in">document</span>.body).outerWidth(<span class="literal">true</span>);<span class="comment">//æµè§ˆå™¨å½“å‰çª—å£æ–‡æ¡£bodyçš„æ€»å®½åº¦ åŒ…æ‹¬border padding margin </span></span><br><span class="line">$(<span class="built_in">document</span>).scrollTop();<span class="comment">//ç½‘é¡µè¢«å·å»çš„é«˜</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.body.clientWidth; <span class="comment">//ç½‘é¡µå¯è§åŒºåŸŸå®½</span></span><br><span class="line"><span class="built_in">document</span>.body.clientHeight; <span class="comment">//ç½‘é¡µå¯è§åŒºåŸŸé«˜</span></span><br><span class="line"><span class="built_in">document</span>.body.offsetWidth; <span class="comment">//ç½‘é¡µå¯è§åŒºåŸŸå®½(åŒ…æ‹¬è¾¹çº¿å’Œæ»šåŠ¨æ¡çš„å®½)</span></span><br><span class="line"><span class="built_in">document</span>.body.offsetHeight;<span class="comment">//ç½‘é¡µå¯è§åŒºåŸŸé«˜ (åŒ…æ‹¬è¾¹çº¿çš„å®½)";</span></span><br><span class="line"><span class="built_in">document</span>.body.scrollWidth;<span class="comment">//ç½‘é¡µæ­£æ–‡å…¨æ–‡å®½</span></span><br><span class="line"><span class="built_in">document</span>.body.scrollHeight;<span class="comment">//ç½‘é¡µæ­£æ–‡å…¨æ–‡é«˜</span></span><br><span class="line"><span class="built_in">document</span>.body.scrollTop;<span class="comment">//ç½‘é¡µè¢«å·å»çš„é«˜(ff)</span></span><br><span class="line"><span class="built_in">document</span>.documentElement.scrollTop;<span class="comment">//ç½‘é¡µè¢«å·å»çš„é«˜(ie)</span></span><br><span class="line"><span class="built_in">document</span>.body.scrollLeft;<span class="comment">//ç½‘é¡µè¢«å·å»çš„å·¦</span></span><br><span class="line"><span class="built_in">window</span>.screen.height;<span class="comment">//å±å¹•åˆ†è¾¨ç‡çš„é«˜</span></span><br><span class="line"><span class="built_in">window</span>.screen.width;<span class="comment">//å±å¹•åˆ†è¾¨ç‡çš„å®½</span></span><br><span class="line"><span class="built_in">window</span>.screen.availHeight;<span class="comment">//å±å¹•å¯ç”¨å·¥ä½œåŒºé«˜åº¦</span></span><br><span class="line"><span class="built_in">window</span>.screen.availWidth;<span class="comment">//å±å¹•å¯ç”¨å·¥ä½œåŒºå®½åº¦</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åœ¨IEä¸­ï¼š</span></span><br><span class="line"><span class="built_in">document</span>.body.clientWidth ==&gt; BODYå¯¹è±¡å®½åº¦</span><br><span class="line"><span class="built_in">document</span>.body.clientHeight ==&gt; BODYå¯¹è±¡é«˜åº¦</span><br><span class="line"><span class="built_in">document</span>.documentElement.clientWidth ==&gt; å¯è§åŒºåŸŸå®½åº¦</span><br><span class="line"><span class="built_in">document</span>.documentElement.clientHeight ==&gt; å¯è§åŒºåŸŸé«˜åº¦</span><br><span class="line"><span class="comment">//åœ¨FireFoxä¸­ï¼š</span></span><br><span class="line"><span class="built_in">document</span>.body.clientWidth ==&gt; BODYå¯¹è±¡å®½åº¦</span><br><span class="line"><span class="built_in">document</span>.body.clientHeight ==&gt; BODYå¯¹è±¡é«˜åº¦</span><br><span class="line"><span class="built_in">document</span>.documentElement.clientWidth ==&gt; å¯è§åŒºåŸŸå®½åº¦</span><br><span class="line"><span class="built_in">document</span>.documentElement.clientHeight ==&gt; å¯è§åŒºåŸŸé«˜åº¦</span><br><span class="line"><span class="comment">//åœ¨Operaä¸­ï¼š </span></span><br><span class="line"><span class="built_in">document</span>.body.clientWidth ==&gt; å¯è§åŒºåŸŸå®½åº¦</span><br><span class="line"><span class="built_in">document</span>.body.clientHeight ==&gt; å¯è§åŒºåŸŸé«˜åº¦</span><br><span class="line"><span class="built_in">document</span>.documentElement.clientWidth ==&gt; é¡µé¢å¯¹è±¡å®½åº¦ï¼ˆå³BODYå¯¹è±¡å®½åº¦åŠ ä¸ŠMarginå®½ï¼‰</span><br><span class="line"><span class="built_in">document</span>.documentElement.clientHeight ==&gt; é¡µé¢å¯¹è±¡é«˜åº¦ï¼ˆå³BODYå¯¹è±¡é«˜åº¦åŠ ä¸ŠMarginé«˜ï¼‰</span><br><span class="line">è€Œå¦‚æœæ²¡æœ‰å®šä¹‰W3Cçš„æ ‡å‡†ï¼Œåˆ™</span><br><span class="line"><span class="comment">//IEä¸ºï¼š</span></span><br><span class="line"><span class="built_in">document</span>.documentElement.clientWidth ==&gt; <span class="number">0</span></span><br><span class="line"><span class="built_in">document</span>.documentElement.clientHeight ==&gt; <span class="number">0</span></span><br><span class="line"><span class="comment">//FireFoxä¸ºï¼š</span></span><br><span class="line"><span class="built_in">document</span>.documentElement.clientWidth ==&gt; é¡µé¢å¯¹è±¡å®½åº¦ï¼ˆå³BODYå¯¹è±¡å®½åº¦åŠ ä¸ŠMarginå®½ï¼‰</span><br><span class="line"><span class="built_in">document</span>.documentElement.clientHeight ==&gt; é¡µé¢å¯¹è±¡é«˜åº¦ï¼ˆå³BODYå¯¹è±¡é«˜åº¦åŠ ä¸ŠMarginé«˜ï¼‰</span><br><span class="line"><span class="comment">//Operaä¸ºï¼š</span></span><br><span class="line"><span class="built_in">document</span>.documentElement.clientWidth ==&gt; é¡µé¢å¯¹è±¡å®½åº¦ï¼ˆå³BODYå¯¹è±¡å®½åº¦åŠ ä¸ŠMarginå®½ï¼‰</span><br><span class="line"><span class="built_in">document</span>.documentElement.clientHeight ==&gt; é¡µé¢å¯¹è±¡é«˜åº¦ï¼ˆå³BODYå¯¹è±¡é«˜åº¦åŠ ä¸ŠMarginé«˜ï¼‰</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è·å–é¡µé¢çš„é«˜åº¦ã€å®½åº¦</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getPageSize</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> xScroll, yScroll;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">window</span>.innerHeight &amp;&amp; <span class="built_in">window</span>.scrollMaxY) &#123;</span><br><span class="line">        xScroll = <span class="built_in">window</span>.innerWidth + <span class="built_in">window</span>.scrollMaxX;</span><br><span class="line">        yScroll = <span class="built_in">window</span>.innerHeight + <span class="built_in">window</span>.scrollMaxY;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">document</span>.body.scrollHeight &gt; <span class="built_in">document</span>.body.offsetHeight) &#123; <span class="comment">// all but Explorer Mac    </span></span><br><span class="line">            xScroll = <span class="built_in">document</span>.body.scrollWidth;</span><br><span class="line">            yScroll = <span class="built_in">document</span>.body.scrollHeight;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; <span class="comment">// Explorer Mac...would also work in Explorer 6 Strict, Mozilla and Safari    </span></span><br><span class="line">            xScroll = <span class="built_in">document</span>.body.offsetWidth;</span><br><span class="line">            yScroll = <span class="built_in">document</span>.body.offsetHeight;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> windowWidth, windowHeight;</span><br><span class="line">    <span class="keyword">if</span> (self.innerHeight) &#123; <span class="comment">// all except Explorer    </span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">document</span>.documentElement.clientWidth) &#123;</span><br><span class="line">            windowWidth = <span class="built_in">document</span>.documentElement.clientWidth;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            windowWidth = self.innerWidth;</span><br><span class="line">        &#125;</span><br><span class="line">        windowHeight = self.innerHeight;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">document</span>.documentElement &amp;&amp; <span class="built_in">document</span>.documentElement.clientHeight) &#123; <span class="comment">// Explorer 6 Strict Mode    </span></span><br><span class="line">            windowWidth = <span class="built_in">document</span>.documentElement.clientWidth;</span><br><span class="line">            windowHeight = <span class="built_in">document</span>.documentElement.clientHeight;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">document</span>.body) &#123; <span class="comment">// other Explorers    </span></span><br><span class="line">                windowWidth = <span class="built_in">document</span>.body.clientWidth;</span><br><span class="line">                windowHeight = <span class="built_in">document</span>.body.clientHeight;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;       </span><br><span class="line">    <span class="comment">// for small pages with total height less then height of the viewport    </span></span><br><span class="line">    <span class="keyword">if</span> (yScroll &lt; windowHeight) &#123;</span><br><span class="line">        pageHeight = windowHeight;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        pageHeight = yScroll;</span><br><span class="line">    &#125;    </span><br><span class="line">    <span class="comment">// for small pages with total width less then width of the viewport    </span></span><br><span class="line">    <span class="keyword">if</span> (xScroll &lt; windowWidth) &#123;</span><br><span class="line">        pageWidth = xScroll;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        pageWidth = windowWidth;</span><br><span class="line">    &#125;</span><br><span class="line">    arrayPageSize = <span class="keyword">new</span> <span class="built_in">Array</span>(pageWidth, pageHeight, windowWidth, windowHeight);</span><br><span class="line">    <span class="keyword">return</span> arrayPageSize;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™:"></a>å‚è€ƒèµ„æ–™:</h1><p><a href="http://www.cnblogs.com/henllyee/archive/2008/04/20/1162517.html" target="_blank" rel="noopener">http://www.cnblogs.com/henllyee/archive/2008/04/20/1162517.html</a><br><a href="http://www.cnblogs.com/hoojo/archive/2012/02/16/2354663.html" target="_blank" rel="noopener">http://www.cnblogs.com/hoojo/archive/2012/02/16/2354663.html</a></p><hr><blockquote><h3 id="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢"><a href="#æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢" class="headerlink" title="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~"></a>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</h3><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>fiddlerå­¦ä¹ ç¬”è®°</title>
      <link href="/2015/03/11/fiddler%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
      <url>/2015/03/11/fiddler%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<p>æ…•è¯¾ç½‘fiddlerå­¦ä¹ ä»¥åŠéƒ¨åˆ†è¡¥å……è¯´æ˜<br><a id="more"></a></p><h1 id="fiddlerè§†é¢‘æ•™ç¨‹"><a href="#fiddlerè§†é¢‘æ•™ç¨‹" class="headerlink" title="fiddlerè§†é¢‘æ•™ç¨‹"></a>fiddlerè§†é¢‘æ•™ç¨‹</h1><blockquote><p><a href="http://www.imooc.com/learn/37" target="_blank" rel="noopener">æ…•è¯¾ç½‘fiddlerè§†é¢‘æ•™ç¨‹</a></p></blockquote><h1 id="æ·»åŠ ServerIP"><a href="#æ·»åŠ ServerIP" class="headerlink" title="æ·»åŠ ServerIP"></a>æ·»åŠ ServerIP</h1><blockquote><p>å¿«æ·é”®Ctrl+R  æˆ–è€…  èœå•-&gt;Rules-&gt;Customize Rulesâ€¦</p></blockquote><p>åœ¨<code>CustomRules.js</code>æ–‡ä»¶é‡Œ<code>Ctrl+F</code>æŸ¥æ‰¾å­—ç¬¦ä¸²<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">Main</span>(<span class="params"></span>)</span></span><br></pre></td></tr></table></figure></p><blockquote><p>æ·»åŠ ä¸€è¡Œä»£ç å³å¯æ˜¾ç¤ºIP</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FiddlerObject.UI.lvSessions.AddBoundColumn(<span class="string">"ServerIP"</span>, <span class="number">120</span>, <span class="string">"X-HostIP"</span>);</span><br></pre></td></tr></table></figure><p>ç»“æœå¦‚ä¸‹æ‰€ç¤º:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">Main</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> today: <span class="built_in">Date</span> = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">        </span><br><span class="line">        FiddlerObject.StatusText = <span class="string">" CustomRules.js was loaded at: "</span> + today;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ·»åŠ æ˜¾ç¤º ServerIP</span></span><br><span class="line">        FiddlerObject.UI.lvSessions.AddBoundColumn(<span class="string">"ServerIP"</span>, <span class="number">120</span>, <span class="string">"X-HostIP"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Uncomment to add a "Server" column containing the response "Server" header, if present</span></span><br><span class="line">        <span class="comment">// UI.lvSessions.AddBoundColumn("Server", 50, "@response.server");</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// Uncomment to add a global hotkey (Win+G) that invokes the ExecAction method below...</span></span><br><span class="line">        <span class="comment">// UI.RegisterCustomHotkey(HotkeyModifiers.Windows, Keys.G, "screenshot"); </span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><h1 id="å›¾æ ‡ä»£è¡¨å«ä¹‰"><a href="#å›¾æ ‡ä»£è¡¨å«ä¹‰" class="headerlink" title="å›¾æ ‡ä»£è¡¨å«ä¹‰"></a>å›¾æ ‡ä»£è¡¨å«ä¹‰</h1><figure class="image-box">                <img src="/img/fiddler/meaning.png" alt="" title="" class="">                <p></p>            </figure><h1 id="ä½¿ç”¨Fiddlerè°ƒè¯•æ‰‹æœºé¡µé¢è¯·æ±‚"><a href="#ä½¿ç”¨Fiddlerè°ƒè¯•æ‰‹æœºé¡µé¢è¯·æ±‚" class="headerlink" title="ä½¿ç”¨Fiddlerè°ƒè¯•æ‰‹æœºé¡µé¢è¯·æ±‚"></a>ä½¿ç”¨Fiddlerè°ƒè¯•æ‰‹æœºé¡µé¢è¯·æ±‚</h1><p><a href="http://i.wanz.im/2013/04/30/debugging_http_request_with_fiddler/" target="_blank" rel="noopener">http://i.wanz.im/2013/04/30/debugging_http_request_with_fiddler/</a></p><h1 id="fiddler-ä¸æ”¯æŒè§†é¢‘æœ€åè®²çš„-Willow"><a href="#fiddler-ä¸æ”¯æŒè§†é¢‘æœ€åè®²çš„-Willow" class="headerlink" title="fiddler ä¸æ”¯æŒè§†é¢‘æœ€åè®²çš„ Willow"></a>fiddler ä¸æ”¯æŒè§†é¢‘æœ€åè®²çš„ Willow</h1><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™:"></a>å‚è€ƒèµ„æ–™:</h1><p><a href="http://www.xuanfengge.com/fiddler-displays-the-set-ip-method.html" target="_blank" rel="noopener">http://www.xuanfengge.com/fiddler-displays-the-set-ip-method.html</a><br><a href="http://tid.tenpay.com/?p=3011" target="_blank" rel="noopener">http://tid.tenpay.com/?p=3011</a></p><hr><blockquote><h3 id="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢"><a href="#æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢" class="headerlink" title="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~"></a>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</h3><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> fiddler </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>jså…³é—­æµè§ˆå™¨äº‹ä»¶</title>
      <link href="/2015/03/10/js%E5%85%B3%E9%97%AD%E6%B5%8F%E8%A7%88%E5%99%A8%E4%BA%8B%E4%BB%B6/"/>
      <url>/2015/03/10/js%E5%85%B3%E9%97%AD%E6%B5%8F%E8%A7%88%E5%99%A8%E4%BA%8B%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<p>jså…³é—­æµè§ˆå™¨äº‹ä»¶æ³¨æ„ç‚¹!<br><a id="more"></a></p><h1 id="jså…³é—­æµè§ˆå™¨äº‹ä»¶"><a href="#jså…³é—­æµè§ˆå™¨äº‹ä»¶" class="headerlink" title="jså…³é—­æµè§ˆå™¨äº‹ä»¶"></a>jså…³é—­æµè§ˆå™¨äº‹ä»¶</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.onbeforeunload = <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">  e = e || <span class="built_in">window</span>.event;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å…¼å®¹IE8å’ŒFirefox 4ä¹‹å‰çš„ç‰ˆæœ¬</span></span><br><span class="line">  <span class="keyword">if</span> (e) &#123;</span><br><span class="line">    e.returnValue = <span class="string">'å…³é—­æç¤º'</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Chrome, Safari, Firefox 4+, Opera 12+ , IE 9+</span></span><br><span class="line">  <span class="keyword">return</span> <span class="string">'å…³é—­æç¤º'</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="è‡ªå®šä¹‰çš„å…³é—­æç¤ºæ— æ³•å®Œæˆ"><a href="#è‡ªå®šä¹‰çš„å…³é—­æç¤ºæ— æ³•å®Œæˆ" class="headerlink" title="è‡ªå®šä¹‰çš„å…³é—­æç¤ºæ— æ³•å®Œæˆ!"></a>è‡ªå®šä¹‰çš„å…³é—­æç¤ºæ— æ³•å®Œæˆ!</h2><blockquote><p>ä»2011å¹´5æœˆ25æ—¥èµ·,  HTML5 è§„èŒƒ å£°æ˜:åœ¨è¯¥äº‹ä»¶çš„å¤„ç†å‡½æ•°ä¸­è°ƒç”¨ä¸‹åˆ—å¼¹çª—ç›¸å…³çš„æ–¹æ³•æ—¶,å¯ä»¥å¿½ç•¥ä¸æ‰§è¡Œ,window.showModalDialog(), window.alert(), window.confirm() window.prompt().</p></blockquote><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™:"></a>å‚è€ƒèµ„æ–™:</h2><ul><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Window/onbeforeunload" target="_blank" rel="noopener">https://developer.mozilla.org/zh-CN/docs/Web/API/Window/onbeforeunload</a></li></ul><blockquote><h3 id="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢"><a href="#æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢" class="headerlink" title="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~"></a>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</h3><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[è½¬]ECMAScriptå‡½æ•°çš„åŸå‹</title>
      <link href="/2015/03/08/-%E8%BD%AC-ECMAScript%E5%87%BD%E6%95%B0%E7%9A%84%E5%8E%9F%E5%9E%8B/"/>
      <url>/2015/03/08/-%E8%BD%AC-ECMAScript%E5%87%BD%E6%95%B0%E7%9A%84%E5%8E%9F%E5%9E%8B/</url>
      
        <content type="html"><![CDATA[<p>ECMAScriptå‡½æ•°çš„åŸå‹<br><a id="more"></a></p><h2 id="å‡½æ•°çš„åŸå‹åŸºæœ¬æ¦‚å¿µ"><a href="#å‡½æ•°çš„åŸå‹åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="å‡½æ•°çš„åŸå‹åŸºæœ¬æ¦‚å¿µ"></a>å‡½æ•°çš„åŸå‹åŸºæœ¬æ¦‚å¿µ</h2><ol><li>æ¯ä¸ªå‡½æ•°éƒ½æœ‰ä¸€ä¸ªåŸå‹ï¼ˆprototypeï¼‰å±æ€§ï¼›</li><li>åŸå‹å±æ€§æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘ä¸€ä¸ªå¯¹è±¡ï¼›</li><li>å¯¹è±¡çš„ç”¨é€”æ˜¯åŒ…å«å¯ä»¥ç”±ç‰¹å®šç±»å‹çš„æ‰€æœ‰å®ä¾‹å…±äº«çš„å±æ€§å’Œæ–¹æ³•ã€‚</li></ol><h2 id="ç†è§£å‡½æ•°åŸå‹å¯¹è±¡ï¼ˆprototypeï¼‰"><a href="#ç†è§£å‡½æ•°åŸå‹å¯¹è±¡ï¼ˆprototypeï¼‰" class="headerlink" title="ç†è§£å‡½æ•°åŸå‹å¯¹è±¡ï¼ˆprototypeï¼‰"></a>ç†è§£å‡½æ•°åŸå‹å¯¹è±¡ï¼ˆprototypeï¼‰</h2><ol><li><p>constructorå±æ€§ã€‚åˆ›å»ºå‡½æ•°åï¼Œè‡ªåŠ¨è·å–åˆ°æ­¤å±æ€§ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå‡½æ•°prototypeçš„constructoræŒ‡å‘å‡½æ•°æœ¬èº«ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line">Foo.prototype.constructor === Foo;  <span class="comment">//true</span></span><br></pre></td></tr></table></figure></li><li><p>prototypeä¸Šå…¶ä»–æ–¹æ³•ç»§æ‰¿è‡ªObjectï¼Œå¦‚toString()ã€valueOf(),hasOwnPrototype()ã€isPrototypeOf()ç­‰ç­‰ã€‚</p></li></ol><h2 id="æ„é€ å‡½æ•°ã€å‡½æ•°çš„åŸå‹å¯¹è±¡å’Œæ„é€ å‡½æ•°å®ä¾‹ä¹‹é—´çš„å…³ç³»"><a href="#æ„é€ å‡½æ•°ã€å‡½æ•°çš„åŸå‹å¯¹è±¡å’Œæ„é€ å‡½æ•°å®ä¾‹ä¹‹é—´çš„å…³ç³»" class="headerlink" title="æ„é€ å‡½æ•°ã€å‡½æ•°çš„åŸå‹å¯¹è±¡å’Œæ„é€ å‡½æ•°å®ä¾‹ä¹‹é—´çš„å…³ç³»"></a>æ„é€ å‡½æ•°ã€å‡½æ•°çš„åŸå‹å¯¹è±¡å’Œæ„é€ å‡½æ•°å®ä¾‹ä¹‹é—´çš„å…³ç³»</h2><p>å½“è°ƒç”¨æ„é€ å‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°å®ä¾‹åï¼Œè¯¥å®ä¾‹çš„å†…éƒ¨å°†åŒ…å«ä¸€ä¸ªæŒ‡é’ˆï¼ˆå†…éƒ¨å±æ€§ï¼‰ï¼ŒæŒ‡å‘æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ã€‚ECMA-262ç¬¬5ç‰ˆä¸­ç®¡è¿™ä¸ªæŒ‡é’ˆå«[[Prototype]]ã€‚<strong>è¿™ä¸ªè¿æ¥å­˜åœ¨äºå®ä¾‹ä¸æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ä¹‹é—´ï¼Œè€Œä¸æ˜¯å­˜åœ¨äºå®ä¾‹ä¸æ„é€ å‡½æ•°ä¹‹é—´ã€‚</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Person.prototype.name = <span class="string">"MirrorAvatar"</span>;</span><br><span class="line">Person.prototype.age = <span class="number">3</span>;</span><br><span class="line">Person.prototype.job = <span class="string">"coder"</span>;</span><br><span class="line">Person.prototype.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">alert(<span class="keyword">this</span>.name);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> person1 = <span class="keyword">new</span> Person();</span><br><span class="line">person1.sayName();  <span class="comment">//MirrorAvatar</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> person2 = <span class="keyword">new</span> Person();</span><br><span class="line">person2.sayName();  <span class="comment">//MirrorAvatar</span></span><br><span class="line"></span><br><span class="line">person1.sayName === person2.sayName;  <span class="comment">//true</span></span><br></pre></td></tr></table></figure><p>æ„é€ å‡½æ•°Personã€Personçš„åŸå‹å¯¹è±¡prototypeå’ŒPersonçš„ä¸¤ä¸ªå®ä¾‹person1&amp;&amp;person2å…³ç³»å›¾ï¼š</p><figure class="image-box">                <img src="/img/proyotype/person.png" alt="å…³ç³»å›¾" title="" class="">                <p>å…³ç³»å›¾</p>            </figure><p>æ–‡å­—æè¿°ï¼š</p><ol><li>Person.prototypeæŒ‡å‘äº†åŸå‹å¯¹è±¡ï¼›</li><li>Person.prototype.constructoræŒ‡å›äº†Personï¼›</li><li>åŸå‹å¯¹è±¡ä¸å…‰åªæœ‰ä¸€ä¸ªconstructorå±æ€§ï¼Œè¿˜æœ‰åæ¥æ·»åŠ ä¸Šæ¥çš„å±æ€§ï¼›</li><li>Personçš„ä¸¤ä¸ªå®ä¾‹person1å’Œperson2ä»…ä»…æŒ‡å‘äº†Person.prototype,å®ƒä»¬ä¸æ„é€ å‡½æ•°Personæ²¡æœ‰ç›´æ¥è”ç³»ï¼›</li><li>person1å’Œperson2ä¸åŒ…å«å±æ€§å’Œæ–¹æ³•ï¼Œä½†æ˜¯å¯ä»¥è®¿é—®åˆ°ã€‚</li></ol><h2 id="æ£€æµ‹æŸä¸ªå®ä¾‹æ˜¯å¦å’ŒæŸä¸ªåŸå‹å¯¹è±¡å­˜åœ¨å…³ç³»"><a href="#æ£€æµ‹æŸä¸ªå®ä¾‹æ˜¯å¦å’ŒæŸä¸ªåŸå‹å¯¹è±¡å­˜åœ¨å…³ç³»" class="headerlink" title="æ£€æµ‹æŸä¸ªå®ä¾‹æ˜¯å¦å’ŒæŸä¸ªåŸå‹å¯¹è±¡å­˜åœ¨å…³ç³»"></a>æ£€æµ‹æŸä¸ªå®ä¾‹æ˜¯å¦å’ŒæŸä¸ªåŸå‹å¯¹è±¡å­˜åœ¨å…³ç³»</h2><ol><li><p>isPrototypeOf</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ­¤æ–¹æ³•ç»§æ‰¿è‡ªObject</span></span><br><span class="line">Person.prototype.isPrototypeOf(person1);  <span class="comment">//true</span></span><br><span class="line">Person.prototype.isPrototypeOf(person2);  <span class="comment">//true</span></span><br></pre></td></tr></table></figure></li><li><p>ECMAScript5çš„Object.getPrototypeOf()</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">æ­¤æ–¹æ³•è¿”å›[[Prototype]]çš„å€¼,å³è¿”å›è¿™ä¸ªå¯¹è±¡çš„åŸå‹ã€‚</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.getPrototypeOf(person1) === Person.prototype;  <span class="comment">//true</span></span><br><span class="line"><span class="built_in">Object</span>.getPrototypeOf(person1).name;  <span class="comment">//"MirrorAvatar"</span></span><br></pre></td></tr></table></figure></li></ol><h2 id="å¤šä¸ªå¯¹è±¡å®ä¾‹å…±äº«åŸå‹æ‰€ä¿å­˜çš„å±æ€§å’Œæ–¹æ³•çš„åŸºæœ¬åŸç†"><a href="#å¤šä¸ªå¯¹è±¡å®ä¾‹å…±äº«åŸå‹æ‰€ä¿å­˜çš„å±æ€§å’Œæ–¹æ³•çš„åŸºæœ¬åŸç†" class="headerlink" title="å¤šä¸ªå¯¹è±¡å®ä¾‹å…±äº«åŸå‹æ‰€ä¿å­˜çš„å±æ€§å’Œæ–¹æ³•çš„åŸºæœ¬åŸç†"></a>å¤šä¸ªå¯¹è±¡å®ä¾‹å…±äº«åŸå‹æ‰€ä¿å­˜çš„å±æ€§å’Œæ–¹æ³•çš„åŸºæœ¬åŸç†</h2><p>æ¯å½“ä»£ç è¯»å–æŸä¸ªå¯¹è±¡çš„æŸä¸ªå±æ€§æ—¶ï¼Œéƒ½ä¼šæ‰§è¡Œä¸€æ¬¡æœç´¢ï¼Œç›®æ ‡æ˜¯å…·æœ‰ç»™å®šåå­—çš„å±æ€§ã€‚</p><p>è¿‡ç¨‹ï¼š</p><ol><li>æœç´¢å¯¹è±¡å®ä¾‹æœ¬èº«ã€‚æœ‰ï¼Œè¿”å›ï¼›æ— ï¼Œç»§ç»­ã€‚</li><li>æœç´¢æŒ‡é’ˆæŒ‡å‘çš„åŸå‹å¯¹è±¡ã€‚æœ‰ï¼Œè¿”å›ï¼›æ— ï¼Œè¿”å›undefinedã€‚</li></ol><p>æ³¨æ„ï¼š</p><p><strong>å¯¹è±¡å®ä¾‹è®¿é—®ä¿å­˜åœ¨åŸå‹ä¸­çš„å€¼ï¼Œä½†å´ä¸èƒ½é€šè¿‡å¯¹è±¡å®ä¾‹é‡å†™åŸå‹ä¸­çš„å€¼ã€‚</strong>å¦‚æœæˆ‘ä»¬åœ¨å®ä¾‹ä¸­æ·»åŠ äº†ä¸€ä¸ªå±æ€§ï¼Œè€Œè¯¥å±æ€§ä¸å®ä¾‹åŸå‹ä¸­çš„ä¸€ä¸ªå±æ€§åŒåï¼Œé‚£æˆ‘ä»¬å°±åœ¨å®ä¾‹ä¸­åˆ›å»ºè¯¥å±æ€§ï¼Œè¯¥å±æ€§å°†ä¼šå±è”½åŸå‹ä¸­çš„é‚£ä¸ªå±æ€§ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Person.prototype.name = <span class="string">"Cindy"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> person1 = <span class="keyword">new</span> Person();</span><br><span class="line"><span class="keyword">var</span> person2 = <span class="keyword">new</span> Person();</span><br><span class="line"></span><br><span class="line">person1.name = <span class="string">"MirrorAvatar"</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(person1.name);  <span class="comment">//"MirrorAvatar"ï¼Œå€¼æ¥ç€å®ä¾‹ï¼Œå±è”½åŸå‹çš„</span></span><br><span class="line"><span class="built_in">console</span>.log(person2.name);  <span class="comment">//"Cindy"ï¼Œå€¼æ¥è‡ªåŸå‹</span></span><br><span class="line">person1.hasOwnProperty(<span class="string">"name"</span>);  <span class="comment">//true</span></span><br><span class="line">person2.hasOwnProperty(<span class="string">"name"</span>);  <span class="comment">//false</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> person1.name;  <span class="comment">//å¯ä»¥åˆ é™¤å®ä¾‹çš„å±æ€§</span></span><br><span class="line"><span class="built_in">console</span>.log(person1.name);  <span class="comment">//"Cindy"ï¼Œå€¼æ¥è‡ªåŸå‹ï¼Œè¯´æ˜åªæ˜¯å±è”½æ²¡æœ‰è¢«é‡å†™</span></span><br><span class="line">person1.hasOwnProperty(<span class="string">"name"</span>);  <span class="comment">//false</span></span><br></pre></td></tr></table></figure><h1 id="è½¬è½½è‡ª-http-mirroravatar-iteye-com-blog-2190410"><a href="#è½¬è½½è‡ª-http-mirroravatar-iteye-com-blog-2190410" class="headerlink" title="è½¬è½½è‡ª: http://mirroravatar.iteye.com/blog/2190410"></a>è½¬è½½è‡ª: <a href="http://mirroravatar.iteye.com/blog/2190410" target="_blank" rel="noopener">http://mirroravatar.iteye.com/blog/2190410</a></h1><blockquote><h3 id="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢"><a href="#æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£-è°¢è°¢" class="headerlink" title="æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~"></a>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</h3><p><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a></p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>blurè¸©å‘</title>
      <link href="/2015/03/08/blur%E8%B8%A9%E5%9D%91/"/>
      <url>/2015/03/08/blur%E8%B8%A9%E5%9D%91/</url>
      
        <content type="html"><![CDATA[<p>ä¸€ç›´ä»¥ä¸ºblurå¯ä»¥ç›´æ¥è®¾ç½®åœ¨ä»»ä½•å…ƒç´ ä¸Š,ç„¶åæ‚²å‰§çš„å‘ç°å¹¶ä¸æ˜¯â€¦.<br><a id="more"></a></p><h1 id="divæ— æ³•ä½¿ç”¨bluråˆ¤æ–­å¤±å»ç„¦ç‚¹"><a href="#divæ— æ³•ä½¿ç”¨bluråˆ¤æ–­å¤±å»ç„¦ç‚¹" class="headerlink" title="divæ— æ³•ä½¿ç”¨bluråˆ¤æ–­å¤±å»ç„¦ç‚¹"></a>divæ— æ³•ä½¿ç”¨bluråˆ¤æ–­å¤±å»ç„¦ç‚¹</h1><blockquote><p>An element can have focus if the tabIndex property is set to any valid negative or positive integer.<br>Elements that receive focus can fire the onblur and onfocus events as of Internet Explorer 4.0, and the onkeydown, onkeypress, and onkeyup events as of Internet Explorer 5.</p></blockquote><blockquote><p>åªè¦å…ƒç´ çš„tabIndexå±æ€§è®¾ç½®æˆä»»ä½•æœ‰æ•ˆçš„æ•´æ•°é‚£ä¹ˆè¯¥å…ƒç´ å°±èƒ½å–å¾—ç„¦ç‚¹ã€‚å…ƒç´ åœ¨å–å¾—ç„¦ç‚¹åå°±èƒ½è§¦å‘onblurï¼Œonfocusï¼Œonkeydown, onkeypresså’Œonkeyupäº‹ä»¶ã€‚</p></blockquote><blockquote><p>ä¸åŒtabIndexå€¼åœ¨tab orderï¼ˆTabbing navigationï¼‰ä¸­çš„æƒ…å†µï¼š</p></blockquote><blockquote><p>Objects with a positive tabIndex are selected in increasing iIndex order and in source order to resolve duplicates.<br>Objects with an tabIndex of zero are selected in source order.<br>Objects with a negative tabIndex are omitted from the tabbing order.</p></blockquote><blockquote><p>tabIndexå€¼æ˜¯æ­£æ•°çš„å¯¹è±¡æ ¹æ®é€’å¢çš„å€¼é¡ºåºå’Œä»£ç ä¸­çš„ä½ç½®é¡ºåºæ¥è¢«é€‰æ‹©<br>tabIndexå€¼æ˜¯0çš„å¯¹è±¡æ ¹æ®åœ¨ä»£ç ä¸­çš„ä½ç½®é¡ºåºè¢«é€‰æ‹©<br>tabIndexå€¼æ˜¯è´Ÿæ•°çš„å¯¹è±¡ä¼šè¢«å¿½ç•¥</p></blockquote><h2 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h2><p><a href="http://www.cnblogs.com/cloudgamer/archive/2008/12/24/Slider.html" target="_blank" rel="noopener">Slider æ»‘åŠ¨æ¡æ•ˆæœ</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é˜¿é‡Œäº‘ECSä¸Šnpm install å¤±è´¥</title>
      <link href="/2015/03/04/%E9%98%BF%E9%87%8C%E4%BA%91ECS%E4%B8%8Anpm-install-%E5%A4%B1%E8%B4%A5/"/>
      <url>/2015/03/04/%E9%98%BF%E9%87%8C%E4%BA%91ECS%E4%B8%8Anpm-install-%E5%A4%B1%E8%B4%A5/</url>
      
        <content type="html"><![CDATA[<blockquote><p>æ˜¨å¤©æ²¡é—®é¢˜,ä»Šå¤©é‡è£…ç³»ç»Ÿåå°±å‡ºç°é—®é¢˜äº†</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">error <span class="built_in">Error</span>: CERT_UNTRUSTED</span><br><span class="line">error     at SecurePair.&lt;anonymous&gt; (tls.js:<span class="number">1370</span>:<span class="number">32</span>)</span><br><span class="line">error     at SecurePair.EventEmitter.emit (events.js:<span class="number">92</span>:<span class="number">17</span>)</span><br><span class="line">error     at SecurePair.maybeInitFinished (tls.js:<span class="number">982</span>:<span class="number">10</span>)</span><br><span class="line">error     at CleartextStream.read [<span class="keyword">as</span> _read] (tls.js:<span class="number">469</span>:<span class="number">13</span>)</span><br><span class="line">error     at CleartextStream.Readable.read (_stream_readable.js:<span class="number">320</span>:<span class="number">10</span>)</span><br><span class="line">error     at EncryptedStream.write [<span class="keyword">as</span> _write] (tls.js:<span class="number">366</span>:<span class="number">25</span>)</span><br><span class="line">error     at doWrite (_stream_writable.js:<span class="number">221</span>:<span class="number">10</span>)</span><br><span class="line">error     at writeOrBuffer (_stream_writable.js:<span class="number">211</span>:<span class="number">5</span>)</span><br><span class="line">error     at EncryptedStream.Writable.write (_stream_writable.js:<span class="number">180</span>:<span class="number">11</span>)</span><br><span class="line">error     at write (_stream_readable.js:<span class="number">583</span>:<span class="number">24</span>)</span><br><span class="line">error If you need help, you may report <span class="keyword">this</span> *entire* log,</span><br></pre></td></tr></table></figure><blockquote><p>è°·æ­Œå¾—çŸ¥æ˜¯ssl çš„é—®é¢˜,<br>æ‰€ä»¥è§£å†³åŠæ³•:</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm config set strict-ssl <span class="literal">false</span></span><br></pre></td></tr></table></figure><blockquote><p>æˆåŠŸ~~~</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> npm </tag>
            
            <tag> ECS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é˜¿é‡Œäº‘ECSä¸Šnodeå¤–ç½‘è®¿é—®</title>
      <link href="/2015/03/03/%E9%98%BF%E9%87%8C%E4%BA%91ECS%E4%B8%8Anode%E5%A4%96%E7%BD%91%E8%AE%BF%E9%97%AE/"/>
      <url>/2015/03/03/%E9%98%BF%E9%87%8C%E4%BA%91ECS%E4%B8%8Anode%E5%A4%96%E7%BD%91%E8%AE%BF%E9%97%AE/</url>
      
        <content type="html"><![CDATA[<p>å€Ÿäº†ä¸ªé˜¿é‡Œäº‘çš„è´¦å·,å¤–ç½‘è®¿é—®nodejsé‡åˆ°é—®é¢˜,åšä¸‹è®°å½•â€¦<br><a id="more"></a></p><blockquote><p>åŸæ¥æ˜¯è¿™ä¹ˆå†™çš„: </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http.createServer(<span class="function"><span class="keyword">function</span>(<span class="params">req,res</span>)</span>&#123;</span><br><span class="line">    res.writeHead(<span class="number">200</span>,&#123;<span class="string">'Content-Type'</span>:<span class="string">'text/plain'</span>&#125;);</span><br><span class="line">    res.end(<span class="string">'Hello Aliyun Node.js\n'</span>);</span><br><span class="line">&#125;).listen(<span class="number">80</span>,<span class="string">"127.0.0.1"</span>);</span><br></pre></td></tr></table></figure><blockquote><p>æç¤ºå‡ºé”™,åŸå› æ˜¯80ç«¯å£è¢«å ç”¨,å¯ä»¥ä½¿ç”¨8888ç­‰ç«¯å£</p></blockquote><blockquote><p>ä½¿ç”¨<code>ECSå¤–ç½‘IP:8888</code> è®¿é—®å‘ç°æ— æ³•æ‰“å¼€<br><a href="http://www.aboutit.cn/post/598" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a>æ˜¯è¿™ä¹ˆåšçš„:</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ã€€createServer(...).listen(<span class="number">8888</span>,<span class="string">"é˜¿é‡Œäº‘ECSå¤–ç½‘IP"</span>);</span><br></pre></td></tr></table></figure><blockquote><p>ä½†æ˜¯åœ¨æˆ‘è¿™é‡Œå¤±è´¥äº†;<br>æ¥ç€<a href="http://www.haodaima.net/art/2657330" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a>è¯´: <code>å¯åŠ¨NodeJsçš„ä¾¦å¬è¿›ç¨‹æ—¶ï¼Œéœ€è¦ä¾¦å¬æ‰€æœ‰IPï¼ˆ0.0.0.0ï¼‰</code></p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">createServer(...).listen(<span class="number">8888</span>,<span class="string">"0.0.0.0"</span>);</span><br></pre></td></tr></table></figure><blockquote><p>æˆåŠŸäº†~~~</p></blockquote><blockquote><p>å®Œæ•´æµ‹è¯•ä¾‹å­</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</span><br><span class="line"></span><br><span class="line">http.createServer(<span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">  res.writeHead(<span class="number">200</span>, &#123;</span><br><span class="line">      <span class="string">'Content-Type'</span>: <span class="string">'text/plain'</span></span><br><span class="line">    &#125;</span><br><span class="line">  );</span><br><span class="line">  res.end(<span class="string">'Hello Aliyun Node.js\n'</span>);</span><br><span class="line">&#125;).listen(<span class="number">8888</span>, <span class="string">"0.0.0.0"</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'NodeJS Server running at http://0.0.0.0:8888'</span>);</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><ol><li><a href="http://www.aboutit.cn/post/598" target="_blank" rel="noopener">http://www.aboutit.cn/post/598</a></li><li><a href="http://www.haodaima.net/art/2657330" target="_blank" rel="noopener">http://www.haodaima.net/art/2657330</a></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> node </tag>
            
            <tag> ECS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é˜¿é‡Œäº‘ECSå®‰è£…node</title>
      <link href="/2015/03/03/%E9%98%BF%E9%87%8C%E4%BA%91ECS%E5%AE%89%E8%A3%85node/"/>
      <url>/2015/03/03/%E9%98%BF%E9%87%8C%E4%BA%91ECS%E5%AE%89%E8%A3%85node/</url>
      
        <content type="html"><![CDATA[<p>å€Ÿäº†ä¸ªé˜¿é‡Œäº‘çš„è´¦å·å°è¯•å®‰è£…nodejs,å…¶å®å’Œlinuxä¸€æ ·â€¦.<br><a id="more"></a></p><h1 id="å®‰è£…è¿‡ç¨‹"><a href="#å®‰è£…è¿‡ç¨‹" class="headerlink" title="å®‰è£…è¿‡ç¨‹"></a>å®‰è£…è¿‡ç¨‹</h1><ul><li>ç¡®è®¤æœåŠ¡å™¨æœ‰nodejsç¼–è¯‘åŠä¾èµ–ç›¸å…³è½¯ä»¶ <em>æ²¡æœ‰è¿è¡Œä¸‹é¢å‘½ä»¤å®‰è£…</em></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install gcc gcc-c++ openssl-devel</span><br></pre></td></tr></table></figure><ul><li><p>ä¸‹è½½Node</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http:<span class="comment">//nodejs.org/dist/v0.10.24/node-v0.10.24.tar.gz</span></span><br></pre></td></tr></table></figure></li><li><p>è§£å‹Nodeæºç åŒ…</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tar zxvf node-v0<span class="number">.10</span><span class="number">.24</span>.tar.gz</span><br><span class="line"></span><br><span class="line">cd node-v0<span class="number">.10</span><span class="number">.24</span></span><br></pre></td></tr></table></figure></li><li><p>é…ç½®</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./configure --prefix=<span class="regexp">/usr/</span>local/node</span><br></pre></td></tr></table></figure></li><li><p>ç¼–è¯‘,å®‰è£…  <strong>ç¼–è¯‘æ—¶é—´è¾ƒé•¿!</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure></li><li><p>é…ç½®Nodeç¯å¢ƒ</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/profile</span><br></pre></td></tr></table></figure></li></ul><blockquote><p>è¾“å…¥ <code>i</code> è¿›è¡Œæ’å…¥ <code>åŸæ¥çš„æ–‡ä»¶å†…å®¹ä¸è¦æ”¹~~</code></p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> NODE_HOME=<span class="regexp">/usr/</span>local/node</span><br><span class="line"><span class="keyword">export</span> PATH=$NODE_HOME/bin:$PATH</span><br><span class="line"><span class="keyword">export</span> NODE_PATH=$NODE_HOME/lib/node_modules:$PATH</span><br></pre></td></tr></table></figure><blockquote><p>æŒ‰<code>esc</code>é”®, ç„¶åè¾“å…¥ <code>:wq</code> å›è½¦é€€å‡º</p></blockquote><ul><li><p>é‡å¯ç”Ÿæ•ˆ</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure></li><li><p>æµ‹è¯•</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node -v &amp;&amp; npm -v</span><br></pre></td></tr></table></figure></li></ul><blockquote><p>å‡ºç° ç‰ˆæœ¬å·æ­£ç¡®~~~</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> node </tag>
            
            <tag> ECS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>gulpåˆçº§æ•™ç¨‹</title>
      <link href="/2015/03/01/gulp%E5%88%9D%E7%BA%A7%E6%95%99%E7%A8%8B/"/>
      <url>/2015/03/01/gulp%E5%88%9D%E7%BA%A7%E6%95%99%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<p>æˆ‘çš„gulpå­¦ä¹ ç¬”è®°åŠæ€»ç»“<br><a id="more"></a></p><h2 id="æœ¬æ–‡ç•¥æœ‰è¿‡æ—¶-å»ºè®®é˜…è¯»"><a href="#æœ¬æ–‡ç•¥æœ‰è¿‡æ—¶-å»ºè®®é˜…è¯»" class="headerlink" title="æœ¬æ–‡ç•¥æœ‰è¿‡æ—¶,å»ºè®®é˜…è¯»:"></a>æœ¬æ–‡ç•¥æœ‰è¿‡æ—¶,å»ºè®®é˜…è¯»:</h2><h2 id="https-github-com-Platform-CUF-use-gulp"><a href="#https-github-com-Platform-CUF-use-gulp" class="headerlink" title="https://github.com/Platform-CUF/use-gulp"></a><a href="https://github.com/Platform-CUF/use-gulp" target="_blank" rel="noopener">https://github.com/Platform-CUF/use-gulp</a></h2><h2 id="https-github-com-lisposter-gulp-docs-zh-cn"><a href="#https-github-com-lisposter-gulp-docs-zh-cn" class="headerlink" title="https://github.com/lisposter/gulp-docs-zh-cn"></a><a href="https://github.com/lisposter/gulp-docs-zh-cn" target="_blank" rel="noopener">https://github.com/lisposter/gulp-docs-zh-cn</a></h2><h1 id="å…¥é—¨å›¾è¡¨"><a href="#å…¥é—¨å›¾è¡¨" class="headerlink" title="å…¥é—¨å›¾è¡¨"></a>å…¥é—¨å›¾è¡¨</h1><p><a href="https://github.com/osscafe/gulp-cheatsheet" target="_blank" rel="noopener">github_gulp-cheatsheet</a></p><blockquote><p>ä¸­æ–‡ç‰ˆç›´æ¥ä¸‹è½½åœ°å€: <a href="https://github.com/osscafe/gulp-cheetsheet/raw/master/dist/cn-js-p1.pdf" target="_blank" rel="noopener"><code>pdf1</code></a> <a href="https://github.com/osscafe/gulp-cheetsheet/raw/master/dist/cn-js-p2.pdf" target="_blank" rel="noopener"><code>pdf2</code></a></p></blockquote><h1 id="ä¸€äº›gulp-api"><a href="#ä¸€äº›gulp-api" class="headerlink" title="ä¸€äº›gulp api"></a>ä¸€äº›gulp api</h1><p><code>gulp.src(globs[, options])</code></p><blockquote><p>æ ¹æ®globsæä¾›çš„æ–‡ä»¶åˆ—è¡¨,å¾—åˆ°ä¸€ä¸ªstream,æŒ‰ç…§ç®¡é“æ¨¡å¼ç»™å…¶å®ƒæ’ä»¶å¤„ç†</p></blockquote><p><code>gulp.dest(path[, options])</code></p><blockquote><p>å°†ç®¡é“ä¸­çš„æ•°æ®å†™å…¥åˆ°æ–‡ä»¶å¤¹ã€‚</p></blockquote><p><code>gulp.task(name[, deps], fn)</code><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">gulp.task(<span class="string">'taskname'</span>, [<span class="string">'task1'</span>, <span class="string">'task2'</span>], <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// Do stuff</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//å‘½ä»¤å·¥å…·è¾“å…¥ gulpæ˜¯æ‰§è¡Œ defaultä»»åŠ¡</span></span><br><span class="line"><span class="comment">// Default task</span></span><br><span class="line">gulp.task(<span class="string">'default'</span>, [<span class="string">'é¦–å…ˆæ‰§è¡Œçš„ä»»åŠ¡(å¯é€‰)'</span>], <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    gulp.start([<span class="string">'taskname'</span>, <span class="string">'taskname2'</span>]); <span class="comment">//å¼€å§‹å¹¶è¡Œæ‰§è¡Œä»»åŠ¡å‘€</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><blockquote><p>å®šä¹‰ä»»åŠ¡. <em>deps æ˜¯ä»»åŠ¡æ•°ç»„,åœ¨æ‰§è¡Œæœ¬ä»»åŠ¡æ—¶æ•°ç»„ä¸­çš„ä»»åŠ¡è¦æ‰§è¡Œå¹¶å®Œæˆ</em></p></blockquote><p><code>gulp.watch(glob [, opts], tasks)</code><br><code>gulp.watch(glob [, opts, cb])</code></p><blockquote><p>ç›‘æ§æ–‡ä»¶.å½“ç›‘æ§çš„æ–‡ä»¶æœ‰æ‰€æ”¹å˜æ—¶æ‰§è¡Œç‰¹å®šçš„ä»»åŠ¡.</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Watch</span></span><br><span class="line">gulp.task(<span class="string">'watch'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// Watch .scss files</span></span><br><span class="line">    gulp.watch(<span class="string">'css/**/*'</span>, [<span class="string">'css'</span>]);</span><br><span class="line">    <span class="comment">// Watch .js files</span></span><br><span class="line">    gulp.watch(<span class="string">'js/**/*.js'</span>, [<span class="string">'js'</span>]);</span><br><span class="line">    <span class="comment">// Create LiveReload server</span></span><br><span class="line">    livereload.listen();</span><br><span class="line">    <span class="comment">// Watch any files in dist/, reload on change</span></span><br><span class="line">    gulp.watch([<span class="string">'public/**'</span>]).on(<span class="string">'change'</span>, livereload.changed);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h1 id="ä¸€äº›æ’ä»¶"><a href="#ä¸€äº›æ’ä»¶" class="headerlink" title="ä¸€äº›æ’ä»¶"></a>ä¸€äº›æ’ä»¶</h1><ul><li><a href="https://github.com/gulpjs/gulp/tree/master/docs/recipes#recipes" target="_blank" rel="noopener">å®˜æ–¹è‹±æ–‡æ–‡æ¡£</a></li><li><code>gulp-browserify</code><blockquote><p>browserifyå¯ä»¥ä¸ºæµè§ˆå™¨ç¼–è¯‘nodeé£æ ¼çš„éµå¾ªcommonjsçš„æ¨¡å—ã€‚ å®ƒæœç´¢æ–‡ä»¶ä¸­çš„require()è°ƒç”¨ï¼Œ é€’å½’çš„å»ºç«‹æ¨¡å—ä¾èµ–å›¾ã€‚</p></blockquote></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</span><br><span class="line"><span class="keyword">var</span> browserify = <span class="built_in">require</span>(<span class="string">'gulp-browserify'</span>);</span><br><span class="line"><span class="comment">// Basic usage</span></span><br><span class="line">gulp.task(<span class="string">'scripts'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// Single entry point to browserify</span></span><br><span class="line">    gulp.src(<span class="string">'src/js/app.js'</span>)</span><br><span class="line">        .pipe(browserify(&#123;</span><br><span class="line">          insertGlobals : <span class="literal">true</span>,</span><br><span class="line">          debug : !gulp.env.production</span><br><span class="line">        &#125;))</span><br><span class="line">        .pipe(gulp.dest(<span class="string">'./build/js'</span>))</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><ul><li><code>gulp-jshint</code><blockquote><p>gulpçš„jshintæ’ä»¶</p></blockquote></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> jshint = <span class="built_in">require</span>(<span class="string">'gulp-jshint'</span>);</span><br><span class="line"><span class="keyword">var</span> gulp   = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</span><br><span class="line">gulp.task(<span class="string">'lint'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> gulp.src(<span class="string">'./lib/*.js'</span>)</span><br><span class="line">    .pipe(jshint())</span><br><span class="line">    .pipe(jshint.reporter(<span class="string">'YOUR_REPORTER_HERE'</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><ul><li><code>gulp-imagemin</code><blockquote><p>å‹ç¼©å›¾ç‰‡çš„å·¥å…·</p></blockquote></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</span><br><span class="line"><span class="keyword">var</span> imagemin = <span class="built_in">require</span>(<span class="string">'gulp-imagemin'</span>);</span><br><span class="line"><span class="keyword">var</span> pngquant = <span class="built_in">require</span>(<span class="string">'imagemin-pngquant'</span>);</span><br><span class="line">gulp.task(<span class="string">'default'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.src(<span class="string">'src/images/*'</span>)</span><br><span class="line">        .pipe(imagemin(&#123;</span><br><span class="line">            progressive: <span class="literal">true</span>,</span><br><span class="line">            svgoPlugins: [&#123;<span class="attr">removeViewBox</span>: <span class="literal">false</span>&#125;],</span><br><span class="line">            use: [pngquant()]</span><br><span class="line">        &#125;))</span><br><span class="line">        .pipe(gulp.dest(<span class="string">'dist'</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><ul><li><code>glup-sass</code></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</span><br><span class="line"><span class="keyword">var</span> sass = <span class="built_in">require</span>(<span class="string">'gulp-sass'</span>);</span><br><span class="line">gulp.task(<span class="string">'sass'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    gulp.src(<span class="string">'./scss/*.scss'</span>)</span><br><span class="line">        .pipe(sass())</span><br><span class="line">        .pipe(gulp.dest(<span class="string">'./css'</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><ul><li><code>browser-sync</code><blockquote><p>BrowserSync æ˜¯ä¸€ä¸ªè‡ªåŠ¨åŒ–æµ‹è¯•è¾…åŠ©å·¥å…·,å¯ä»¥å¸®ä½ åœ¨ç½‘é¡µæ–‡ä»¶å˜æ›´æ—¶è‡ªåŠ¨è½½å…¥æ–°çš„ç½‘é¡µ</p></blockquote></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</span><br><span class="line"><span class="keyword">var</span> browserSync = <span class="built_in">require</span>(<span class="string">'browser-sync'</span>);</span><br><span class="line"><span class="comment">// Static server</span></span><br><span class="line">gulp.task(<span class="string">'browser-sync'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    browserSync(&#123;</span><br><span class="line">        server: &#123;</span><br><span class="line">            baseDir: <span class="string">"./"</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// or...</span></span><br><span class="line">gulp.task(<span class="string">'browser-sync'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    browserSync(&#123;</span><br><span class="line">        proxy: <span class="string">"yourlocal.dev"</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><ul><li><p><code>proxy-middleware</code></p><blockquote><p>ä½œä¸ºhttp proxy,è½¬å‘ç‰¹å®šçš„è¯·æ±‚</p></blockquote></li><li><p><code>gulp-usemin</code></p><blockquote><p>ç”¨æ¥å°†HTML æ–‡ä»¶ä¸­ï¼ˆæˆ–è€…templates/viewsï¼‰ä¸­æ²¡æœ‰ä¼˜åŒ–çš„script å’Œstylesheets æ›¿æ¢ä¸ºä¼˜åŒ–è¿‡çš„ç‰ˆæœ¬</p></blockquote></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//html</span></span><br><span class="line">&lt;!-- build:&lt;pipelineId&gt;(alternate search path) &lt;path&gt; --&gt;</span><br><span class="line">... HTML Markup, list of script / link tags.</span><br><span class="line">&lt;!-- endbuild --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- build:css css/user.css --&gt;</span><br><span class="line">&lt;link rel="stylesheet" href="css/style.css"&gt;</span><br><span class="line">&lt;!-- endbuild --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- build:js js/user.js --&gt;</span><br><span class="line">&lt;script src="js/ajax.js"&gt;&lt;/script&gt;</span><br><span class="line">&lt;!-- endbuild --&gt;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// gulpfile.js</span></span><br><span class="line"><span class="keyword">var</span> rev = <span class="built_in">require</span>(<span class="string">'gulp-rev'</span>);</span><br><span class="line"><span class="keyword">var</span> usemin = <span class="built_in">require</span>(<span class="string">'gulp-usemin'</span>);</span><br><span class="line">gulp.task(<span class="string">'usemin'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.src(<span class="string">'index.html'</span>)</span><br><span class="line">        .pipe(</span><br><span class="line">            usemin(&#123;</span><br><span class="line">                <span class="comment">//rev() æ–‡ä»¶å¸¦hash  'concat' æ–‡ä»¶æ²¡æœ‰hash</span></span><br><span class="line">                css: [minifycss(), <span class="string">'concat'</span>],</span><br><span class="line">                html: [minifyhtml(&#123;</span><br><span class="line">                    empty: <span class="literal">true</span></span><br><span class="line">                &#125;)],</span><br><span class="line">                js: [uglify(), rev()]</span><br><span class="line">            &#125;)</span><br><span class="line">        )</span><br><span class="line">        .pipe(</span><br><span class="line">            gulp.dest(<span class="string">'public/'</span>)</span><br><span class="line">        );</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><ul><li><code>gulp-uglify</code><blockquote><p>javascriptä»£ç ä¼˜åŒ–å·¥å…·ï¼Œå¯ä»¥è§£æï¼Œå‹ç¼©å’Œç¾åŒ–javascript</p></blockquote></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> uglify = <span class="built_in">require</span>(<span class="string">'gulp-uglify'</span>);</span><br><span class="line">gulp.task(<span class="string">'compress'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  gulp.src(<span class="string">'lib/*.js'</span>)</span><br><span class="line">    .pipe(uglify())</span><br><span class="line">    .pipe(gulp.dest(<span class="string">'dist'</span>))</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><ul><li><code>gulp-inject</code><blockquote><p>å¯ä»¥æ³¨å…¥css,javascriptå’Œwebç»„ä»¶,ä¸éœ€æ‰‹å·¥æ›´æ–°ndex.html</p></blockquote></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;title&gt;My index&lt;<span class="regexp">/title&gt;</span></span><br><span class="line"><span class="regexp">  &lt;!-- inject:css --&gt;</span></span><br><span class="line"><span class="regexp">  &lt;!-- endinject --&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;!-- inject:js --&gt;</span><br><span class="line">  &lt;!-- endinject --&gt;</span><br><span class="line">&lt;<span class="regexp">/body&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>html&gt;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// gulpfile.js</span></span><br><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</span><br><span class="line"><span class="keyword">var</span> inject = <span class="built_in">require</span>(<span class="string">"gulp-inject"</span>);</span><br><span class="line">gulp.task(<span class="string">'index'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> target = gulp.src(<span class="string">'./src/index.html'</span>);</span><br><span class="line">  <span class="comment">// It's not necessary to read the files (will speed up things), we're only after their paths:</span></span><br><span class="line">  <span class="keyword">var</span> sources = gulp.src([<span class="string">'./src/**/*.js'</span>, <span class="string">'./src/**/*.css'</span>], &#123;<span class="attr">read</span>: <span class="literal">false</span>&#125;);</span><br><span class="line">  <span class="keyword">return</span> target.pipe(inject(sources))</span><br><span class="line">    .pipe(gulp.dest(<span class="string">'./src'</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><ul><li><code>gulp-rename</code><blockquote><p>æ”¹å˜ç®¡é“ä¸­çš„æ–‡ä»¶å</p></blockquote></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> rename = <span class="built_in">require</span>(<span class="string">"gulp-rename"</span>);</span><br><span class="line"><span class="comment">// rename via string</span></span><br><span class="line">gulp.src(<span class="string">"./src/main/text/hello.txt"</span>)</span><br><span class="line">    .pipe(rename(<span class="string">"main/text/ciao/goodbye.md"</span>))</span><br><span class="line">    .pipe(gulp.dest(<span class="string">"./dist"</span>)); <span class="comment">// ./dist/main/text/ciao/goodbye.md</span></span><br><span class="line"><span class="comment">// rename via function</span></span><br><span class="line">gulp.src(<span class="string">"./src/**/hello.txt"</span>)</span><br><span class="line">    .pipe(rename(<span class="function"><span class="keyword">function</span> (<span class="params">path</span>) </span>&#123;</span><br><span class="line">        path.dirname += <span class="string">"/ciao"</span>;</span><br><span class="line">        path.basename += <span class="string">"-goodbye"</span>;</span><br><span class="line">        path.extname = <span class="string">".md"</span></span><br><span class="line">    &#125;))</span><br><span class="line">    .pipe(gulp.dest(<span class="string">"./dist"</span>)); <span class="comment">// ./dist/main/text/ciao/hello-goodbye.md</span></span><br><span class="line"><span class="comment">// rename via hash</span></span><br><span class="line">gulp.src(<span class="string">"./src/main/text/hello.txt"</span>, &#123; <span class="attr">base</span>: process.cwd() &#125;)</span><br><span class="line">    .pipe(rename(&#123;</span><br><span class="line">        dirname: <span class="string">"main/text/ciao"</span>,</span><br><span class="line">        basename: <span class="string">"aloha"</span>,</span><br><span class="line">        prefix: <span class="string">"bonjour-"</span>,</span><br><span class="line">        suffix: <span class="string">"-hola"</span>,</span><br><span class="line">        extname: <span class="string">".md"</span></span><br><span class="line">    &#125;))</span><br><span class="line">    .pipe(gulp.dest(<span class="string">"./dist"</span>)); <span class="comment">// ./dist/main/text/ciao/bonjour-aloha-hola.md</span></span><br></pre></td></tr></table></figure><ul><li><code>gulp-clean</code><blockquote><p>æä¾›cleanåŠŸèƒ½</p></blockquote></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);  </span><br><span class="line"><span class="keyword">var</span> clean = <span class="built_in">require</span>(<span class="string">'gulp-clean'</span>);</span><br><span class="line">gulp.task(<span class="string">'clean'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;  </span><br><span class="line">  <span class="keyword">return</span> gulp.src(<span class="string">'build'</span>, &#123;<span class="attr">read</span>: <span class="literal">false</span>&#125;)</span><br><span class="line">    .pipe(clean());</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><ul><li><code>gulp-concat</code><blockquote><p>è¿æ¥åˆå¹¶æ–‡ä»¶</p></blockquote></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> concat = <span class="built_in">require</span>(<span class="string">'gulp-concat'</span>);</span><br><span class="line">gulp.task(<span class="string">'scripts'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  gulp.src(<span class="string">'./lib/*.js'</span>)</span><br><span class="line">    .pipe(concat(<span class="string">'all.js'</span>))</span><br><span class="line">    .pipe(gulp.dest(<span class="string">'./dist/'</span>))</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h1 id="ä¸€ä¸ªå®Œæ•´çš„gulpfile"><a href="#ä¸€ä¸ªå®Œæ•´çš„gulpfile" class="headerlink" title="ä¸€ä¸ªå®Œæ•´çš„gulpfile"></a>ä¸€ä¸ªå®Œæ•´çš„gulpfile</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*!</span></span><br><span class="line"><span class="comment"> * gulp</span></span><br><span class="line"><span class="comment"> * $ npm install gulp-ruby-sass gulp-autoprefixer gulp-minify-css gulp-jshint gulp-concat gulp-uglify gulp-imagemin gulp-notify gulp-rename gulp-livereload gulp-cache del --save-dev</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">// Load plugins</span></span><br><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>),</span><br><span class="line">    sass = <span class="built_in">require</span>(<span class="string">'gulp-ruby-sass'</span>),</span><br><span class="line">    autoprefixer = <span class="built_in">require</span>(<span class="string">'gulp-autoprefixer'</span>),</span><br><span class="line">    minifycss = <span class="built_in">require</span>(<span class="string">'gulp-minify-css'</span>),</span><br><span class="line">    jshint = <span class="built_in">require</span>(<span class="string">'gulp-jshint'</span>),</span><br><span class="line">    uglify = <span class="built_in">require</span>(<span class="string">'gulp-uglify'</span>),</span><br><span class="line">    imagemin = <span class="built_in">require</span>(<span class="string">'gulp-imagemin'</span>),</span><br><span class="line">    rename = <span class="built_in">require</span>(<span class="string">'gulp-rename'</span>),</span><br><span class="line">    concat = <span class="built_in">require</span>(<span class="string">'gulp-concat'</span>),</span><br><span class="line">    notify = <span class="built_in">require</span>(<span class="string">'gulp-notify'</span>),</span><br><span class="line">    cache = <span class="built_in">require</span>(<span class="string">'gulp-cache'</span>),</span><br><span class="line">    livereload = <span class="built_in">require</span>(<span class="string">'gulp-livereload'</span>),</span><br><span class="line">    del = <span class="built_in">require</span>(<span class="string">'del'</span>);</span><br><span class="line"> </span><br><span class="line"><span class="comment">// Styles</span></span><br><span class="line">gulp.task(<span class="string">'styles'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> gulp.src(<span class="string">'src/styles/main.scss'</span>)</span><br><span class="line">    .pipe(sass(&#123; <span class="attr">style</span>: <span class="string">'expanded'</span>, &#125;))</span><br><span class="line">    .pipe(autoprefixer(<span class="string">'last 2 version'</span>, <span class="string">'safari 5'</span>, <span class="string">'ie 8'</span>, <span class="string">'ie 9'</span>, <span class="string">'opera 12.1'</span>, <span class="string">'ios 6'</span>, <span class="string">'android 4'</span>))</span><br><span class="line">    .pipe(gulp.dest(<span class="string">'dist/styles'</span>))</span><br><span class="line">    .pipe(rename(&#123; <span class="attr">suffix</span>: <span class="string">'.min'</span> &#125;))</span><br><span class="line">    .pipe(minifycss())</span><br><span class="line">    .pipe(gulp.dest(<span class="string">'dist/styles'</span>))</span><br><span class="line">    .pipe(notify(&#123; <span class="attr">message</span>: <span class="string">'Styles task complete'</span> &#125;));</span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line"><span class="comment">// Scripts</span></span><br><span class="line">gulp.task(<span class="string">'scripts'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> gulp.src(<span class="string">'src/scripts/**/*.js'</span>)</span><br><span class="line">    .pipe(jshint(<span class="string">'.jshintrc'</span>))</span><br><span class="line">    .pipe(jshint.reporter(<span class="string">'default'</span>))</span><br><span class="line">    .pipe(concat(<span class="string">'main.js'</span>))</span><br><span class="line">    .pipe(gulp.dest(<span class="string">'dist/scripts'</span>))</span><br><span class="line">    .pipe(rename(&#123; <span class="attr">suffix</span>: <span class="string">'.min'</span> &#125;))</span><br><span class="line">    .pipe(uglify())</span><br><span class="line">    .pipe(gulp.dest(<span class="string">'dist/scripts'</span>))</span><br><span class="line">    .pipe(notify(&#123; <span class="attr">message</span>: <span class="string">'Scripts task complete'</span> &#125;));</span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line"><span class="comment">// Images</span></span><br><span class="line">gulp.task(<span class="string">'images'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> gulp.src(<span class="string">'src/images/**/*'</span>)</span><br><span class="line">    .pipe(cache(imagemin(&#123; <span class="attr">optimizationLevel</span>: <span class="number">3</span>, <span class="attr">progressive</span>: <span class="literal">true</span>, <span class="attr">interlaced</span>: <span class="literal">true</span> &#125;)))</span><br><span class="line">    .pipe(gulp.dest(<span class="string">'dist/images'</span>))</span><br><span class="line">    .pipe(notify(&#123; <span class="attr">message</span>: <span class="string">'Images task complete'</span> &#125;));</span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line"><span class="comment">// Clean</span></span><br><span class="line">gulp.task(<span class="string">'clean'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">cb</span>) </span>&#123;</span><br><span class="line">    del([<span class="string">'dist/assets/css'</span>, <span class="string">'dist/assets/js'</span>, <span class="string">'dist/assets/img'</span>], cb)</span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line"><span class="comment">// Default task</span></span><br><span class="line">gulp.task(<span class="string">'default'</span>, [<span class="string">'clean'</span>], <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    gulp.start(<span class="string">'styles'</span>, <span class="string">'scripts'</span>, <span class="string">'images'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line"><span class="comment">// Watch</span></span><br><span class="line">gulp.task(<span class="string">'watch'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// Watch .scss files</span></span><br><span class="line">  gulp.watch(<span class="string">'src/styles/**/*.scss'</span>, [<span class="string">'styles'</span>]);</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// Watch .js files</span></span><br><span class="line">  gulp.watch(<span class="string">'src/scripts/**/*.js'</span>, [<span class="string">'scripts'</span>]);</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// Watch image files</span></span><br><span class="line">  gulp.watch(<span class="string">'src/images/**/*'</span>, [<span class="string">'images'</span>]);</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// Create LiveReload server</span></span><br><span class="line">  livereload.listen();</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// Watch any files in dist/, reload on change</span></span><br><span class="line">  gulp.watch([<span class="string">'dist/**'</span>]).on(<span class="string">'change'</span>, livereload.changed);</span><br><span class="line"> </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><p><a href="http://colobu.com/2014/11/17/gulp-plugins-introduction/" target="_blank" rel="noopener">gulp-plugins-introduction/</a><br><a href="https://gist.github.com/markgoodyear/8497946#file-gulpfile-js" target="_blank" rel="noopener">gruntä¸gulpæ¯”è¾ƒ</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> gulp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>gulpç§»åŠ¨/å¤åˆ¶æ–‡ä»¶</title>
      <link href="/2015/02/27/gulp%E7%A7%BB%E5%8A%A8-%E5%A4%8D%E5%88%B6%E6%96%87%E4%BB%B6/"/>
      <url>/2015/02/27/gulp%E7%A7%BB%E5%8A%A8-%E5%A4%8D%E5%88%B6%E6%96%87%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<p>gulpç›´æ¥dest é»˜è®¤ç›´æ¥å¤åˆ¶æ–‡ä»¶,ä¸ä¼šè®¾ç½®æ–‡ä»¶çš„æ–‡ä»¶ç›®å½•,åœ¨gulp &gt;= 3.2.2åå¯ä»¥è®¾ç½®baseæ¥è¾¾åˆ°æ–‡ä»¶å«ç›®å½•<br><a id="more"></a></p><h2 id="æœ‰ä»¥ä¸‹æ–‡ä»¶-æ–‡ä»¶å¤¹"><a href="#æœ‰ä»¥ä¸‹æ–‡ä»¶-æ–‡ä»¶å¤¹" class="headerlink" title="æœ‰ä»¥ä¸‹æ–‡ä»¶/æ–‡ä»¶å¤¹"></a>æœ‰ä»¥ä¸‹æ–‡ä»¶/æ–‡ä»¶å¤¹</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-js/**/*</span><br><span class="line">-css/**/*</span><br><span class="line">-images/**/*</span><br><span class="line">-index.html</span><br></pre></td></tr></table></figure><h2 id="æƒ³è¦è½¬æ¢æˆ"><a href="#æƒ³è¦è½¬æ¢æˆ" class="headerlink" title="æƒ³è¦è½¬æ¢æˆ"></a>æƒ³è¦è½¬æ¢æˆ</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-public</span><br><span class="line">    -js/**/*</span><br><span class="line">    -css/**/*</span><br><span class="line">    -images/**/*</span><br><span class="line">    -index.html</span><br></pre></td></tr></table></figure><blockquote><p>glob-stream versions &gt;= 3.1.0 (used by gulp &gt;= 3.2.2) accept a base option, which can be used to explicitly set the base.  </p></blockquote><blockquote><p>åªè¦gulpç‰ˆæœ¬ &gt;= 3.2.2; å¯ä»¥ä½¿ç”¨baseå‚æ•°æŒ‡å®šæ‹·è´å¼€å§‹ç›®å½•</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// move</span></span><br><span class="line">gulp.task(<span class="string">'move'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.src(</span><br><span class="line">        [<span class="string">'js/**/*jquery*js'</span>, <span class="string">'js/**/*bootstrap*js'</span>, <span class="string">'images/**/*'</span>, <span class="string">'css/**/*bootstrap*css'</span>], &#123;</span><br><span class="line">            base: <span class="string">'./'</span>   <span class="comment">//å¦‚æœè®¾ç½®ä¸º base: 'js' å°†åªä¼šå¤åˆ¶ jsç›®å½•ä¸‹æ–‡ä»¶, å…¶ä»–æ–‡ä»¶ä¼šå¿½ç•¥</span></span><br><span class="line">        &#125;</span><br><span class="line">    ).pipe(gulp.dest(<span class="string">'public'</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="gulp-src-globs-options-ä¸­optionsç”¨æ³•"><a href="#gulp-src-globs-options-ä¸­optionsç”¨æ³•" class="headerlink" title="gulp.src(globs[, options]) ä¸­optionsç”¨æ³•"></a>gulp.src(globs[, options]) ä¸­optionsç”¨æ³•</h2><p>å­˜åœ¨æ–‡ä»¶ <code>app/views/index.html</code>, <code>gulp</code>ä»£ç å¦‚ä¸‹<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> src = <span class="string">'index.html'</span>;</span><br><span class="line"><span class="keyword">var</span> opt = &#123;</span><br><span class="line">  cwd: <span class="string">'app/views'</span>,</span><br><span class="line">  base: <span class="string">'app'</span></span><br><span class="line">&#125;;</span><br><span class="line">gulp.src(src, opt);</span><br></pre></td></tr></table></figure></p><p>æ„æ€ä¸º:  <code>opt.cwd</code> è·¯å¾„ä¸‹è¯»å– <code>src</code>, è¾“å‡ºè·¯å¾„çš„ <code>base</code> ä¸º <code>opt.base</code>; å³è¾“å‡ºè·¯å¾„ä¸º <code>views/index.html</code>;<br>å‡è®¾ <code>opt.base</code> ä¸º <code>app2</code> , å› ä¸º<code>baseè·¯å¾„</code>åŸºäº <code>opt.cwd + src</code>, æ‰€ä»¥ è¾“å‡ºè·¯å¾„ä¸º <code>ç©º</code> , å³æ²¡æœ‰ä»»ä½•æ–‡ä»¶èƒ½è¾“å‡º</p><h2 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h2><ul><li><a href="http://www.levihackwith.com/how-to-make-gulp-copy-a-directory-and-its-contents/" target="_blank" rel="noopener">http://www.levihackwith.com/how-to-make-gulp-copy-a-directory-and-its-contents/</a></li><li><a href="https://github.com/hparra/gulp-rename" target="_blank" rel="noopener">https://github.com/hparra/gulp-rename</a></li></ul><hr><blockquote><p><strong>æ–‡ç« è‹¥æœ‰çº°æ¼è¯·å¤§å®¶è¡¥å……æŒ‡æ­£,è°¢è°¢~~</strong><br><a href="http://blog.xinshangshangxin.com">http://blog.xinshangshangxin.com</a> SHANGæ®‡</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> gulp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Node.jsä¸­fs.renameå‡ºé”™Error EXDEV</title>
      <link href="/2015/02/24/Node-js%E4%B8%ADfs-rename%E5%87%BA%E9%94%99Error-EXDEV/"/>
      <url>/2015/02/24/Node-js%E4%B8%ADfs-rename%E5%87%BA%E9%94%99Error-EXDEV/</url>
      
        <content type="html"><![CDATA[<p>renameå‡ºé”™Error EXDEVç”±äºè·¨ç£ç›˜åˆ†åŒºç§»åŠ¨æˆ–æ“ä½œæ–‡ä»¶ä¼šæœ‰æƒé™é—®é¢˜(é»˜è®¤è·¯å¾„æ˜¯windowä¸´æ—¶ç›®å½•C:\Users\ADMINI~1\AppData\Local\Temp\ï¼‰<br><a id="more"></a></p><h1 id="è§£å†³åŠæ³•"><a href="#è§£å†³åŠæ³•" class="headerlink" title="è§£å†³åŠæ³•"></a>è§£å†³åŠæ³•</h1><blockquote><p>æ–¹æ³•ä¸€<br>åœ¨é¡¹ç›®å…¥å£çš„æ–‡ä»¶ï¼ˆ<code>app.js</code>ï¼‰çš„é¡¶éƒ¨ï¼Œ åŠ ä»¥ä¸‹è¿™è¡Œä»£ç </p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">process.env.TMPDIR = <span class="string">'./temp'</span>;</span><br><span class="line"><span class="comment">// æˆ–è€…</span></span><br><span class="line"><span class="comment">// process.env.TMPDIR = '/path/to/directory';</span></span><br></pre></td></tr></table></figure><blockquote><p>æ–¹æ³•äºŒ<br>åœ¨é¡¹ç›®æ ¹ç›®å½•è·¯å¾„ï¼Œåœ¨<code>å‘½ä»¤è¡Œ</code>ä¸‹ è¾“å…¥</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">env TMPDIR=<span class="regexp">/path/</span>to/directory node app.js</span><br></pre></td></tr></table></figure><blockquote><p>æ–¹æ³•ä¸‰<br>åˆ©ç”¨fsçš„<code>createReadStream</code>ã€<code>createWriteSream</code>å’Œ<code>unlinkSync</code>æ–¹æ³•</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">"fs"</span>),</span><br><span class="line">    util = <span class="built_in">require</span>(<span class="string">'util'</span>);</span><br><span class="line">    ...</span><br><span class="line">    </span><br><span class="line"><span class="keyword">var</span> readStream = fs.createReadStream(files.upload.path)</span><br><span class="line"><span class="keyword">var</span> writeStream = fs.createWriteStream(<span class="string">"/tmp/test.png"</span>);</span><br><span class="line"></span><br><span class="line">util.pump(readStream, writeStream, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    fs.unlinkSync(files.upload.path);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><blockquote><p>æ–¹æ³•å››<br>å¦‚æœä½¿ç”¨ <a href="https://github.com/felixge/node-formidable" target="_blank" rel="noopener">formidable</a></p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> form = <span class="keyword">new</span> formidable.IncomingForm();</span><br><span class="line">form.uploadDir = dir;<span class="comment">// ç›´æ¥è®¾ç½®è·¯å¾„å³å¯</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> node </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ConEmuè®¾ç½®å½“å‰ç›®å½•æ‰“å¼€å³é”®èœå•</title>
      <link href="/2015/02/22/ConEmu%E8%AE%BE%E7%BD%AE%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95%E6%89%93%E5%BC%80/"/>
      <url>/2015/02/22/ConEmu%E8%AE%BE%E7%BD%AE%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95%E6%89%93%E5%BC%80/</url>
      
        <content type="html"><![CDATA[<p>cmderåŸºäºConEmu,ä½†æ˜¯ConEmuæ²¡æœ‰ç›´æ¥è®¾ç½®å½“å‰ç›®å½•æ‰“å¼€çš„å³é”®èœå•<br><a id="more"></a></p><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>cmder å¾ˆå¥½ç”¨,å°±æ˜¯ç»å¸¸åå­—å’Œå¤šå­—; æŸ¥äº†ä¸‹,cmderåŸºäºConEmu,å°±å°è¯•äº†ConEmu</p><h1 id="ConEmuè®¾ç½®å½“å‰ç›®å½•æ‰“å¼€å³é”®èœå•"><a href="#ConEmuè®¾ç½®å½“å‰ç›®å½•æ‰“å¼€å³é”®èœå•" class="headerlink" title="ConEmuè®¾ç½®å½“å‰ç›®å½•æ‰“å¼€å³é”®èœå•"></a>ConEmuè®¾ç½®å½“å‰ç›®å½•æ‰“å¼€å³é”®èœå•</h1><ol><li>æ‰“å¼€è®¾ç½® <code>win+alt+p</code> æˆ–è€… å¦‚å›¾æ‰“å¼€<figure class="image-box">                <img src="/img/conemu/2.png" alt="ConEmu" title="" class="">                <p>ConEmu</p>            </figure></li><li><p>æ‰“å¼€Integreation å¦‚å›¾å¡«å†™<br><code>cmd -cur_console:n %P</code><br><img src="/img/conemu/3.png" alt="ConEmu"></p></li><li><p>å³é”®æµ‹è¯•ä¸‹å§~</p></li></ol><h1 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h1><ol><li>åœ¨ConEmu å®‰è£…/è§£å‹ ç›®å½•ä½¿ç”¨ æ— æ•ˆ!</li><li>åœ¨ æœç‹—å£çº¸ ç­‰è½¯ä»¶ä¸Š æ— æ•ˆ!  </li></ol><p><em>æˆ‘æµ‹è¯•çš„æ—¶å€™å°±æ˜¯åœ¨ConEmuç›®å½•ä¸‹ å’Œ æœç‹—å£çº¸çš„æ¡Œé¢ä¸Šæµ‹è¯•;å§‹ç»ˆæ— æ•ˆ,æ£é¼“äº†å¥½é•¿æ—¶é—´â€¦</em></p>]]></content>
      
      
      
        <tags>
            
            <tag> ConEmu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è‡ªè¡Œæ­å»ºyoukuvodæœåŠ¡å™¨</title>
      <link href="/2015/02/20/%E8%87%AA%E8%A1%8C%E6%90%AD%E5%BB%BAyoukuvod%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
      <url>/2015/02/20/%E8%87%AA%E8%A1%8C%E6%90%AD%E5%BB%BAyoukuvod%E6%9C%8D%E5%8A%A1%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<p>ç”±äºazureæœåŠ¡å™¨åˆ°æœŸ,è½¬è‡³coding.net,è‡ªè¡Œæ­å»ºyoukuvodæœåŠ¡å™¨ç¯å¢ƒå¯æé«˜é€Ÿåº¦<br><a id="more"></a></p><h1 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h1><ol><li>èœé¸Ÿä½œå“, å¤§ç¥è¯·ç•¥è¿‡</li><li>ç›´æ¥å¯ç”¨è„šæœ¬<a href="https://greasyfork.org/zh-CN/scripts/2837-youkuvod" target="_blank" rel="noopener">greasyfork-youkuvod</a></li><li>æ‹…å¿ƒæœåŠ¡å™¨å®æ‰æ‰å‡ºç°æœ¬æ–‡</li><li>æ­å»ºåé»˜è®¤åªèƒ½ä½¿ç”¨ç¡•é¼ è§£æ;é£é©´è§£æéœ€è¦ç”³è¯·token</li><li>è¯·æ­£ç¡®ä½¿ç”¨coding.netæä¾›çš„ç©ºé—´,ä¸è¦æµªè´¹â€¦..</li></ol><h1 id="ä½¿ç”¨coding-netæ­å»ºæœåŠ¡å™¨"><a href="#ä½¿ç”¨coding-netæ­å»ºæœåŠ¡å™¨" class="headerlink" title="ä½¿ç”¨coding.netæ­å»ºæœåŠ¡å™¨"></a>ä½¿ç”¨coding.netæ­å»ºæœåŠ¡å™¨</h1><ul><li>ç”³è¯·è´¦å·: <a href="https://coding.net/register" target="_blank" rel="noopener">https://coding.net/register</a></li><li>æ–°å»ºé¡¹ç›®<figure class="image-box">                <img src="/img/youkuvod/1.png" alt="youkuvod" title="" class="">                <p>youkuvod</p>            </figure></li></ul><blockquote><p>å¡«å†™åœ°å€ <code>https://github.com/xinshangshangxin/youkuvod.git</code></p></blockquote><figure class="image-box">                <img src="/img/youkuvod/2.png" alt="youkuvod" title="" class="">                <p>youkuvod</p>            </figure><blockquote><p>ç‚¹å‡»åˆ›å»ºåç­‰å¾…</p></blockquote><figure class="image-box">                <img src="/img/youkuvod/3.png" alt="youkuvod" title="" class="">                <p>youkuvod</p>            </figure><blockquote><p>ç‚¹å‡»æ¼”ç¤ºæŒ‰é’®</p></blockquote><figure class="image-box">                <img src="/img/youkuvod/4.png" alt="youkuvod" title="" class="">                <p>youkuvod</p>            </figure><figure class="image-box">                <img src="/img/youkuvod/5.png" alt="youkuvod" title="" class="">                <p>youkuvod</p>            </figure><figure class="image-box">                <img src="/img/youkuvod/6.png" alt="youkuvod" title="" class="">                <p>youkuvod</p>            </figure><figure class="image-box">                <img src="/img/youkuvod/7.png" alt="youkuvod" title="" class="">                <p>youkuvod</p>            </figure><blockquote><p>ç‚¹å‡» ä¸€é”®éƒ¨ç½²åç­‰å¾…; å¦‚æœç­‰å¾…æ—¶é—´ è¿‡é•¿; è¯·ç‚¹å‡»æŒ‰é’® <code>é‡å¯</code><br>å‡ºç°å¦‚å›¾æ‰€ç¤ºéƒ¨ç½²æˆåŠŸ</p></blockquote><figure class="image-box">                <img src="/img/youkuvod/9.png" alt="youkuvod" title="" class="">                <p>youkuvod</p>            </figure><blockquote><p><strong>[å¯ç•¥è¿‡æ­¤æ­¥]</strong> é»˜è®¤åªå¼€å¯ç¡•é¼ è§£æ;é£é©´è§£æéœ€è¦ç”³è¯· token; è¯·åˆ°<a href="https://www.flvxz.com/docs.php?doc=api" target="_blank" rel="noopener">é£é©´</a>ç”³è¯·<br>é£é©´tokenè®¾ç½®ç‚¹å‡»å·¦ä¾§<code>ç¯å¢ƒå˜é‡</code> </p></blockquote><p><img src="/img/youkuvod/8.png" alt="youkuvod"></p><blockquote><p><strong>æ·»åŠ è„šæœ¬</strong><br>chrome éœ€è¦ <a href="https://chrome.google.com/extensions/detail/dhdgffkkebhmkfjojejmpbldmpobfkfo" target="_blank" rel="noopener">Tampermonkey</a>;å¦‚æœæ— æ³•æ‰“å¼€ç½‘å€,è¯·è‡ªè¡Œç™¾åº¦<br>firefox è¯·è‡ªè¡Œå¯»æ‰¾,IE å†è§~~</p><blockquote><p>å¯ä»¥ç›´æ¥æ·»åŠ  <a href="https://greasyfork.org/zh-CN/scripts/2837-youkuvod" target="_blank" rel="noopener">greasyfork</a>çš„è„šæœ¬ä¿®æ”¹<br>ä¹Ÿå¯ä»¥å¤åˆ¶<a href="https://coding.net/u/youkuvod/p/youkuvod/git/raw/master/index.js" target="_blank" rel="noopener">coding.net</a> æ–°å»ºè„šæœ¬<br>æ–¹æ³•å¦‚å›¾:</p></blockquote></blockquote><figure class="image-box">                <img src="/img/youkuvod/12.png" alt="youkuvod" title="" class="">                <p>youkuvod</p>            </figure><blockquote><p><strong>ä¿®æ”¹è„šæœ¬</strong></p></blockquote><figure class="image-box">                <img src="/img/youkuvod/11.png" alt="youkuvod" title="" class="">                <p>youkuvod</p>            </figure><blockquote><p>æ‰“å¼€ä¼˜é…·, è¿›è¡Œæµ‹è¯•;<br>å‡ºç°ä¼˜é…·é¡µé¢è®¾ç½®(å¦‚å›¾) æˆåŠŸ!!</p></blockquote><figure class="image-box">                <img src="/img/youkuvod/10.png" alt="youkuvod" title="" class="">                <p>youkuvod</p>            </figure>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
            <tag> youkuvod </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>jsä½¿ç”¨æ­£åˆ™æ ¼å¼åŒ–æ—¶é—´[è½¬]</title>
      <link href="/2015/02/19/js%E4%BD%BF%E7%94%A8%E6%AD%A3%E5%88%99%E6%A0%BC%E5%BC%8F%E5%8C%96%E6%97%B6%E9%97%B4-%E8%BD%AC/"/>
      <url>/2015/02/19/js%E4%BD%BF%E7%94%A8%E6%AD%A3%E5%88%99%E6%A0%BC%E5%BC%8F%E5%8C%96%E6%97%B6%E9%97%B4-%E8%BD%AC/</url>
      
        <content type="html"><![CDATA[<p>JSæ²¡æœ‰æä¾›ç±»ä¼¼ format(â€˜yyyy-MM-dd hh:mm:ss.Sâ€™) çš„ æ—¶é—´æ ¼å¼åŒ–,åœ¨ç½‘ä¸Šæ‰¾åˆ°äº†ä¸€æ®µæç®€çš„ä»£ç å°† Date è½¬åŒ–ä¸ºæŒ‡å®šæ ¼å¼çš„String<br><a id="more"></a></p><blockquote><p>ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼çš„ RegExp.$1 æ¥åˆ¤æ–­ ä½¿ç”¨å¤šå°‘ä¸ªå ä½ç¬¦<br>è½¬è½½ä»¥å¤‡å¾…ç”¨</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¹Dateçš„æ‰©å±•ï¼Œå°† Date è½¬åŒ–ä¸ºæŒ‡å®šæ ¼å¼çš„String   </span></span><br><span class="line"><span class="comment">// æœˆ(M)ã€æ—¥(d)ã€å°æ—¶(h)ã€åˆ†(m)ã€ç§’(s)ã€å­£åº¦(q) å¯ä»¥ç”¨ 1-2 ä¸ªå ä½ç¬¦ï¼Œ   </span></span><br><span class="line"><span class="comment">// å¹´(y)å¯ä»¥ç”¨ 1-4 ä¸ªå ä½ç¬¦ï¼Œæ¯«ç§’(S)åªèƒ½ç”¨ 1 ä¸ªå ä½ç¬¦(æ˜¯ 1-3 ä½çš„æ•°å­—)   </span></span><br><span class="line"><span class="comment">// ä¾‹å­ï¼š   </span></span><br><span class="line"><span class="comment">// (new Date()).Format('yyyy-MM-dd hh:mm:ss.S') ==&gt; 2006-07-02 08:09:04.423   </span></span><br><span class="line"><span class="comment">// (new Date()).Format('yyyy-M-d h:m:s.S')      ==&gt; 2006-7-2 8:9:4.18   </span></span><br><span class="line"><span class="comment">//author: meizz   </span></span><br><span class="line"><span class="built_in">Date</span>.prototype.Format = <span class="function"><span class="keyword">function</span>(<span class="params">fmt</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> o = &#123;</span><br><span class="line">        <span class="string">'M+'</span>: <span class="keyword">this</span>.getMonth() + <span class="number">1</span>, <span class="comment">//æœˆä»½   </span></span><br><span class="line">        <span class="string">'d+'</span>: <span class="keyword">this</span>.getDate(), <span class="comment">//æ—¥   </span></span><br><span class="line">        <span class="string">'h+'</span>: <span class="keyword">this</span>.getHours(), <span class="comment">//å°æ—¶   </span></span><br><span class="line">        <span class="string">'m+'</span>: <span class="keyword">this</span>.getMinutes(), <span class="comment">//åˆ†   </span></span><br><span class="line">        <span class="string">'s+'</span>: <span class="keyword">this</span>.getSeconds(), <span class="comment">//ç§’   </span></span><br><span class="line">        <span class="string">'q+'</span>: <span class="built_in">Math</span>.floor((<span class="keyword">this</span>.getMonth() + <span class="number">3</span>) / <span class="number">3</span>), <span class="comment">//å­£åº¦   </span></span><br><span class="line">        <span class="string">'S'</span>: <span class="keyword">this</span>.getMilliseconds() <span class="comment">//æ¯«ç§’   </span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">if</span> (<span class="regexp">/(y+)/</span>.test(fmt)) &#123;</span><br><span class="line">        fmt = fmt.replace(<span class="built_in">RegExp</span>.$<span class="number">1</span>, (<span class="keyword">this</span>.getFullYear() + <span class="string">''</span>).substr(<span class="number">4</span> - <span class="built_in">RegExp</span>.$<span class="number">1.</span>length));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> k <span class="keyword">in</span> o) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">'('</span> + k + <span class="string">')'</span>).test(fmt)) &#123;</span><br><span class="line">            fmt = fmt.replace(<span class="built_in">RegExp</span>.$<span class="number">1</span>, (<span class="built_in">RegExp</span>.$<span class="number">1.</span>length == <span class="number">1</span>) ? (o[k]) : ((<span class="string">'00'</span> + o[k]).substr((<span class="string">''</span> + o[k]).length)));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> fmt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>npmå®‰è£…moduleså¤±è´¥</title>
      <link href="/2015/02/18/npm%E5%AE%89%E8%A3%85modules%E5%A4%B1%E8%B4%A5/"/>
      <url>/2015/02/18/npm%E5%AE%89%E8%A3%85modules%E5%A4%B1%E8%B4%A5/</url>
      
        <content type="html"><![CDATA[<p>npmå®‰è£…moduleså¤±è´¥è§£å†³æ–¹æ³•,ä»¥åŠwindowsä¸‹æ— æ³•åˆ é™¤modulesè§£å†³åŠæ³•<br><a id="more"></a></p><h1 id="npmå®‰è£…moduleså¤±è´¥"><a href="#npmå®‰è£…moduleså¤±è´¥" class="headerlink" title="npmå®‰è£…moduleså¤±è´¥"></a>npmå®‰è£…moduleså¤±è´¥</h1><h2 id="è®¾ç½®ä»£ç†æœåŠ¡å™¨"><a href="#è®¾ç½®ä»£ç†æœåŠ¡å™¨" class="headerlink" title="è®¾ç½®ä»£ç†æœåŠ¡å™¨"></a>è®¾ç½®ä»£ç†æœåŠ¡å™¨</h2><blockquote><p>è®¾ç½®GoAgentä»£ç†åœ¨æˆ‘è¿™é‡Œå¤±è´¥äº†â€¦â€¦</p></blockquote><h3 id="ç”¨çº¯æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€ç¼–è¾‘"><a href="#ç”¨çº¯æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€ç¼–è¾‘" class="headerlink" title="ç”¨çº¯æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€ç¼–è¾‘"></a>ç”¨çº¯æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€ç¼–è¾‘</h3><h4 id="ç”¨æˆ·é…ç½®æˆ–è€…å…¨å±€é…ç½®-2é€‰1å³å¯"><a href="#ç”¨æˆ·é…ç½®æˆ–è€…å…¨å±€é…ç½®-2é€‰1å³å¯" class="headerlink" title="ç”¨æˆ·é…ç½®æˆ–è€…å…¨å±€é…ç½®[2é€‰1å³å¯]"></a>ç”¨æˆ·é…ç½®æˆ–è€…å…¨å±€é…ç½®[2é€‰1å³å¯]</h4><ul><li><p>è·å–ç”¨æˆ·é…ç½®æ–‡ä»¶è·¯å¾„</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm config get userconfig</span><br></pre></td></tr></table></figure></li><li><p>è·å–å…¨å±€é…ç½®æ–‡ä»¶è·¯å¾„</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm config get globalconfig</span><br></pre></td></tr></table></figure></li><li><p>ç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€ååŠ ä¸Š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">proxy = http:<span class="comment">//server:port</span></span><br><span class="line">https-proxy = http:<span class="comment">//server:port</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="ç”¨cmdç¼–è¾‘ä»£ç†"><a href="#ç”¨cmdç¼–è¾‘ä»£ç†" class="headerlink" title="ç”¨cmdç¼–è¾‘ä»£ç†"></a>ç”¨cmdç¼–è¾‘ä»£ç†</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm config set proxy http:<span class="comment">//server:port</span></span><br><span class="line">npm config set https-proxy http:<span class="comment">//server:port</span></span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨ä¼˜ç§€çš„npmé•œåƒèµ„æº-æˆ‘æ­£åœ¨ä½¿ç”¨çš„"><a href="#ä½¿ç”¨ä¼˜ç§€çš„npmé•œåƒèµ„æº-æˆ‘æ­£åœ¨ä½¿ç”¨çš„" class="headerlink" title="ä½¿ç”¨ä¼˜ç§€çš„npmé•œåƒèµ„æº æˆ‘æ­£åœ¨ä½¿ç”¨çš„"></a>ä½¿ç”¨ä¼˜ç§€çš„npmé•œåƒèµ„æº <em>æˆ‘æ­£åœ¨ä½¿ç”¨çš„</em></h2><blockquote><p><strong>æ·˜å®npmé•œåƒ</strong><br>æœç´¢åœ°å€ï¼š<a href="http://npm.taobao.org/" target="_blank" rel="noopener">http://npm.taobao.org/</a><br>registryåœ°å€ï¼š<a href="http://registry.npm.taobao.org/" target="_blank" rel="noopener">http://registry.npm.taobao.org/</a></p><p><strong>cnpmjsé•œåƒ</strong><br>æœç´¢åœ°å€ï¼š<a href="http://cnpmjs.org/" target="_blank" rel="noopener">http://cnpmjs.org/</a><br>registryåœ°å€ï¼š<a href="http://r.cnpmjs.org/" target="_blank" rel="noopener">http://r.cnpmjs.org/</a></p></blockquote><h3 id="ä¸´æ—¶ä½¿ç”¨"><a href="#ä¸´æ—¶ä½¿ç”¨" class="headerlink" title="ä¸´æ—¶ä½¿ç”¨"></a>ä¸´æ—¶ä½¿ç”¨</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm --registry https:<span class="comment">//registry.npm.taobao.org install express</span></span><br></pre></td></tr></table></figure><h3 id="æŒä¹…ä½¿ç”¨"><a href="#æŒä¹…ä½¿ç”¨" class="headerlink" title="æŒä¹…ä½¿ç”¨"></a>æŒä¹…ä½¿ç”¨</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">npm config set registry https:<span class="comment">//registry.npm.taobao.org</span></span><br><span class="line"><span class="comment">// é…ç½®åå¯é€šè¿‡ä¸‹é¢æ–¹å¼æ¥éªŒè¯æ˜¯å¦æˆåŠŸ</span></span><br><span class="line">npm config get registry</span><br><span class="line"><span class="comment">// æˆ–</span></span><br><span class="line">npm info express</span><br></pre></td></tr></table></figure><h1 id="windowsä¸‹æ— æ³•åˆ é™¤modules-æç¤ºæ‰¾ä¸åˆ°æ–‡ä»¶"><a href="#windowsä¸‹æ— æ³•åˆ é™¤modules-æç¤ºæ‰¾ä¸åˆ°æ–‡ä»¶" class="headerlink" title="windowsä¸‹æ— æ³•åˆ é™¤modules, æç¤ºæ‰¾ä¸åˆ°æ–‡ä»¶"></a>windowsä¸‹æ— æ³•åˆ é™¤modules, æç¤ºæ‰¾ä¸åˆ°æ–‡ä»¶</h1><blockquote><p>googleäº†ä¸‹,åœ¨ <a href="stackoverflow.com">stackoverflow.com</a>ä¸Šæ‰¾åˆ°äº†ç­”æ¡ˆ:<br><code>Windowsä¸‹æ–‡ä»¶åµŒå¥—é•¿åº¦æ— æ³•è¶…è¿‡256å­—ç¬¦,</code>æ‰€ä»¥å°±åªèƒ½æŠŠæ–‡ä»¶åç§°æ”¹çŸ­äº†,æœ‰äººç»™äº† <code>.bat</code>æ–‡ä»¶</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@echo off</span><br><span class="line"><span class="keyword">if</span> not (%<span class="number">1</span>)==() cd %<span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> /D %%i <span class="keyword">in</span> (*) <span class="keyword">do</span> <span class="keyword">if</span> not %%i==_ ren <span class="string">"%%i"</span> _</span><br><span class="line">pushd _ </span><br><span class="line">%<span class="number">0</span> </span><br><span class="line">popd</span><br></pre></td></tr></table></figure><blockquote><p>æ–°å»ºæ–‡æœ¬æ–‡ä»¶;å¤åˆ¶ä¸Šé¢çš„ä»£ç å¹¶ä¿å­˜, é‡æ–°å‘½åæ–‡ä»¶ä¸º <code>æ–‡ä»¶åè¿‡é•¿.bat</code><br>å°†ä½ è¦åˆ é™¤çš„modules æ‹–åˆ°è¿™ä¸ª <code>æ–‡ä»¶åè¿‡é•¿.bat</code>ä¸Š;å‡ºç°ä¸‹é¢çš„æˆªå›¾å†…å®¹å…³é—­</p></blockquote><figure class="image-box">                <img src="/img/npm/1.png" alt="" title="" class="">                <p></p>            </figure><blockquote><p>æ¥ç€å†åˆ é™¤è¿™ä¸ª æ–‡ä»¶å¤¹; å¦‚æœè¿˜æ˜¯åˆ é™¤ä¸äº†;ç”¨ä¸‹é¢çš„ bat;ç”¨æ³•å’Œä¸Šé¢ä¸€æ ·</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">DEL /F /A /Q \\?\%<span class="number">1</span></span><br><span class="line">RD /S /Q \\?\%<span class="number">1</span></span><br></pre></td></tr></table></figure><blockquote><p>è¿˜æ˜¯æ— æ³•åˆ é™¤?!! æ‰‹åŠ¨è¿›å…¥æ–‡ä»¶å¤¹;æŸ¥çœ‹å“ªä¸ªæ–‡ä»¶å¤¹çš„åç§°ä¸æ˜¯ <code>_</code> ,å†ä½¿ç”¨ç¬¬ä¸€ä¸ª<code>bat</code>æ–‡ä»¶,å°è¯•åˆ é™¤;å¦‚æ­¤å¾ªç¯â€¦.</p></blockquote><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><ol><li><a href="stackoverflow.com">stackoverflow.com</a></li><li><a href="http://www.cnblogs.com/huang0925/archive/2013/05/07.html" target="_blank" rel="noopener">Npmçš„é…ç½®ç®¡ç†åŠè®¾ç½®ä»£ç†</a></li><li><a href="http://riny.net/2014/cnpm/" target="_blank" rel="noopener">å›½å†…ä¼˜ç§€npmé•œåƒæ¨èåŠä½¿ç”¨</a></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> node </tag>
            
            <tag> npm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cordova_Intellij é…ç½®</title>
      <link href="/2015/02/17/Cordova%E5%AF%BC%E5%85%A5IntelliJ-IDEA/"/>
      <url>/2015/02/17/Cordova%E5%AF%BC%E5%85%A5IntelliJ-IDEA/</url>
      
        <content type="html"><![CDATA[<p>ä½¿ç”¨Intellij æ­å»ºç¬¬ä¸€ä¸ªcordova æ··åˆåº”ç”¨ç¨‹åº;ä»¥ windows å’Œ andorid ä¸ºä¾‹<br><a id="more"></a></p><h1 id="ç¯å¢ƒå˜é‡é…ç½®-Android"><a href="#ç¯å¢ƒå˜é‡é…ç½®-Android" class="headerlink" title="ç¯å¢ƒå˜é‡é…ç½®[Android]"></a>ç¯å¢ƒå˜é‡é…ç½®[Android]</h1><blockquote><p>ANT_HOME<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\Program Files\ant</span><br></pre></td></tr></table></figure></p></blockquote><blockquote><p>ANDROID_HOME<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\Program Files\adt-bundle-windows-x86_64<span class="number">-20140321</span>\sdk</span><br></pre></td></tr></table></figure></p></blockquote><blockquote><p>JAVA_HOME<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\Program Files\Java\jdk1<span class="number">.7</span><span class="number">.0</span>_05</span><br></pre></td></tr></table></figure></p></blockquote><blockquote><p>æ·»åŠ åˆ°PATH<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%JAVA_HOME%\bin;%ANT_HOME%\bin;%ANDROID_HOME%\platform-tools;%ANDROID_HOME%\tools;</span><br></pre></td></tr></table></figure></p></blockquote><h1 id="nodejsä¸‹è½½å®‰è£…"><a href="#nodejsä¸‹è½½å®‰è£…" class="headerlink" title="nodejsä¸‹è½½å®‰è£…"></a>nodejsä¸‹è½½å®‰è£…</h1><blockquote><ul><li><a href="http://nodejs.org/" target="_blank" rel="noopener">å®˜ç½‘ä¸‹è½½nodejs</a></li><li>å®‰è£…ç›´æ¥ä¸‹ä¸€æ­¥â€¦â€¦å®‰è£…å®Œæˆ</li><li>æ–°çš„CMD æµ‹è¯•ä¸‹ <code>node -v</code> å’Œ <code>npm -v</code>; æ˜¾ç¤ºç‰ˆæœ¬å·åˆ™å®‰è£…æˆåŠŸ</li></ul></blockquote><h1 id="cordova-æ„å»ºåº”ç”¨"><a href="#cordova-æ„å»ºåº”ç”¨" class="headerlink" title="cordova æ„å»ºåº”ç”¨"></a>cordova æ„å»ºåº”ç”¨</h1><ol><li><p>å®‰è£…cordova</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g cordova</span><br></pre></td></tr></table></figure></li><li><p>åˆ›å»ºApp</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">d:</span><br><span class="line">cd d:<span class="regexp">/android</span></span><br><span class="line"><span class="regexp">cordova create hello com.example.hello HelloWorld</span></span><br></pre></td></tr></table></figure></li><li><p>è¿›å…¥ hello ç›®å½•</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd hello</span><br></pre></td></tr></table></figure></li><li><p>æ·»åŠ å¹³å° <em>åªé…ç½®äº†androidç¯å¢ƒ;æ‰€ä»¥åªéœ€è¦ç¬¬ä¸€æ¡å‘½ä»¤</em></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cordova platform add android</span><br><span class="line">cordova platform add ios</span><br><span class="line">cordova platform add amazon-fireos</span><br><span class="line">cordova platform add blackberry10</span><br><span class="line">cordova platform add firefoxos</span><br></pre></td></tr></table></figure></li><li><p>æ„é€ App</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cordova build</span><br></pre></td></tr></table></figure></li></ol><h1 id="Intellij-IDEAå¯¼å…¥é¡¹ç›®"><a href="#Intellij-IDEAå¯¼å…¥é¡¹ç›®" class="headerlink" title="Intellij IDEAå¯¼å…¥é¡¹ç›®"></a>Intellij IDEAå¯¼å…¥é¡¹ç›®</h1><figure class="image-box">                <img src="/img/Intellij_cordova/2.png" alt="Intellij_cordova" title="" class="">                <p>Intellij_cordova</p>            </figure><blockquote><p><em>é€‰æ‹©å®‰è£… hello çš„æ ¹ç›®å½•</em></p></blockquote><figure class="image-box">                <img src="/img/Intellij_cordova/3.png" alt="Intellij_cordova" title="" class="">                <p>Intellij_cordova</p>            </figure><blockquote><p><em>é€‰æ‹© create</em></p></blockquote><figure class="image-box">                <img src="/img/Intellij_cordova/4.png" alt="Intellij_cordova" title="" class="">                <p>Intellij_cordova</p>            </figure><figure class="image-box">                <img src="/img/Intellij_cordova/5.png" alt="Intellij_cordova" title="" class="">                <p>Intellij_cordova</p>            </figure><figure class="image-box">                <img src="/img/Intellij_cordova/6.png" alt="Intellij_cordova" title="" class="">                <p>Intellij_cordova</p>            </figure><blockquote><p><strong>æ³¨æ„!!!</strong></p></blockquote><figure class="image-box">                <img src="/img/Intellij_cordova/7.png" alt="Intellij_cordova" title="" class="">                <p>Intellij_cordova</p>            </figure><figure class="image-box">                <img src="/img/Intellij_cordova/8.png" alt="Intellij_cordova" title="" class="">                <p>Intellij_cordova</p>            </figure><figure class="image-box">                <img src="/img/Intellij_cordova/9.png" alt="Intellij_cordova" title="" class="">                <p>Intellij_cordova</p>            </figure><figure class="image-box">                <img src="/img/Intellij_cordova/10.png" alt="Intellij_cordova" title="" class="">                <p>Intellij_cordova</p>            </figure><blockquote><p><strong>æ³¨æ„!!!</strong></p></blockquote><figure class="image-box">                <img src="/img/Intellij_cordova/11.png" alt="Intellij_cordova" title="" class="">                <p>Intellij_cordova</p>            </figure><h1 id="å…¶ä»–å¯èƒ½é—®é¢˜"><a href="#å…¶ä»–å¯èƒ½é—®é¢˜" class="headerlink" title="å…¶ä»–å¯èƒ½é—®é¢˜:"></a>å…¶ä»–å¯èƒ½é—®é¢˜:</h1><h3 id="usbè°ƒè¯•"><a href="#usbè°ƒè¯•" class="headerlink" title="usbè°ƒè¯•"></a>usbè°ƒè¯•</h3><figure class="image-box">                <img src="/img/Intellij_cordova/13.png" alt="Intellij_cordova" title="" class="">                <p>Intellij_cordova</p>            </figure><blockquote><p><em>å¦‚æœæ²¡æœ‰å›¾ä¸­æ‰€ç¤ºçš„Android; å°±å…ˆåœ¨å³ä¾§é¡¹ç›®ä¸Šå³é”® ç‚¹å‡» run all test</em></p></blockquote><figure class="image-box">                <img src="/img/Intellij_cordova/12.png" alt="Intellij_cordova" title="" class="">                <p>Intellij_cordova</p>            </figure><h3 id="source-1-3-ä¸­ä¸æ”¯æŒæ³¨é‡Š-è¯·ä½¿ç”¨-source-5-æˆ–æ›´é«˜ç‰ˆæœ¬ä»¥â€¦"><a href="#source-1-3-ä¸­ä¸æ”¯æŒæ³¨é‡Š-è¯·ä½¿ç”¨-source-5-æˆ–æ›´é«˜ç‰ˆæœ¬ä»¥â€¦" class="headerlink" title="source 1.3 ä¸­ä¸æ”¯æŒæ³¨é‡Š (è¯·ä½¿ç”¨ -source 5 æˆ–æ›´é«˜ç‰ˆæœ¬ä»¥â€¦"></a>source 1.3 ä¸­ä¸æ”¯æŒæ³¨é‡Š (è¯·ä½¿ç”¨ -source 5 æˆ–æ›´é«˜ç‰ˆæœ¬ä»¥â€¦</h3><blockquote><p><a href="http://stackoverflow.com/questions/17714584/what-is-project-language-level-in-intellij-idea&quot;å‚è€ƒèµ„æ–™&quot;" target="_blank" rel="noopener">Set language level via File &gt; Project Structure &gt; Project &gt; Project language level</a></p></blockquote><figure class="image-box">                <img src="/img/Intellij_cordova/14.png" alt="Intellij_cordova" title="" class="">                <p>Intellij_cordova</p>            </figure><figure class="image-box">                <img src="/img/Intellij_cordova/15.png" alt="Intellij_cordova" title="" class="">                <p>Intellij_cordova</p>            </figure><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><p><a href="http://www.it165.net/pro/html/201407/17784.html" target="_blank" rel="noopener">http://www.it165.net/pro/html/201407/17784.html</a><br><a href="http://www.cnblogs.com/or2-/p/3842158.html" target="_blank" rel="noopener">http://www.cnblogs.com/or2-/p/3842158.html</a><br><a href="http://cordova.apache.org/docs/zh/edge/_index.html" target="_blank" rel="noopener">å®˜æ–¹æ’ä»¶</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> cordova </tag>
            
            <tag> Intellij </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
